-- MySQL dump 10.11
--
-- Host: localhost    Database: scoop
-- ------------------------------------------------------
-- Server version	5.0.32-Debian_7etch8-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `blocks`
--

DROP TABLE IF EXISTS `blocks`;
CREATE TABLE `blocks` (
  `bid` varchar(30) NOT NULL default '',
  `block` text,
  `aid` varchar(20) default NULL,
  `description` text,
  `category` varchar(128) NOT NULL default 'general',
  `theme` varchar(32) NOT NULL default 'default',
  `language` varchar(10) NOT NULL default 'en',
  PRIMARY KEY  (`bid`,`theme`,`language`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Dumping data for table `blocks`
--

LOCK TABLES `blocks` WRITE;
/*!40000 ALTER TABLE `blocks` DISABLE KEYS */;
INSERT INTO `blocks` VALUES ('','\n','1',NULL,'general','default','en'),('admin_alert_body','This is an administrative alert from the site %%sitename%%, \nat %%site_url%%%%rootdir%%. The event that \ntriggered this message was:\n\nevent: %%warning%%\n user: %%uid%%, \"%%nick%%\"\n   ip: %%ip%%\n\nYou may take further action by editing this user, at the url:\n\n%%user_pref%%\n\nThe user\'s info page is at:\n\n%%user_info%%\n\n\n--%%from%%','1','<P>The body for admin alert emails, sent to all emails in the site control <B>admin_alert</B> when something happens that the admins need to know about. This is an email and thus not sent through the usual page processing; the only keys recognized are the ones specifically defined for this block. The special keys recognized are:</P>\n<DL>\n <DT>from</DT>\n  <DD>The contents of the site control <B>local_email</B></DD>\n <DT>sitename, site_url, rootdir</DT>\n  <DD>The contents of the site controls of the same name</DD>\n <DT>warning</DT>\n  <DD>The text of the warning, generated in the code</DD>\n <DT>nick</DT>\n  <DD>The nickname of the user who did something to trigger the warning</DD>\n <DT>uid</DT>\n  <DD>The user ID of the user who did something to trigger the warning</DD>\n <DT>ip</DT>\n  <DD>The IP address the above user was coming from</DD>\n <DT>user_pref</DT>\n  <DD>The link to the protected preferences page for the above user (email, password, permission group, etc)</DD>\n <DT>user_info</DT>\n  <DD>The link to the user info page for the above user</DD>\n</DL>','Emails','default','en'),('admin_alert_subject','Admin Alert from %%sitename%%: %%warning%%','1','<P>The subject line for admin alert emails, sent to all emails in the site control <B>admin_alert</B> when something happens that the admins need to know about. This is an email and thus not sent through the usual page processing; the only keys recognized are the ones specifically defined for this block. The special keys recognized are:</P>\n<DL>\n <DT>from</DT>\n  <DD>The contents of the site control <B>local_email</B></DD>\n <DT>sitename, site_url, rootdir</DT>\n  <DD>The contents of the site controls of the same name</DD>\n <DT>warning</DT>\n  <DD>The text of the warning, generated in the code</DD>\n <DT>nick</DT>\n  <DD>The nickname of the user who did something to trigger the warning</DD>\n <DT>uid</DT>\n  <DD>The user ID of the user who did something to trigger the warning</DD>\n <DT>ip</DT>\n  <DD>The IP address the above user was coming from</DD>\n <DT>user_pref</DT>\n  <DD>The link to the protected preferences page for the above user (email, password, permission group, etc)</DD>\n <DT>user_info</DT>\n  <DD>The link to the user info page for the above user</DD>\n</DL>','Emails','default','en'),('admin_boxes_form','<form name=\"boxes\" action=\"%%rootdir%%/admin/boxes\" method=\"post\">\r\n  <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\r\n    <tr>\r\n      <td bgcolor=\"%%title_bgcolor%%\">%%title_font%%Edit Boxes</font></td>\r\n    </tr>\r\n    <tr><td>%%title_font%%<font color=\"#FF0000\">%%admin_boxes_errormsg%%</font></font></td></tr>\r\n    <tr>   \r\n      <td>%%norm_font%%<b>Box:</b> %%admin_boxes_box_menu%%\r\n        <input type=\"submit\" name=\"get\" value=\"Get Box\"></font></td>\r\n    </tr><tr><td>\r\n%%norm_font%%<b>%%admin_boxes_delete_check%%</b></font>\r\n</td></tr>\r\n    <tr>\r\n      <td>%%norm_font%%<b>Box ID:</b>\r\n        <input type=\"text\" name=\"boxid\" value=\"%%admin_boxes_boxid%%\" size=\"40\">\r\n      </font></td>\r\n    </tr>\r\n    <tr>\r\n      <td>%%norm_font%%<b>Title:</b>\r\n        <input type=\"text\" name=\"title\" value=\"%%admin_boxes_title%%\" size=\"40\">\r\n      </font></td>\r\n    </tr>\r\n    <tr>\r\n      <td>%%norm_font%%<b>Template:</b>%%admin_boxes_template_menu%% %%admin_boxes_template_link%%</font></td>\r\n    </tr>\r\n    <tr>\r\n      <td><input type=\"checkbox\" name=\"choose\" value=\"1\" %%admin_boxes_choose_checked%%>\r\n        %%norm_font%%Allow users to toggle box off%%norm_font_end%%\r\n      </td>\r\n    </tr>\r\n    <tr><td>%%norm_font%%<b>Description:</b></td></tr>\r\n    <tr>\r\n      <td>%%norm_font%%\r\n        <textarea cols=\"50\" rows=\"3\" name=\"description\" wrap=\"soft\">%%admin_boxes_description%%</textarea>\r\n      </font></td>\r\n    </tr>\r\n    <tr><td>%%norm_font%%<b>Content:</b></td></tr>\r\n    <tr><td>%%norm_font%%\r\n      <textarea cols=\"50\" rows=\"25\" name=\"content\">%%admin_boxes_content%%</textarea>\r\n    </font></td></tr>\r\n    <tr><td>%%norm_font%%\r\n      <input type=\"submit\" name=\"write\" value=\"Save Box\"> <input type=\"reset\">\r\n    </font></td></tr>\r\n  </table>\r\n</form>  \r\n',NULL,'<P>This block is used to create the Box Admin Tool page.  It must contain all of the form elements used in the Box Admin page, and should be self-contained HTML.  The special keys recognised are:</P>\r\n<DL>\r\n <DT>admin_boxes_errormsg</DT>\r\n  <DD>A message indicating whether a save was successful or not, and if not, the text of the error message</DD>\r\n <DT>admin_boxes_box_menu</DT>\r\n  <DD>The select box used to choose a box to edit</DD>\r\n <DT>admin_boxes_delete_check</DT>\r\n  <DD>The delete checkbox displayed when a box is being edited</DD>\r\n <DT>admin_boxes_template_menu</DT>\r\n  <DD>The select box used to choose the box template to use for a particular box</DD>\r\n <DT>admin_boxes_template_link</DT>\r\n  <DD>A link to the block admin tool to edit the box template selected for the box currently being edited</DD>\r\n <DT>admin_boxes_choose_checked</DT>\r\n  <DD>The \"checked\" status of the checkbox which determines whether or not the users can choose to show or hide that particular box in their display preferences</DD>\r\n <DT>admin_boxes_boxid</DT>\r\n  <DD>The name of the box currently being edited</DD>\r\n <DT>admin_boxes_title</DT>\r\n  <DD>The title of the box currently being edited</DD>\r\n <DT>admin_boxes_description</DT>\r\n  <DD>The description of the box currently being edited</DD>\r\n <DT>admin_boxes_content</DT>\r\n  <DD>The perl code of the box currently being edited</DD>\r\n </DL>\r\n<P>Do not change the names of the form elements, or remove any form elements, or box editing may fail in unexpected ways.</P>','Admin Pages','default','en'),('admin_calendar_list','<P>%%msg%%</P>\n\n<TABLE width=\"100%\" cellpadding=\"2px\" cellspacing=\"0\">\n  <TR>\n    <TH>Calendar</TH>\n    <TH>Owner</TH>\n    <TH>Actions</TH>\n  </TR>\n%%calendar_list_rows%%\n</TABLE>\n\n<FORM name=\"newcal\" action=\"%%rootdir%%/admin/calendar/list\" method=\"POST\">\n  <P><B>Create a new site-wide calendar</B></P>\n  <P>Title: <INPUT type=\"text\" name=\"title\" size=\"30\">\n  <FIELDSET><LEGEND>View Permissions:</LEGEND>\n  <INPUT type=\"radio\" name=\"public_view\" value=\"public\"> Everybody\n  <BR><INPUT type=\"radio\" name=\"public_view\" value=\"invite\"> Only people on the invitation list\n  <BR><INPUT type=\"radio\" name=\"public_view\" value=\"private\"> Only admins\n  </FIELDSET><BR>\n  <FIELDSET><LEGEND>Submit permissions:</LEGEND>\n  <INPUT type=\"radio\" name=\"public_submit\" value=\"public\"> Everybody\n  <BR><INPUT type=\"radio\" name=\"public_submit\" value=\"modpublic\"> Everybody, but an admin will review the events before they\'re visible\n  <BR><INPUT type=\"radio\" name=\"public_submit\" value=\"invite\"> Only people on the invitation list\n  <BR><INPUT type=\"radio\" name=\"public_submit\" value=\"modinvite\"> Only people on the invitation list, but an admin will review the events before they\'re visible\n  <BR><INPUT type=\"radio\" name=\"public_submit\" value=\"private\"> Only admins</FIELDSET>\n  <BR><INPUT type=\"submit\" name=\"create\" value=\"Create\"></P>\n  \n</FORM>','1','<P>This block creates the calendar list admin tool. This is inserted into the block <B>admin_calendar_main</b> when you are working specifically with the calendar list. The names of the form elements should not be changed. The following special keys are recognized:</p>\n<DL>\n <DT>msg</dt>\n  <DD>Any status or error messages.</dd>\n <DT>calendar_list_rows</dt>\n  <DD>All of the rows containing the calendars. Each row is built from the block <B>admin_calendar_list_item</b>.</dd>\n</dl>','Admin Pages','default','en'),('admin_calendar_list_item','  <TR>\n    <TD><A href=\"%%rootdir%%/calendar//%%cal_id%%\">%%title%%</A><BR>%%description%%</TD>\n    <TD><A href=\"%%rootdir%%/user/%%owner_nick%%\">%%owner_nick%%</A></TD>\n    <TD>[<A href=\"%%rootdir%%/admin/calendar/list?delete=%%cal_id%%\">delete</A>] [<A href=\"%%rootdir%%/editcalendar/settings/%%cal_id%%\">edit</A>]</TD>\n  </TR>\n','1','<P>This block formats a single item of the calendar list admin tool. The following special keys are recognized:</p>\n<DL>\n <DT>cal_id</dt>\n  <DD>The ID number of the calendar being formatted here</dd>\n <DT>title</dt>\n  <DD>The calendar\'s title</dd>\n <DT>owner</dt>\n  <DD>The calendar\'s owner\'s UID</dd>\n <DT>owner_nick</dt>\n  <DD>The calendar\'s owner\'s nickname</dd>\n <DT>description</dt>\n  <DD>The calendar description</dd>\n <DT>public_view</dt>\n  <DD>The view permission status</dd>\n <DT>public_submit</dt>\n  <DD>The event submission permission status</dd>\n</dl>','Admin Pages','default','en'),('admin_calendar_main','  <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n    <tr>\n      <td bgcolor=\"%%title_bgcolor%%\">%%title_font%%Events and Calendars%%title_font_end%%</td>\n    </tr>\n  </table>\n  <P><a href=\"%%rootdir%%/admin/calendar/list\">Calendar List</A>\n  <A href=\"%%rootdir%%/admin/calendar/eventlist\">Event List</A>\n  <A href=\"%%rootdir%%/admin/calendar/eventproperties\">Event Properties</A></P>\n\n%%calendar_form%%\n','1','<P>This block is used to create the Calendars Admin Tool page.  It should be self-contained HTML.  The special keys recognised are:</p>\n<DL>\n <DT>calendar_form</dt>\n  <DD>The page for the particular tool requested within the calendar admin tool</dd>\n</dl>\n','Admin Pages','default','en'),('admin_event_list','<P>%%error_font%%%%admin_events_errormsg%%%%error_font_end%%</P>\n<P>%%prevlink%%</P>\n<table width=\"100%\" cellpadding=\"2px\" cellspacing=\"0\">\n  <tr>\n    <th>Event</th>\n    <th>Organizer</th>\n    <th>Calendar(s)</th>\n  </tr>\n%%list%%\n</table>\n<P align=\"right\">%%nextlink%%</P>\n','1','<P>This block is used to create the Event List for the Calendar Admin Tool.</p>\n<DL>\n <DT>admin_events_errmsg</dt>\n  <DD>Any error or status message</dd>\n <DT>prevlink</dt>\n  <DD>If we are not on the first page, a link to the previous page. Formatted with the block <B>prev_page_link</b></dd>\n <DT>nextlink</dt>\n  <DD>If there are more events than those shown on this and earlier pages, a link to the next page. Formatted with the block <B>next_page_link</b></dd>\n <DT>list</dt>\n  <DD>The actual list of events. Each row is formatted using the block <B>admin_event_list_item</b></dd>\n</dl>','Admin Pages','default','en'),('admin_event_list_item','  <tr bgcolor=\"%%rowbg%%\">\n    <td><A href=\"%%rootdir%%/event/%%eid%%\">%%title%%</A> [<A href=\"%%rootdir%%/submitevent/edit/%%eid%%\">edit</A>] (%%date_start%%)</td>\n    <td><A href=\"%%rootdir%%/user/%%owner_nick%%\">%%owner_nick%%</A></td>\n    <td>%%cal_list%%</td>\n  </tr>\n','1','<P>This block is used to format each row in the event list in the calendars admin tool. The following special keys are recognized:</p>\n<DL>\n <DT>eid</dt>\n  <DD>The event ID number</dd>\n <DT>rowbg</dt>\n  <DD>This toggles between blank and the value in <B>story_mod_bg</b> so rows can be easily distinguished</dd>\n <DT>owner_nick</dt>\n  <DD>The event owner\'s nickname</dd>\n <DT>cal_list</dt>\n  <DD>The list of calendars this event is included in, each formatted using the block <B>admin_event_list_item_cals</b></dd>\n</dl>\n<P>Also recognized are all valid event fields, including all built-in fields and all fields defined in Event Properties.</p>','Admin Pages','default','en'),('admin_event_list_item_cals','%%primary_marker%% <A href=\"%%rootdir%%/calendar//%%cal_id%%/%%date_start%%\">%%title%%</A> [<A href=\"%%rootdir%%/editcalendar/settings/%%cal_id%%\">edit</A>] <A href=\"%%rootdir%%/user/%%owner_nick%%\">%%owner_nick%%</A><br>\n','1','<P>This block is used to format each calendar an event is included in, for the event list in the calendars admin tool. The special keys recognized are:</p>\n<DL>\n <DT>primary_marker</dt>\n  <DD>A mark used to indicated which calendar the event is primarily associated with and hence where it draws its permissions from</dd>\n <DT>cal_id</dt>\n  <DD>The ID number of the calendar</dd>\n <DT>owner_nick</dt>\n  <DD>The owner of the calendar\'s nickname</dd>\n</dl>\n<P>Also recognized are all calendar properties and all event properties and event fields which do not share a name with a calendar property.</p>','Admin Pages','default','en'),('admin_event_properties','<form name=\"event_properties\" action=\"%%rootdir%%/admin/calendar/eventproperties\" method=\"post\">\n  <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n    <tr><td>%%error_font%%%%admin_events_errormsg%%%%error_font_end%%</td></tr>\n    <tr>   \n      <td>%%norm_font%%<b>Property:</b> %%admin_events_property_menu%%\n        <input type=\"submit\" name=\"get\" value=\"Get Event Property\" /></font></td>\n    </tr><tr><td>\n%%norm_font%%<b>%%admin_events_delete_check%%</b></font>\n</td></tr>\n    <tr>\n      <td>%%norm_font%%<b>Property ID:</b>\n        <input type=\"text\" name=\"property\" value=\"%%admin_events_property%%\" size=\"40\" />\n      </font></td>\n    </tr>\n    <tr>\n      <td>%%norm_font%%<b>Title:</b>\n        <input type=\"text\" name=\"title\" value=\"%%admin_events_title%%\" size=\"40\" />\n      </font></td>\n    </tr>\n    <tr>\n      <td>%%norm_font%%<b>Format on event page:</b><INPUT type=\"text\" size=\"40\" name=\"template\" value=\"%%admin_events_template%%\">%%norm_font_end%%</td>\n    </tr>\n    <tr>\n      <td>%%norm_font%%<b>Format in calendar view:</b><INPUT type=\"text\" size=\"40\" name=\"calendar_template\" value=\"%%admin_events_calendar_template%%\">%%norm_font_end%%</td>\n    </tr>\n    <tr>\n      <td><input type=\"checkbox\" name=\"enabled\" value=\"1\"%%admin_events_enabled_checked%% />\n        %%norm_font%%Enabled%%norm_font_end%%\n        <input type=\"checkbox\" name=\"required\" value=\"1\"%%admin_events_required_checked%% />\n        %%norm_font%%Required%%norm_font_end%%\n        <input type=\"checkbox\" name=\"html\" value=\"1\"%%admin_events_html_checked%% />\n        %%norm_font%%HTML allowed%%norm_font_end%%\n        <input type=\"checkbox\" name=\"is_date\" value=\"1\"%%admin_events_is_date_checked%% />\n        %%norm_font%%Property is a date%%norm_font_end%%\n      </td>\n    </tr>\n    <tr><td>%%norm_font%%<b>Display order:</b> <input type=\"text\" name=\"display_order\" size=\"5\" value=\"%%admin_events_display_order%%\"></td></tr>\n    <tr><td>%%norm_font%%<b>Form field:</b>\n    %%admin_events_field_list%% %%admin_events_field_edit%%%%norm_font_end%%</td>\n    </tr>\n    <tr><td>%%norm_font%%<b>Validation regex:</b> <INPUT type=\"text\" size=\"30\" name=\"regex\" value=\"%%admin_events_regex%%\">%%norm_font_end%%</td></tr>\n    <tr><td>%%norm_font%%<b>This property requires:</b>%%admin_events_requires_menu%%%%norm_font_end%%</td></tr>\n    <tr><td>%%norm_font%%<b>Description:</b>%%norm_font_end%%</td></tr>\n    <tr>\n      <td>%%norm_font%%\n        <textarea cols=\"50\" rows=\"5\" name=\"description\" wrap=\"soft\">%%admin_events_description%%</textarea>\n      </font></td>\n    </tr>\n    <tr><td>%%norm_font%%\n      <input type=\"submit\" name=\"write\" value=\"Save Event Property\" /> <input type=\"reset\" />\n    </font></td></tr>\n  </table>\n</form>\n','1','<P>This block is used to create the Event Properties Admin Tool page.  It must contain all of the form elements used in the Event Properties Admin page, and should be self-contained HTML.  The special keys recognised are:</p>\n<DL>\n <DT>admin_events_errormsg</dt>\n  <DD>A message indicating whether a save was successful or not, and if not, the text of the error message</dd>\n <DT>admin_events_property_menu</dt>\n  <DD>The select box used to choose an event property to edit</dd>\n <DT>admin_events_delete_check</dt>\n  <DD>The delete checkbox displayed when an event property is being edited</dd>\n <DT>admin_events_template_menu</dt>\n  <DD>The select box used to choose the template block to use for a particular event property</dd>\n <DT>admin_events_template_link</dt>\n  <DD>A link to the block admin tool to edit the event property template selected for the event property currently being edited</dd>\n <DT>admin_events_enabled_checked</dt>\n  <DD>The \"checked\" status of the checkbox which determines whether or not the event property is enabled</dd>\n <DT>admin_events_required_checked</dt>\n  <DD>The \"checked\" status of the checkbox which determines whether or not the event property is required</dd>\n <DT>admin_events_property</dt>\n  <DD>The name of the event property currently being edited</dd>\n <DT>admin_events_title</dt>\n  <DD>The title of the event property currently being edited</dd>\n <DT>admin_events_description</dt>\n  <DD>The description of the event property currently being edited</dd>\n <DT>admin_events_field</dt>\n  <DD>The HTML form field for the event property currently being edited.</dd>\n <DT>admin_events_order</dt>\n  <DD>The display order for the current event property</dd>\n </dl>\n<P>Do not change the names of the form elements, or remove any form elements, or event property editing may fail in unexpected ways.</p>','Admin Pages','default','en'),('admin_template','%%doctype%%\r\n<HTML>\r\n<HEAD>\r\n%%stylesheet%%\r\n<TITLE>%%sitename%% || %%subtitle%%</TITLE>\r\n%%site_logo%%\r\n%%BOX,use_spell_suggest%%\r\n%%BOX,use_fckeditor%%\r\n</HEAD>\r\n<BODY bgcolor=\"#FFFFFF\" text=\"#000000\" link=\"#006699\" vlink=\"#003366\">\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<TABLE BORDER=0 WIDTH=\"99%\" ALIGN=\"center\" CELLPADDING=0 CELLSPACING=10>\r\n	<!-- Main page block -->\r\n	<TR>\r\n		\r\n		<!-- Center content section -->\r\n		<TD VALIGN=\"top\" width=\"73%\">\r\n          			%%STORY%%\r\n			%%BOX,comment_controls%%\r\n			%%CONTENT%%\r\n         			%%BOX,comment_controls%%\r\n		</TD>\r\n		<!-- X center content section -->\r\n		\r\n		<!-- Right boxes column -->\r\n		<TD VALIGN=\"top\" WIDTH=\"27%\">\r\n                        %%BOX,user_box%%\r\n			%%BOX,hotlist_flex_box%%\r\n			%%BOX,admin_tools%%\r\n		\r\n		</TD>\r\n		<!-- X Right boxes column -->\r\n	</TR>\r\n	<!-- X main page block -->\r\n</TABLE>\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</BODY>\r\n</HTML>\r\n',NULL,'','general','default','en'),('advertising_account_disclaimer','Please remember the following with your new advertising account. <br><br><blockquote> <b>Any stories posted to this site for purely advertising purposes will void your contract with us.</b> The articles and diaries on this site are <b>not for advertising purposes</b>.  This account entitles you to submit ads for posting in specified places on the page only.  If you are caught abusing this account, your ads will be disabled, no money will be refunded, and your account will be disabled.  If you have any questions about this send mail to %%local_email%%.\r\n</blockquote><br>  Thank you for your understanding.','1','<P>This block is displayed in the form that collects extra information from advertisers when they create an \"advertiser account\".  It is only relevant if the variable <B>req_extra_advertiser_info</B> is set to 1.  It should contain whatever extra terms your site requires of an advertising account, if they are distinguished from regular accounts.  There are no special keys.</P>','Ads','default','en'),('ad_approval_mail','The ad that you submitted to %%sitename%% was accepted for display on our site.\r\n\r\nAdvertisement details:\r\nTitle: %%TITLE%%\r\nText1: %%TEXT1%%\r\nURL: %%URL%%\r\n\r\nIf you have received this message in error, please reply and let us know.\r\n\r\n-%%sitename%%\r\n%%local_email%%\r\n','1','<P>This block is emailed to a user when an advertisement he submitted has been approved by a site admin.  It should be plain text and say that the ad has been approved.  The special keys recognised are:</P>\n<DL>\n <DT>REASON</DT>\n  <DD>The reason given by the administrator when approving the ad, if any</DD>\n <DT>TITLE</DT>\n  <DD>The title of the advertisement approved</DD>\n <DT>TEXT1</DT>\n  <DD>The \"TEXT1\" field of the advertisement approved</DD>\n <DT>URL</DT>\n  <DD>The url the advertisement points to</DD>\n <DT>VIEWS_LEFT</DT>\n  <DD>The number of impressions remaining</DD>\n <DT>IMPRESSIONS</DT>\n  <DD>The number of impressions to buy (only used in ad renewal, which is yet another unimplemented ad features)</DD>\n <DT>AD_ID</DT>\n  <DD>The internal ID number of the advertisement approved</DD>\n <DT>sitename</DT>\n  <DD>The contents of the variable <B>sitename</B></DD>\n <DT>site_url</DT>\n  <DD>The contents of the variable <B>site_url</B></DD>\n <DT>local_email</DT>\n  <DD>The contents of the variable <B>local_email</B></DD>\n</DL>\n<P>The last three are not technically special keys, but since emails are not sent through the normal page processing, keys are not substituted normally.  No keys other than the ones listed here will be interpolated.  Not all available keys are necessarily relevant.</P>','Ads,Emails','default','en'),('ad_confirm_text','<p>Your ad is shown above for you to make sure that its how you want it.  If you see any problems,\r\nhit back and fix them. If you like what you see, hit \"Submit Ad\" below, if not, hit back and make your\r\nchanges.</p>','1','<P>This block is displayed on the advertisement preview screen when a user is submitting an ad.  It should be a self-contained bit of text and should explain how to make changes if the previewed ad is not what the submittor wanted, and how to purchase if it is.  There are no special keys.</P>','Ads','default','en'),('ad_disapproval_mail','The ad that you submitted to %%sitename%% was disapproved today\r\nfor the following reason:\r\n\r\n%%REASON%%\r\n\r\nAdvertisement details:\r\nTitle: %%TITLE%%\r\nText1: %%TEXT1%%\r\nURL: %%URL%%\r\n\r\nIf you have received this message in error, please reply and let us know.\r\n\r\n-%%sitename%%\r\n%%local_email%%\r\n','1','<P>This block is emailed to a user when an advertisement he submitted has been disapproved by a site admin.  It should be plain text and say that the ad has been disapproved.  The special keys recognised are:</P>\n<DL>\n <DT>REASON</DT>\n  <DD>The reason given by the administrator when disapproving the ad, if any</DD>\n <DT>TITLE</DT>\n  <DD>The title of the advertisement disapproved</DD>\n <DT>TEXT1</DT>\n  <DD>The \"TEXT1\" field of the advertisement disapproved</DD>\n <DT>URL</DT>\n  <DD>The url the advertisement points to</DD>\n <DT>VIEWS_LEFT</DT>\n  <DD>The number of impressions remaining</DD>\n <DT>IMPRESSIONS</DT>\n  <DD>The number of impressions to buy (only used in ad renewals, which is yet another unimplemented ad feature)</DD>\n <DT>AD_ID</DT>\n  <DD>The internal ID number of the advertisement disapproved</DD>\n <DT>sitename</DT>\n  <DD>The contents of the variable <B>sitename</B></DD>\n <DT>site_url</DT>\n  <DD>The contents of the variable <B>site_url</B></DD>\n <DT>local_email</DT>\n  <DD>The contents of the variable <B>local_email</B></DD>\n</DL>\n<P>The last three are not technically special keys, but since emails are not sent through the normal page processing, keys are not substituted normally.  No keys other than the ones listed here will be interpolated.  Not all available keys are necessarily relevant.</P>','Ads,Emails','default','en'),('ad_free_msg','This advert has cost you nothing, and will appear as soon as it is approved.','2','This message is displayed as part of the advert submission process. See the block ad_submitted_message for more information on where it will appear.\r\nThere are two special variables concerned with this. |num_impressions| will be replaced by the number of impressions ordered.\r\n|price| will be replace by the total cost of the order.','Ads','default','en'),('ad_pay_cc_msg','<p>%%norm_font%%<a\r\nhref=\"%%secure_site_url%%%%rootdir%%/special/adpay?type=cc%%payment_args%%\"><img\r\nsrc=\"%%imagedir%%/cclogos.gif\" width=\"87\" height=\"27\"\r\nborder=0 ALT=\"%%sitename%% accepts Visa and MasterCard\"><br>Pay with Visa or Mastercard</a>%%norm_font_end%%</p>','2','This message is displayed as part of the advert submission process. See the block ad_submitted_message for more information on where it will appear.\r\nThere are two special variables concerned with this. |num_impressions| will be replaced by the number of impressions ordered.\r\n|price| will be replace by the total cost of the order.\r\n|payment_args| must be present somewhere in the link url to correctly pass arguments to the payment method.','Ads','default','en'),('ad_pay_paypal_msg','<p>%%norm_font%%<a\r\nhref=\"%%secure_site_url%%%%rootdir%%/special/adpay?type=paypal%%payment_args%%\"><img\r\nsrc=\"%%imagedir%%/paypal.gif\" width=\"87\" height=\"27\"\r\nborder=0 ALT=\"Pay with Paypal\">Pay with Paypal</a>%%norm_font_end%%</p>','2','This message is displayed as part of the advert submission process. See the block ad_submitted_message for more information on where it will appear.\r\nThere are two special variables concerned with this. |num_impressions| will be replaced by the number of impressions ordered.\r\n|price| will be replace by the total cost of the order.\r\n|payment_args| must be present somewhere in the link url to correctly pass arguments to the payment method.','Ads','default','en'),('ad_renewal_mail','Your ad on %%sitename%% has been renewed.\r\n\r\nAdvertisement details:\r\nTitle: %%TITLE%%\r\nText1: %%TEXT1%%\r\nURL: %%URL%%\r\nAdditional Impressions: %%IMPRESSIONS%%\r\n\r\nIf you have received this message in error, please reply and let us know.\r\n\r\n-%%sitename%%\r\n%%local_email%%\r\n','1','not used.  Yet another unimplemented ad feature.','Ads,Emails','default','en'),('ad_renewed_message','<p>Thank you for renewing your advert. As it\'s already been approved, you don\'t have to wait.  As soon as it\'s paid for, it will appear.</p>\r\n%%AD_CC_PAY%%\r\n%%AD_PAYPAL_PAY%%\r\n%%AD_FREE_MESSAGE%%','1','This message is displayed when an advert has gone through all the stages of renewal, apart from payment. As renewals don\'t need approving, the advert will appear as soon as it is paid for. If the advert needs paying for, then some more messages will be displayed at the same time.\r\nIf the total cost of the advert is nothing, then |AD_FREE_MESSAGE| will be replaced by the contents of the block, ad_free_msg. AD_CC_PAY and AD_PAYPAL_PAY will be ignored.\r\nIf the site control ads_use_cc is enabled, then |AD_CC_PAY| will be replaced with the contents of the block ad_pay_cc_msg.\r\nIf the site control ads_use_paypal is enable, then |AD_PAYPAL_PAY| will be replaced with the contents of the block ad_pay_paypal_msg.\r\n','Ads','default','en'),('ad_step1_rules','<!-- ad_step1_rules.  Do not take out the |NEXT_LINK| text, as it will be replaced with a button to get the user to the next step in the process -->\r\n<TABLE BORDER=0 WIDTH=\"99%\" ALIGN=\"center\" CELLPADDING=0 CELLSPACING=10>\r\n<TR>\r\n        <TD VALIGN=\"top\" width=\"55%\" BGCOLOR=\"%%title_bgcolor%%\">\r\n            %%title_font%% Rules for Submitting Ads %%title_font_end%%\r\n        </TD>\r\n</TR>\r\n<TR>\r\n<TD>%%norm_font%%\r\n<ul>\r\n<li>If hulver likes your ad, it gets approved. If he doesn\'t then he reserves the right to delete all your posting history and remove your account.</ul>\r\n%%norm_font_end%%\r\n</TD>\r\n</TR>\r\n<TR><TD>%%norm_font%% %%NEXT_LINK%% %%norm_font_end%%\r\n</TABLE>','1','<P>This block is displayed as the first step when a user starts submitting ads.  It should be self-contained HTML, and should explain all of the rules, terms, and conditions for ad submission before the actual submission process begins.</P>\n<P>There is one special key: NEXT_LINK which is the \"I agree\" button.</P>','Ads','default','en'),('ad_submitted_message','<p> Now that you\'ve submitted the ad, it has to be approved.  Our crack team of site maintainers who pore over all of the ad submissions daily will notice yours has arrived, and approve it so that it can be displayed on the site.  If for some reason they don\'t see fit to approve it, you will get an email sent to your real_email address explaining why.</p>\r\n%%AD_CC_PAY%%\r\n%%AD_PAYPAL_PAY%%\r\n%%AD_FREE_MESSAGE%%','1','This message is displayed when an advert has gone through all the stages of submission, apart from payment, and is waiting to be approved. If the advert needs paying for, then some more message will be displayed at the same time.\r\nIf the total cost of the advert is nothing, then |AD_FREE_MESSAGE| will be replaced by the contents of the block, ad_free_msg. AD_CC_PAY and AD_PAYPAL_PAY will be ignored.\r\nIf the site control ads_use_cc is enabled, then |AD_CC_PAY| will be replaced with the contents of the block ad_pay_cc_msg.\r\nIf the site control ads_use_paypal is enable, then |AD_PAYPAL_PAY| will be replaced with the contents of the block ad_pay_paypal_msg.\r\n','Ads','default','en'),('ad_submitted_message_old','<p> Now that you\'ve submitted the ad, it has to be approved.  Our crack team of site maintainers who pore over all of the ad submissions daily will notice yours has arrived, and approve it so that it can be displayed on the site.  If for some reason they don\'t see fit to approve it, you will get an email sent to your real_email address explaining why.</p>\r\n%%AD_CC_PAY%%\r\n%%AD_PAYPAL_PAY%%\r\n%%AD_FREE_MESSAGE%%','2','This message is displayed when an advert has gone through all the stages of submission, apart from payment, and is waiting to be approved. If the advert needs paying for, then some more message will be displayed at the same time.\r\nIf the total cost of the advert is nothing, then |AD_FREE_MESSAGE| will be replaced by the contents of the block, ad_free_msg. AD_CC_PAY and AD_PAYPAL_PAY will be ignored.\r\nIf the site control ads_use_cc is enabled, then |AD_CC_PAY| will be replaced with the contents of the block ad_pay_cc_msg.\r\nIf the site control ads_use_paypal is enable, then |AD_PAYPAL_PAY| will be replaced with the contents of the block ad_pay_paypal_msg.\r\n','advertising','default','en'),('ad_submit_help','','1','<P>This block is displayed at the bottom of ad submission step 3.  It should be self-contained HTML, and should contain general instructions for ad submission.  There are no special keys.</P>','Ads','default','en'),('ad_test_template','<HTML>\r\n<HEAD>\r\n%%stylesheet%%\r\n<TITLE>%%slogan%%</TITLE>\r\n</HEAD>\r\n<BODY BGCOLOR=\"#FFFFFF\">%%BOX,show_ad,fromurl%%</body>\r\n</html>','1','<P>This block is used to display a single ad for preview purposes without counting impressions.  It must be a complete HTML page, and should contain a call to the <B>show_ad</B> box.  There are no special keys.</P>','Ads,Page Templates','default','en'),('amazonlogo_ad_template','<table border=\"0\" width=\"100%\">\r\n<tr><td class=\"boxtitle\">%%BOX,hidebox_box,ad_box%% <a class=\"adverttitle\" href=\"%%rootdir%%/section/adverts\">Amazon</a></td></tr>\r\n<tr><td class=\"textaddbody\" align=\"center\">%%TEXT1%%</td></tr>\r\n<tr><td>%%smallfont%%%%COMMENTS%%%%smallfont_end%%</td></tr>\r\n</table><p>','2','The template used for text ads.','advertising,amazon','default','en'),('amazon_ad_template','<table border=\"0\" width=\"100%\">\r\n<tr><td class=\"boxtitle\">%%BOX,hidebox_box,ad_box%%<a class=\"adverttitle\" href=\"%%rootdir%%/section/adverts\">Advertisement</a></td></tr>\r\n<tr><td class=\"commentheader\">\r\n<table bgcolor=\"#FFFFFF\" fgcolor=\"000000\" border=\"0\" cellpadding=\"2\" cellspacing=\"0\" width=\"100%\">\r\n<tr><td class=\"textadtitle\"><a href=\"%%LINK_URL%%\" title=\"%%AD_URL%%\">%%TITLE%%</a></td></tr>\r\n<tr><td class=\"textaddbody\">%%TEXT1%%</td></tr>\r\n<tr><td>%%smallfont%%%%COMMENTS%%%%smallfont_end%%</td></tr>\r\n</table></tr></td>\r\n</table><p>','2','The template used for text ads.','advertising,amazon','default','en'),('amazon_body','<br>\r\n<a class=\"amazon_link\" href=\"%%detail_link%%\">\r\n<img class=\"amazon_image\" src=\"%%img_url_large%%\" alt=\"Product Image\">\r\n<br>%%product_name%% - %%product_by%% <b>%%comments%%</b></a>\r\n<br>%%list_price%%%%our_price%%%%saving%%\r\n<br>%%button%%\r\n<p>\r\n%%reviews%%\r\n</p>','2','','amazon','default','en'),('amazon_buy_de-notworking','<form method=\"POST\" action=\"http://www.amazon.de/exec/obidos/dt/assoc/handle-buy-box=%%asin%%\">\r\n<input type=\"hidden\" name=\"asin.%%asin%%\" value=\"1\">\r\n<input type=\"hidden\" name=\"tag-value\" value=\"%%assoc%%\">\r\n<input type=\"hidden\" name=\"tag_value\" value=\"%%assoc%%\">\r\n<input type=\"hidden\" name=\"dev-tag-value\" value=\"%%dev_token%%\">\r\n<input type=\"submit\" name=\"submit.add-to-registry.babyreg\" value=\"Buy from Amazon.de\">\r\n</form>','2','','amazon','default','en'),('amazon_buy_uk','<form method=\"POST\" action=\"http://www.amazon.co.uk/exec/obidos/dt/assoc/handle-buy-box=%%asin%%\">\r\n<input type=\"hidden\" name=\"asin.%%asin%%\" value=\"1\">\r\n<input type=\"hidden\" name=\"tag-value\" value=\"%%assoc%%\">\r\n<input type=\"hidden\" name=\"tag_value\" value=\"%%assoc%%\">\r\n<input type=\"hidden\" name=\"dev-tag-value\" value=\"%%dev_token%%\">\r\n<input type=\"submit\" name=\"submit.add-to-cart\" value=\"Buy from Amazon.co.uk\">\r\n</form>\r\n','2','','amazon','default','en'),('amazon_buy_us','<form method=\"POST\" action=\"http://www.amazon.com/exec/obidos/dt/assoc/handle-buy-box=%%asin%%\">\r\n<input type=\"hidden\" name=\"asin.%%asin%%\" value=\"1\">\r\n<input type=\"hidden\" name=\"tag-value\" value=\"%%assoc%%\">\r\n<input type=\"hidden\" name=\"tag_value\" value=\"%%assoc%%\">\r\n<input type=\"hidden\" name=\"dev-tag-value\" value=\"%%dev_token%%\">\r\n<input type=\"submit\" name=\"submit.add-to-cart\" value=\"Buy From Amazon.com\">\r\n</form>','2','','amazon','default','en'),('amazon_cc_ad','<iframe width=120 height=240 scrolling=\"no\" frameborder=0 src=\"http://rcm.amazon.com/e/cm?t=husi-20&p=28&o=1&l=dl1&f=ifr\">\r\n\r\n\r\n\r\n<map name=\"boxmap-b3\"><area shape=\"rect\" coords=\"0, 230, 120, 240\" href=\"http://rcm.amazon.com/e/cm/privacy-policy.html?o=1\" ><area coords=\"0,0,10000,10000\" href=\"http://www.amazon.com/exec/obidos/redirect?tag=husi-20&creative=92497&camp=8117&link_code=dl1&path=subst/misc/amazon-cobrand-cc/v3/marketing-from-associates-step1.html/ref%3Db1_assoc_28\" ></map><img src=\"http://rcm-images.amazon.com/images/G/01/associates/promotions/b1c-120x240.gif\" width=\"120\" height=\"240\" border=\"0\" usemap=\"#boxmap-b3\" alt=\"Amazon.com Platinum Visa Card\">\r\n\r\n\r\n</iframe>','2','','general','default','en'),('amazon_logo','<a href=\"http://www.amazon.com/exec/obidos/redirect?tag=%%affiliate%%&path=subst/home/home.html\"><img src=\"%%imagedir%%/us_a130X60w.gif\" border=\"0\" alt=\"In Association with Amazon.com\"  title=\"In Association with Amazon.com\"></a>\r\n','2','','amazon,general','default','en'),('amazon_logo_ca','<a href=\"http://www.amazon.ca/exec/obidos/redirect-home?site=amazon&tag=%%affiliate-ca%%\">\r\n<img src=\"%%imagedir%%/amazon_logo_association_w.gif\" border=\"0\" height=\"60\" width=\"130\"\r\nalt=\"In Association with Amazon.ca\" title=\"In Association with Amazon.ca\"></a>\r\n','2','','amazon,general','default','en'),('amazon_logo_de','<a href=\"http://www.amazon.de/exec/obidos/redirect-home?tag=%%affiliate-de%%&site=amazon\"><img src=\"%%imagedir%%/de_a130X66w.gif\" alt=\"In Association with Amazon.de\" title=\"In Association with Amazon.de\" border=\"0\"></a> \r\n','2','','amazon,general','default','en'),('amazon_logo_fr','<a href=\"http://www.amazon.fr/exec/obidos/redirect-home?tag=%%affiliate-fr%%&site=amazon\"><img src=\"%%imagedir%%/fr_a130X60w.gif\" alt=\"In Association with Amazon.fr\" title=\"In Association with Amazon.fr\" border=\"0\"></a> \r\n','2','','amazon,general','default','en'),('amazon_logo_uk','<a href=\"http://www.amazon.co.uk/exec/obidos/redirect-home?tag=%%affiliate-uk%%&site=amazon\"><img src=\"%%imagedir%%/uk_wh_logo2.gif\" alt=\"In Association with Amazon.co.uk\"  title=\"In Association with Amazon.co.uk\" border=\"0\"></a> \r\n','2','','amazon,general','default','en'),('amazon_product','<br>\r\n<div class=\"amazon_product\">\r\n<a class=\"amazon_link\" href=\"%%detail_link%%\">\r\n<img class=\"amazon_image\" src=\"%%img_url_medium%%\">\r\n<br>%%product_name%% - %%product_by%% <b>%%comments%%</b></a>\r\n<br>%%list_price%%%%our_price%%%%saving%%\r\n<br>%%button%%\r\n</div>','2','','amazon','default','en'),('amazon_review','<p><b>%%summary%%</b></p>\r\n<p>%%comment%%</p>\r\n<br>','2','','amazon','default','en'),('amazon_searchform_ca','<FORM METHOD=\"get\" ACTION=\"http://www.amazon.ca/exec/obidos/external-search\">\r\n<TABLE BORDER=\"0\" CELLPADDING=\"1\" cellspacing=\"0\" BGCOLOR=\"#000000\"><TR><TD>\r\n<TABLE BORDER=\"0\" CELLPADDING=\"2\" cellspacing=\"0\" align=\"center\" BGCOLOR=\"#FFFFFF\">\r\n<TR BORDER=\"0\">\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"RIGHT\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\"><B>Search:</B></font></TD>\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"left\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\"> \r\n<SELECT NAME=\"mode\">\r\n<OPTION VALUE=\"blended\" selected>All Products\r\n<OPTION VALUE=\"books\">Books\r\n<OPTION VALUE=\"music-ca\">Popular Music\r\n<OPTION VALUE=\"classical-ca\">Classical Music\r\n<OPTION VALUE=\"vhs-ca\">Video\r\n<OPTION VALUE=\"dvd-ca\">DVD\r\n<OPTION VALUE=\"software-ca\">Software\r\n<OPTION VALUE=\"video-games-ca\">Video Games\r\n</SELECT>\r\n</font></TD>\r\n<TR BORDER=\"0\">\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"RIGHT\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\"><B>Keywords:</B></font></TD>\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"left\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\">\r\n<INPUT TYPE=\"text\" NAME=\"keyword\" SIZE=\"10\" VALUE=\"\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tag\" VALUE=\"%%affilicate-ca%%\">\r\n<INPUT TYPE=\"image\" WIDTH=\"21\" HEIGHT=\"21\" BORDER=\"0\" VALUE=\"Go\" NAME=\"Go\" src=\"%%imagedir%%/orange-go.gif\" ALIGN=absmiddle>\r\n</font></TD>\r\n</TR>\r\n<TR>\r\n<TD COLSPAN=\"2\" VALIGN=\"top\" ALIGN=\"center\" BGCOLOR=\"#000000\">\r\n<A HREF=\"http://www.amazon.ca/exec/obidos/redirect-home?site=amazon&tag=%%affilicate-ca%%\"><IMG SRC=\"%%imagedir%%/amznsearch-newused-ca.gif\" width=\"126\" height=\"36\" BORDER=\"0\" HSPACE=\"0\" VSPACE=\"0\" ALT=\"In Association with Amazon.ca\"></a>\r\n</TD>\r\n</TR>\r\n</TABLE></TD></TR></TABLE>\r\n</FORM> \r\n','2','','amazon,search','default','en'),('amazon_searchform_uk','<!--begin Pull-down Menu Search Box-->\r\n<FORM METHOD=\"get\" ACTION=\"http://www.amazon.co.uk/exec/obidos/external-search\">\r\n<TABLE BORDER=\"0\" CELLPADDING=\"1\" cellspacing=\"0\" BGCOLOR=\"#000000\"><TR><TD>\r\n<TABLE BORDER=\"0\" CELLPADDING=\"2\" cellspacing=\"0\" align=\"center\" BGCOLOR=\"#FFFFFF\">\r\n<TR BORDER=\"0\">\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"RIGHT\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\"><B>Search:</B></font></TD>\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"left\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\"> \r\n<SELECT NAME=\"mode\">\r\n<OPTION VALUE=\"blended\" selected>All Products\r\n<OPTION VALUE=\"books-uk\">Books\r\n<OPTION VALUE=\"books-uk:ebooks\">e-Books\r\n<OPTION VALUE=\"electronics-uk\">Electronics & Photo\r\n<OPTION VALUE=\"music\">Popular Music\r\n<OPTION VALUE=\"classical\">Classical Music\r\n<OPTION VALUE=\"dvd-uk\">DVD\r\n<OPTION VALUE=\"vhs-uk\">Video\r\n<OPTION VALUE=\"software-uk\">Software\r\n<OPTION VALUE=\"tools-uk\">DIY & Tools\r\n<OPTION VALUE=\"kitchen-uk\">Kitchen & Home\r\n<OPTION VALUE=\"hpc-uk\">Personal Care\r\n<OPTION VALUE=\"garden-uk\">Garden & Outdoors\r\n<OPTION VALUE=\"video-games-uk\">PC & Video Games\r\n<OPTION VALUE=\"toys-uk\">Toys & Kids!\r\n</SELECT>\r\n</font></TD>\r\n<TR BORDER=\"0\">\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"RIGHT\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\"><B>Keywords:</B></font></TD>\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"left\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\">\r\n<INPUT TYPE=\"text\" NAME=\"keyword\" SIZE=\"10\" VALUE=\"\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tag\" VALUE=\"%%affiliate-uk%%\">\r\n<INPUT TYPE=\"image\" BORDER=\"0\" VALUE=\"Go\" NAME=\"Go\" src=\"%%imagedir%%/pdm-search-go-btn.gif\" ALIGN=absmiddle>\r\n</font></TD>\r\n</TR>\r\n<TR>\r\n<TD COLSPAN=\"2\" VALIGN=\"top\" ALIGN=\"center\" BGCOLOR=\"#000000\">\r\n<A HREF=\"http://www.amazon.co.uk/exec/obidos/redirect-home?tag=%%affiliate-uk%%&site=amazon\"><IMG SRC=\"%%imagedir%%/amznsearch-newused-146x33.gif\" BORDER=\"0\" HSPACE=\"0\" VSPACE=\"0\" ALT=\"In Association with Amazon.co.uk\"></a>\r\n</TD>\r\n</TR>\r\n</TABLE></TD></TR></TABLE>\r\n</FORM> \r\n<!--End Pull-down Menu Search Box-->\r\n','2','','amazon,search','default','en'),('amazon_searchform_us','<FORM METHOD=\"get\" ACTION=\"http://www.amazon.com/exec/obidos/external-search\">\r\n<TABLE BORDER=\"0\" CELLPADDING=\"1\" cellspacing=\"0\" BGCOLOR=\"#000000\"><TR><TD>\r\n<TABLE BORDER=\"0\" CELLPADDING=\"2\" cellspacing=\"0\" align=\"center\" BGCOLOR=\"#FFFFFF\">\r\n<TR BORDER=\"0\">\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"RIGHT\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\"><B>Search:</B></font></TD>\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"left\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\"> \r\n<SELECT NAME=\"mode\">\r\n<option value=\"blended\" selected>All Products\r\n<option value=\"books\">Books\r\n<option value=\"music\">Popular Music\r\n<option value=\"music-dd\">Music Downloads\r\n<option value=\"classical-music\">Classical Music\r\n<option value=\"dvd\">DVD\r\n<option value=\"vhs\">VHS\r\n<option value=\"apparel-index\">Apparel\r\n<option value=\"toys\">Toys\r\n<option value=\"baby\">Baby\r\n<option value=\"pc-hardware\">Computers\r\n<option value=\"videogames\">Computer & Video Games\r\n<option value=\"electronics\">Electronics\r\n<option value=\"photo\">Camera & Photo\r\n<option value=\"software\">Software\r\n<option value=\"tools\">Tools & Hardware\r\n<option value=\"magazines\">Magazines\r\n<option value=\"sporting-index\">Sporting Goods\r\n<option value=\"garden\">Outdoor Living\r\n<option value=\"kitchen\">Kitchen & Housewares\r\n<option value=\"jewelry-index\">Jewelry & Watches\r\n<option value=\"gourmet-index\">Gourmet Food\r\n<option value=\"hpc-index\">Health/Personal Care\r\n<option value=\"wireless-phones\">Cell Phones & Service\r\n<option value=\"outlet\">Outlet\r\n</SELECT>\r\n</font></TD>\r\n<TR BORDER=\"0\">\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"RIGHT\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\"><B>Keywords:</B></font></TD>\r\n<TD BGCOLOR=\"#FFFFFF\" align=\"left\" valign=\"middle\"><font face=\"verdana,arial,helvetica\" size=\"-2\">\r\n<INPUT TYPE=\"text\" NAME=\"keyword\" SIZE=\"10\" VALUE=\"\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tag\" VALUE=\"%%affiliate%%\">\r\n<INPUT TYPE=\"image\" WIDTH=\"21\" HEIGHT=\"21\" BORDER=\"0\" VALUE=\"Go\" NAME=\"Go\" src=\"%%imagedir%%/pdm-search-go-btn.gif\" ALIGN=absmiddle>\r\n</font></TD>\r\n</TR>\r\n<TR>\r\n<TD COLSPAN=\"2\" VALIGN=\"top\" ALIGN=\"center\" BGCOLOR=\"#000000\">\r\n<A HREF=\"http://www.amazon.com/exec/obidos/redirect-home/%%affiliate%%\"><IMG SRC=\"%%imagedir%%/pdm-search-logo-126x32.gif\" width=\"126\" height=\"32\" BORDER=\"0\" HSPACE=\"0\" VSPACE=\"0\" ALT=\"In Association with Amazon.com\"></a>\r\n</TD>\r\n</TR>\r\n</TABLE></TD></TR></TABLE>\r\n</FORM> \r\n','2','','amazon,search','default','en'),('amazon_search_ca','<FORM METHOD=\"get\" ACTION=\"http://www.amazon.ca/exec/obidos/external-search\">\r\n<input type=hidden name=\"mode\" value=\"%%mode%%\">\r\n<INPUT TYPE=\"hidden\" NAME=\"keyword\" VALUE=\"%%search_keyword%%\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tag\" VALUE=\"%%assoc%%\">\r\n<INPUT TYPE=\"submit\" VALUE=\"Search Amazon.ca\" NAME=\"Go\">\r\n</FORM>\r\n','2','','amazon','default','en'),('amazon_search_de','<FORM METHOD=\"get\" ACTION=\"http://www.amazon.de/exec/obidos/external-search\">\r\n<input type=hidden name=\"mode\" value=\"%%mode%%\">\r\n<INPUT TYPE=\"hidden\" NAME=\"keyword\" VALUE=\"%%search_keyword%%\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tag\" VALUE=\"%%assoc%%\">\r\n<INPUT TYPE=\"submit\" VALUE=\"Search Amazon.de\" NAME=\"Go\">\r\n</FORM>','2','','amazon','default','en'),('amazon_search_fr','<FORM METHOD=\"get\" ACTION=\"http://www.amazon.fr/exec/obidos/external-search\">\r\n<input type=hidden name=\"mode\" value=\"%%mode%%\">\r\n<INPUT TYPE=\"hidden\" NAME=\"keyword\" VALUE=\"%%search_keyword%%\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tag\" VALUE=\"%%assoc%%\">\r\n<INPUT TYPE=\"submit\" VALUE=\"Search Amazon.fr\" NAME=\"Go\">\r\n</FORM>','2','','amazon','default','en'),('amazon_search_uk','<FORM METHOD=\"get\" ACTION=\"http://www.amazon.co.uk/exec/obidos/external-search\">\r\n<input type=hidden name=\"mode\" value=\"%%mode%%\">\r\n<INPUT TYPE=\"hidden\" NAME=\"keyword\" VALUE=\"%%search_keyword%%\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tag\" VALUE=\"%%assoc%%\">\r\n<INPUT TYPE=\"submit\" VALUE=\"Search Amazon.co.uk\" NAME=\"Go\">\r\n</FORM>','2','','amazon','default','en'),('amazon_search_us','<FORM METHOD=\"get\" ACTION=\"http://www.amazon.com/exec/obidos/external-search\">\r\n<input type=hidden name=\"mode\" value=\"%%mode%%\">\r\n<INPUT TYPE=\"hidden\" NAME=\"keyword\" VALUE=\"%%search_keyword%%\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tag\" VALUE=\"%%assoc%%\">\r\n<INPUT TYPE=\"submit\" VALUE=\"Search Amazon.com\" NAME=\"Go\">\r\n</FORM>','2','','amazon','default','en'),('amazon_story_body_block','<a class=\"amazon_link\" href=\"%%detail_link%%\">\r\n<br>%%product_name%% - %%product_by%%</a>\r\n<br>%%list_price%%%%our_price%%%%saving%%\r\n<br>%%button%%','2','','amazon','default','en'),('amazon_story_intro_block','<a class=\"amazon_link\" href=\"%%detail_link%%\">\r\n<img class=\"amazon_image\" src=\"%%img_url_medium%%\"><br>\r\n%%product_name%% - %%product_by%%</a>','2','','amazon','default','en'),('amazon_uk_0','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=bn1&mode=books-uk&browse=69&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','General childrens fiction browse.','amazon','default','en'),('amazon_uk_1',' <iframe width=\"120\" height=\"250\" scrolling=\"no\" frameborder=0 src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&l=ez&p=34&o=2&f=ifr&lt1=_blank\"> <table border=\'0\' cellpadding=\'0\' cellspacing=\'0\' width=\'120\' height=\'250\'><tr><td><A HREF=\'http://www.amazon.co.uk/exec/obidos/redirect-home/husi-21\' target=_blank><img src=\"http://images-eu.amazon.com/images/G/02/associates/recommends/default_120x250.gif\" width=120 height=250 border=\"0\" access=regular></a></td></tr></table></iframe> \r\n','2','Easy link','amazon','default','en'),('amazon_uk_10','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=st1&mode=books-uk&search=.net&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','Microsoft programming','amazon','default','en'),('amazon_uk_11','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=bn1&mode=electronics-uk&browse=560800&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','General Electronics','amazon','default','en'),('amazon_uk_12','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=bn1&mode=books-uk&browse=56&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','Sci-fi books','amazon','default','en'),('amazon_uk_2','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=bn1&mode=music&browse=231239&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','General rock music','amazon','default','en'),('amazon_uk_3','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=bn1&mode=dvd-uk&browse=573406&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','General DVD','amazon','default','en'),('amazon_uk_4','<A HREF=\"http://www.amazon.co.uk/exec/obidos/redirect-home?tag=husi-21&site=amazon\"><IMG SRC=\"%%imagedir%%/uk_wh_logo2.gif\" alt=\"In Association with Amazon.co.uk\"  title=\"In Association with Amazon.co.uk\" BORDER=\"0\" ></A> \r\n','2','Amazon.co.uk Logo','amazon,general','default','en'),('amazon_uk_5','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=bn1&mode=dvd-uk&browse=501880&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','General Video','amazon','default','en'),('amazon_uk_6','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=bn1&mode=video-games-uk&browse=403718&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','Computer games','amazon','default','en'),('amazon_uk_7','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=st1&mode=books-uk&search=perl&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','Perl programming books','amazon','default','en'),('amazon_uk_8','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=st1&mode=books-uk&search=php&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','PHP programming books','amazon','default','en'),('amazon_uk_9','<iframe src=\"http://rcm-uk.amazon.co.uk/e/cm?t=husi-21&o=2&p=8&l=bn1&mode=books-uk&browse=564334&fc1=&=1&lc1=&lt1=&f=ifr&bg1=\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','General programming books.','amazon','default','en'),('amazon_us_0','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=28&l=dl1&f=ifr&f=ifr\" width=\"120\" height=\"240\" scrolling=\"no\" border=\"0\" frameborder=\"0\" style=\"border:none;\"></iframe>','2','US Credit card advert','amazon','default','en'),('amazon_us_1','<A HREF=\"http://www.amazon.com/exec/obidos/redirect?tag=%%affiliate%%&path=subst/home/home.html\"><img src=%%imagedir%%/a130X60w.gif border=0></A>\r\n','2','US Logo','amazon,general','default','en'),('amazon_us_10','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=st1&mode=books&search=.net&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','.NET programming books.','amazon,general','default','en'),('amazon_us_11','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=st1&mode=books&search=microsoft&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','Microsoft Books.','amazon,general','default','en'),('amazon_us_12','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=bn1&mode=books&browse=25&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','Sci-fi books','amazon,general','default','en'),('amazon_us_2','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=bn1&mode=electronics&browse=493964&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','Electronics\r\n','amazon,general','default','en'),('amazon_us_3','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=bn1&mode=dvd&browse=404276&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','General DVD','amazon,general','default','en'),('amazon_us_4','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=bn1&mode=music&browse=301668&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','General Music','amazon,general','default','en'),('amazon_us_5','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=bn1&mode=books&browse=17&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','General fiction books','amazon,general','default','en'),('amazon_us_6','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=bn1&mode=books&browse=5&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','General computing books','amazon,general','default','en'),('amazon_us_7','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=st1&mode=books&search=perl&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','Perl books','amazon,general','default','en'),('amazon_us_8','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=st1&mode=books&search=tcp%20ip&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','TCP/IP programming books','amazon,general','default','en'),('amazon_us_9','<iframe src=\"http://rcm.amazon.com/e/cm?t=husi-20&o=1&p=8&l=st1&mode=books&search=java&fc1=&=1&lc1=&lt1=&f=ifr&bg1=&f=ifr\" marginwidth=\"0\" marginheight=\"0\" width=\"120\" height=\"240\" border=\"0\" frameborder=\"0\" style=\"border:none;\" scrolling=\"no\"></iframe>','2','Java programming books.','amazon,general','default','en'),('anonymous_rsvp_form','<FIELDSET>\r\n<LEGEND>RSVP</LEGEND>\r\nPlease <a href=\"/login\">sign in</a> or <a href=\"/newuser\">create an account</a> to RSVP.\r\n</FIELDSET>\r\n','1','','Calendars and Events','default','en'),('archive_list_title','Archived Stories','1','','','default','en'),('attach_poll_message','Below you can attach a poll to this story, if you like. \r\nPolls are not required, but if you want one, fill in a question and some answers below.','1','<P>This block is displayed below the story submission form and above the attached poll submission form.  It should be self-contained HTML and should contain an explanation of polls attached to stories.  There are no special keys.</P>','Polls,Stories','default','en'),('author_edit_console','<!-- author_edit_console -->\r\n<div class=\"story_edit_instructions\">\r\nAs the author of this story, you may cancel the submission at any time during voting. Simply check the confirm box below, and click \"Cancel Submission\". \r\n%%author_edit_instructions%%\r\n<p>\r\n%%author_edit_form%%\r\n</div>\r\n<!-- X vote_console -->\r\n','1','<P>This block is displayed below a story in the queue for the author only.  It should be self-contained HTML, and should explain the process for cancelling stories.  The special keys recognised are:</P>\n<DL>\n <DT>author_edit_form</DT>\n  <DD>The form including the delete checkbox and the edit button if the story is in the edit queue</DD>\n <DT>author_edit_instructions</DT>\n  <DD>Instructions to the author for the editing process, displayed only if the story is in the edit queue.  The contents are taken from the block <B>author_edit_instructions</B></DD>\n</DL>','Stories','default','en'),('author_edit_instructions','<div class=\"story_edit_instructions\">\r\n<p>\r\nThis story is in editing. You may edit it using the \"Edit\" button below. To finish the editing period and move the story to voting, click \"Edit\", uncheck \"Request editorial feedback\" and save.\r\n</div>','1','Instructions to the author when story is in editing mode.','site_html','default','en'),('bars','||',NULL,'<P>This block is used as a separator in the page title. It should be short and have no HTML tags in it. There are no special keys.</P>','General','default','en'),('basic2_banner_ad_template','<!-- basic2_banner_ad_template BEGIN -->\r\n<a href=\"%%LINK_URL%%\"><img src=\"%%ad_server_url%%/%%IMAGE_PATH%%\"></a><br>\r\n%%norm_font%%<b>%%TEXT1%%</b>%%norm_font_end%%<br>\r\n%%norm_font%% %%TEXT2%% %%norm_font_end%%<br>\r\n<!-- basic_banner_ad_template END -->','1','A template for a basic graphical banner ad.','advertising','default','en'),('basic_banner_ad_template','<!-- basic_banner_ad_template BEGIN -->\r\n<img src=\"%%ad_server_url%%%%IMAGE_PATH%%\"><br>\r\n%%norm_font%% %%TEXT1%% %%norm_font_end%%<br>\r\n<!-- basic_banner_ad_template END -->','1','A template for a basic graphical banner ad.','advertising','default','en'),('blank_box','<div class=\"box\">\r\n	<div class=\"boxcontent\">\r\n			%%content%%\r\n	</div>\r\n</div>\r\n','2','<P>This block is used to provide a container for box output, and is not used directly in the page templates.  It should be self-contained HTML, and provide a \"blank\" frame for the box output.  The special keys recognised are:</P>\r\n<DL>\r\n <DT>title</DT>\r\n  <DD>The title of the box; if the box code returns a value for the title, that is used, otherwise the title field set in the Boxes Admin Tool is used</DD>\r\n <DT>content</DT>\r\n  <DD>The main body of the box.  This is the only thing the box code must return; if the box returns nothing or an empty string, the entire box (and its template) is not displayed at all</DD>\r\n <DT>bid</DT>\r\n  <DD>The internal name for the box.</DD>\r\n</DL>','Box Templates','default','en'),('blank_pref','%%title%%','2','<P>The preference item template generally used for selectboxes. This should be a self-contained bit of HTML as it is used to display a single user preference, both on the user info page and the preferences edit forms. The following special keys are recognised:</P>\r\n<DL>\r\n <DT>required</DT>\r\n  <DD>If the preference is required, the contents of <B>required_pref_marker</B>, otherwise blank</DD>\r\n <DT>title</DT>\r\n  <DD>The displayed title of the preference, as set in the User Preferences Admin Tool</DD>\r\n <DT>control</DT>\r\n  <DD>On the preferences edit form, this is the form field required for the preference, as set in the User Preferences Admin Tool. On the user info page, this is the value of the preference</DD>\r\n <DT>description</DT>\r\n  <DD>On the preferences edit form, this is the description as entered in the User Preferences Admin Tool. On the user info page, this is not displayed.</DD>\r\n <DT>allowed_html</DT>\r\n  <DD>If the preference supports HTML, displays the \"Allowed HTML\" string.</DD>\r\n</DL>','Accounts','default','en'),('blank_template','%%doctype%%\r\n<HTML>\r\n<HEAD>\r\n%%stylesheet%%\r\n<TITLE>%%slogan%%</TITLE>\r\n</HEAD>\r\n<BODY></body>\r\n</html>','1','<P>This block is a complete, blank HTML page. No header, footer, or CONTENT. It must be a complete HTML page. This template is used for commands which do not display pages, such as the logout or redirect ops.</P>','Page Templates','default','en'),('block_category_list','<tr>\r\n<td>%%norm_font%%<a href=\"%%rootdir%%/admin/blocks/%%item_url%%\">%%item%%</a>%%norm_font_end%%</td>\r\n<td>%%norm_font%%<a href=\"%%rootdir%%/admin/blocks/%%item_url%%\">%%item%%</a>%%norm_font_end%%</td>\r\n<td>%%norm_font%%<a href=\"%%rootdir%%/admin/blocks/%%item_url%%\">%%item%%</a>%%norm_font_end%%</td>\r\n</tr>\r\n',NULL,'<P>This block is used to build the list of category links in the Blocks Admin Tool.  It is repeated as many times as necessary to display all the categories.  It should contain a complete single line (by default a table row) that can be inserted into the containing block (by default a table with no rows) present in the block <B>edit_block</B> (This block is placed as many times as necessary in the spot designated by the special key <B>catlist</B>).  Multiple instances of the special keys listed below are permitted in this block.  The special keys recognised are:</P>\n<DL>\n <DT>item_url</DT>\n  <DD>The url-safe name of the category; you must insert it into the URL of the hyperlink yourself.</DD>\n <DT>item</DT>\n  <DD>The display name of the category, typically used as the text of the hyperlink</DD>\n</DL>','Admin Pages','default','en'),('box','<div class=\"box\">\r\n	<div class=\"boxtitle\">\r\n			%%BOX,hidebox_box,%%bid%%%% %%title%%\r\n	</div>\r\n	<div class=\"boxcontent\">\r\n			%%content%%\r\n	</div>\r\n</div>\r\n','2','<P>This block is used to provide a container for box output, and is not used directly in the page templates.  It should be self-contained HTML, and provide the frame seen around the boxes in the sidebar.  The special keys recognised are:</P>\r\n<DL>\r\n <DT>title</DT>\r\n  <DD>The title of the box; if the box code returns a value for the title, that is used, otherwise the title field set in the Boxes Admin Tool is used</DD>\r\n <DT>content</DT>\r\n  <DD>The main body of the box.  This is the only thing the box code must return; if the box returns nothing or an empty string, the entire box (and its template) is not displayed at all</DD>\r\n <DT>bid</DT>\r\n  <DD>The internal name for the box.</DD>\r\n</DL>','Box Templates','default','en'),('box_failed_msg','This box seems to be broken. Please <A href=\"mailto:%%local_email%%?subject=broken%20box%20on%20%%sitename%%\">email the site admin</A> and tell them the time and date (and your timezone) so it can be fixed.','1','<P>The message displayed inside the template <B>error_box</B> when a box fails with a fatal error. The actual error message generated will be printed to the site\'s error log. There are no special keys.</P>','Error Messages','default','en'),('box_titleless','<TABLE CLASS=\"box\">\r\n	<TR>\r\n		<TD CLASS=\"boxcontent\">\r\n			%%content%%\r\n		</TD>\r\n	</TR>\r\n</TABLE>\r\n<P>','2','A box template - the default one with the blue title bar. The special vars |title| and |content| are supplied by the box code','boxes','default','en'),('box_title_bg','#006699','1','<P>This block is used wherever a colour value is needed to set the colour of the sidebar box title bars.  It should be a hex colour value, including the #, such as #000000 for black.  There are no special keys.</P>','Colours','default','en'),('box_title_bg','#999999','1','<P>This block is used wherever a colour value is needed to set the colour of the sidebar box title bars.  It should be a hex colour value, including the #, such as #000000 for black.  There are no special keys.</P>','Colours','greyscale','en'),('box_title_font','<FONT FACE=\"verdana, arial, helvetica, sans-serif\" SIZE=2 COLOR=\"#FFFFFF\"><B>',NULL,'<P>This block is used in box templates before the box title.  It should be a complete opening font or text style indicator, such as a font or b tag.  It must be properly closed by the contents of the block <B>box_title_font_end</B>.  There are no special keys.</P>','Fonts','default','en'),('box_title_font_end','</B></FONT>',NULL,'<P>This block is used in box templates after the box title.  It should be a complete closing font or text style indicator, such as a closing font or b tag.  It must properly close the tags opened in the block <B>box_title_font</B>.  There are no special keys.</P>','Fonts','default','en'),('buy_ad_impression_message','From here you can pre-pay for ad impressions.  Once you have prepaid impressions on your account, you can distribute them to any ad you have submitted, from the <a href=\"%%rootdir%%/ads/dist\">distribution</a> page.','1','not used.  Yet another unimplemented ad feature.','Ads','default','en'),('calendar_body_daily','<div class=\"cal_head\">\r\n<div class=\"title\">%%calendar_title%% - %%dow%% <a href=\"%%rootdir%%/calendar/monthly/%%cal_id%%/%%year%%-%%monthnum%%\">%%month%%</a> %%day_num%%, %%year%%</div>\r\n%%BOX,calendar_actions%%\r\n<ul id=\"cal_datenav\">\r\n%%BOX,calendar_datenav%%\r\n</ul>\r\n</div>\r\n<p>\r\n<div class=\"cal_body\">\r\n\r\n<table width=\"100%\" border=0 cellpadding=0 cellspacing=0 style=\"border-right: 1px solid black; border-bottom: 1px solid black;\">\r\n<tr>%%day%%</tr>\r\n</table>\r\n</div>','1','<P>This block formats the body of the calendar in \"daily\" view. This should be a self-contained block of HTML that can be inserted anywhere. The following special keys are recognized:</P>\r\n<DL>\r\n <DT>day</DT>\r\n  <DD>the contents of <B>calendar_body_one_day</B> for the given date</DD>\r\n <DT>subscribe_link</DT>\r\n  <DD>The link to subscribe (or unsubscribe) to this calendar, if viewing one calendar.</DD>\r\n <DT>calendar_title</dt>\r\n  <DD>The title of the current calendar</dd>\r\n <DT>date</dt>\r\n  <DD>The date being viewed (YYYY-MM-DD)</dd>\r\n <DT>mediumdate</dt>\r\n  <DD>The date being viewed (DD-Mmm-YYYY)</dd>\r\n <DT>longdate</dt>\r\n  <DD>The date being viewed (Wwwwww, DD Mmmmmmm YYYY)</dd>\r\n <DT>dow</dt>\r\n  <DD>The name of the day of the week being viewed (Monday, Tuesday, etc)</dd>\r\n <DT>dow_short</dt>\r\n  <DD>The abbreviated day of the week being viewed (Mon, Tues, etc)</dd>\r\n <DT>day_num</dt>\r\n  <DD>The day number</dd>\r\n <DT>day_ord</dt>\r\n  <DD>The day number in ordinal form (1st, 2nd, 3rd, etc)</dd>\r\n <DT>month</dt>\r\n  <DD>The name of the month</dd>\r\n <DT>monthnum</dt>\r\n  <DD>The number of the month</dd>\r\n <DT>year</dt>\r\n  <DD>The year.</dd>\r\n</DL>','Calendars and Events','default','en'),('calendar_body_monthly','<DIV class=\"cal_head\">\r\n<div class=\"title\">%%calendar_title%% - %%longdate%%</div>\r\n%%BOX,calendar_actions%%\r\n<ul id=\"cal_datenav\">\r\n%%BOX,calendar_datenav%%\r\n</ul>\r\n</DIV>\r\n<p>\r\n<DIV class=\"cal_body\">\r\n\r\n<TABLE width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-right: 1px solid black; border-bottom: 1px solid black;\">\r\n<TR>\r\n <TH>Monday</TH>\r\n <TH>Tuesday</TH>\r\n <TH>Wednesday</TH>\r\n <TH>Thursday</TH>\r\n <TH>Friday</TH>\r\n <TH>Saturday</TH>\r\n <TH>Sunday</TH>\r\n <TH> </TH>\r\n</TR>\r\n%%rows%%\r\n</TABLE>\r\n</DIV>\r\n%%subscribe_link%%','1','<P>This block formats the body of the calendar in \"monthly\" view. This should be a self-contained block of HTML that can be inserted anywhere. The following special keys are recognized:</P>\r\n<DL>\r\n <DT>wk*_d*</DT>\r\n  <DD>The week number within the month and day number within the week. The code replaces each of these with the contents of <B>calendar_body_one_day</B> formatted for the appropriate day.</DD>\r\n <DT>wk*</DT>\r\n  <DD>The week number within the month. The code replaces each of these with the date of the monday of that week.</DD>\r\n <DT>cal_id</DT>\r\n  <DD>The ID of the calendar currently being viewed, or zero for the current user\'s personal calendar view.</DD>\r\n <DT>subscribe_link</DT>\r\n  <DD>The link to subscribe (or unsubscribe) to this calendar, if viewing one calendar.</DD>\r\n <DT>calendar_title</dt>\r\n  <DD>The title of the current calendar</dd>\r\n <DT>date</dt>\r\n  <DD>The month being viewed (YYYY-MM)</dd>\r\n <DT>longdate</dt>\r\n  <DD>The month being viewed (Mmmmmmm YYYY)</dd>\r\n <DT>month</dt>\r\n  <DD>The name of the month</dd>\r\n <DT>monthnum</dt>\r\n  <DD>The number of the month</dd>\r\n <DT>year</dt>\r\n  <DD>The year.</dd>\r\n</DL>','Calendars and Events','default','en'),('calendar_body_monthly_mini','<DIV class=\"cal_body\">\r\n<P align=\"center\"><A href=\"%%rootdir%%/calendar/monthly/\">%%month%% %%year%%</A></P>\r\n<TABLE width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\r\n<TR>\r\n <TH>M</TH>\r\n <TH>T</TH>\r\n <TH>W</TH>\r\n <TH>T</TH>\r\n <TH>F</TH>\r\n <TH>S</TH>\r\n <TH>S</TH>\r\n</TR>\r\n<TR>\r\n %%wk1_d1%%\r\n %%wk1_d2%%\r\n %%wk1_d3%%\r\n %%wk1_d4%%\r\n %%wk1_d5%%\r\n %%wk1_d6%%\r\n %%wk1_d7%%\r\n</TR>\r\n<TR>\r\n %%wk2_d1%%\r\n %%wk2_d2%%\r\n %%wk2_d3%%\r\n %%wk2_d4%%\r\n %%wk2_d5%%\r\n %%wk2_d6%%\r\n %%wk2_d7%%\r\n</TR>\r\n<TR>\r\n %%wk3_d1%%\r\n %%wk3_d2%%\r\n %%wk3_d3%%\r\n %%wk3_d4%%\r\n %%wk3_d5%%\r\n %%wk3_d6%%\r\n %%wk3_d7%%\r\n</TR>\r\n<TR>\r\n %%wk4_d1%%\r\n %%wk4_d2%%\r\n %%wk4_d3%%\r\n %%wk4_d4%%\r\n %%wk4_d5%%\r\n %%wk4_d6%%\r\n %%wk4_d7%%\r\n</TR>\r\n<TR>\r\n %%wk5_d1%%\r\n %%wk5_d2%%\r\n %%wk5_d3%%\r\n %%wk5_d4%%\r\n %%wk5_d5%%\r\n %%wk5_d6%%\r\n %%wk5_d7%%\r\n</TR>\r\n<TR>\r\n %%wk6_d1%%\r\n %%wk6_d2%%\r\n %%wk6_d3%%\r\n %%wk6_d4%%\r\n %%wk6_d5%%\r\n %%wk6_d6%%\r\n %%wk6_d7%%\r\n</TR>\r\n</TABLE>\r\n\r\n</DIV>','1','<P>This block formats the body of the mini monthly calendar on the front page. This should be a self-contained block of HTML that can be inserted anywhere. The following special keys are recognized:</p>\n<DL>\n <DT>wk*_d*</dt>\n  <DD>The week number within the month and day number within the week. The code replaces each of these with the contents of <B>calendar_body_one_day</b> formatted for the appropriate day.</dd>\n <DT>cal_id</dt>\n  <DD>The ID of the calendar currently being viewed, or zero for the current user\'s personal calendar view.</dd>\n <DT>month</dt>\n  <DD>The current month</dd>\n <DT>year</dt>\n  <DD>The current year</dd>\n</dl>','Calendars and Events','default','en'),('calendar_body_one_day','<TD%%hilight%% valign=\"top\"><DIV class=\"cal_day\">\r\n<DIV class=\"date_number\"><A href=\"%%rootdir%%/calendar/daily/%%cal_id%%/%%year%%-%%month%%-%%date_number%%\">%%date_number%%</A></DIV>\r\n%%events%%\r\n</DIV></TD>','1','<P>This block formats the inside of a single day from either <B>calendar_body_monthly</B>, <B>calendar_body_weekly</B>, or <B>calendar_body_daily</B>. By default it is a single table cell, so all three of the calendar templates must treat it as such and encapsulate it in the appropriate table structure. The following special keys are recognized:</P>\n<DL>\n <DT>hilight</DT>\n  <DD>If the date being formatted is the current date, this is replaced with the contents of <B>calendar_today_hilight</B>, otherwise it is cleared.</DD>\n <DT>cal_id</DT>\n  <DD>The ID of the calendar currently being viewed, or zero for the current user\'s personal calendar view.</DD>\n <DT>year</DT>\n  <DD>The year being viewed</DD>\n <DT>month</DT>\n  <DD>The month being viewed</DD>\n <DT>date_number</DT>\n  <DD>The day being viewed</DD>\n <DT>usercal</dt>\n  <DD>If viewing another user\'s personal calendar view, the \"/user/nickname\" portion of the URL, otherwise blank</dd>\n<DT>events</DT>\n  <DD>All of the events for this day, each formatted according to <B>event_format_monthly</B>, <B>event_format_weekly</B>, or <B>event_format_daily</B>, depending on which calendar view is currently being used.</DD>\n</DL>','Calendars and Events','default','en'),('calendar_body_weekly','<table border=0 cellpadding=0 cellspacing=0 width=\"100%\"><tr><td>\r\n<DIV class=\"cal_head\">\r\n<div class=\"title\">%%calendar_title%% - Week starting %%dow%% <a href=\"%%rootdir%%/calendar/monthly/%%cal_id%%/%%year%%-%%monthnum%%\">%%month%%</a> %%day_num%%, %%year%%</div>\r\n%%BOX,calendar_actions%%\r\n<table align=\"center\" border=0 cellpadding=0 cellspacing=0><tr><td>\r\n<ul id=\"cal_datenav\">\r\n%%BOX,calendar_datenav%%\r\n</ul>\r\n</td></tr></table>\r\n</DIV>\r\n</td></tr></table>\r\n<p>\r\n\r\n\r\n<DIV class=\"cal_body\">\r\n\r\n<TABLE width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-right: 1px solid black; border-bottom: 1px solid black;\">\r\n<TR>\r\n <TH>Monday</TH>\r\n <TH>Tuesday</TH>\r\n <TH>Wednesday</TH>\r\n <TH>Thursday</TH>\r\n <TH>Friday</TH>\r\n <TH>Saturday</TH>\r\n <TH>Sunday</TH>\r\n</TR>\r\n<TR>\r\n %%d1%%\r\n %%d2%%\r\n %%d3%%\r\n %%d4%%\r\n %%d5%%\r\n %%d6%%\r\n %%d7%%\r\n</TR>\r\n\r\n</TABLE>\r\n</div>','1','<P>This block formats the body of the calendar in \"weekly\" view. This should be a self-contained block of HTML that can be inserted anywhere. The following special keys are recognized:</P>\r\n<DL>\r\n <DT>d*</DT>\r\n  <DD>The day number within the current week. Each one is replaced with the block <B>calendar_body_one_day</B> formatted for the appropriate day.</DD>\r\n <DT>subscribe_link</DT>\r\n  <DD>The link to subscribe (or unsubscribe) to this calendar, if viewing one calendar.</DD>\r\n <DT>date</dt>\r\n  <DD>The monday of the week being viewed (YYYY-MM-DD)</dd>\r\n <DT>mediumdate</dt>\r\n  <DD>The monday of the week being viewed (DD-Mmm-YYYY)</dd>\r\n <DT>longdate</dt>\r\n  <DD>The monday of the week being viewed (Wwwwww, DD Mmmmmmm YYYY)</dd>\r\n <DT>dow</dt>\r\n  <DD>Monday (the date displayed is always the monday of the week being viewed)</dd>\r\n <DT>dow_short</dt>\r\n  <DD>Mon (see above)</dd>\r\n <DT>day_num</dt>\r\n  <DD>The day number of the week\'s monday</dd>\r\n <DT>day_ord</dt>\r\n  <DD>The day number of the week\'s monday in ordinal form (1st, 2nd, 3rd, etc)</dd>\r\n <DT>month</dt>\r\n  <DD>The name of the month (if the week spans the end/beginning of a month, it is the month of the week\'s monday)</dd>\r\n <DT>monthnum</dt>\r\n  <DD>The number of the month</dd>\r\n <DT>year</dt>\r\n  <DD>The year (if the week spans the end/beginning of a year, it is the year of the week\'s monday)</dd>\r\n</DL>','Calendars and Events','default','en'),('calendar_css','/* calendar stuff */\r\n\r\n.cal_head { }\r\n\r\n.cal_head ul  {\r\n               border: 0;\r\n               margin-top: 10px;\r\n               margin-left: 0;\r\n               padding-left: 0;\r\n               list-style-type: none;\r\n               text-align: center;\r\n               }\r\n\r\n.cal_head ul li  {\r\n               display: inline;\r\n               text-align: center;\r\n               float: left;\r\n               padding: 0;\r\n               margin: 0;\r\n               }\r\n\r\n.cal_head ul li a  {\r\n               border: 1px solid #006;\r\n               margin: 0;\r\n               padding: 5px;\r\n               color: #3B3B3B;\r\n               text-decoration: none;\r\n               display: block;\r\n               text-align: center;\r\n               font: normal 10px/18px \"Lucida Grande\", \"Lucida Sans Unicode\", verdana, lucida, sans-serif;\r\n               }\r\n\r\n.cal_head ul li a:hover  {\r\n                color: #fff;\r\n                background: #3B3B3B;\r\n                }\r\n\r\n.cal_head UL LI A#current { background-color: #ff0000;\r\n                            color: #ffffff;\r\n                            font-weight: bold; }\r\n\r\n.cal_body {  }\r\n\r\n.cal_body TD { border-top: 1px solid black;\r\n               border-left: 1px solid black;\r\n               border-right: 0px;\r\n               border-bottom: 0px;\r\n               padding: 3px; \r\n               height: 25px;\r\n             }\r\n\r\n.cal_body TD { width: 100px;\r\n               height: 100px;\r\n             }\r\n\r\n.cal_body TH { border-right: 0px;\r\n               border-bottom: 0px;\r\n             }\r\n\r\n.cal_mini_body TD,TH { border: 1px solid black;\r\n                  padding: 1px; \r\n                  height: 5px;\r\n                }\r\n.cal_mini_body TD { width: 10px;\r\n               height: 10px;\r\n             }\r\n\r\n.cal_day_head { height: 25px; }\r\n\r\n.cal_body #today { background-color: #eeeeee; }\r\n.cal_body #other_month { background-color: #cccccc; }\r\n\r\n.date_number a { font-size: 12px; \r\n               border-right: 1px solid black;\r\n               border-bottom: 1px solid black;\r\n               padding: 3px;\r\n               min-wdth: 14px;\r\n               margin-left: -3px;\r\n               margin-top -3px;\r\n}\r\n\r\n.tinylink   { font-size: 9px;\r\n              font-weight: normal;\r\n              font-stretch: wider;\r\n            }\r\n\r\n.event_body { border: 1px solid #222; \r\n              background-color: #F5F5CE;\r\n              margin-left: 25px;\r\n              margin-right:25px;\r\n            }\r\n\r\n.event_title { background-color: #9E7B1B;\r\n               color: #fff;\r\n               font-size: 15px;\r\n               font-weight: bold;\r\n               padding-top:5px;\r\n               padding-bottom:6px;\r\n             }\r\n\r\n.event_details { padding-left: 10px;\r\n                 padding-right:10px;\r\n               }\r\n\r\n.child_event_list { padding-left: 10px;\r\n                    padding-right:10px;\r\n                    margin-left: 25px;\r\n                    margin-right:25px;\r\n\r\n               }','1','','CSS','default','en'),('calendar_error_body','%%title_font%%No Such Calendar%%title_font_end%%\r\n\r\n<P>Sorry, the calendar you requested either doesn\'t exist or is private. <A href=\"%%rootdir%%/my/calendar\">Your personal calendar view</A>.</P>','1','<P>This is the error message displayed when a user requests a calendar that either doesn\'t exist or which they don\'t have permission to see.</P>','Calendars and Events','default','en'),('calendar_invitations','%%title_font%%Invite users%%title_font_end%%\r\n\r\n%%edit_calendar_links%%\r\n\r\n<P>%%msg%%</P>\r\n\r\n<P><B>Users invited to view this calendar</B></P>\r\n\r\n<UL>\r\n%%view_list%%\r\n</UL>\r\n%%view_add%%\r\n\r\n<P><B>Users invited to submit events to this calendar</B></P>\r\n\r\n<UL>\r\n%%submit_list%%\r\n</UL>\r\n%%submit_add%%','1','<P>This block formats the page where a calendar owner manages the invitation lists for their calendar. The following special keys are recognized:</p>\n<DL>\n <DT>msg</dt>\n  <DD>Any status or error message produced</dd>\n <DT>view_list</dt>\n  <DD>The list of users invited to view the calendar</dd>\n <DT>view_add</dt>\n  <DD>The form used to add users to the above list</dd>\n <DT>submit_list</dt>\n  <DD>The list of users invited to submit events to the calendar</dd>\n <DT>submit_add</dt>\n  <DD>The form used to add users to the above list</dd>\n</dl>','Calendars and Events','default','en'),('calendar_invitations_add','<FORM action=\"%%rootdir%%/%%op%%/invite/%%cal_id%%\" method=\"POST\">\r\n<INPUT type=\"hidden\" name=\"action\" value=\"%%list%%_add\">\r\nNickname: <INPUT type=\"text\" name=\"nick\" size=\"20\"> <INPUT type=\"submit\" name=\"add\" value=\"Add\">\r\n</FORM>','1','<P>This block contains the form used in the block <B>calendar_invitations</b> and <B>event_invitations</b> to add to either list available in those two pages. The special keys recognized are:</p>\n<DL>\n <DT>op</dt>\n  <DD>The current op, either editcalendar or submitevent depending on whether we\'re working on a calendar or an event</dd>\n <DT>cal_id</dt>\n  <DD>The internal ID of either the calendar or the event, depending on which we\'re working on</dd>\n <DT>list</dt>\n  <DD>Which list, view or submit, this form is being used for</dd>\n</dl>','Calendars and Events','default','en'),('calendar_invitations_item','<LI><A href=\"%%rootdir%%/user/%%urlnick%%\">%%nickname%%</A> (<A href=\"%%rootdir%%/%%op%%/invite/%%cal_id%%?action=%%list%%_remove;nick=%%nickname%%\">remove</A>)</LI>','1','<P>This block formats a single item in either list in either calendar or event invitation management. The special keys recognized are:</p>\n<DL>\n <DT>urlnick</dt>\n  <DD>the user\'s url-escaped nickname</dd>\n <DT>op</dt>\n  <DD>the current op, either for the calendar or the event</dd>\n <DT>cal_id</dt>\n  <DD>the ID number of the calender or event currently being edited</dd>\n <DT>list</dt>\n  <DD>the name of the list, either view or submit, currently being displayed</dd>\n <DT>nickname</dt>\n  <DD>the user\'s nickname</dd>\n</dl>','Calendars and Events','default','en'),('calendar_monthly_one_week','<TR>\r\n %%wk%%week%%_d1%%\r\n %%wk%%week%%_d2%%\r\n %%wk%%week%%_d3%%\r\n %%wk%%week%%_d4%%\r\n %%wk%%week%%_d5%%\r\n %%wk%%week%%_d6%%\r\n %%wk%%week%%_d7%%\r\n <td style=\"width: 20px;\"><a href=\"%%rootdir%%/calendar/weekly/%%cal_id%%/%%wk%%week%%%%\">W<br>E<br>E<br>K</a></td>\r\n</TR>','1','','Calendars and Events','default','en'),('calendar_navigation_hilight',' id=\"current\"','1','<P>The text placed in <B>calendar_navigation_item</B> to indicate the currently selected calendar date. By default this is an HTML id property for use with CSS, but it can be anything.</P>','Calendars and Events','default','en'),('calendar_navigation_item','<LI><A href=\"%%link_url%%\"%%css_id%%>%%nav_link%%</A></LI>','1','<P>This block formats a single item in the calendar navigation bar. By default it is a single list item, so the block <B>calendar_header</B> must contain the appropriate list start and end HTML. The following special keys are recognized:</P>\n<DL>\n <DT>type</DT>\n  <DD>The current calendar view: monthly, weekly, or daily.</DD>\n <DT>cal_id</DT>\n  <DD>The calendar ID of the current calendar, or zero for the user\'s personal calendar view.</DD>\n <DT>date</DT>\n  <DD>The link\'s destination date.</DD>\n <DT>css_id</DT>\n  <DD>The contents of <B>calendar_navigation_hilight</B> if this is the item for the current calendar, blank otherwise.</DD>\n <DT>nav_link</DT>\n  <DD>The formatted destination date.</DD>\n <DT>usercal</DT>\n  <DD>If viewing a user\'s personal calendar view, this becomes /user/nickname; otherwise blank</DD>\n</DL>','Calendars and Events','default','en'),('calendar_other_month_hilight',' id=\"other_month\"','1','<P>The text placed in <B>calendar_body_one_day</b> to indicate days which are outside the range being displayed. This is only used in the monthly view, to fill in the grid. By default this is an HTML id property for use with CSS, but it can be anything.</p>','Calendars and Events','default','en'),('calendar_settings','%%title_font%%%%pagetitle%%%%title_font_end%%\r\n\r\n%%edit_calendar_links%%\r\n\r\n<DIV>\r\n<FORM name=\"calendar_settings\" action=\"%%rootdir%%/editcalendar/settings/%%cal_id%%\" method=\"POST\">\r\n<P>%%msg%%</P>\r\n<P><B>Calendar Title:</B> <INPUT type=\"text\" size=\"50\" maxlength=\"100\" name=\"title\" value=\"%%title%%\"></P>\r\n<P><B>Description:</B><BR>\r\n<TEXTAREA name=\"description\" rows=\"%%textarea_rows%%\" cols=\"%%textarea_cols%%\">%%description%%</TEXTAREA></P>\r\n<FIELDSET><LEGEND>Who can see this calendar?</LEGEND>\r\n<INPUT type=\"radio\" name=\"public_view\" value=\"public\"%%view_public_checked%%> Everybody<BR>\r\n<INPUT type=\"radio\" name=\"public_view\" value=\"invite\"%%view_invite_checked%%> Only people on <A href=\"%%rootdir%%/editcalendar/invite/%%cal_id%%\">the invitation list</A><BR>\r\n<INPUT type=\"radio\" name=\"public_view\" value=\"private\"%%view_private_checked%%> Only me</FIELDSET>\r\n<FIELDSET><LEGEND>Who can submit events to this calendar?</LEGEND>\r\n<INPUT type=\"radio\" name=\"public_submit\" value=\"public\"%%submit_public_checked%%> Everybody<BR>\r\n<INPUT type=\"radio\" name=\"public_submit\" value=\"modpublic\"%%submit_modpublic_checked%%> Everybody, but I will review the events before they\'re visible<BR>\r\n<INPUT type=\"radio\" name=\"public_submit\" value=\"invite\"%%submit_invite_checked%%> Only people on <A href=\"%%rootdir%%/editcalendar/invite/%%cal_id%%\">the invitation list</A><BR>\r\n<INPUT type=\"radio\" name=\"public_submit\" value=\"modinvite\"%%submit_modinvite_checked%%> Only people on <A href=\"%%rootdir%%/editcalendar/invite/%%cal_id%%\">the invitation list</A>, but I will review the events before they\'re visible<BR>\r\n<INPUT type=\"radio\" name=\"public_submit\" value=\"private\"%%submit_private_checked%%> Only me</FIELDSET>\r\n<P><INPUT type=\"submit\" name=\"save\" value=\"Save\"></P>\r\n</FORM>\r\n<P><A href=\"%%rootdir%%/calendar//%%cal_id%%\">View this calendar</A></P>\r\n</DIV>','1','<P>This block is the form used to edit a particular calendar. The special keys recognized are:</P>\n<DL>\n <DT>submit_*_checked, view_*_checked</DT>\n  <DD>The checked indicator for the permissions radio buttons</DD>\n <DT>pagetitle</DT>\n  <DD>The title of the page</DD>\n <DT>cal_id</DT>\n  <DD>The internal ID of the calendar we\'re editing</DD>\n <DT>msg</DT>\n  <DD>Any status or error message that comes up when we save a calendar</DD>\n <DT>title</DT>\n  <DD>The calendar title</DD>\n <DT>description</DT>\n  <DD>A description of what the calendar is for</DD> </DL>','Calendars and Events','default','en'),('calendar_subscribe_item','<INPUT type=\"checkbox\" name=\"subscribe_item\" value=\"%%cal_value%%\"%%cal_checked%%> <A href=\"%%rootdir%%/calendar/%%view%%/%%cal_value%%/%%date%%\">%%cal_title%%</A><BR>\r\n','1','<P>This is one item in the list of calendars we can subscribe to. It is shown in the personal calendar view. If this is a list item, the block <B>calendar_subscribe_multi_form</B> must contain the list start and end tags. The following special keys are recognized:</P>\n<DL>\n <DT>cal_value</DT>\n  <DD>The calendar number for the calendar being displayed on this line</DD>\n <DT>cal_checked</DT>\n  <DD>the \'checked\' toggle to indicate if this calendar is in our subscription list or not</DD>\n <DT>view</DT>\n  <DD>monthly, weekly, or daily, depending on the current view</DD>\n <DT>date</dt>\n  <DD>The date of the calendar currently being viewed</dd>\n <DT>cal_title</DT>\n  <DD>The title of the calendar</DD>\n<DL>','Calendars and Events','default','en'),('calendar_subscribe_link','<P><A href=\"/calendar/%%view%%/%%cal_id%%/%%date%%?subscribe=add\">Subscribe to this calendar</A></P>','1','<P>This block is the subscribe link shown underneath a calendar to which the user is not currently subscribed, if the site control <B>allow_personal_calendar_view</B> is on. The special keys recognized are:</P>\n<DL>\n <DT>view</DT>\n  <DD>The current view (monthly, weekly, or daily)</DD>\n <DT>cal_id</DT>\n  <DD>The ID number of the current calendar</DD>\n <DT>date</DT>\n  <DD>The current calendar\'s date</DD>\n</DL>','Calendars and Events','default','en'),('calendar_subscribe_multi_form','<P>Calendars in your personal calendar view:<BR>\r\n<FORM name=\"calendar_subscribe\" action=\"%%rootdir%%%%usercal%%/calendar/%%view%%/%%cal_id%%/%%date%%\" method=\"post\">\r\n<INPUT type=\"hidden\" name=\"subscribe\" value=\"multi\">\r\n%%calendar_checks%%\r\n<BR>\r\n<INPUT type=\"submit\" name=\"save\" value=\"Update Calendar\">\r\n</FORM>','1','<P>This is the framework for the calendar subscription form shown underneath the personal calendar view, if the site control <B>allow_personal_calendar_view</B> is on. The special keys recognized are:</P>\n<DL>\n <DT>view</DT>\n  <DD>The current view (monthly, weekly, or daily)</DD>\n <DT>cal_id</DT>\n  <DD>The ID number of the current calendar</DD>\n <DT>date</DT>\n  <DD>The current calendar\'s date</DD>\n <DT>usercal</DT>\n  <DD>If we\'re in the user op, the user op and nickname, otherwise blank.</DD>\n <DT>calendar_checks</DT>\n  <DD>one copy of <B>calendar_subscribe_item</B> for each calendar the current user is allowed to subscribe to, checked appropriately.</DD>\n</DL>','Calendars and Events','default','en'),('calendar_today_hilight',' id=\"today\"','1','<P>The text placed in <B>calendar_body_one_day</B> to indicate today. By default this is an HTML id property for use with CSS, but it can be anything.</P>','Calendars and Events','default','en'),('calendar_unsubscribe_link','<P><A href=\"/calendar/%%view%%/%%cal_id%%/%%date%%?subscribe=remove\">Unsubscribe from this calendar</A></P>','1','<P>This block is the unsubscribe link shown underneath a calendar to which the user is currently subscribed, if the site control <B>allow_personal_calendar_view</B> is on. The special keys recognized are:</P>\n<DL>\n <DT>view</DT>\n  <DD>The current view (monthly, weekly, or daily)</DD>\n <DT>cal_id</DT>\n  <DD>The ID number of the current calendar</DD>\n <DT>date</DT>\n  <DD>The current calendar\'s date</DD>\n</DL>','Calendars and Events','default','en'),('cellar_guidelines','Thank you for taking the time to submit some stuff into The Whine Cellar\r\n<p>\r\nAnything you post here is not available to people who aren\'t logged in. As search engines aren\'t usually logged in, they don\'t normally index stories posted here. Don\'t count on it though.\r\n<p>\r\nUnlike the hole, stories posted here are not deleted. They stick around forever (or as long as the site does anyway).','2','','display,general','default','en'),('cellar_submission_message','<br><div class=\"submission_message\">Your new entry has been posted. Enjoy!</div>','2','<P>This block is displayed just underneath a user\'s diary when they have just posted it.  It should contain a message informing the user that their diary was successfully saved, and is otherwise free-form, self-contained HTML. There are no special keys.</P>','Diaries','default','en'),('charset','<meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\">','2','','general','default','en'),('comment','<!-- start comment -->\r\n<div class=\"graph_commentheader\" title=\"Posted %%date%%\"><a class=\"light\" name=\"%%cid%%\"></a>\r\n    %%new%% <b>%%subject%%</b> by <a class=\"light\" href=\"%%rootdir%%/user/uid:%%uid%%\">%%name%%</a> %%member%% %%rating_format%% <a class=\"light\" href=\"%%rootdir%%/comments/%%sid%%/%%cid%%#%%cid%%\">#%%cid%%</a>\r\n%%comment_ip%% <span class=\"comment_time\">%%date%%</span>\r\n</div>\r\n<div class=\"comment\">\r\n    %%comment%%<br>%%sig%%<br>%%actions%%\r\n<br><br>\r\n</div>\r\n%%replies%%\r\n\r\n<!-- end comment -->','1','<P>This block is used to format each topical comment attached to a story or poll.  It is not used directly in any block, but is called repeatedly in the code, once for each topical comment displayed.  (Editorial comments use the block <B>moderation_comment</B>).  This should be a self-contained chunk of HTML code that can be nested arbitrarily deep.  The special keys recognised are:</P>\r\n<DL>\r\n <DT>uid</DT>\r\n  <DD>The numeric user ID of the comment poster</DD>\r\n <DT>edit_user</DT>\r\n  <DD>The edit user link, only displayed if the user viewing the page has the perm <B>edit_user</B>.</DD>\r\n <DT>name</DT>\r\n  <DD>The nickname of the comment poster</DD>\r\n <DT>date</DT>\r\n  <DD>A formatted time/date string</DD>\r\n <DT>subject</DT>\r\n  <DD>The subject of the comment</DD>\r\n <DT>new</DT>\r\n  <DD>The contents of the block <B>new_comment_marker</B>, if the comment is not yet marked as read for the user viewing the comment.  Use this, not new_comment_marker, in this block.</DD>\r\n <DT>member</DT>\r\n  <DD>The contents of the block <B>mark_(groupname)</B>, if it exists for the poster\'s group</DD>\r\n <DT>sig</DT>\r\n  <DD>The user\'s signature, if one is set.</DD>\r\n <DT>rating_format</DT>\r\n  <DD>If ratings are turned off, or the user chooses not to see ratings, this is blanked; if ratings should be displayed, this is replaced with the contents of the block <B>rating_format</B> which may use the special keys <B>score</B> and <B>num_ratings</B> to display the current ratings.</DD>\r\n <DT>comment</DT>\r\n  <DD>The body of the comment</DD>\r\n <DT>cid</DT>\r\n  <DD>The comment ID. This plus the sid uniquely identifies each comment.</DD>\r\n <DT>actions</DT>\r\n  <DD>The parent, reply, delete, toggle, and dynamic mode expand and collapse links; each part according to permissions.</DD>\r\n <DT>user_info</DT>\r\n  <DD>A link to the comment poster\'s user info page.</DD>\r\n <DT>sid</DT>\r\n  <DD>The story ID.  This plus the cid uniquely identifies each comment; this alone uniquely identifies each story or poll.</DD>\r\n <DT>score</DT>\r\n  <DD>The comment\'s current score, an average of all the ratings.</DD>\r\n <DT>num_ratings</DT>\r\n  <DD>The number of ratings given to the comment.</DD>\r\n <DT>email</DT>\r\n  <DD>The user\'s \"fake email\" from their user preferences in a mailto: link, if present</DD>\r\n <DT>url</DT>\r\n  <DD>The user\'s homepage from their user preferences in a link, if present</DD>\r\n <DT>replies</DT>\r\n  <DD>All comment replies.  If in threaded or minimal, this is formatted as just the subject; if in nested, this is formatted as the full comment.</DD>\r\n</DL>','Comments','default','en'),('comment','<!-- start comment -->\r\n<div class=\"commentheader\"><a class=\"light\" name=\"%%cid%%\"></a>\r\n    %%new%% <b>%%subject%%</b>\r\n%%rating_format%% (<a class=\"light\" href=\"%%rootdir%%/comments/%%sid%%/%%cid%%#%%cid%%\">#%%cid%%</a>)<br>\r\nby <a class=\"light\" href=\"%%rootdir%%/user/uid:%%uid%%\">%%name%%</a> %%member%% %%email%% on %%date%% %%comment_ip%% <br>%%url%%\r\n</div>\r\n<div class=\"comment\"><br>\r\n    %%comment%%<br>%%sig%%<br>%%actions%%\r\n<br><br>\r\n</div>\r\n%%replies%%\r\n\r\n<!-- end comment -->','2','<P>This block is used to format each topical comment attached to a story or poll.  It is not used directly in any block, but is called repeatedly in the code, once for each topical comment displayed.  (Editorial comments use the block <B>moderation_comment</B>).  This should be a self-contained chunk of HTML code that can be nested arbitrarily deep.  The special keys recognised are:</P>\r\n<DL>\r\n <DT>uid</DT>\r\n  <DD>The numeric user ID of the comment poster</DD>\r\n <DT>edit_user</DT>\r\n  <DD>The edit user link, only displayed if the user viewing the page has the perm <B>edit_user</B>.</DD>\r\n <DT>name</DT>\r\n  <DD>The nickname of the comment poster</DD>\r\n <DT>date</DT>\r\n  <DD>A formatted time/date string</DD>\r\n <DT>subject</DT>\r\n  <DD>The subject of the comment</DD>\r\n <DT>new</DT>\r\n  <DD>The contents of the block <B>new_comment_marker</B>, if the comment is not yet marked as read for the user viewing the comment.  Use this, not new_comment_marker, in this block.</DD>\r\n <DT>member</DT>\r\n  <DD>The contents of the block <B>mark_(groupname)</B>, if it exists for the poster\'s group</DD>\r\n <DT>sig</DT>\r\n  <DD>The user\'s signature, if one is set.</DD>\r\n <DT>rating_format</DT>\r\n  <DD>If ratings are turned off, or the user chooses not to see ratings, this is blanked; if ratings should be displayed, this is replaced with the contents of the block <B>rating_format</B> which may use the special keys <B>score</B> and <B>num_ratings</B> to display the current ratings.</DD>\r\n <DT>comment</DT>\r\n  <DD>The body of the comment</DD>\r\n <DT>cid</DT>\r\n  <DD>The comment ID. This plus the sid uniquely identifies each comment.</DD>\r\n <DT>actions</DT>\r\n  <DD>The parent, reply, delete, toggle, and dynamic mode expand and collapse links; each part according to permissions.</DD>\r\n <DT>user_info</DT>\r\n  <DD>A link to the comment poster\'s user info page.</DD>\r\n <DT>sid</DT>\r\n  <DD>The story ID.  This plus the cid uniquely identifies each comment; this alone uniquely identifies each story or poll.</DD>\r\n <DT>score</DT>\r\n  <DD>The comment\'s current score, an average of all the ratings.</DD>\r\n <DT>num_ratings</DT>\r\n  <DD>The number of ratings given to the comment.</DD>\r\n <DT>email</DT>\r\n  <DD>The user\'s \"fake email\" from their user preferences in a mailto: link, if present</DD>\r\n <DT>url</DT>\r\n  <DD>The user\'s homepage from their user preferences in a link, if present</DD>\r\n <DT>replies</DT>\r\n  <DD>All comment replies.  If in threaded or minimal, this is formatted as just the subject; if in nested, this is formatted as the full comment.</DD>\r\n</DL>','Comments','old-skool','en'),('commentdisclaimer','This is the whine cellar. Comments posted to stories here are not visible to users who aren\'t logged in. You should be careful about posting information based on that though. It\'s very easy to get an account here, and anybody could be reading this.<p>\r\n','2','<P>This block is displayed just above the comment posting form.  Put whatever message or warning you want displayed every time somebody posts a comment.  This should be self-contained HTML.  There are no special keys.</P>','Comments','cellar','en'),('commentdisclaimer','This is the hole. Comments posted to stories here are not archived, they are deleted along with the stories they\'re attached to.','2','<P>This block is displayed just above the comment posting form.  Put whatever message or warning you want displayed every time somebody posts a comment.  This should be self-contained HTML.  There are no special keys.</P>','Comments','crap','en'),('commentdisclaimer','Please make sure you have read the <a href=\"/scoop/special/faq\">faq</a> before posting.','1','<P>This block is displayed just above the comment posting form.  Put whatever message or warning you want displayed every time somebody posts a comment.  This should be self-contained HTML.  There are no special keys.</P>','Comments','default','en'),('commentreply_display','<table cellpadding=\"1\" cellspacing=\"0\" border=\"0\" width=\"100%\">\r\n  <tr>\r\n    <td bgcolor=\"%%title_bgcolor%%\" width=\"100%\">\r\n      %%title_font%%<b>Replying To:</b>%%title_font_end%%\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td>\r\n      %%replying_to%%\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td>\r\n      %%post_form%%\r\n    </td>\r\n  </tr>\r\n</table>\r\n','1','<P>This block lays out the comment post form. It recognises the following special keys:</P>\n<DL>\n <DT>replying_to</DT>\n  <DD>The story or comment the user is replying to.</DD>\n <DT>post_form</DT>\n  <DD>The actual comment posting form. This is laid out in the block <B>comment_post_form</B>.</DD>\n</DL>','Comments','default','en'),('comment_controls','<FORM NAME=\"commentmode\" ACTION=\"%%rootdir%%/%%anchor%%\" METHOD=\"post\">\r\n%%hidden_inputs%%\r\nView: \r\n%%commenttype_select%%\r\nDisplay: \r\n%%commentmode_select%%\r\nSort:\r\n%%commentrating_select%%\r\n%%commentorder_select%%\r\n%%commentrating_choice%%\r\n<INPUT TYPE=\"submit\" NAME=\"setcomments\" VALUE=\"set\">\r\n</FORM>','2','','general','default','en'),('comment_delete_link',' (<A CLASS=\"light\" HREF=\"%%rootdir%%/comments/%%sid%%/%%cid%%/delete\">delete</A>)','1','<P>The link to delete a comment (remove entirely and make replies to this comment become replies to this comment\'s parent), if the user has the <B>comment_delete</B> perm. Special keys sid and cid identify the comment.</P>','Comments','default','en'),('comment_head_bg','#eeeeee','1','<P>This block is used wherever a colour value is needed to set the background colour of the comment header (which typically contains the subject and poster\'s information, but not the comment itself).  It should be a hex colour value, including the #, such as #000000 for black.  There are no special keys.</P>','Colours','default','en'),('comment_head_bg','#eeeeee','1','<P>This block is used wherever a colour value is needed to set the background colour of the comment header (which typically contains the subject and poster\'s information, but not the comment itself).  It should be a hex colour value, including the #, such as #000000 for black.  There are no special keys.</P>','Colours','greyscale','en'),('comment_ip_display','<a href=\"%%rootdir%%/iplookup/%%ip%%\">%%ip%%</a>','19','Format for the IP display/link attached to comments. \r\n<p>\r\nSpecial keys:\r\n<ul><li>ip: Replaced with the ip</li></ul>','Comments','default','en'),('comment_not_logged_in','<P>%%norm_font%%You are not logged in. If you don\'t have a user account yet, by all means <A HREF=\"%%rootdir%%/newuser\">go make one</A>! If you do have one, you can post as \"yourself\" by filling in your nickname and password below. Otherwise, your comment will be posted as <B>%%anon_user_nick%%</B>.%%norm_font_end%%</P>\r\n\r\n<P>%%norm_font%%<A HREF=\"%%rootdir%%/newuser\">Create Account</A>\r\n<BR>Nickname: <INPUT TYPE=\"text\" SIZE=\"30\" NAME=\"uname\">\r\n<BR>Password: <INPUT TYPE=\"password\" SIZE=\"30\" NAME=\"pass\">%%norm_font_end%%</P>\r\n','1','<P>This block contains the message and login form shown when an anonymous user tries to post a comment (if anonymous users can post comments). There are no special keys. The login form must have fields named \"uname\" and \"pass\".</P>','Comments','default','en'),('comment_num_format_end','','1','<P>This block is used just after the number of total comments attached to a story. It should be a complete closing font or text style indicator, such as a font or b tag. It must properly close the tags opened by the contents of the block <B>comment_num_format_start</B>.  There are no special keys.</P>','Comments','default','en'),('comment_num_format_start','','1','<P>This block is used just before the number of total comments attached to a story. It should be a complete opening font or text style indicator, such as a font or b tag. It must be properly closed by the contents of the block <B>comment_num_format_end</B>.  There are no special keys.</P>','Comments','default','en'),('comment_plural','s','1','<P>This block is used to provide a plural suffix if there is more than one comment attached to a story.  It is simply appended to the value in <B>comment_word</B> where appropriate.  There are no special keys.</P>','Comments','default','en'),('comment_posted_display','%%comment_controls%%\r\n<table cellpadding=\"1\" cellspacing=\"0\" border=\"0\" width=\"100%\">\r\n  <tr>\r\n    <td BGCOLOR=\"%%title_bgcolor%%\">\r\n      %%title_font%%%%post_msg%%%%title_font_end%%\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td>\r\n      %%new_comment%%\r\n    </td>\r\n  </tr>\r\n</table>\r\n','1','<P>This block lays out the comment display after the comment has been posted. The special keys are:</P>\n<DL>\n <DT>comment_controls</DT>\n  <DD>the comment display options</DD>\n <DT>post_msg</DT>\n  <DD>If the user is untrusted (has a mojo below <B>rating_min</B>) the block <B>untrusted_post_message</B> is displayed here, otherwise the block <B>comment_posted_message</B></DD>\n <DT>new_comment</DT>\n  <DD>The comment just posted.</DD>\n</DL>','Comments','default','en'),('comment_posted_message','<A NAME=\"here\">Comment posted!</A> Thank you for contributing.','2','<P>This block is displayed after a user has successfully posted a message. It should contain a message telling the user so. There are no special keys.</P>','Comments','default','en'),('comment_post_form','<FORM NAME=\"postcomment\" ACTION=\"%%rootdir%%/comments/%%sid%%/%%pid%%/post#here\" METHOD=\"POST\">\r\n  <TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=0 CELLSPACING=0>\r\n    <TR>\r\n      <TD BGCOLOR=\"%%title_bgcolor%%\" WIDTH=\"100%\">\r\n        %%preview_msg%%\r\n      </TD>\r\n    </TR>\r\n    <TR>\r\n      <TD>\r\n        %%COMM_ERR%%\r\n        <P><!-- begin previewed comment -->\r\n        %%PRE_COMMENT%%\r\n        <!-- end previewed comment -->\r\n      </TD>\r\n    </TR>\r\n    <TR>\r\n      <TD BGCOLOR=\"%%title_bgcolor%%\" WIDTH=\"100%\">\r\n        <A NAME=\"%%here%%\"><B>Post Comment</B></A>\r\n      </TD>\r\n    </TR>\r\n    <TR>\r\n      <TD>\r\n        <P>%%norm_font%%%%not_logged_in%%%%norm_font_end%%</P>\r\n        <P>%%norm_font%%%%commentdisclaimer%%%%norm_font_end%%</P>\r\n        %%formkey_element%%\r\n        <P>%%norm_font%%%%post_as%%%%norm_font_end%%</P>\r\n        %%pending_form%%\r\n      </TD>\r\n    </TR>\r\n    <TR>\r\n      <TD>\r\n        %%norm_font%%Subject:%%norm_font_end%%<BR>\r\n        %%norm_font%%<INPUT TYPE=\"text\" size=\"50\" name=\"subject\" VALUE=\"%%subject%%\" maxlength=\"50\">%%norm_font_end%%\r\n      </TD>\r\n    </TR>\r\n    <TR>\r\n      <TD>\r\n        %%norm_font%%Comment:%%norm_font_end%%<BR>\r\n        %%norm_font%%<TEXTAREA NAME=\"comment\" COLS=\"%%textarea_cols%%\" ROWS=\"%%textarea_rows%%\">%%comment_body%%</TEXTAREA>%%norm_font_end%%\r\n      </TD>\r\n    </TR>\r\n    <TR>\r\n      <TD>\r\n        %%sig_behavior_form%%\r\n      </TD>\r\n    </TR>\r\n    <TR>\r\n      <TD>\r\n        %%post_opt%%\r\n      </TD>\r\n    </TR>\r\n    <TR>\r\n      <TD>%%norm_font%%\r\n        %%spellcheck_form%%\r\n        <INPUT TYPE=\"submit\" NAME=\"preview\" VALUE=\"Preview\">\r\n        <INPUT TYPE=\"submit\" NAME=\"post\" VALUE=\"Post\">\r\n        %%norm_font_end%%\r\n      </TD>\r\n    </TR>\r\n    <TR>\r\n      <TD>\r\n        %%allow_tags%%\r\n      </TD>\r\n    </TR>\r\n  </TABLE>\r\n</FORM>','1','<P>This block lays out the comment post form. The following form elements are used:</P>\r\n<DL>\r\n <DT>subject</DT>\r\n  <DD>The form field for the comment subject. Generally a regular text input.</DD>\r\n <DT>comment</DT>\r\n  <DD>The form field for the comment body. Generally a textarea.</DD>\r\n <DT>preview</DT>\r\n  <DD>The \"preview\" button. Value can be anything that isn\'t a perl false value (zero or empty string)</DD>\r\n <DT>post</DT>\r\n  <DD>The \"post\" button. Value can be anything that isn\'t a perl false value (zero or empty string)</DD>\r\n</DL>\r\n<P>The following special keys are used:</P>\r\n<DL>\r\n <DT>sid</DT>\r\n  <DD>The sid of the story the comment will be attached to</DD>\r\n <DT>pid</DT>\r\n  <DD>The comment ID of the comment being replied to</DD>\r\n <DT>preview_msg</DT>\r\n  <DD>The contents of the block <B>comment_preview_msg</B>, if there\'s a comment currently being previewed.</DD>\r\n <DT>COMM_ERR</DT>\r\n  <DD>Any error messages generated during the post or preview process.</DD>\r\n <DT>PRE_COMMENT</DT>\r\n  <DD>The formatted comment being previewed</DD>\r\n <DT>here</DT>\r\n  <DD>Either \"here\" (if there\'s no comment being previewed) or \"there\" (if there is) so that the anchors work out properly</DD>\r\n <DT>not_logged_in</DT>\r\n  <DD>The contents of the block <B>comment_not_logged_in</B> if the user is not currently logged in</DD>\r\n <DT>formkey_element</DT>\r\n  <DD>The formkey for the comment post form</DD>\r\n <DT>post_as</DT>\r\n  <DD>If anonymous users are allowed to post and the user is logged in, this is a selectbox that allows the user to choose whether to post anonymously or not</DD>\r\n <DT>pending_form</DT>\r\n  <DD>If the story is still in the queue, this is a selectbox that allows the user to choose whether to post an editorial or topical comment.</DD>\r\n <DT>subject</DT>\r\n  <DD>The comment\'s subject, used as a default value for the subject form element</DD>\r\n <DT>textarea_cols</DT>\r\n  <DD>The user preference for size of the textarea</DD>\r\n <DT>textarea_rows</DT>\r\n  <DD>The user preference for size of the textarea</DD>\r\n <DT>comment_body</DT>\r\n  <DD>The comment\'s body, used as a default value for the comment form element</DD>\r\n <DT>spellcheck_form</DT>\r\n  <DD>The contents of the block <B>spellcheck_form_item</B> if spellcheck is turned on</DD>\r\n <DT>sig_behavior_form</DT>\r\n  <DD>A form element that allows users to choose whether or how to display their sig, if permitted and if they have a sig</DD>\r\n <DT>post_opt</DT>\r\n  <DD>A form element that allows users to choose which post mode (plain text, autoformat, html) they want to use</DD>\r\n <DT>allow_tags</DT>\r\n  <DD>The \"allowed HTML\"</DD>\r\n</DL>','Comments','default','en'),('comment_preview_msg','%%title_font%%<A NAME=\"here\">Preview Comment</A>%%title_font_end%%','1','<P>This is the \"Preview Comment\" title bar. Make sure it has an anchor named \"here\" in it. There are no special keys.</P>','Comments','default','en'),('comment_remove_link',' (<A CLASS=\"light\" HREF=\"%%rootdir%%/comments/%%sid%%/%%cid%%/remove\">suppress comment</A>)','1','<P>The link to remove a comment (replace with a placeholder indicating that the comment has been deleted), if the user has the <B>comment_remove</B> perm. Special keys sid and cid identify the comment.</P>','Comments','default','en'),('comment_search_item','<B>%%count%%) <A HREF=\"%%rootdir%%/comments/%%sid%%/%%cid%%#%%cid%%\">%%subject%%</A></B>\r\n[<A HREF=\"%%rootdir%%/comments/%%sid%%/%%cid%%?mode=alone;showrate=1#%%cid%%\">%%score%% / %%num_rate%%</A>]\r\nReplies: <B>%%replies%%</B>\r\n<BR>posted by <A HREF=\"%%rootdir%%/user/%%urlnick%%\">%%nick%%</A> on %%ftime%%\r\n<BR>\r\nattached to <a href=\"%%attached_link%%\">%%attached_title%%</a>\r\n<p>','19','Formatting for an item in a comment search result list.\r\n<p>\r\nSpecial keys:\r\n<ul>\r\n<li> count: the result number\r\n<li> sid: story id\r\n<li> cid: comment id\r\n<li> pid: parent comments id (or 0)\r\n<li> uid: uid fo the poster\r\n<li> nick: nickname of the poster\r\n<li> urlnick: nickname of the poster escaped for url use (like \"/user/|urlnick|\")\r\n<li> date: comment posting date (raw)\r\n<li> ftime: comment post date (formatted and timezone adjusted)\r\n<li> subject: comment subject\r\n<li> comment: comment text\r\n<li> score: rating score\r\n<li> num_rate: number of ratings\r\n<li> rank: rank value (if you\'re using mysql fulltext search)\r\n<li> attached_link: url for the story or poll the comment is attached to\r\n<li> attached_title: title of the story or poll the comment is attached to\r\n</ul>','Comments','default','en'),('comment_template','%%doctype%%\r\n<HTML>\r\n<HEAD>\r\n%%stylesheet%%\r\n<TITLE>%%sitename%% || %%subtitle%%</TITLE>\r\n%%site_logo%%\r\n%%BOX,use_spell_suggest%%\r\n%%BOX,use_fckeditor%%\r\n</HEAD>\r\n<BODY bgcolor=\"#FFFFFF\" text=\"#000000\" link=\"#006699\" vlink=\"#003366\">\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<TABLE BORDER=0 WIDTH=\"99%\" ALIGN=\"center\" CELLPADDING=0 CELLSPACING=10>\r\n	<!-- Main page block -->\r\n	<TR>\r\n		\r\n		<!-- Center content section -->\r\n		<TD VALIGN=\"top\" width=\"73%\">\r\n          			%%STORY%%\r\n			<!--BOX,comment_controls-->\r\n			%%CONTENT%%\r\n         			<!--BOX,comment_controls-->\r\n		</TD>\r\n		<!-- X center content section -->\r\n		\r\n		<!-- Right boxes column -->\r\n		<TD VALIGN=\"top\" WIDTH=\"27%\">\r\n			%%BOX,ad_box%%\r\n                        %%BOX,user_box%%\r\n			%%BOX,hotlist_flex_box%%\r\n                        %%BOX,user_files_list,comment%%\r\n			%%BOX,admin_tools%%\r\n		</TD>\r\n		<!-- X Right boxes column -->\r\n	</TR>\r\n	<!-- X main page block -->\r\n</TABLE>\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</BODY>\r\n</HTML>\r\n','2','Page used to display comments. This page is used to show comments for a story, and to post a comment to a story.','templates','default','en'),('comment_template','%%doctype%%\r\n<HTML>\r\n<HEAD>\r\n%%stylesheet%%\r\n<TITLE>%%sitename%% || %%subtitle%%</TITLE>\r\n%%site_logo%%\r\n%%BOX,use_spell_suggest%%\r\n%%BOX,use_fckeditor%%\r\n</HEAD>\r\n<BODY bgcolor=\"#FFFFFF\" text=\"#000000\" link=\"#006699\" vlink=\"#003366\">\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<div class=\"main\">\r\n	<div class=\"storystuff\">\r\n	<!-- Story stuff -->\r\n	%%STORY%%\r\n\r\n	%%CONTENT%%\r\n	<!-- X story stuff -->\r\n	</div>\r\n</div>\r\n\r\n<!-- comments -->\r\n		\r\n		<!-- Right boxes column -->\r\n<div>\r\n%%BOX,ad_box%%\r\n%%BOX,user_box%%\r\n%%BOX,hotlist_flex_box%%\r\n%%BOX,user_files_list,comment%%\r\n%%BOX,admin_tools%%\r\n		<!-- X Right boxes column -->\r\n\r\n</div>\r\n\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</BODY>\r\n</HTML>\r\n','2','Page used to display comments. This page is used to show comments for a story, and to post a comment to a story.','templates','mobile','en'),('comment_toggle_link',' (<A CLASS=\"light\" HREF=\"%%rootdir%%/comments/%%sid%%/%%cid%%/%%toggle%%\">toggle</A>)','1','<P>The link to toggle a comment between topical and editorial, if the user has the <B>comment_toggle</B> perm. Special keys sid and cid identify the comment, and toggle sets the type (topical or editorial).</P>','Comments','default','en'),('comment_word','comment','1','<P>This block contains the word used for comments in the comment count on the front page.  This should be the singular form; the plural suffix is set in the block <B>comment_plural</B>.  There are no special keys.</P>','Comments','default','en'),('confirm_ad_renew','%%norm_font%% Be sure this is the number of impressions you want, and hit \"Submit\" below when you are ready to renew your ad %%norm_font_end%%','1','<P>This block is used during the final confirmation step of ad renewal.  It should be reasonably self-contained HTML and contain a message explaining that this is the final confirmation step before the ad renewal is actually processed.  There are no special keys. Ad renewal is yet another unimplemented ad feature.</P>','Ads','default','en'),('confirm_purchase_impressions','If you\'re sure that you want this many impressions, click \"Submit\" below.  If you need to make a change, change the number and hit confirm again.','1','yet another unimplemented ad feature','Ads','default','en'),('content_only_page_template','%%CONTENT%%','1','<P>This block can be used where you want Scoop to output only the content, with no HTML page wrapper at all.  It should contain only the special key CONTENT and nothing else.  The special key CONTENT is replaced with the output of whichever function or box is run using this block as its page template (see the Ops Admin Tool).</P>','Page Templates','default','en'),('crap_guidelines','Thank you for taking the time to submit some stuff into the hole\r\n<p>\r\nAnything you post here is not available to people who aren\'t logged in. As search engines aren\'t usually logged in, they don\'t normally index stories in the hole. Don\'t count on it though.\r\n<p>\r\nStories posted here don\'t stick around long. They, and all the comments posted here are deleted after about a month.','2','','display,general','default','en'),('crap_submission_message','<br><div class=\"submission_message\">Your new entry has been posted. Enjoy!</div>','2','<P>This block is displayed just underneath a user\'s diary when they have just posted it.  It should contain a message informing the user that their diary was successfully saved, and is otherwise free-form, self-contained HTML. There are no special keys.</P>','Diaries','default','en'),('cron_template','<html>\r\n<head>\r\n%%stylesheet%%\r\n<title>%%slogan%% %%%% Cron</title>\r\n</head>\r\n<body bgcolor=\"#FFFFFF\"><pre>%%CONTENT%%</pre></body>\r\n</html>','1','<P>This block is used to format Scoop\'s cron system output.  It parsed by run_cron.pl and should not be changed as neither users nor administrators ever use it directly.</P>','Page Templates','default','en'),('css_includes','<link rel=\"stylesheet\" type=\"text/css\" href=\"%%site_url%%/main.css\">\r\n<link rel=\"stylesheet\" type=\"text/css\" href=\"%%site_url%%/dark.css\">','2','','CSS,general','crap','en'),('css_includes','<link rel=\"stylesheet\" type=\"text/css\" href=\"%%site_url%%/main.css\">\r\n<link rel=\"stylesheet\" type=\"text/css\" href=\"%%site_url%%/dark.css\">','2','','CSS,general','dark','en'),('css_includes','<link rel=\"stylesheet\" type=\"text/css\" href=\"%%site_url%%/main.css\">\r\n%%BOX,meta_information%%','2','','CSS,general','default','en'),('css_includes','<link rel=\"stylesheet\" type=\"text/css\" href=\"%%site_url%%/mobile.css\">\r\n%%BOX,meta_information%%','2','','CSS,general','mobile','en'),('css_includes','<link rel=\"stylesheet\" type=\"text/css\" href=\"%%site_url%%/main.css\">\r\n<link rel=\"stylesheet\" href=\"%%BOX,file_location%%style.css\" type=\"text/css\">\r\n%%BOX,user_script%%','2','','CSS,general','user_supplied','en'),('dark_css','/******************/\r\n\r\nBODY \r\n{\r\n	background-color: #000;\r\n	color: #bbc;\r\n	font-family: verdana, arial, helvetica, sans-serif;\r\n}\r\n\r\n/******************\r\n   LINK STYLES\r\n******************/\r\n\r\nA { \r\n	color: #33f;\r\n}\r\n\r\nA:hover { \r\n	color: #99f; \r\n}\r\n\r\nA.adverttitle {\r\n	color: #33f;\r\n	background-color: #069;\r\n}\r\n\r\nA.adverttitle:link, A.adverttitle:visited { \r\n	color: #eae;\r\n	background-color: transparent;\r\n}\r\n\r\nA.light {\r\n	color: #99f; \r\n	background-color: transparent;\r\n}\r\n\r\n.spoiler {\r\n        color: white;\r\n        background-color: white;\r\n}\r\n\r\n.spoiler:hover {\r\n	background-color: #000;\r\n	color: #bbc;\r\n}\r\n\r\n/******************\r\n   SCOOP STYLES\r\n******************/\r\n\r\n\r\n\r\nTD\r\n{\r\n	background-color: #000;\r\n	color: #bbc;\r\n}\r\n\r\n.sectiontitle\r\n{\r\n	background-color: #069;\r\n	color: inherit;\r\n}\r\n\r\n.boxtitle\r\n{\r\n	background-color: #069;\r\n	color: #000;\r\n	border-color: #069;\r\n}\r\n\r\n.storytitle\r\n{\r\n	background-color: #069;\r\n}\r\n\r\n.storynavbar\r\n{\r\n	background-color: #069;\r\n}\r\n\r\n.storyinfo\r\n{\r\n	background-color: #069;\r\n}\r\n\r\n.commentheader\r\n{\r\n	border-color: #333; \r\n	background-color: #069;\r\n}\r\n\r\n.commentheaderedit\r\n{\r\n	border-color: #333; \r\n	background-color: #069;\r\n}\r\n\r\n.site_logo\r\n{\r\n        font-size: xx-large;\r\n        font-weight: bolder;\r\n        vertical-align: middle;\r\n}','2','<P>This block contains the CSS stylesheet for the site. It should be what you\'d expect to find in a .css file on the filesystem, except it recognizes the standard keys for interpolation. There are no special keys. This is sent to the client via the URL |rootdir|/css/main - any other stylesheets you create must also have _css at the end of their name if you want them accessible via the css op.</p>','CSS','default','en'),('default_template','%%doctype%%\r\n<html>\r\n<head>\r\n%%stylesheet%%\r\n<title>%%sitename%% || %%subtitle%%</title>\r\n%%site_logo%%\r\n</head>\r\n<body>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout -->\r\n\r\n<div class=\"container\">\r\n\r\n<div class=\"main\">\r\n%%STORY%%\r\n%%CONTENT%%\r\n</div>\r\n<div class=\"menu\">\r\n%%BOX,user_box%%\r\n%%BOX,hotlist_flex_box%%\r\n%%BOX,admin_tools%%\r\n%%BOX,comment_controls%%\r\n</div><!--menu-->\r\n</div><!--container-->\r\n<!-- X Main layout -->\r\n<p></p>\r\n%%footer%%\r\n</body>\r\n</html>','1','<P>This block is used to build most pages on the site.  It must be a full HTML page; dynamic content is added through the use of special keys.  The special keys recognised are:</P>\r\n<DL>\r\n <DT>subtitle</DT>\r\n  <DD>This is replaced with an appropriate subtitle indicating which page is currently being viewed.</DD>\r\n <DT>dynamicmode_javascript</DT>\r\n  <DD>This is replaced with javascript for the dynamic comment display if the page template is being used for comment display.</DD>\r\n <DT>STORY</DT>\r\n  <DD>This is replaced with either the poll display or the story display, if either are being viewed.</DD>\r\n <DT>CONTENT</DT>\r\n  <DD>This is replaced with any other content specific to the page being requested.  It is provided by the function or box named in the Ops Admin Tool which handles the op (the first pseudo-directory) of the page.  This can be forms, comments, special pages, or custom content from your own boxes.</DD>\r\n</DL>','Page Templates','default','en'),('delimiter_default_end','</UL>','1','','Comments','default','en'),('delimiter_default_itemend','</LI>','1','','Comments','default','en'),('delimiter_default_itemstart','<LI>','1','','Comments','default','en'),('delimiter_default_levelend','</UL>','1','','Comments','default','en'),('delimiter_default_levelstart','<UL>','1','','Comments','default','en'),('delimiter_default_start','<UL>','1','','Comments','default','en'),('delimiter_dyn_end','</DIV>','1','','Comments','default','en'),('delimiter_dyn_itemend','</DIV></TD></TR></TABLE>','1','','Comments','default','en'),('delimiter_dyn_itemstart','<TABLE><TR>\r\n<TD VALIGN=\"top\">%%norm_font%%<TT><A ID=\"toggle!cid!\" STYLE=\"text-decoration:none\" HREF=\"javascript:void(toggle(!cid!))\">%%text%%</A></TT>&nbsp;%%norm_font_end%%</TD>\r\n<TD><DIV CLASS=\"%%class%%\" ID=\"content!cid!\">','1','','Comments','default','en'),('delimiter_dyn_start','<DIV STYLE=\"margin-left: 2.5em\">','1','','Comments','default','en'),('delimiter_nested_end','</DL>','1','','Comments','default','en'),('delimiter_nested_levelend','</DD>','1','','Comments','default','en'),('delimiter_nested_levelstart','<DT></DT><DD>','1','','Comments','default','en'),('delimiter_nested_start','<DL>','1','','Comments','default','en'),('dept_font','<FONT FACE=\"arial, helvetica, sans-serif\" SIZE=2>','1','<P>This block is used to format the \"from the x department\" string attached to stories, if the variable <B>show_dept</B> is turned on.  It should be a complete opening font or text style indicator, such as a font or b tag. It must be properly closed by the contents of the block <B>dept_font_end</B>.  There are no special keys.</P>','Fonts','default','en'),('diary_guidelines','Thank you for taking the time to submit a diary!<P>\r\nHere are some general guidelines for diaries, more detailed guidelines are available <a href=\"%%rootdir%%/special/Diary_guide\">here</a>:\r\n<p>Do <b>NOT</b> put all your text in the &quot;Intro Copy&quot; text box. The intro text is a short introduction, that shows up on the diary page. Put the main body of the diary in the &quot;Extended Copy&quot; box.\r\n<p>\r\nYou should consider anything you post here could be around FOREVER. That\'s a mighty long time, as they say. So if you\'re going to post about that time you did <em>&lt;Insert embarrassing act here&gt;</em> you might want to consider what would happen if your boss/wife/husband/lover read it.\r\n<p>\r\nDo not post more than one diary per day, unless you know what you are doing.','2','','display,general','default','en'),('diary_post_message','<br><div class=\"submission_message\">Your new entry has been posted. Enjoy!</div>','1','<P>This block is displayed just underneath a user\'s diary when they have just posted it.  It should contain a message informing the user that their diary was successfully saved, and is otherwise free-form, self-contained HTML. There are no special keys.</P>','Diaries','default','en'),('digest_headerfooter','---------------------------------------------------------\nThis is the %%FREQUENCY%% digest for SITENAME.\nIf you have received this email in error, just reply to \nthis message and say that you got it in error.\nPlease mention that this email was sent for user number %%USERID%%.\n---------------------------------------------------------\n','1','<P>This block is displayed at the top and bottom of the story digest email sent to users who request it.  It should name the site and introduce the digest in a way suited for any frequency.  This should be plain text, with no HTML formatting.  If either of the blocks <B>digest_header</B> or <B>digest_footer</B> exist, they override this block for the email header and footer, respectively.  Because this is an email and is not sent through the usual processing given an HTML page, the only keys that work at all are the special keys defined for this block. The following special keys are recognised:</P>\n<DL>\n <DT>FREQUENCY</DT>\n  <DD>This key is replaced with the digest frequency requested by the user receiving the email, which may be daily, weekly, or monthly.</DD>\n <DT>USERID</DT>\n  <DD>The numeric user ID of the recipient of the digest</DD>\n <DT>NICKNAME</DT>\n  <DD>The nickname of the recipient of the digest</DD>\n</DL>','Story Digests','default','en'),('digest_storyformat','\n%%title%% \n  By %%aid%%, %%time%% \n  Section: %%section%%, Topic: %%tid%% \n\n%%introtext%% \n\n%%url%%\n\n----\n','1','<P>This block is used to format each story summary in the story digest email sent to users who request it. This should be plain text, with no HTML formatting. Because this is an email and is not sent through the usual processing given an HTML page, the only keys that work at all are the special keys defined for this block. The following special keys are recognised:</P>\n<DL>\n <DT>sid</DT>\n  <DD>The story ID for the story being formatted. This is used in <TT>url</TT> (below) to create the full URL of the story and probably isn\'t needed on its own.</DD>\n <DT>tid</DT>\n  <DD>The \"alt text\" of the topic attached to the story.</DD>\n <DT>aid</DT>\n  <DD>The author\'s nickname.</DD>\n <DT>nick</DT>\n  <DD>The author\'s nickname.</DD>\n <DT>time</DT>\n  <DD>The time and date the story was posted on.</DD>\n <DT>title</DT>\n  <DD>The title of the story</DD>\n <DT>dept</DT>\n  <DD>The \"department\" of the story, if that feature is turned on in Site Controls (<B>show_dept</B>).</DD>\n <DT>introtext</DT>\n  <DD>The story summary; that part of the story that is displayed on the index page of the scoop site. HTML line breaks are converted to newlines, links have their URL displayed beside the link text, and all other HTML tags are stripped. The intro text is then wrapped to 75 columns.</DD>\n <DT>section</DT>\n  <DD>The title of the section the story is filed in.</DD>\n <DT>url</DT>\n  <DD>The full URL of the story, built from the site\'s base URL and the story\'s sid.</DD>\n</DL>\n','Story Digests','default','en'),('digest_subject','Hulver\'s site Story digest',NULL,'<P>This block is used as the subject line of the story digest email sent to users who request it. This should be plain text, with no HTML formatting. Because this is an email and is not sent through the usual processing given an HTML page, none of the usual keys will work. This block has no special keys.</P>','Story Digests','default','en'),('doctype','<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">','2','','general','default','en'),('donate_ad_template','<table border=\"0\" width=\"100%\">\r\n<tr><td class=\"boxtitle\">%%BOX,hidebox_box,ad_box%% Donate</td></tr>\r\n<tr><td class=\"paidtextadtitle\">%%TITLE%%</td></tr>\r\n<tr><td class=\"paidtextadbody\">%%TEXT1%%</TD></tr>\r\n<tr><td class=\"paidtextadbody\">%%smallfont%%%%COMMENTS%%%%smallfont_end%%</td></tr>\r\n</table><p>','2','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</P>\r\n<DL>\r\n <DT>FILE_PATH</DT>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</DD>\r\n <DT>TEXT1</DT>\r\n  <DD>The text the ad sponsor entered in the text1 field.</DD>\r\n <DT>TEXT2</DT>\r\n  <DD>The text the ad sponsor entered in the text2 field.</DD>\r\n <DT>TITLE</DT>\r\n  <DD>The text the ad sponsor entered in the title field.</DD>\r\n <DT>LINK_URL</DT>\r\n  <DD>The URL of the page being advertised.</DD>\r\n <DT>SID</DT>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</DD>\r\n <DT>REDIRECT_URL</DT>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</DD>\r\n</DL><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</P>','Ads','default','en'),('donate_email_pledge','Thank you for your donation. Please remember to send $%%AMOUNT%% to our mailing address.',NULL,'<P>This block is an email sent to a user who has pledged to send a donation. It should be plain text and contain the amount the user has pledged and a reminder to send the amount. Putting the mailing address in this block is probably a good idea too. Because this is an email and is not sent through the usual processing given an HTML page, no keys except the following special keys will work.</P>\n<DL>\n <DT>AMOUNT</DT>\n  <DD>The amount pledged.</DD>\n</DL>','Emails','default','en'),('donate_email_success','Thank you for your donation of $%%AMOUNT%%.',NULL,'<P>This block is an email sent to a user who has made a donation. It should be plain text and indicate that the donation has been received. Because this is an email and is not sent through the usual processing given an HTML page, no keys except the following special keys will work.</P>\n<DL>\n <DT>AMOUNT</DT>\n  <DD>The amount donated.</DD>\n</DL>','Emails','default','en'),('donate_text','<b><a href=\"http://www.hulver.com/scoop/story/2004/9/3/2135/96137\">You\'ve done it!</a></b><p>\r\nThanks to everybody who donated. We had 44 donations, making a total of ','2','','Donation','default','en'),('dot','-','1','<P>This block is used whenever a dot or list item indicator of some sort is needed. It is called directly by other blocks, never assembled as part of a special key, and recognizes no special keys itself.</P>','General','default','en'),('dynamic_collapse_bottom_link','<img src=\"%%imagedir%%/dyn_colb.gif\" width=\"12\" height=\"12\" ALT=\"-\" border=\"0\">','1','<P>This block should contain either the text or an image used as the link to collapse a comment when expanded comments are viewed in either of the dynamic modes. If it is an image, it should have an alt element to stand in if the image is missing. It is placed with the actions at the bottom of the comment; the block <B>dynamic_collapse_link</B> is the one placed at the top. This block has no special keys.</P>','Comments','default','en'),('dynamic_collapse_link','<img src=\"%%imagedir%%/dyn_col.gif\" width=\"12\" height=\"16\" ALT=\"-\" border=\"0\">','1','<P>This block should contain either the text or an image used as the link to collapse a comment when expanded comments are viewed in either of the dynamic modes. If it is an image, it should have an alt element to stand in if the image is missing. It is placed near the subject at the top of the comment; the block <B>dynamic_collapse_bottom_link</B> is the one used at the bottom. This block has no special keys.</P>','Comments','default','en'),('dynamic_collapse_thread_link','<img src=\"/images/dyn_cola.gif\" alt=\"--\" title=\"Collapse Subthread\" width=\"12\" height=\"12\" border=\"0\">',NULL,'<P>This block should contain either the text or an image used as the link to collapse an entire subthread of comments when expanded comments are viewed in either of the dynamic modes. If it is an image, it should have an alt element to stand in if the image is missing. It is placed with the actions at the bottom of the comment. This block has no special keys.</P>','Comments','default','en'),('dynamic_expand_link','<img src=\"%%imagedir%%/dyn_exp.gif\" width=\"12\" height=\"16\" alt=\"+\" border=\"0\">','1','<P>This block should contain either the text or an image used as the link to expand a single comment when viewing comments in either of the dynamic modes. If it is an image, it should have an alt element to stand in if the image is missing. It is placed near the subject at the top of the comment. This block has no special keys.</P>','Comments','default','en'),('dynamic_expand_thread_link','<img src=\"/images/dyn_expa.gif\" alt=\"++\" title=\"Expand Subthread\" width=\"12\" height=\"12\" border=\"0\">',NULL,'<P>This block should contain either the text or an image used as the link to expand an entire subthread of comments when comments are viewed in either of the dynamic modes. If it is an image, it should have an alt element to stand in if the image is missing. It is placed with the actions at the bottom of the comment. This block has no special keys.</P>','Comments','default','en'),('dynamic_js_tag','<script type=\"text/javascript\" src=\"/images/dynamic-comments.js\"></script>',NULL,'<P>This block is what allows dynamic comments to work. On pages where comments are viewed and dynamic comment mode is active, the key <TT>|dynamicmode_javascript|</TT> is replaced with the contents of this block. (That key is best placed in the <B>header</B> block, so it is always available.) This block should only be modified to reflect the location of the dynamic-comments.js file, which it loads. This block has no special keys.','Comments','default','en'),('dynamic_loading_link','<img src=\"%%imagedir%%/dyn_wait.gif\" width=\"12\" height=\"16\" alt=\"x\" border=\"0\">','1','<P>This block contains the image tag that will replace the expand/collapse link when a comment is in the process of being loaded/unloaded. This shouldn\'t actually be a link, just a marker of the same size and format as <B>dynamic_expand_link</B> and <B>dynamic_collapse_link</B>. This block has no special keys.</P>','Comments','default','en'),('dynamic_loading_message','%%norm_font%%<i>Loading...</i>%%norm_font_end%%',NULL,'<P>This block contains the message that will replace the comment title or comment when that comment is in the process of being loaded or unloaded. This should be small and indicate that Scoop is working on it and the comment or comment title will appear shortly.</P>','Comments','default','en'),('dynamic_template','%%doctype%%\r\n<html>\r\n<head>\r\n<title>%%sitename%% || %%subtitle%%</title>\r\n%%dynamicmode_javascript%%\r\n</head>\r\n<body onload=\"copyContent(%%mainpid%%,%%dynamicmode%%)\">\r\n%%CONTENT%%\r\n</body>\r\n</html>\r\n','1','<P>This block is a nearly empty page template used for loading individual comments in dynamic mode. It must contain the correct <B>BODY onload</B> event. You probably shouldn\'t change this, since it will never be seen directly anyway. There are two special keys: mainpid and dynamicmode; both are set by the code to indicate whether or not dynamic comments are in use.</P>','Comments,Page Templates','default','en'),('editqueuespam_bg','#f9e5de','1','<P>This block is used as a background colour in the story list for stories in the edit queue that the user has voted \"Spam\" on, to make it easy to remember which ones they can safely ignore while they remain in the edit queue. It should contain a hex colour value or a recognized colour name. It only applies if both the edit queue and the edit queue anti-spam button are turned on. This block has no special keys.</P>','Colours','default','en'),('editqueuestory_bg','silver','1','<P>This block is used as a background colour in the story list for stories in the edit queue, to distinguish them from stories that may be voted on.  It should contain a hex colour value or a recognized colour name.It only applies if the edit queue is turned on. This block has no special keys.</P>','Colours','default','en'),('edit_block','<form name=\"editblocks\" action=\"%%rootdir%%/admin/blocks/\" method=\"post\">\r\n<input type=\"hidden\" name=\"cat\" value=\"%%category%%\" />\r\n\r\n<table border=\"0\" cellpadding=\"2\" cellspacing=\"0\" width=\"100%\">\r\n<tr><td bgcolor=\"%%title_bgcolor%%\">%%title_font%%Blocks: %%category%%%%title_font_end%%</td></tr>\r\n<tr><td>%%norm_font%%%%update_msg%%%%norm_font_end%%</td></tr>\r\n<tr><td>%%norm_font%%%%theme_sel%%%%norm_font_end%%</td></tr>\r\n<tr><td>%%norm_font%%Choose a category to edit:%%norm_font_end%%</td></tr>\r\n<tr><td>\r\n	<table border=\"0\" cellpadding=\"0\" cellspacing=\"2\" width=\"100%\">%%catlist%%</table>\r\n</td></tr>\r\n<tr><td>%%norm_font%%<input type=\"submit\" name=\"save\" value=\"Save\"> <input type=\"submit\" name=\"edit\" value=\"Get\" />%%norm_font_end%%</td></tr>\r\n<tr><td>%%norm_font%%%%html_check%%%%norm_font_end%%</td></tr>\r\n<tr><td>\r\n	<table border=0 cellpadding=1 cellspacing=0 width=\"100%\">%%form_body%%</table>\r\n</td></tr>\r\n<tr><td>%%norm_font%%<input type=\"submit\" name=\"save\" value=\"Save\"> <input type=\"submit\" name=\"edit\" value=\"Get\" />%%norm_font_end%%</td></tr>\r\n</table>\r\n</form>\r\n',NULL,'<P>This block is used to build the block editing form. It should contain the admin page structure, set up the form, and contain all of the special keys listed below to ensure that block editing is not broken. This block recognizes the following special keys:</P>\r\n<DL>\r\n <DT>catlist</DT>\r\n  <DD>The list of all block categories in the current theme, linkified to bring you to the form with all blocks in that category within the current theme. The list itself is built using the block <B>block_category_list</B> as many times as necessary to display all of the categories.</DD>\r\n <DT>category</DT>\r\n  <DD>Either the block name or the category name (depending on whether you\'re in single block or category edit mode) and the name of the theme you\'re currently working in, just so it\'s easier to remember where you are.</DD>\r\n <DT>update_msg</DT>\r\n  <DD>Any save, status, or error messages generated due to one of your actions in this admin tool.</DD>\r\n <DT>theme_sel</DT>\r\n  <DD>The list of themes across the top of the page that allows you to switch between which theme you\'re working in. The current theme is not linkified, all others are.</DD>\r\n <DT>html_check</DT>\r\n  <DD>The checkbox that determines if Scoop should check the HTML of the block when saving. Valid HTML is determined by the block <B>all_html</B>.</DD>\r\n <DT>form_body</DT>\r\n  <DD>The body of the block editing form. This will either be the single block form from <B>edit_one_block</B> or the category edit form from <B>edit_cat_blocks</B>, depending on whether you are editing one block or an entire category.</DD>\r\n</DL>\r\n<P>Be very careful when changing this block, as it is used to build the interface required to change it back if it is broken. Changing the form elements is strongly not recommended.</P>','Admin Pages','default','en'),('edit_calendar_links','<DIV class=\"caledit_menu\">\r\n<A href=\"%%rootdir%%/editcalendar/settings/%%cal_id%%\">Edit Calendar Settings</A>\r\n<A href=\"%%rootdir%%/editcalendar/moderate/%%cal_id%%\">Approve Submitted Events</A>\r\n<A href=\"%%rootdir%%/editcalendar/listevents/%%cal_id%%\">Event List</A>\r\n<A href=\"%%rootdir%%/editcalendar/invite/%%cal_id%%\">Invitation List</A>\r\n</DIV>','1','<P>This is the menu at the top of the calendar edit page which links to the other pages available through the calendar edit form. The only special key recognized is cal_id, the ID number of the calendar being edited.</p>','Calendars and Events','default','en'),('edit_cat_blocks','<!-- category line begin -->\r\n<tr>\r\n	<td>\r\n		%%norm_font%%%%name%%<br>\r\n		%%description%%%%norm_font_end%%\r\n	</td>\r\n	<td>%%norm_font%%%%value%%%%norm_font_end%%</td>\r\n</tr>\r\n<!--category line end -->\r\n',NULL,'<P>This block is used to build the block editing form when in category view. It should contain one line of the category view (that is, the code for one block only). This block recognizes the following special keys:</P>\r\n<DL>\r\n <DT>name</DT>\r\n  <DD>The name of the block, formatted as a link to the single block edit form for that block.</DD>\r\n <DT>value</DT>\r\n  <DD>A textarea field containing the value of the block.</DD>\r\n <DT>description</DT>\r\n  <DD>The block description.</DD>\r\n</DL>','Admin Pages','default','en'),('edit_cat_vars','<tr>\r\n	<td>%%norm_font%%%%name%%%%norm_font_end%%</td>\r\n	<td>%%norm_font%%%%value%%%%norm_font_end%%</td>\r\n	<td>%%norm_font%%%%description%%%%norm_font_end%%</td>\r\n</tr>\r\n',NULL,'<P>This block is used to build the Site Control editing form when in category view. It should contain one line of the category view (that is, the code for one variable only). This block recognizes the following special keys:</P>\n<DL>\n <DT>name</DT>\n  <DD>The name of the variable, formatted as a link to the single variable edit form for that variable.</DD>\n <DT>value</DT>\n  <DD>A field containing the value of the variable. Depending on the variable type, this may be a checkbox (boolean), a short text field (number), a longer text field (text), or a textarea field (textarea).</DD>\n <DT>description</DT>\n  <DD>The variable description.</DD>\n</DL>','Admin Pages','default','en'),('edit_instructions','<!-- vote_console -->\r\n<p>\r\n<div class=\"story_edit_instructions\">\r\n<b>Please Help.</b> The author of this story has requested editorial help from you, and the rest of the community. Please read, and post your editorial suggestions below. The author can edit at any time, so some suggestions may already have been fixed when you read them. After editing, the story will continue on to voting as usual.\r\n%%spam_form%%\r\n</div>\r\n<!-- X vote_console -->','1','<P>This block is displayed underneath the text of a story in the edit queue, informing readers of its status. This should be a reasonably self-contained bit of HTML and text which explains the process of story editing from the point of view of a reader who is not the author. This block recognizes the following special key:</P>\n<DL>\n <DT>spam_form</DT>\n  <DD>This is replaced with the contents of <B>edit_instructions_abuse</B> if the edit queue anti-spam feature is turned on.</DD>\n</DL>','Stories','default','en'),('edit_instructions_abuse','<P>If this article is abusing the edit queue please indicate this by pressing the button below.</P>\r\n<FORM NAME=\"storymoderate\" ACTION=\"%%rootdir%%/\" METHOD=\"POST\">\r\n<P align=\"center\">\r\n	<INPUT type=\"hidden\" NAME=\"op\" VALUE=\"displaystory\">\r\n	<INPUT type=\"hidden\" NAME=\"sid\" VALUE=\"%%sid%%\">\r\n	<INPUT type=\"hidden\" NAME=\"mode\" VALUE=\"spam\">\r\n	%%formkey%%\r\n	<INPUT type=\"hidden\" NAME=\"vote\" VALUE=\"-1\">\r\n	<INPUT type=\"submit\" name=\"save\" value=\"Spam\">\r\n</P>\r\n</FORM>',NULL,'<P>This block is displayed underneath the text of a story in the edit queue, if the edit queue anti-spam feature is activated. This should be a reasonably self-contained bit of HTML which explains what the spam button is to be used for and sets up the form for the spam button. All of the hidden form elements are required. This block recognizes the following special keys:</P>\n<DL>\n <DT>sid</DT>\n  <DD>The story ID of the current story.</DD>\n <DT>formkey</DT>\n  <DD>A formkey element used to help prevent duplicate votes, scripted votes, and other form spoofing strategies.</DD>\n</DL>','Stories','default','en'),('edit_macro','<form name=\"editmacros\" action=\"%%rootdir%%/admin/macros/\" method=\"post\">\r\n<input type=\"hidden\" name=\"cat\" value=\"%%category%%\">\r\n\r\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n<tr><td bgcolor=\"%%title_bgcolor%%\">%%title_font%%Macros: %%category%%%%title_font_end%%</td></tr>\r\n<tr><td>%%norm_font%%%%update_msg%%%%norm_font_end%%</td></tr>\r\n<tr><td> </td></tr>\r\n<tr><td>%%norm_font%%Choose a category to edit:%%norm_font_end%%</td></tr>\r\n<tr><td>\r\n	<table border=\"0\" cellpadding=\"0\" cellspacing=\"2\" width=\"100%\">%%catlist%%</table>\r\n</td></tr>\r\n<tr><td>%%norm_font%%<input type=\"submit\" name=\"save\" value=\"Save\"> <input type=\"submit\" name=\"edit\" value=\"Get\">%%norm_font_end%%</td></tr>\r\n<tr><td><table border=\"0\" cellpadding=\"2\" cellspacing=\"0\" width=\"100%\">%%form_body%%</table></td></tr>\r\n<tr><td>%%norm_font%%<input type=\"submit\" name=\"save\" value=\"Save\"> <input type=\"submit\" name=\"edit\" value=\"Get\">%%norm_font_end%%</td></tr>\r\n</table>\r\n</form>\r\n',NULL,'The main edit macro page.  The special var \"form_body\" is either the single-var edit form, or the category table, depending on which view you\'re using.','Admin Pages','default','en'),('edit_one_block','<tr><td>%%norm_font%%Or edit a block directly:%%norm_font_end%%</td></tr>\r\n<tr><td><table cellspacing=\"2\" cellpadding=\"0\" width=\"100%\">\r\n<tr>\r\n	<td colspan=\"2\">%%norm_font%%<b>Delete:</b><input type=\"checkbox\" name=\"delete\" value=\"1\">%%norm_font_end%%</td>\r\n</tr>\r\n<tr>\r\n	<td>%%norm_font%%<b>Select Block:</b>%%norm_font_end%%</td>\r\n	<td>%%blockselect%%</td>\r\n</tr>\r\n<tr>\r\n	<td>%%norm_font%%<b>Select Categories:</b>%%norm_font_end%%</td>\r\n	<td>%%catselect%%</td>\r\n</tr>\r\n<tr>\r\n	<td>%%norm_font%%<b>Name:</b>%%norm_font_end%%</td>\r\n	<td><input type=\"text\" size=\"60\" name=\"name\" value=\"%%bid%%\"></td>\r\n</tr>\r\n<tr>\r\n	<td>%%norm_font%%<b>Theme:</b>%%norm_font_end%%</td>\r\n	<td><input type=\"text\" size=\"60\" name=\"block_theme\" value=\"%%theme%%\"><input type=\"hidden\" name=\"theme\" value=\"%%curr_theme%%\"></td>\r\n</tr>\r\n<tr>\r\n	<td>%%norm_font%%<b>New Category:</b>%%norm_font_end%%</td>\r\n	<td><input type=\"text\" size=\"60\" name=\"category\" value=\"\"><br>\r\n	%%norm_font%%<i>(separate multiple categories with commas)</i>%%norm_font_end%%\r\n	</td>\r\n</tr>\r\n<tr>\r\n	<td colspan=\"2\">\r\n	%%norm_font%%<b>Value:</b>%%norm_font_end%%<br>\r\n	<textarea cols=\"60\" rows=\"20\" name=\"value\" wrap=\"soft\">%%value%%</textarea>\r\n	</td>\r\n</tr>\r\n<tr>\r\n	<td colspan=\"2\">%%norm_font%%%%description%%%%norm_font_end%%</td>\r\n</tr>\r\n<tr>\r\n	<td colspan=\"2\">\r\n	%%norm_font%%<b>Description:</b>%%norm_font_end%%<br>\r\n	<textarea cols=\"60\" rows=\"5\" name=\"description\"\r\n	wrap=\"soft\">%%description%%</textarea>\r\n	</td>\r\n</tr>\r\n</table></td></tr>\r\n',NULL,'<P>This block is used to build the single block edit form for the Blocks Admin Tool. It contains the form elements and special keys required for block editing to work. This block recognizes the following special keys:</P>\r\n<DL>\r\n <DT>blockselect</DT>\r\n  <DD>The select form element listing all the blocks available to edit.</DD>\r\n <DT>catselect</DT>\r\n  <DD>The select form element listing all the categories available to file a block in.</DD>\r\n <DT>bid</DT>\r\n  <DD>The name of the block (block ID).</DD>\r\n <DT>value</DT>\r\n  <DD>The value of the block.</DD>\r\n <DT>theme</DT>\r\n  <DD>The name of the theme the block should be saved in.</DD>\r\n <DT>curr_theme</DT>\r\n  <DD>The name of the theme you are currently working in. If a new block is created and the theme (above) is left empty, this value is used in its place, so blocks are created where you\'d expect them.</DD>\r\n <DT>description</DT>\r\n  <DD>The description of the block.</DD>\r\n</DL>','Admin Pages','default','en'),('edit_one_macro','<tr><td>%%norm_font%%Or edit a macro directly:%%norm_font_end%%</td></tr>\r\n<tr><td><table cellspacing=\"2\" cellpadding=\"0\" width=\"100%\">\r\n	<tr>\r\n		<td colspan=\"2\">%%norm_font%%<b>Delete:</b><input type=\"checkbox\" name=\"delete\" value=\"1\">%%norm_font_end%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Select Macro:</b>%%norm_font_end%%</td>\r\n		<td>%%macroselect%%</td>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Select Categories:</b>%%norm_font_end%%</td>\r\n		<td>%%catselect%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Name:</b>%%norm_font_end%%</td>\r\n		<td><input type=\"text\" size=\"60\" name=\"name\" value=\"%%name%%\"></td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>New Category:</b>%%norm_font_end%%</td>\r\n		<td><input type=\"text\" size=\"60\" name=\"category\" value=\"\"><br>\r\n			%%norm_font%%<i>(separate multiple categories with commas)</i>%%norm_font_end%%\r\n		</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Parameters:</b>%%norm_font_end%%</td>\r\n		<td><input type=\"text\" size=\"60\" name=\"parameter\" value=\"%%parameter%%\"></td>\r\n	</tr>\r\n	<tr>\r\n		<td colspan=\"2\">\r\n			%%norm_font%%<b>Value:</b>%%norm_font_end%%<br>\r\n			<textarea cols=\"60\" rows=\"6\" name=\"value\" wrap=\"soft\">%%value%%</textarea>\r\n		</td>\r\n	</tr>\r\n	<tr>\r\n		<td colspan=\"2\">\r\n			%%norm_font%%<b>Description:</b>%%norm_font_end%%<br>\r\n			<textarea cols=\"60\" rows=\"3\" name=\"description\" wrap=\"soft\">%%description%%</textarea>\r\n		</td>\r\n	</tr>\r\n</table></td></tr>\r\n',NULL,'','Admin Pages','default','en'),('edit_one_var','<tr><td>%%norm_font%%Or edit a variable directly:%%norm_font_end%%</td></tr>\r\n<tr><td><table cellspacing=\"2\" cellpadding=\"0\" width=\"100%\">\r\n	<tr>\r\n		<td colspan=\"2\">%%norm_font%%<b>Delete:</b><input type=\"checkbox\" name=\"delete\" value=\"1\">%%norm_font_end%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Type:</b>%%norm_font_end%%</td>\r\n		<td>%%typeselect%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Select Variable:</b>%%norm_font_end%%</td>\r\n		<td>%%varselect%%</td>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Select Categories:</b>%%norm_font_end%%</td>\r\n		<td>%%catselect%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Name:</b>%%norm_font_end%%</td>\r\n		<td><input type=\"text\" size=\"60\" name=\"name\" value=\"%%name%%\"></td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>New Category:</b>%%norm_font_end%%</td>\r\n		<td><input type=\"text\" size=\"60\" name=\"category\" value=\"\"><br>\r\n			%%norm_font%%<i>(separate multiple categories with commas)</i>%%norm_font_end%%\r\n		</td>\r\n	</tr>\r\n	<tr>\r\n		<td colspan=\"2\">\r\n			%%norm_font%%<b>Value:</b>%%norm_font_end%%<br>\r\n			<textarea cols=\"60\" rows=\"20\" name=\"value\" wrap=\"soft\">%%value%%</textarea>\r\n		</td>\r\n	</tr>\r\n	<tr>\r\n		<td colspan=\"2\">%%norm_font%%%%description%%%%norm_font_end%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td colspan=\"2\">\r\n			%%norm_font%%<b>Description:</b>%%norm_font_end%%<br>\r\n			<textarea cols=\"60\" rows=\"3\" name=\"description\" wrap=\"soft\">%%description%%</textarea>\r\n		</td>\r\n	</tr>\r\n</table></td></tr>\r\n',NULL,'<P>This block is used to build the single variable edit form for the Site Controls Admin Tool. It contains the form elements and special keys required for variable editing to work. This block recognizes the following special keys:</P>\r\n<DL>\r\n <DT>varselect</DT>\r\n  <DD>The select form element listing all the variables available to edit.</DD>\r\n <DT>catselect</DT>\r\n  <DD>The select form element listing all the categories available to file a variable in.</DD>\r\n <DT>name</DT>\r\n  <DD>The name of the variable.</DD>\r\n <DT>value</DT>\r\n  <DD>The value of the variable.</DD>\r\n <DT>typeselect</DT>\r\n  <DD>The select form element listing the possible variable types.</DD>\r\n <DT>description</DT>\r\n  <DD>The description of the variable.</DD>\r\n</DL>','Admin Pages','default','en'),('edit_ops','<form action=\"%%rootdir%%/admin/ops\" method=\"POST\">\r\n<table width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"0\">\r\n	<tr bgcolor=\"%%title_bgcolor%%\">\r\n		<td colspan=\"2\">%%title_font%%Edit Ops%%title_font_end%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td colspan=\"2\">%%title_font%%<font color=\"#ff0000\">%%msg%%</font>%%title_font_end%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td align=\"right\">\r\n			<input type=\"submit\" name=\"get\" value=\"Get Op\">\r\n		</td>\r\n		<td>%%op_list%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Op:</b>%%norm_font_end%%</td>\r\n		<td><input type=\"text\" name=\"opcode\" value=\"%%opcode%%\"></td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Template:</b>%%norm_font_end%%</td>\r\n		<td>%%tmpl_list%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Function:</b>%%norm_font_end%%</td>\r\n		<td><input type=\"text\" name=\"func\" value=\"%%func%%\">%%edit_box%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td>&nbsp;</td>\r\n		<td>%%norm_font%%\r\n			<input type=\"checkbox\" name=\"is_box\" value=\"1\" %%is_box_checked%%> Function is a box%%norm_font_end%%\r\n		</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Permission:</b>%%norm_font_end%%</td>\r\n		<td>%%perm_list%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>Enabled:</b>%%norm_font_end%%</td>\r\n		<td><input type=\"checkbox\" name=\"enabled\" value=\"1\" %%enabled_checked%%></td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%<b>OP Aliases:</b>%%norm_font_end%%</td>\r\n		<td><input type=\"text\" name=\"aliases\" value=\"%%aliases%%\" size=\"40\"></td>\r\n	</tr>\r\n	<tr>\r\n		<td valign=\"top\">%%norm_font%%<b>URL Templates:</b>%%norm_font_end%%</td>\r\n		<td><textarea cols=\"40\" rows=\"10\" name=\"urltemplates\" wrap=\"no\">%%urltemplates%%</textarea></td>\r\n	</tr>\r\n	<tr>\r\n		<td valign=\"top\">%%norm_font%%<b>Description:</b>%%norm_font_end%%</td>\r\n		<td><textarea cols=\"40\" rows=\"3\" name=\"desc\" wrap=\"soft\">%%desc%%</textarea></td>\r\n	</tr>\r\n	%%delete_check%%\r\n	<tr>\r\n		<td>&nbsp;</td>\r\n		<td>\r\n			<input type=\"submit\" name=\"save\" value=\"Write Op\"> \r\n			<input type=\"reset\" value=\"Reset\">\r\n		</td>\r\n	</tr>\r\n</table>\r\n</form>','1','<P>This block is used to build the ops editing form. It should contain the admin page structure, set up the form, and contain all of the special keys listed below to ensure that op editing is not broken. This block recognizes the following special keys:</p>\r\n<DL>\r\n <DT>msg</DT>\r\n  <DD>Status or error messages from the update just performed.</DD>\r\n <DT>op_list</DT>\r\n  <DD>The drop-down box containing all of the ops in the system.</DD>\r\n <DT>opcode</DT>\r\n  <DD>The name of the currently loaded op. Not a form field, just the value.</DD>\r\n <DT>tmpl_list</DT>\r\n  <DD>The drop-down box containing all of the page templates (blocks ending in _template)</DD>\r\n <DT>func</DT>\r\n  <DD>The name of the function or box run when the currently loaded op is requested. Not a form field, just the value.</DD>\r\n <DT>is_box_checked</DT>\r\n  <DD>The \"checked\" property of the checkbox that determines whether or not the function named above is a box or not. Not a form field, just the value.</DD>\r\n <DT>perm_list</DT>\r\n  <DD>The drop-down box containing all of the permissions in the system.</DD>\r\n <DT>aliases</DT>\r\n  <DD>The aliases of the currently loaded op. Not a form field, just the value.</DD>\r\n <DT>urltemplates</DT>\r\n  <DD>The URL templates of the currently loaded op. Not a form field, just the value.</DD>\r\n <DT>enabled_checked</DT>\r\n  <DD>The \"checked\" property of the checkbox that determines whether or not the currently loaded op is enabled. Not a form field, just the value.</DD>\r\n <DT>desc</DT>\r\n  <DD>The description of the currently loaded op. Not a form field, just the value.</DD>\r\n <DT>delete_check</DT>\r\n  <DD>If an op is loaded, this is replaced with a table row containing the delete checkbox and label. Otherwise, it\'s removed.</DD>\r\n <DT>edit_box</DT>\r\n  <DD>A link to the Boxes Admin Tool and the box associated with the currently loaded op, if the function named is marked as being a box and that box exists in the database.</DD>\r\n</DL>','Admin Pages','default','en'),('edit_prefs','%%title_font%%Edit User Preferences%%title_font_end%%\r\n\r\n<P>%%err_font%%%%update_msg%%%%err_font_end%%</P>\r\n\r\n<FORM action=\"%%rootdir%%/admin/prefs\" method=\"post\">\r\n<INPUT type=\"submit\" name=\"save\" value=\"Save\">\r\n<INPUT type=\"submit\" name=\"get\" value=\"Get\">\r\n\r\n<TABLE border=\"0\">\r\n  <TR>\r\n    <TD><B>Select Preference:</B></TD>\r\n    <TD>%%pref_selectbox%%</TD>\r\n  </TR>\r\n  <TR>\r\n    <TD colspan=\"2\"><B>Delete:</B> <INPUT type=\"checkbox\" name=\"delete\" value=\"1\"> Many prefs should be disabled (not deleted) if you want to prevent users from changing them, as Scoop requires their default values in order to run correctly.</TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Name:</B></TD>\r\n    <TD><INPUT type=\"text\" size=\"20\" maxlength=\"32\" name=\"prefname\" value=\"%%pref_name%%\"> <B>Enabled:</B><INPUT type=\"checkbox\" name=\"enabled\" value=\"1\"%%pref_enabled%%></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Title:</B></TD>\r\n    <TD><INPUT type=\"text\" size=\"50\" maxlength=\"50\" name=\"title\" value=\"%%pref_title%%\"></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Description:</B>\r\n      <BR>The description may contain any HTML or normal block reference.</TD>\r\n    <TD><TEXTAREA rows=\"%%rows%%\" cols=\"%%cols%%\" name=\"description\">%%pref_desc%%</TEXTAREA></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Default Value:</B></TD>\r\n    <TD><INPUT type=\"text\" size=\"30\" name=\"default_value\" value=\"%%pref_default%%\"></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD colspan=\"2\">&nbsp;</TD>\r\n  </TR>\r\n  <TR>\r\n    <TD colspan=\"2\"><B>Preference Display Settings</B></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Shown on signup page?</B></TD>\r\n    <TD><INPUT type=\"radio\" name=\"signup\" value=\"normal\"%%pref_signup_normal%%> No\r\n    <BR><INPUT type=\"radio\" name=\"signup\" value=\"signup\"%%pref_signup_signup%%> Yes\r\n    <BR><INPUT type=\"radio\" name=\"signup\" value=\"required\"%%pref_signup_required%%> Yes, and it\'s required</TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Preferences page:</B></TD>\r\n    <TD><INPUT type=\"text\" size=\"20\" maxlength=\"50\" name=\"page\" value=\"%%pref_page%%\"></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Order on page:</B></TD>\r\n    <TD><INPUT type=\"text\" size=\"5\" maxlength=\"5\" name=\"display_order\" value=\"%%pref_order%%\"></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Control to display:</B>\r\n      <BR>Special key <I>value</I> is the current value of the preference</TD>\r\n    <TD><INPUT type=\"text\" size=\"50\" name=\"field\" value=\"%%pref_field%%\"></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Template:</B></TD>\r\n    <TD>%%pref_template%%</TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Visible on public user info page?</B></TD>\r\n    <TD><INPUT type=\"checkbox\" name=\"visible\" value=\"1\"%%pref_visible%%></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Formatting to apply to value</B></TD>\r\n    <TD><INPUT type=\"text\" name=\"display_fmt\" value=\"%%pref_fmt%%\" size=\"50\"></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD colspan=\"2\">&nbsp;</TD>\r\n  </TR>\r\n  <TR>\r\n    <TD colspan=\"2\"><B>Requires</B></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Site Control:</B></TD>\r\n    <TD>%%pref_var%%</TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Perm to view:</B></TD>\r\n    <TD>%%pref_perm_view%%</TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Perm to edit:</B></TD>\r\n    <TD>%%pref_perm_edit%%</TD>\r\n  </TR>\r\n  <TR>\r\n  <TD><B>Trusted User status:</B></TD>\r\n    <TD><INPUT type=\"checkbox\" name=\"req_tu\" value=\"1\"%%pref_tu%%></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD colspan=\"2\">&nbsp;</TD>\r\n  </TR>\r\n  <TR>\r\n    <TD colspan=\"2\"><B>Validation</B> (blank to allow anything)</TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>HTML allowed?</B></TD>\r\n    <TD><INPUT type=\"checkbox\" name=\"html\" value=\"1\"%%pref_html%%></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Field length:</B></TD>\r\n    <TD><INPUT type=\"text\" size=\"5\" maxlength=\"5\" name=\"length\" value=\"%%pref_length%%\"></TD>\r\n  </TR>\r\n  <TR>\r\n    <TD><B>Box or regular expression:</B>\r\n      <BR>either a perl regex (pipes escaped) or BOX,boxname[,args]</TD>\r\n    <TD><INPUT type=\"text\" size=\"50\" name=\"regex\" value=\"%%pref_regex%%\"></TD>\r\n  </TR>\r\n</TABLE>\r\n\r\n<INPUT type=\"submit\" name=\"save\" value=\"Save\">\r\n<INPUT type=\"submit\" name=\"get\" value=\"Get\">\r\n</FORM>\r\n','1','','Admin Pages','default','en'),('edit_story_admin_page','<div class=\"title\">Edit Story</div>\r\n<div class=\"error\">%%error%%</div>\r\n%%story%%\r\n<p>\r\n%%edit_form%%','1','','Admin Pages','default','en'),('edit_story_archive_fail','<table>\r\n<TR><TD>%%norm_font%%<B>Could not archive story.</B>%%norm_font_end%%</TD></TR>\r\n</table>','1','','Stories','default','en'),('edit_story_archive_success','<table>\r\n<TR><TD>%%norm_font%%<B>Story archived.</B>%%norm_font_end%%</TD></TR>\r\n</table>','1','','Stories','default','en'),('edit_story_deleted','<table>\r\n<TR><TD>%%norm_font%%<B>Story deleted.</B>%%norm_font_end%%</TD></TR>\r\n</table>','1','','Stories','default','en'),('edit_story_form','<FORM NAME=\"editstory\" ACTION=\"%%rootdir%%/\" METHOD=\"POST\" enctype=\"multipart/form-data\">\r\n%%hidden_form_data%%\r\n<table width=\"100%\" border=0 cellpadding=\"8\" cellspacing=0>\r\n<tr>\r\n<td valign=\"top\" colspan=\"2\">%%guidelines%%</td>\r\n</tr>\r\n<tr>\r\n<td valign=\"top\" colspan=\"2\">%%all_buttons%%</td>\r\n</tr>\r\n<tr>\r\n<td valign=\"top\">post&nbsp;to:</td>\r\n<td valign=\"top\">%%section_select%% %%topic_select%% %%postmode_select%%</td>\r\n</tr>\r\n%%edit_queue%%\r\n<tr>\r\n<td valign=\"top\" colspan=\"2\">title:</td>\r\n</tr>\r\n<tr>\r\n<td valign=\"top\" colspan=\"2\"><INPUT TYPE=\"text\" NAME=\"title\" VALUE=\"%%title%%\" SIZE=50><br>\r\n%%dept%%</td>\r\n</tr>\r\n%%notes%%\r\n<tr>\r\n<td valign=\"top\" colspan=\"2\">intro:</td>\r\n</tr>\r\n<tr>\r\n<td valign=\"top\" colspan=\"2\"><TEXTAREA NAME=\"introtext\" COLS=\"%%textarea_cols%%\" ROWS=\"%%textarea_rows%%\" WRAP=\"soft\">%%introtext%%</TEXTAREA></td>\r\n</tr>\r\n<tr>\r\n<td valign=\"top\" colspan=\"2\">body:</td>\r\n</tr>\r\n<tr>\r\n<td valign=\"top\" colspan=\"2\"><TEXTAREA NAME=\"bodytext\" COLS=\"%%textarea_cols%%\" ROWS=\"%%textarea_rows%%\" WRAP=\"soft\">%%bodytext%%</TEXTAREA></td>\r\n</tr>\r\n%%spellcheck%%\r\n%%tags%%\r\n<tr>\r\n<td></td>\r\n<td valign=\"top\">%%displaystatus_select%% %%commentstatus_select%% %%edit_category_select%%\r\n</td>\r\n</tr>\r\n%%time_update%%\r\n<tr>\r\n<td>%%poll_message%%</td>\r\n<td>%%poll_form%%</td>\r\n</tr>\r\n<tr>\r\n<td valign=\"top\" colspan=\"2\">%%all_buttons%%</td>\r\n</tr>\r\n</table>\r\n</FORM>','1','The main form for submitting and editing stories. This one has a lot of permitted special keys. Here goes:\r\n\r\n<ul>\r\n<li> allowed_html_intro: the string for what html is allowed in intro. Optional.\r\n<li> allowed_html_body: likewise, for the body field\r\n<li> notes: Block \"story_edit_notes\" -- traditionally for the ED and UPDATE explanations\r\n<li> tid: Topic id of story\r\n<li> section: section id of story\r\n<li> parent: section id of parent section, if there is one\r\n<li> topic_select: The selector for topics. Generated internally based on perms and vars. REQUIRED -- it will be a hidden field if you\'re not using topics, but you must have it.\r\n<li> displaystatus_select: Selector for displaystatus. Generated based on perms\r\n<li> commentstatus_select: Obvious\r\n<li> edit_category_select: If you\'re using edit categories, this\'ll be the selector\r\n<li> postmode_select: Selector for posting mode, like \"front page\", \"editing\" etc\r\n<li> all_buttons: The set of currently allowed and relevant buttons. Very required.\r\n<li> aid: uid of author\r\n<li> hidden_form_data: various bits of hdden stuff for the form that scoop needs to track. Very required.\r\n<li> title: Text of the title -- use your own html form element, just include this for \"value\"\r\n<li> dept: Dept field, formatted by block \"story_edit_dept\". Included if show_dept is turned on\r\n<li> upload_page: Story upload form, if you\'re using that.\r\n<li> spellcheck: Spellcheck element, if used. Formatted in block story_edit_spellcheck\r\n<li> edit_queue: Post to edit queue element, if you\'re using that. Formatted in block story_edit_editqueue\r\n<li> time_update: Update timestamp to now button, if you have permission. Formatted in block story_edit_timeupdate, subject to perm \"story_time_update\"\r\n<li> update_txt: block story_edit_updatetxt\r\n<li> edit_txt: block story_edit_edittxt\r\n<li> textarea_cols: textarea columns, based on perfs and stuff\r\n<li> textarea_rows: textarea rows, likewise\r\n<li> poll_message: Poll into message, from attach_poll_message, if you\'re using polls\r\n<li> poll_form: Poll form, if you\'re using polls\r\n<li> introtext: introtext of the story\r\n<li> bodytext: body text of the story\r\n<li> guidelines: The block \"submission_guidelines\", included for user-level story submit\r\n</ul>','Admin Pages','default','en'),('edit_var','<form name=\"editvars\" action=\"%%rootdir%%/admin/vars/\" method=\"post\">\r\n<input type=\"hidden\" name=\"cat\" value=\"%%category%%\">\r\n\r\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n<tr><td bgcolor=\"%%title_bgcolor%%\">%%title_font%%Site Controls: %%category%%%%title_font_end%%</td></tr>\r\n<tr><td>%%norm_font%%%%update_msg%%%%norm_font_end%%</td></tr>\r\n<tr><td> </td></tr>\r\n<tr><td>%%norm_font%%Choose a category to edit:%%norm_font_end%%</td></tr>\r\n<tr><td>\r\n	<table border=\"0\" cellpadding=\"0\" cellspacing=\"2\" width=\"100%\">%%catlist%%</table>\r\n</td></tr>\r\n<tr><td>%%norm_font%%<input type=\"submit\" name=\"save\" value=\"Save\"> <input type=\"submit\" name=\"edit\" value=\"Get\">%%norm_font_end%%</td></tr>\r\n<tr><td><table border=\"0\" cellpadding=\"2\" cellspacing=\"0\" width=\"100%\">%%form_body%%</table></td></tr>\r\n<tr><td>%%norm_font%%<input type=\"submit\" name=\"save\" value=\"Save\"> <input type=\"submit\" name=\"edit\" value=\"Get\">%%norm_font_end%%</td></tr>\r\n</table>\r\n</form>\r\n',NULL,'<P>This block is used to build the Site Controls editing form. It should contain the admin page structure, set up the form, and contain all of the special keys listed below to ensure that variable editing is not broken. This block recognizes the following special keys:</P>\r\n<DL>\r\n <DT>catlist</DT>\r\n  <DD>The list of all variable categories, linkified to bring you to the form with all variables in that category. The list itself is built using the block <B>var_category_list</B> as many times as necessary to display all of the categories.</DD>\r\n <DT>category</DT>\r\n  <DD>The name of the category you\'re currently editing.</DD>\r\n <DT>update_msg</DT>\r\n  <DD>Any save, status, or error messages generated due to one of your actions in this admin tool.</DD>\r\n <DT>form_body</DT>\r\n  <DD>The body of the variable editing form. This will either be the single variable form from <B>edit_one_var</B> or the category edit form from <B>edit_cat_vars</B>, depending on whether you are editing one variable or an entire category.</DD>\r\n</DL>','Admin Pages','default','en'),('email_error','Failed to send mail. It could be a problem with the address you entered, or with the server. Please double-check the email address you entered, make sure that it is receiving email, and if still fails, copy and paste the error message and send it to %%local_email%% for help. The error message is: \"%%error%%\".','1','<P>This block is displayed when somebody attempts to create an account but the email sending process fails. The one special key recognised is <B>error</B>, which is whatever Mail::Sendmail returns as its error string.</P>','Emails,Accounts','default','en'),('empty_box','%%content%%','1','<P>This block is a box template that should have absolutely nothing but the content special key in it, so that the box output has no frame and will not mess up the formatting of whatever part of the page it\'s placed on. The special key content is replaced with the output of whichever box uses it as a wrapper.</P>','Box Templates','default','en'),('empty_template','%%CONTENT%%','2','','general','default','en'),('error_box','<DIV><P>%%title%%</P>\n<P>%%bid%%: %%content%%</P>\n</DIV>','1','<P>This block is used to provide a container for box output, and is not used directly in the page templates. It should be self-contained HTML. It provides the frame for the error message generated by any box that fails with a fatal error. The special keys recognised are:</P>\n<DL>\n <DT>title</DT>\n  <DD>The title of the box; if the box code returns a value for the title, that is used, otherwise the title field set in the Boxes Admin Tool is used</DD>\n <DT>content</DT>\n  <DD>The main body of the box. For a box that fails with a fatal error, the content is set by the block <B>box_failed_msg</B>. (The actual error code will be in your server error log.)</DD>\n <DT>bid</DT>\n  <DD>The internal name for the box.</DD>\n</DL>','Box Templates','default','en'),('error_font','<FONT COLOR=\"#FF0000\">','1','','Fonts','default','en'),('error_font_end','</FONT>','1','','Fonts','default','en'),('error_template','<h1>%%ERROR_TYPE%%</h1>\r\n<p>\r\n<b>Time:</b> %%thetime%%<br>\r\n<b>Package:</b> %%package%%<br>\r\n<b>File:</b> %%file%% <br>\r\n<b>Line:</b> %%line%% <br>\r\n<b>Additional Messages:</b> %%ERROR_MSG%%\r\n<b>Var Dump:</b><br>\r\n%%VARDUMP%%\r\n</p>','1','<P>The HTML output generated by Scoop if it runs into certain types of errors. Don\'t change this, except maybe to put your email address in it and ask the user to send you a copy of the text in the page. Everything on this page is a special key.</P>','Page Templates','default','en'),('event','%%title_font%%%%title%%%%title_font_end%%\r\n\r\n<DIV class=\"event_body\">\r\n<P id=\"description\">%%description%%</P>\r\n<P>Organizer: <A href=\"%%rootdir%%/user/uid:%%owner%%\">%%owner_nick%%</A></P>\r\n<P>Date: %%date_start%%</P><P>Calendar: <A href=\"%%rootdir%%/calendar//%%cal_id%%/%%date_start%%\">%%calendar_title%%</A></P>\r\n%%deadline%%\r\n%%address%%\r\n%%City%%\r\n%%state%%\r\n%%country%%\r\n%%rsvp%%\r\n<P>%%edit_link%% %%add_cal_link%% %%add_child_link%% %%event_sub_link%% %%add_story_link%%</P>\r\n</DIV>\r\n%%child_events%%\r\n\r\n<HR>\r\n\r\n<DIV class=\"event_stories\">\r\n%%BOX,event_stories%%\r\n</DIV>\r\n','1','<P>This block formats the page when viewing a single event in full detail. This should be a fully self-contained block of HTML. The special keys recognized are any defined event property name. Each one is replaced with the value of that property, formatted according to the template defined for that event property. If no template is defined, the value alone is used.</P>','Calendars and Events','default','en'),('event_add_child_link','[<A href=\"%%rootdir%%/submitevent/submit/%%eid%%?newchild=1\">Add a sub-event</A>]','1','<P>This is the link shown on the event page when the event displayed is a parent event and may have sub-events added, and the user viewing the event has permission to submit an event. The only special key recognized is eid, the current event\'s ID number.</p>','Calendars and Events','default','en'),('event_add_story_link','[<A href=\"%%rootdir%%/submitstory/?event=%%eid%%\">Write a story</A>]','1','<P>This is the link displayed when the current user has permission to submit a story to the event being displayed. The only special key recognized is eid, the current event\'s event ID number.</P>','Calendars and Events','default','en'),('event_also_submit','<INPUT type=\"checkbox\" name=\"other_cals\" value=\"%%cal_value%%\"%%cal_checked%%> <A href=\"%%rootdir%%/calendar//%%cal_value%%\">%%cal_title%%</A><BR>\r\n','1','<P>This is a single item in the list of alternate calendars to submit an event to, on the event edit form. The following special keys are recognized:</p>\n<DL>\n <DT>cal_value</dt>\n  <DD>The ID number of the calendar in this list item</dd>\n <DT>cal_checked</dt>\n  <DD>The checked/unchecked indicator showing if the current event has been submitted to the calendar in this list item</dd>\n <DT>cal_title</dt>\n  <DD>The calendar\'s display title</dd>\n</dl>','Calendars and Events','default','en'),('event_child_list','<P>Local events:</P>\r\n<UL>\r\n%%child_list%%\r\n</UL>\r\n','1','<P>This sets up the list of child events (or sub-events) on the display of a parent event. The only special key is child_list, which is built from one copy of event_child_list_item per child event.</p>','Calendars and Events','default','en'),('event_child_list_item','  <LI><A href=\"%%rootdir%%/event/%%eid%%\">%%title%%</A></LI>\r\n','1','<P>This is one item in the list of child events (or sub-events) for a parent event. The special keys recognized are any defined event property.</p>','Calendars and Events','default','en'),('event_edit_displaystatus','<SELECT name=\"displaystatus\" size=\"1\">\r\n  <OPTION value=\"-2\"%%pending_selected%%>Pending Moderation</OPTION>\r\n  <OPTION value=\"-1\"%%never_selected%%>Never Display</OPTION>\r\n  <OPTION value=\"0\"%%always_selected%%>Always Display</OPTION>\r\n</SELECT>','1','<P>This is the displaystatus selectbox shown on the event edit form to those users who have admin permissions for an event. The special keys recognized are the three *_selected keys, which show which option is currently set for the event being displayed.</p>','Calendars and Events','default','en'),('event_edit_form','%%title_font%%Edit Event%%title_font_end%%\r\n<P>%%msg%%</P>\r\n<FORM name=\"event_edit\" action=\"%%rootdir%%/submitevent/%%action%%/%%id%%\" method=\"POST\"><INPUT type=\"hidden\" name=\"parent\" value=\"%%parent%%\">\r\n<INPUT type=\"hidden\" name=\"newchild\" value=\"%%newchild%%\">\r\n\r\n<TABLE>\r\n<tr><td>%%required_pref_marker%%<B>Display event?</B></td>\r\n<td>%%displaystatus%%</td></tr>\r\n<tr><td>%%required_pref_marker%%<B>Submit to Calendar:</B></td>\r\n<td>%%BOX,calendar_selectbox%%</td></tr>\r\n\r\n%%event_form_items%%\r\n\r\n<tr><td><B>Event needs volunteers?</B></td>\r\n<td><input type=\"checkbox\" name=\"volunteers\" value=\"1\"%%volunteers%%></td></tr>\r\n<tr><td>%%required_pref_marker%%<B>Event is public?</B></td>\r\n<td><input type=\"radio\" name=\"public_view\" value=\"public\"%%public_checked%%> Public\r\n<BR><input type=\"radio\" name=\"public_view\" value=\"private\"%%private_checked%%> Private\r\n<BR><input type=\"radio\" name=\"public_view\" value=\"invite\"%%invite_checked%%> Invitation Only%%invite_link%%</td></tr><tr><td>%%required_pref_marker%%<B>Who can submit stories to this event?</B></td>\r\n<td><input type=\"radio\" name=\"public_submit\" value=\"public\"%%public_submit_checked%%> Public\r\n<BR><input type=\"radio\" name=\"public_submit\" value=\"private\"%%private_submit_checked%%> Private\r\n<BR><input type=\"radio\" name=\"public_submit\" value=\"invite\"%%invite_submit_checked%%> Invitation Only%%invite_link%%</td></tr>\r\n\r\n<tr><td>%%required_pref_marker%%<B>Start date</B>:</td><td><INPUT type=\"hidden\" name=\"date_start\" value=\"%%date_start%%\">\r\n<SELECT name=\"date_start_year\">\r\n%%BOX,cal_year_select,%%date_start_year%%%%</SELECT>\r\n<SELECT name=\"date_start_month\">\r\n%%BOX,cal_month_select,%%date_start_month%%%%</SELECT>\r\n<SELECT name=\"date_start_day\">\r\n%%BOX,cal_day_select,%%date_start_day%%%%</SELECT></td></tr>\r\n\r\n<tr><td><B>End date</B>:<br>(Only for multi-day events)</td>\r\n<td><INPUT type=\"radio\" name=\"date_end\" value=\"\"%%one_day%%> One Day Event\r\n<BR><INPUT type=\"radio\" name=\"date_end\" value=\"%%date_end%%\"%%multi_day%%> This date:\r\n<SELECT name=\"date_end_year\">\r\n%%BOX,cal_year_select,%%date_end_year%%%%</SELECT> \r\n<SELECT name=\"date_end_month\">\r\n%%BOX,cal_month_select,%%date_end_month%%%%</SELECT> \r\n<SELECT name=\"date_end_day\">\r\n%%BOX,cal_day_select,%%date_end_day%%%%</SELECT></td></tr>\r\n\r\n\r\n%%also_submit_line%%\r\n\r\n%%parent_event_line%%\r\n\r\n</TABLE>\r\n<BR><INPUT type=\"submit\" name=\"save\" value=\"Save Event\">\r\n</FORM>','1','<P>This block builds the single event edit and submit form. The special keys recognized are:</p>\n<DL>\n <DT>msg</dt>\n  <DD>Any status or error messages</dd>\n <DT>action</dt>\n  <DD>The \"action\" part of the URL (edit or submit)</dd>\n <DT>id</dt>\n  <DD>The ID of the calendar (if we\'re submitting an event) or the event (if we\'re editing an event)</dd>\n <DT>eid</dt>\n  <DD>The event ID</dd>\n <DT>cal_id</dt>\n  <DD>The event\'s calendar ID</dd>\n <DT>parent</dt>\n  <DD>The event ID of the parent event, if this is a sub-event</dd>\n <DT>newchild</dt>\n  <DD>True if this is a new sub-event</dd>\n <DT>displaystatus</dt>\n  <DD>The displaystatus control. A selectbox if the user can administer this event</dd>\n <DT>event_form_items</dt>\n  <DD>The form elements for each event property. The formatting of each event is determined by that event property\'s template</dd>\n <DT>volunteers</dt>\n  <DD>the checked indicator, if the event is marked as needing volunteers or not</dd>\n <DT>*_checked</dt>\n  <DD>The checked indicator for the permissions radio buttons</dd>\n <DT>date_start</dt>\n  <DD>The current start date</dd>\n <DT>date_start_*</dt>\n  <DD>the year, month and day parts of the date, individually</dd>\n <DT>one_day</dt>\n  <DD>The radio button checked indicator if this is a one-day event</dd>\n <DT>multi_day</dt>\n  <DD>The radio button checked indicator if this is a multi-day event</dd>\n <DT>date_end</dt>\n  <DD>The current end date</dd>\n <DT>date_end_*</dt>\n  <DD>The year, month, and day parts of the date, individually</dd>\n <DT>also_submit_line</dt>\n  <DD>The form elements to submit the current event to other calendars; formatted according to <B>event_other_calendars</b>. Not shown for child events (sub-events)</dd>\n <DT>parent_event_line</dt>\n  <DD>The form element to set an event as a parent (or umbrella) event which can have child events attached. Not shown for child events.</dd>\n <DT>invite_link</DT>\n  <DD>The link to the event\'s invitation management page. Not shown for new events, only existing events.</DD>\n</dl>','Calendars and Events','default','en'),('event_error_body','%%title_font%%%%title%%%%title_font_end%%\r\n\r\n<P>Sorry, the event you requested either doesn\'t exist or is private. <A href=\"%%rootdir%%/my/calendar\">Your personal calendar view</A>.</P>','1','<P>This is the error message displayed in place of the event body if the event requested is not viewable either because it doesn\'t exist or because the user doesn\'t have permission to see it.</P>','Calendars and Events','default','en'),('event_error_title','No Such Event','1','<P>This is the title used for the page if the event requested is not viewable either because it doesn\'t exist or because the user doesn\'t have permission to see it.</P>','Calendars and Events','default','en'),('event_format_daily','%%title%%\r\n%%description%%\r\n%%deadline%%','1','<P>This block formats a single event for use in <B>calendar_body_one_day</B> for the daily view. Zero, one, or more copies of this block may be displayed in a single day. The special keys recognized are any defined event property name. Each one is replaced with the value of that property, formatted according to the calendar_template defined for that event property. If no calendar_template is defined, the value alone is used.</P>','Calendars and Events','default','en'),('event_format_monthly','%%title%%','1','<P>This block formats a single event for use in <B>calendar_body_one_day</B> for the monthly view. Zero, one, or more copies of this block may be displayed in a single day. The special keys recognized are any defined event property name. Each one is replaced with the value of that property, formatted according to the calendar_template defined for that event property. If no calendar_template is defined, the value alone is used.</P>','Calendars and Events','default','en'),('event_format_weekly','%%title%%\r\n%%description%%','1','<P>This block formats a single event for use in <B>calendar_body_one_day</B> for the weekly view. Zero, one, or more copies of this block may be displayed in a single day. The special keys recognized are any defined event property name. Each one is replaced with the value of that property, formatted according to the calendar_template defined for that event property. If no calendar_template is defined, the value alone is used.</P>','Calendars and Events','default','en'),('event_invitations','%%title_font%%Invite users%%title_font_end%%\r\n\r\n<P>%%msg%%</P>\r\n<P><A href=\"%%rootdir%%/submitevent/edit/%%id%%\">Edit this event</A></P>\r\n<P><B>Users invited to view this event</B></P>\r\n\r\n<UL>\r\n%%view_list%%\r\n</UL>\r\n%%view_add%%\r\n\r\n<P><B>Users invited to attach stories to this event</B></P>\r\n<UL>\r\n%%submit_list%%\r\n</UL>\r\n%%submit_add%%\r\n','1','<P>This block formats the event invitation management page. The following special keys are used:</p>\n<DL>\n <DT>msg</dt>\n  <DD>Any status or error messages generated</dd>\n <DT>id</dt>\n  <DD>The event ID number</dd>\n <DT>view_list</dt>\n  <DD>The list of users invited to view the event. Each list item is formatted using <B>calendar_invitations_item</b>.</dd>\n <DT>view_add</dt>\n  <DD>The form used to add a user to the invitation list above. The form is in <B>calendar_invitations_add</b>.</dd>\n <DT>submit_list</dt>\n  <DD>The list of users invited to submit stories to the event. Each list item is formatted using <B>calendar_invitations_item</b>.</dd>\n <DT>submit_add</dt>\n  <DD>The form used to add a user to the invitation list above. The form is in <B>calendar_invitations_add</b>.</dd>\n</dl>','Calendars and Events','default','en'),('event_invitation_link',' <A href=\"%%rootdir%%/submitevent/invite/%%eid%%\">Invite users to view this event</A>','1','<P>This is the link to the event invitation management page. It is placed in <B>event_edit_form</B> for existing events.</P>','Calendars and Events','default','en'),('event_invite_mail','%%nick%%:\r\n\r\n%%sender_nick%% has invited you to attend the following event:\r\n\r\n%%title%%\r\n%%date_start%%\r\n\r\n%%description%%\r\n\r\n----------\r\n\r\nFor more information about this event, and to RSVP and/or \r\nsign up for updates, go to:\r\n\r\n%%event_url%%\r\n\r\n-- %%sitename%%','1','<P>This is the email sent to users invited to view a particular event. It is sent to the real email address of the invitee. Because this is an email and not a regular Scoop page, only the special keys listed below will work.</p>\n<DL>\n <DT>nick</dt>\n  <DD>The nickname of the invitee</dd>\n <DT>sender_nick</dt>\n  <DD>The nickname of the user who sent the invitation</dd>\n <DT>event_url</dt>\n  <DD>The URL of the event display page</dd>\n <DT>sitename</dt>\n  <DD>The contents of the sitename Site Control</dd>\n</dl>\n<P>Any defined event property may also be used.</p>','Calendars and Events','default','en'),('event_invite_mail_subject','You\'re invited!','1','<P>The subject line for the email sent when a user is invited to attend (view) an event. Because this is used in an email and does not go through Scoop\'s usual page out process, no regular keys may be used. There are no special keys for this block.</P>','Calendars and Events','default','en'),('event_list','%%title_font%%Events in %%title%%%%title_font_end%%\r\n\r\n%%edit_calendar_links%%\r\n\r\n<P>%%msg%%</P>\r\n\r\n<P>%%prevlink%%</P>\r\n<TABLE width=\"100%\" cellspacing=0 cellpadding=\"2px\">\r\n <TR>\r\n  <TH>Event</TH>\r\n  <TH>Submitted By</TH>\r\n  <TH>Start Date</TH>\r\n  <TH>Actions</TH>\r\n </TR>\r\n%%eventlist%%\r\n</TABLE>\r\n<P align=\"right\">%%nextlink%%</P>','1','<P>This is the structure of the event list page. By default, it creates a table, and <B>event_list_item</B> contains each row of the table\'s data. The number of columns and associated headings should match the structure and data in <B>event_list_item</B>. The following special keys are recognized:</P>\n<DL>\n <DT>cal_title</DT>\n  <DD>The display title of the calendar whose events are in the list</DD>\n <DT>prevlink</DT>\n  <DD>The link to the previous page of events if we\'re not on the first page</DD>\n <DT>eventlist</DT>\n  <DD>The actual list of events. Each line is built using <B>event_list_item</B> and the number of items displayed is limited by the site control <B>storylist</B>, which also controls the number of items in many other lists</DD>\n <DT>nextlink</DT>\n  <DD>The link to the next page in the event list, if there are more items.</DD>\n</DL>','Calendars and Events','default','en'),('event_list_action_approve',' (<A href=\"%%rootdir%%/editcalendar/moderate/%%cal_id%%\">approve</A>)','1','<P>This is the link used in the event list to a calendar\'s event moderation page, where events can be approved or disapproved for inclusion in a calendar. The only special key is cal_id, the ID number of the calendar currently being edited.</p>','Calendars and Events','default','en'),('event_list_action_edit',' (<A href=\"%%rootdir%%/submitevent/edit/%%eid%%\">edit</A>)','1','<P>This is the link used in the event list to the event\'s edit form. The only special key is eid, the event\'s ID number.</p>','Calendars and Events','default','en'),('event_list_action_remove','(<A href=\"%%rootdir%%/editcalendar/addevent/%%cal_id%%/remove/%%eid%%\">remove</A>)','1','<P>This is the link used to remove an event from the calendar being edited, if this is a \"secondary\" calendar for the event (the \"also show this event in...\" item on the event edit form)</p>','Calendars and Events','default','en'),('event_list_item',' <TR bgcolor=\"%%event_bg%%\">\r\n  <TD><A href=\"%%rootdir%%/event/%%eid%%\">%%title%%</A></TD>\r\n  <TD>%%owner_nick%%</TD>\r\n  <TD>%%date_start%%</TD>\r\n  <TD>%%actions%%</TD>\r\n </TR>\r\n','1','<P>This is one line (one event) in the event list page. It should have the same number of columns as the table in the block <B>event_list</B>, and its data should match the table headers. The following special keys are recognized:</P>\n<DL>\n <DT>event_bg</DT>\n  <DD>Background colours taken from the story list to distinguish between events filed primarily in this calendar, and events included in this calendar separately.</DD>\n <DT>eid</DT>\n <DD>The internal event ID of the event in this line</DD>\n <DT>owner_nick</DT>\n  <DD>The nickname of the event owner (submitter)</DD>\n  <DT>actions</dt>\n  <DD>the actions (edit, remove, etc) that the current user has permission to do.</dd>\n <DT>any other field in the events or event_properties table</DT>\n <DD>Any event property defined can have its name used in this block and the value of that property will be entered exactly as-is</DD>\n</DL>','Calendars and Events','default','en'),('event_moderate','%%title_font%%Moderate Events%%title_font_end%%\r\n\r\n%%edit_calendar_links%%\r\n\r\n<P>%%msg%%</P>\r\n\r\n<FORM name=\"moderate_events\" action=\"%%rootdir%%/editcalendar/moderate/%%cal_id%%\" method=\"POST\">\r\n<TABLE cellspacing=0 cellpadding=\"3px\">\r\n <TR>\r\n  <TD> </TD>\r\n  <TH>Event</TH>\r\n  <TH>Submitted By</TH>\r\n  <TH colspan=\"2\">Date(s)</TH>\r\n </TR>\r\n%%eventlist%%\r\n</TABLE>\r\n<P>With selected events:<BR>\r\n<INPUT type=\"radio\" name=\"action\" value=\"approve\"> Approve for display<BR>\r\n<INPUT type=\"radio\" name=\"action\" value=\"reject\"> Do not display</P>\r\n<P><INPUT type=\"submit\" name=\"save\" value=\"Moderate\">\r\n</FORM>','1','<P>This provides the page structure for the event moderation. The following special keys are recognized:</P>\n<DL>\n <DT>msg</DT>\n  <DD>Any status or error messages</DD>\n <DT>cal_id</DT>\n <DD>The internal ID of the calendar whose events we\'re moderating</DD>\n <DT>eventlist</DT>\n  <DD>The list of events waiting for moderation. The individual events are formatted with the block <B>event_moderate_item</B></DD>\n</DL>','Calendars and Events','default','en'),('event_moderate_item',' <TR>\r\n  <TD><INPUT type=\"checkbox\" name=\"%%eid%%\" value=\"1\"></TD>\r\n  <TD><A href=\"%%rootdir%%/event/%%eid%%\">%%title%%</A></TD>\r\n  <TD>%%owner_nick%%</TD>\r\n  <TD>%%date_start%%</TD>\r\n  <TD>%%date_delim%%%%date_end%%</TD>\r\n </TR>\r\n','1','<P>This formats each item in the event moderation list. The structure must match the structure set out in the block <B>event_moderate</B>. The following special keys are recognized:</P>\n<DL>\n <DT>eid</DT>\n  <DD>The event ID number</DD>\n <DT>date_delim</DT>\n  <DD>If there is an end date, this is a separator to show that it\'s a date range. Otherwise blank.</DD>\n <DT>owner_nick</DT>\n  <DD>The nickname of the event owner (submitter)</DD>\n <DT>any event property</DT>\n  <DD>Any property defined in the events or event_properties table may be used here. The value is substituted as-is</DD>\n</DL>','Calendars and Events','default','en'),('event_other_calendars','<tr><td><B>Also show in</B>:</td><td>%%also_submit%%</td></tr>\r\n','1','<P>This is the portion of the event edit form that displays checkboxes for each calendar the user can submit the event to, excluding the one the event is primarily submitted to. The only special key is also_submit, which is replaced with the actual checkboxes</P>','Calendars and Events','default','en'),('event_parent_item','<P><A href=\"%%rootdir%%/event/%%eid%%\">Related events</A></P>','1','<P>This is the link back to the parent event, shown if the event currently displayed is actually a child event (sub-event). The only special key is eid, the parent event\'s ID</P>','Calendars and Events','default','en'),('event_parent_line','<tr><td><B>This is an \"umbrella\" event</B>:<br>(ie, a country-wide \"meetup\"<br>If so, don\'t set a location.)</td><td><INPUT type=\"checkbox\" name=\"is_parent\" value=\"1\"%%is_parent%%></td></tr>','1','<P>This is the part of the event edit form that sets whether or not an event is a \"parent\" event or not. The only special key recognized is is_parent, a checkbox checked indicator used for the current status of the event.</P>','Calendars and Events','default','en'),('event_property_date','<tr><td><B>%%title%%</B><br>%%description%%</td>\r\n<td><INPUT type=\"radio\" name=\"%%property%%\" value=\"\"%%no_date%%> Not Applicable\r\n<BR><INPUT type=\"radio\" name=\"%%property%%\" value=\"%%value%%\"%%use_date%%> This date:\r\n<SELECT name=\"%%property%%_year\">\r\n%%BOX,cal_year_select,%%year%%%%\r\n</SELECT>\r\n<SELECT name=\"%%property%%_month\">\r\n%%BOX,cal_month_select,%%month%%%%\r\n</SELECT>\r\n<SELECT name=\"%%property%%_day\">\r\n%%BOX,cal_day_select,%%day%%%%\r\n</SELECT></td></tr>\r\n','1','<P>This block formats any date event properties on the submit/edit event form. It should be one item in the structure defined in <B>event_edit_form</B>. The following special keys are recognized:</P>\n<DL>\n <DT>title</DT>\n  <DD>The title of the event property</DD>\n <DT>description</DT>\n  <DD>The description of the event property</DD>\n <DT>property</DT>\n  <DD>The internal name of the event property</DD>\n <DT>no_date</DT>\n  <DD>The radio button checked indicator if this property is not being set for a particular event</DD>\n <DT>use_date</DT>\n  <DD>The radio button checked indicator if this property is being set for a particular event</DD>\n <DT>value</DT>\n  <DD>The current value of this property</DD>\n <DT>year, month, day</DT>\n  <DD>The three parts of the event date, individually</DD>\n</DL>','Calendars and Events','default','en'),('event_property_text','<tr><td>%%required%%<B>%%title%%:</B><br>%%description%%</td><td><INPUT type=\"text\" name=\"%%property%%\" value=\"%%value%%\"></td></tr>\r\n','1','<P>This block formats any plain text format event properties on the submit/edit event form. It should be one item in the structure defined in <B>event_edit_form</B>. The following special keys are recognized:</P>\n<DL>\n <DT>title</DT>\n  <DD>The title of the event property</DD>\n <DT>description</DT>\n  <DD>The description of the event property</DD>\n <DT>property</DT>\n  <DD>The internal name of the event property</DD>\n <DT>value</DT>\n  <DD>The current value of this property</DD>\n</DL>','Calendars and Events','default','en'),('event_property_textarea','<tr><td>%%required%%<B>%%title%%:</B><br>%%description%%</td><td><TEXTAREA name=\"%%property%%\" rows=\"%%textarea_rows%%\" cols=\"%%textarea_cols%%\">%%value%%</textarea></td></tr>\r\n','1','<P>This block formats any textarea format event properties on the submit/edit event form. It should be one item in the structure defined in <B>event_edit_form</B>. The following special keys are recognized:</P>\n<DL>\n <DT>title</DT>\n  <DD>The title of the event property</DD>\n <DT>description</DT>\n  <DD>The description of the event property</DD>\n <DT>property</DT>\n  <DD>The internal name of the event property</DD>\n <DT>value</DT>\n  <DD>The current value of this property</DD>\n</DL>','Calendars and Events','default','en'),('event_saved_msg','%%title_font%%Event saved.%%title_font_end%%\r\n\r\n<UL>\r\n  <LI><A href=\"%%rootdir%%/event/%%eid%%\">View this event</A></LI>\r\n  <LI><A href=\"%%rootdir%%/calendar//%%cal_id%%\">Go to this event\'s calendar</A></LI>\r\n  <LI><A href=\"%%rootdir%%/my/calendar\">Go back to your personal calendar view</A></LI>\r\n  <LI><A href=\"%%rootdir%%/submitevent/submit/%%cal_id%%\">Submit another event</A></LI>\r\n</UL>','1','<P>This is the message displayed when a new event has been submitted. It should provide useful links to things the user might want to do after submitting an event. The following special keys are recognized:</P>\n<DL>\n <DT>cal_id</DT>\n  <DD>The ID of the calendar the user has just submitted an event to</DD>\n <DT>eid</DT>\n  <DD>The ID of the event just submitted</DD>\n</DL>','Calendars and Events','default','en'),('event_search','%%title_font%%Event Search Results%%title_font_end%%\r\n\r\n<P>Any fields left blank will not be used in the search.</P>\r\n\r\n<FORM name=\"Search\" action=\"%%rootdir%%/eventsearch\" method=\"GET\">\r\n<INPUT type=\"hidden\" name=\"page\" value=\"%%page%%\">\r\nEvents between \r\n<SELECT name=\"year_start\">%%BOX,cal_year_select,%%year_start%%%%</SELECT>\r\n<SELECT name=\"month_start\">%%BOX,cal_month_select,%%month_start%%%%</SELECT>\r\n<SELECT name=\"day_start\">%%BOX,cal_day_select,%%day_start%%%%</SELECT>\r\nand <SELECT name=\"year_end\">%%BOX,cal_year_select,%%year_end%%%%</SELECT>\r\n<SELECT name=\"month_end\">%%BOX,cal_month_select,%%month_end%%%%</SELECT>\r\n<SELECT name=\"day_end\">%%BOX,cal_day_select,%%day_end%%%%</SELECT>\r\n<BR>\r\n%%prop_search%%\r\n%%BOX,num_results%% results: <INPUT type=\"submit\" name=\"search\" value=\"Search\">\r\n\r\n<P>%%prev_button%%</P>\r\n%%results%%\r\n<P align=\"right\">%%next_button%%</P>\r\n</FORM>\r\n','1','<P>This is the page for event searching. The following special keys are recognized:</p>\n<DL>\n <DT>page</dt>\n  <DD>The current page number, for pages of search results</dd>\n <DT>year_start, month_start, day_start</dt>\n  <DD>The currently selected value for the start date\'s year, month, and day</dd>\n <DT>year_end, month_end, day_end</dt>\n  <DD>The currently selected value for the end date\'s year, month, and day</dd>\n <DT>prop_search</dt>\n  <DD>The form elements for searching event properties. The number of form elements is set in the Site Control <B>event_search_num_options</b>, and the formatting for each element is set in the block <B>event_search_property_item</b>.</dd>\n <DT>prev_button</dt>\n  <DD>A button to return to the previous page of search results. Only shown if we\'re not on page 1 of results</dd>\n <DT>next_button</dt>\n  <DD>A button to go to the next page of search results. Only shown if there are more search results after the last result shown</dd>\n</dl>','Calendars and Events','default','en'),('event_search_property_item','%%propertysel%% contains <INPUT type=\"text\" size=\"30\" name=\"value_%%num%%\" value=\"%%value_%%num%%%%\"><BR>\r\n','1','<P>This formats one event property form element in the event search form. The special keys are:</P>\n<DL>\n <DT>propertysel</DT>\n  <DD>A selectbox containing a list of all event properties</DD>\n <DT>num</DT>\n  <DD>A counter to distinguish this form element from the others, when it is repeated multiple times</DD>\n <DT>value_|num|</DT>\n  <DD>The value entered by the user. |num| is substituted as above before the value is substituted.</DD>\n</DL>','Calendars and Events','default','en'),('event_search_result_item','<DIV class=\"search_result\">\r\n<P><A href=\"%%rootdir%%/event/%%eid%%\">%%title%%</A> (%%date_start%%)<BR>\r\n%%description%%</P>\r\n</DIV>\r\n','1','<P>This formats one event search result. It should be HTML suitable for repeating an arbitrary number of times.</P>\n<P>The special keys are any defined event property.</P>','Calendars and Events','default','en'),('event_submit','%%title_font%%Submit an Event%%title_font_end%%\r\n\r\n','1','<P>The page title for event submission</P>','Calendars and Events','default','en'),('event_subscribe_link','[<A href=\"%%rootdir%%/event/%%eid%%?subscribe=add\">Notify me of changes to this event</A>]\r\n','1','<P>This is the link displayed on the event display page when the current user is not subscribed to the event being viewed. The only special key is eid, the event ID number.</P>','Calendars and Events','default','en'),('event_unsubscribe_link','[<A href=\"%%rootdir%%/event/%%eid%%?subscribe=remove\">Stop notifying me of changes to this event</A>]\r\n','1','<P>This is the link displayed on the event display page when the current user is already subscribed to the event being viewed. The only special key is eid, the event ID number.</P>','Calendars and Events','default','en'),('fckeditor_script','<script type=\"text/javascript\" src=\"/fckeditor/fckeditor.js\"></script>\r\n<script type=\"text/javascript\">\r\nfunction configFck(oFck) {\r\n	oFck.BasePath = \"/fckeditor/\" ;\r\n	oFck.Config[\"CustomConfigurationsPath\"] = \"/husiconfig.js\";\r\n}\r\n\r\nwindow.onload = function()\r\n{\r\nvar replaced = false;\r\nif (document.getElementsByName(\'introtext\').length > 0) {\r\n	var introeditor = new FCKeditor( \'introtext\' ) ;\r\n	configFck(introeditor);\r\n	introeditor.ToolbarSet = \'Intro\';\r\n	introeditor.ReplaceTextarea();\r\n	replaced = true;\r\n}\r\nif (document.getElementsByName(\'bodytext\').length > 0) {\r\n	var bodyeditor = new FCKeditor( \'bodytext\' ) ;\r\n	configFck(bodyeditor);\r\n	bodyeditor.ReplaceTextarea();\r\n	replaced = true;\r\n}\r\nif (document.getElementsByName(\'comment\').length > 0) {\r\n	var commenteditor = new FCKeditor( \'comment\' ) ;\r\n	configFck(commenteditor);\r\n	commenteditor.ReplaceTextarea();\r\n	replaced = true;\r\n}\r\nif (replaced) {\r\n	var posttype = document.getElementsByName(\'posttype\');\r\n	if (posttype.length > 0) {\r\n		posttype[0].value = \"html\";\r\n		posttype[0].style.display = \"none\";\r\n	}\r\n	var spellcheck = document.getElementsByName(\'preview\');\r\n	if (spellcheck.length > 0) {\r\n		for (x in spellcheck) {\r\n			if (spellcheck[x].value == \"Spellcheck\") {\r\n				spellcheck[x].style.display = \"none\";\r\n			}\r\n		}\r\n	}\r\n\r\n}\r\n}\r\n</script>','2','','general','default','en'),('firstlogin_message','<p><b>Welcome to %%sitename%%!</b> As this is your first login, you probably want to change your password below or some of the settings on the other preference pages. None of these changes are required, but we do recommend at least changing your password. Enjoy your stay.</p>\r\n<p>If you don\'t want to make any changes, you can <a href=\"%%rootdir%%/\">go to the front page</a>.</p>','1','<P>This block is displayed at the top of the Protected settings page the first time a user logs in, if the variable <B>show_prefs_on_first_login</B> is on. It should be self-contained HTML that encourages the new user to change his password and explore the other preference pages. There are no special keys.</P>','Accounts','default','en'),('footer','<div class=\"footer\">\r\n<a class=\"light\" href=\"http://scoop.kuro5hin.org\"><img src=\"%%imagedir%%/new_powered.gif\" alt=\"Powered by Scoop\" title=\"Powered by Scoop\"></a>\r\n%%BOX,amazon_footer%%&nbsp;%%paypal_donate%%&nbsp;\r\n<div class=\"copyright\">\r\nAll trademarks and copyrights on this page are owned by their respective companies.  Comments and Stories are owned by the Poster and Licensed to &quot;Hulver\'s site&quot;. See our <a class=\"light\" href=\"%%rootdir%%/special/copyright\">Copyright</a> page for more information.\r\n</div>\r\n%%menu_footer%%\r\n</div>','1','<P>This block is used at the bottom of each page. It should be fairly self-contained HTML, and contain any copyright notices and badges you want displayed at the bottom of all pages. This block has no special keys.</p>','General','default','en'),('formkey_err','Invalid form key. You probably tried to save your settings more than once. Do not hit \"BACK\"! If you are certain that your settings have not been saved, try to save them from this screen.','1','<P>The error message displayed if there is a formkey error, such as a user double-clicking a button or going too long between loading the form and submitting it.</P>','Accounts','default','en'),('fulltext_asphrase','<input type=\"checkbox\" name=\"phrase\" value=\"true\"            %%CHECKED%%> as Phrase','2','','search','default','en'),('google_adsense','<script type=\"text/javascript\"><!--\r\ngoogle_ad_client = \"pub-8028642453271155\";\r\ngoogle_ad_width = 120;\r\ngoogle_ad_height = 60;\r\ngoogle_ad_format = \"120x60_as_rimg\";\r\ngoogle_cpa_choice = \"CAAQxZqazgEaCMOiwb9yonQWKIHD93M\";\r\n//--></script>\r\n<script type=\"text/javascript\" src=\"http://pagead2.googlesyndication.com/pagead/show_ads.js\">\r\n</script>','2','','','default','en'),('google_ad_anon','<script type=\"text/javascript\"><!--\r\ngoogle_ad_client = \"pub-8028642453271155\";\r\n/* Anonymous */\r\ngoogle_ad_slot = \"7054129075\";\r\ngoogle_ad_width = 160;\r\ngoogle_ad_height = 600;\r\n//-->\r\n</script>\r\n<script type=\"text/javascript\"\r\nsrc=\"http://pagead2.googlesyndication.com/pagead/show_ads.js\">\r\n</script>','2','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</p>\r\n<DL>\r\n <DT>FILE_PATH</dt>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</dd>\r\n <DT>TEXT1</dt>\r\n  <DD>The text the ad sponsor entered in the text1 field.</dd>\r\n <DT>TEXT2</dt>\r\n  <DD>The text the ad sponsor entered in the text2 field.</dd>\r\n <DT>TITLE</dt>\r\n  <DD>The text the ad sponsor entered in the title field.</dd>\r\n <DT>LINK_URL</dt>\r\n  <DD>The URL of the page being advertised.</dd>\r\n <DT>SID</dt>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</dd>\r\n <DT>REDIRECT_URL</dt>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</dd>\r\n</dl><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</p>','Ads','default','en'),('google_ad_banner','<script type=\"text/javascript\"><!--\r\ngoogle_ad_client = \"pub-8028642453271155\";\r\n/* Banner */\r\ngoogle_ad_slot = \"0304217112\";\r\ngoogle_ad_width = 300;\r\ngoogle_ad_height = 250;\r\n//-->\r\n</script>\r\n<script type=\"text/javascript\"\r\nsrc=\"http://pagead2.googlesyndication.com/pagead/show_ads.js\">\r\n</script>\r\n<p></p>\r\n','2','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</p>\r\n<DL>\r\n <DT>FILE_PATH</dt>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</dd>\r\n <DT>TEXT1</dt>\r\n  <DD>The text the ad sponsor entered in the text1 field.</dd>\r\n <DT>TEXT2</dt>\r\n  <DD>The text the ad sponsor entered in the text2 field.</dd>\r\n <DT>TITLE</dt>\r\n  <DD>The text the ad sponsor entered in the title field.</dd>\r\n <DT>LINK_URL</dt>\r\n  <DD>The URL of the page being advertised.</dd>\r\n <DT>SID</dt>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</dd>\r\n <DT>REDIRECT_URL</dt>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</dd>\r\n</dl><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</p>','Ads','default','en'),('google_ad_banner_loggedin','<p></p>\r\n<script type=\"text/javascript\"><!--\r\ngoogle_ad_client = \"pub-8028642453271155\";\r\n/* Logged in Banner */\r\ngoogle_ad_slot = \"5970497628\";\r\ngoogle_ad_width = 468;\r\ngoogle_ad_height = 60;\r\n//-->\r\n</script>\r\n<script type=\"text/javascript\"\r\nsrc=\"http://pagead2.googlesyndication.com/pagead/show_ads.js\">\r\n</script>','2','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</p>\r\n<DL>\r\n <DT>FILE_PATH</dt>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</dd>\r\n <DT>TEXT1</dt>\r\n  <DD>The text the ad sponsor entered in the text1 field.</dd>\r\n <DT>TEXT2</dt>\r\n  <DD>The text the ad sponsor entered in the text2 field.</dd>\r\n <DT>TITLE</dt>\r\n  <DD>The text the ad sponsor entered in the title field.</dd>\r\n <DT>LINK_URL</dt>\r\n  <DD>The URL of the page being advertised.</dd>\r\n <DT>SID</dt>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</dd>\r\n <DT>REDIRECT_URL</dt>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</dd>\r\n</dl><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</p>','Ads','default','en'),('google_ad_template','<table border=\"0\" width=\"100%\">\r\n<tr><td align=\"center\">%%BOX,google_ad_box%%</td></tr></table><p>','2','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</p>\r\n<DL>\r\n <DT>FILE_PATH</dt>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</dd>\r\n <DT>TEXT1</dt>\r\n  <DD>The text the ad sponsor entered in the text1 field.</dd>\r\n <DT>TEXT2</dt>\r\n  <DD>The text the ad sponsor entered in the text2 field.</dd>\r\n <DT>TITLE</dt>\r\n  <DD>The text the ad sponsor entered in the title field.</dd>\r\n <DT>LINK_URL</dt>\r\n  <DD>The URL of the page being advertised.</dd>\r\n <DT>SID</dt>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</dd>\r\n <DT>REDIRECT_URL</dt>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</dd>\r\n</dl><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</p>','Ads','default','en'),('google_ad_user','<script type=\"text/javascript\"><!--\r\ngoogle_ad_client = \"pub-8028642453271155\";\r\n/* Logged in */\r\ngoogle_ad_slot = \"7104523634\";\r\ngoogle_ad_width = 120;\r\ngoogle_ad_height = 240;\r\n//-->\r\n</script>\r\n<script type=\"text/javascript\"\r\nsrc=\"http://pagead2.googlesyndication.com/pagead/show_ads.js\">\r\n</script>','2','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</p>\r\n<DL>\r\n <DT>FILE_PATH</dt>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</dd>\r\n <DT>TEXT1</dt>\r\n  <DD>The text the ad sponsor entered in the text1 field.</dd>\r\n <DT>TEXT2</dt>\r\n  <DD>The text the ad sponsor entered in the text2 field.</dd>\r\n <DT>TITLE</dt>\r\n  <DD>The text the ad sponsor entered in the title field.</dd>\r\n <DT>LINK_URL</dt>\r\n  <DD>The URL of the page being advertised.</dd>\r\n <DT>SID</dt>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</dd>\r\n <DT>REDIRECT_URL</dt>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</dd>\r\n</dl><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</p>','Ads','default','en'),('google_analytics','<script src=\"http://www.google-analytics.com/urchin.js\" type=\"text/javascript\">\r\n</script>\r\n<script type=\"text/javascript\">\r\n_uacct = \"UA-71294-1\";\r\nurchinTracker();\r\n</script>\r\n','2','','general','default','en'),('google_analytics_adsense','<script type=\"text/javascript\">\r\n// by Shawn - http://www.shawnhogan.com/2005/11/track-adsense-clicks-with-google-analytics.html\r\n// Put this at the bottom of the page (after the last AdSense block)\r\n	\r\nfunction adsense_click() {\r\n	if(window.status.indexOf(\'go to\') == 0) {\r\n		urchinTracker (\'/asclick\');\r\n	}\r\n}\r\n	\r\nvar elements;\r\nif(document.getElementsByTagName) {\r\n	elements = document.body.getElementsByTagName(\"IFRAME\");\r\n} else if (document.body.all) {\r\n	elements = document.body.all.tags(\"IFRAME\");\r\n} else {\r\n	elements = Array();\r\n}\r\n	\r\nfor(var i = 0; i < elements.length; i++) {\r\n	if(elements[i].src.indexOf(\'googlesyndication.com\') > -1) {\r\n		elements[i].onfocus = adsense_click;\r\n	}\r\n}\r\n</script>','2','','general','default','en'),('google_firefox','<script type=\"text/javascript\"><!--\r\ngoogle_ad_client = \"pub-8028642453271155\";\r\ngoogle_ad_width = 180;\r\ngoogle_ad_height = 60;\r\ngoogle_ad_format = \"180x60_as_rimg\";\r\ngoogle_cpa_choice = \"CAAQ56j8zwEaCHvU9tBAqJJaKMu293M\";\r\n//--></script>\r\n<script type=\"text/javascript\" src=\"http://pagead2.googlesyndication.com/pagead/show_ads.js\">\r\n</script>','2','','general','default','en'),('header','<!-- header table -->\r\n<div class=\"page_header\">\r\n%%BOX,logo_box%%\r\n<div class=\"section_links\">\r\n%%section_links%%\r\n</div>\r\n<div class=\"new_user_box\">\r\n%%BOX,new_user_box%%\r\n</div>\r\n</div>\r\n<br style=\"clear: both\">\r\n<!-- X header table -->\r\n<form name=\"logout_form\" method=\"post\" action=\"%%rootdir%%/logout\"></form>\r\n\r\n%%dynamicmode_javascript%%\r\n%%dynamicmode_iframe%%\r\n<script language=\"javascript\" type=\"text/javascript\">\r\n<!--\r\n//Toggle function for user images\r\nvar imgPlaceHolder = \'%%imagedir%%%%topics%%/wrkhmp.gif\';\r\n\r\nfunction toggleHiddenImage(img, newsrc) {\r\n      if (img.src == imgPlaceHolder) {\r\n              img.src=newsrc;\r\n      } else {\r\n              img.src=imgPlaceHolder\r\n      }\r\n      return false;\r\n}\r\n-->\r\n</script>','1','<P>This block is used at the top of each page. It should be fairly self-contained HTML, and contain any site-wide navigation you want displayed at the top of all pages. This block has one special key; dynamicmode_iframe is replaced with an IFRAME tag on pages displaying dynamic comments, and with nothing otherwise.</P>','General','default','en'),('header','<!-- header table -->\r\n<div class=\"page_header\">\r\n%%logo%%\r\n<div class=\"section_links\">\r\n%%section_links%%\r\n</div>\r\n</div>\r\n<!-- X header table -->\r\n<form name=\"logout_form\" method=\"post\" action=\"%%rootdir%%/logout\"></form>\r\n\r\n%%dynamicmode_javascript%%\r\n%%dynamicmode_iframe%%\r\n<script language=\"javascript\" type=\"text/javascript\">\r\n<!--\r\n//Toggle function for user images\r\nvar imgPlaceHolder = \'%%imagedir%%%%topics%%/wrkhmp.gif\';\r\n\r\nfunction toggleHiddenImage(img, newsrc) {\r\n      if (img.src == imgPlaceHolder) {\r\n              img.src=newsrc;\r\n      } else {\r\n              img.src=imgPlaceHolder\r\n      }\r\n      return false;\r\n}\r\n-->\r\n</script>','2','<P>This block is used at the top of each page. It should be fairly self-contained HTML, and contain any site-wide navigation you want displayed at the top of all pages. This block has one special key; dynamicmode_iframe is replaced with an IFRAME tag on pages displaying dynamic comments, and with nothing otherwise.</P>','General','mobile','en'),('hotlist_link','&nbsp;+&nbsp;','1','<P>This block is used as the text of the link used to add a story to a user\'s personal hotlist. It is only displayed to users who are logged in and who have not hotlisted that story; the block <B>hotlist_remove_link</B> is displayed to users who have already hotlisted the story. This block has no special keys.</P>','Stories','default','en'),('hotlist_remove_link','&nbsp;-&nbsp;','1','<P>This block is used as the text of the link used to remove a story from a user\'s personal hotlist. It is only displayed to users who are logged in and who have hotlisted that story; the block <B>hotlist_link</B> is displayed to users who have not hotlisted the story. This block has no special keys.</P>','Stories','default','en'),('identify_template','%%BOX,identify_box,key,action,url%%','2','A page template with just the ad on it','templates','default','en'),('index_right_boxes','        <div class=\"menu\">\r\n            %%BOX,donate%%\r\n            %%BOX,user_box%%\r\n            %%BOX,hotlist_flex_box%%\r\n            %%BOX,admin_users%%\r\n            %%BOX,admin_tools%%\r\n            %%BOX,user_theme%%\r\n        </div>\r\n','2','','general','crap','en'),('index_right_boxes','        <div class=\"menu\">\r\n            %%BOX,ad_box,1%%\r\n            %%BOX,donate%%\r\n            %%BOX,user_box%%\r\n            %%BOX,hotlist_flex_box%%\r\n            %%BOX,mini_calendar%%\r\n            %%BOX,admin_users%%\r\n            %%BOX,admin_tools%%\r\n            %%BOX,poll_box%%\r\n            %%BOX,new_diaries_box%%\r\n            %%BOX,new_section_stories_box%%\r\n            %%BOX,rdf_feeds%%\r\n            %%BOX,newest_users%%\r\n            %%BOX,older_list_box%%\r\n            %%BOX,user_theme%%\r\n        </div>\r\n','2','','general','default','en'),('index_right_boxes','        <div class=\"menu\">\r\n            %%BOX,ad_box,1%%\r\n            %%BOX,new_user_box%%\r\n            %%BOX,user_box%%\r\n            %%BOX,hotlist_flex_box%%\r\n            %%BOX,mini_calendar%%\r\n            %%BOX,admin_tools%%\r\n            %%BOX,user_theme%%\r\n        </div>\r\n','2','','general','mobile','en'),('index_template','%%doctype%%\r\n<html>\r\n<head>\r\n%%stylesheet%%\r\n<title>%%sitename%% || %%subtitle%%</title>\r\n%%site_logo%%\r\n</head>\r\n<body>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout -->\r\n\r\n<div class=\"container\">\r\n\r\n<div class=\"main\">\r\n\r\n<div class=\"sectiontitle\">\r\n        %%BOX,section_title%%\r\n</div>\r\n\r\n        %%BOX,new_admin_news%%\r\n        %%CONTENT%%\r\n</div>\r\n%%index_right_boxes%%\r\n</div>\r\n<!-- X Main layout -->\r\n<p></p>\r\n%%footer%%\r\n</body>\r\n</html>\r\n','1','<P>This block is used to build the front and section story index pages. It must be a full HTML page; dynamic content is added through the use of special keys. The special keys recognised are:</p>\r\n<DL>\r\n <DT>subtitle</dt>\r\n  <DD>This is replaced with the display name of the section being displayed.</dd>\r\n <DT>CONTENT</dt>\r\n  <DD>This is replaced with the story summaries for all of the stories that should be displayed on this page. It is built using the block <B>story_summary</b> once for each story displayed.</dd>\r\n</dl>\r\n','Page Templates','default','en'),('index_template','%%doctype%%\r\n<html>\r\n<head>\r\n%%stylesheet%%\r\n<title>%%sitename%% || %%subtitle%%</title>\r\n%%site_logo%%\r\n</head>\r\n<body>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout -->\r\n\r\n<div class=\"container\">\r\n\r\n<div class=\"main\">\r\n\r\n<div class=\"sectiontitle\">\r\n        %%BOX,section_title%%\r\n</div>\r\n\r\n        %%BOX,new_admin_news%%\r\n        %%CONTENT%%\r\n</div>\r\n%%index_right_boxes%%\r\n</div>\r\n<!-- X Main layout -->\r\n<p></p>\r\n%%footer%%\r\n</body>\r\n</html>\r\n','2','<P>This block is used to build the front and section story index pages. It must be a full HTML page; dynamic content is added through the use of special keys. The special keys recognised are:</p>\r\n<DL>\r\n <DT>subtitle</dt>\r\n  <DD>This is replaced with the display name of the section being displayed.</dd>\r\n <DT>CONTENT</dt>\r\n  <DD>This is replaced with the story summaries for all of the stories that should be displayed on this page. It is built using the block <B>story_summary</b> once for each story displayed.</dd>\r\n</dl>\r\n','Page Templates','mobile','en'),('interface_prefs_main_form','                <TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 width=\"100%\">\r\n                <TR>\r\n                        <TD BGCOLOR=\"%%title_bgcolor%%\">\r\n                        %%title_font%%<B>Edit Interface Preferences for %%nickname%%</B>%%title_font_end%%\r\n                        </TD>\r\n                </TR>\r\n                <TR>\r\n                        <TD ALIGN=\"center\">%%title_font%%\r\n                        <P><FONT COLOR=\"#FF0000\">%%title_msg%%</FONT><P>%%title_font%%\r\n                        </TD>\r\n                </TR>\r\n                <TR>\r\n                        <TD>\r\n\r\n                        %%interface_form%%\r\n                        </TD>\r\n                </TR>\r\n                </TABLE>','2','<P>This block is used to build the page for the interface preferences form, one of the userprefs pages. It should be self-contained HTML and contain the page title and the special keys listed below:</P>\n<DL>\n <DT>nickname</DT>\n  <DD>The nickname of the user changing his preferences</DD>\n <DT>title_msg</DT>\n  <DD>Any error or status messages regarding the save</DD>\n <DT>interface_form</DT>\n  <DD>The entire form containing all preferences supported by Scoop</DD>\n</DL>','Preferences','default','en'),('invalid_user_msg','Sorry, I can\'t seem to find that user','1','<P>The error message displayed when somebody requests a page for a user that doesn\'t exist</P>','Accounts','default','en'),('jquery_scripts','<script type=\"text/javascript\">\r\n\r\nfunction hotlistclick(event) {\r\n     event.preventDefault();\r\n     //$(event.target).attr(\"disabled\",\"disabled\");\r\n	 var href = $(event.target).attr(\'href\');\r\n     $(\"a[href=\'\"+href+\"\'\").empty();\r\n     $(\"div.hotlist-hotlist\").empty();\r\n     $(\"div.hotlist-hotlist\").text(\"Updating hotlist\");\r\n\r\n     $.post(\"%%rootdir%%/ajax/hotlist\", { value: event.target.href},\r\n\r\n	function(data) {\r\n		var results = data.results;\r\n		$(event.target).removeAttr(\"disabled\");\r\n		var href = $(event.target).attr(\'href\');\r\n		var oldhref;\r\n		oldhref = href.split(\"/\",9);\r\n		oldhref = oldhref.join(\"/\");\r\n		var res = $(\"a[href^=\'\"+oldhref+\"\']\");\r\n		res.html(\"&nbsp;\" + results[2] + \"&nbsp;\");\r\n		href = href.replace(results[0],results[1]);\r\n		res.attr(\'href\',href);\r\n		$.post(\"%%rootdir%%/ajax/hotlist-update\",\"\",\r\n			function(data) {\r\n				$(\"div.hotlist-hotlist\").empty();\r\n				$(\"div.hotlist-hotlist\").html(data);\r\n				$(\"a.hotlist-flex\").click(hotlistclick);},\"text\");\r\n	}\r\n	,\"json\")\r\n	};\r\n\r\nfunction hotlisttoggle(event) {\r\n	event.preventDefault();\r\n	var a = $(event.target).attr(\'href\');\r\n	alert(a);\r\n}\r\n\r\n$(document).ready(function() {\r\n	$(\"span.hotlist > a\").add(\"a.hotlist-flex\").click(hotlistclick);\r\n	//$(\"#hotlist-flex-hotlist > b > a\").click(hotlisttoggle);\r\n	//$(\"#hotlist-flex-diary > b > a\").click(hotlisttoggle);\r\n	//$(\"#hotlist-flex-replies > b > a\").click(hotlisttoggle);\r\n	\r\n});\r\n\r\n</script>\r\n','2','','general','default','en'),('lastfm_recent','<br>\r\n<style type=\"text/css\">table.lfmWidget20070611102602 td {margin:0 !important;padding:0 !important;border:0 !important;}table.lfmWidget20070611102602 tr.lfmHead a:hover {background:url(http://panther1.last.fm/widgets/images/en/header/chart/recenttracks_regular_red.png) no-repeat 0 0 !important;}table.lfmWidget20070611102602 tr.lfmEmbed object {float:left;}table.lfmWidget20070611102602 tr.lfmFoot td.lfmConfig a:hover {background:url(http://panther1.last.fm/widgets/images/en/footer/red.png) no-repeat 0px 0 !important;;}table.lfmWidget20070611102602 tr.lfmFoot td.lfmView a:hover {background:url(http://panther1.last.fm/widgets/images/en/footer/red.png) no-repeat -85px 0 !important;}table.lfmWidget20070611102602 tr.lfmFoot td.lfmPopup a:hover {background:url(http://panther1.last.fm/widgets/images/en/footer/red.png) no-repeat -159px 0 !important;}</style>\r\n<table class=\"lfmWidget20070611102602\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:184px;\"><tr class=\"lfmHead\"><td><a title=\"%%lastfm_user%%: Recently Listened Tracks\" href=\"http://www.last.fm/user/%%lastfm_user%%/\" target=\"_blank\" style=\"display:block;overflow:hidden;height:20px;width:184px;background:url(http://panther1.last.fm/widgets/images/en/header/chart/recenttracks_regular_red.png) no-repeat 0 -20px;text-decoration:none;\"></a></td></tr><tr class=\"lfmEmbed\"><td><object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" width=\"184\" height=\"179\" codebase=\"http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab%23version=7,0,0,0\" style=\"float:left;\"><param name=\"bgcolor\" value=\"d01f3c\" /><param name=\"movie\" value=\"http://panther1.last.fm/widgets/chart/3.swf\" /><param name=\"quality\" value=\"high\" /><param name=\"allowScriptAccess\" value=\"sameDomain\" /><param name=\"FlashVars\" value=\"type=recenttracks&amp;user=%%lastfm_user%%&amp;theme=red&amp;lang=en\" /><embed src=\"http://panther1.last.fm/widgets/chart/3.swf\" type=\"application/x-shockwave-flash\" name=\"widgetPlayer\" bgcolor=\"d01f3c\" width=\"184\" height=\"179\" quality=\"high\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\"  FlashVars=\"type=recenttracks&amp;user=%%lastfm_user%%&amp;theme=red&amp;lang=en\" allowScriptAccess=\"sameDomain\"></embed></object></td></tr><tr class=\"lfmFoot\"><td style=\"background:url(http://panther1.last.fm/widgets/images/footer_bg/red.png) repeat-x 0 0;text-align:right;\"><table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"width:184px;\"><tr><td class=\"lfmConfig\"><a href=\"http://www.last.fm/widgets/?widget=chart&amp;colour=red&amp;chartType=recenttracks&amp;user=%%lastfm_user%%&amp;from=widget\" title=\"Get your own widget\" target=\"_blank\" style=\"display:block;overflow:hidden;width:85px;height:20px;float:right;background:url(http://panther1.last.fm/widgets/images/en/footer/red.png) no-repeat 0px -20px;text-decoration:none;\"></a></td><td class=\"lfmView\" style=\"width:74px;\"><a href=\"http://www.last.fm/user/%%lastfm_user%%/\" title=\"View %%lastfm_user%%\'s profile\" target=\"_blank\" style=\"display:block;overflow:hidden;width:74px;height:20px;background:url(http://panther1.last.fm/widgets/images/en/footer/red.png) no-repeat -85px -20px;text-decoration:none;\"></a></td><td class=\"lfmPopup\"style=\"width:25px;\"><a href=\"http://www.last.fm/widgets/popup/?widget=chart&amp;colour=red&amp;chartType=recenttracks&amp;user=%%lastfm_user%%&amp;from=widget&amp;resize=1\" title=\"Load this chart in a pop up\" target=\"_blank\" style=\"display:block;overflow:hidden;width:25px;height:20px;background:url(http://panther1.last.fm/widgets/images/en/footer/red.png) no-repeat -159px -20px;text-decoration:none;\" onclick=\"window.open(this.href + \'&amp;resize=0\',\'lfm_popup\',\'height=279,width=234,resizable=yes,scrollbars=yes\'); return false;\"></a></td></tr></table></td></tr></table>\r\n','2','','general','default','en'),('login_box','<form name=\"login\" action=\"\" method=\"post\">\r\n<table border=\"0\" align=\"center\" cellpadding=\"1\" cellspacing=\"0\" bgcolor=\"%%box_content_bgcolor%%\">\r\n	<tr>\r\n		<td colspan=\"2\">\r\n			<center>%%LOGIN_ERROR%%</center>\r\n		</td>\r\n	</tr>\r\n	<tr>\r\n		<td colspan=\"2\">\r\n			<center>\r\n			%%norm_font%%\r\n			<b><a class=\"light\" href=\"%%rootdir%%/newuser\">Make a new account</a></b>\r\n			%%norm_font_end%%\r\n			</center>\r\n		</td>\r\n	</tr>\r\n	<tr>\r\n		<td align=\"right\">\r\n			%%norm_font%%<small>Username:</small>%%norm_font_end%%\r\n		</td>\r\n		<td>\r\n			%%norm_font%%<small><input type=\"text\" size=\"12\" name=\"uname\"></small>%%norm_font_end%%\r\n		</td>\r\n	</tr>\r\n	<tr>\r\n		<td align=\"right\">\r\n			%%norm_font%%<small>Password:</small>%%norm_font_end%%\r\n		</td>\r\n		<td>\r\n			%%norm_font%%<small><input type=\"password\" size=\"12\" name=\"pass\"></small>%%norm_font_end%%\r\n		</td>\r\n	</tr>\r\n	<tr>\r\n		<td align=\"right\" colspan=\"2\">\r\n    		%%norm_font%%\r\n    			<input type=\"submit\" name=\"login\" VALUE=\"Login\">\r\n			<input type=\"submit\" name=\"mailpass\" VALUE=\"Mail Password\">\r\n		%%norm_font_end%%\r\n    	</td>\r\n	</tr>\r\n</table>\r\n</form>','1','<P>Despite its name, this is not a box template. It is an entire static box used to present the login form and new account link in place of the user box to a visitor who is not logged in. It should be self-contained HTML. It should contain the special key below:</P>\r\n<DL>\r\n <DT>LOGIN_ERROR</DT>\r\n  <DD>The error message generated from a failed login attempt. The text and format of the error messages are set in the blocks <B>login_error_message</B>, <B>login_mailed_message</B>, or <B>login_mail_failed</B>, depending on which error was encountered.</DD>\r\n</DL>\r\n<P>The block must contain the following form elements or the login process will not work properly:</P>\r\n<DL>\r\n <DT>FORM</DT>\r\n  <DD>The form should post to the root directory of your site.</DD>\r\n <DT>Username field</DT>\r\n  <DD>The text input field must be named \"uname\"</DD>\r\n <DT>Password field</DT>\r\n  <DD>The password input field must be named \"pass\"</DD>\r\n <DT>Login button</DT>\r\n  <DD>The button that submits both above fields for login must be named \"login\"</DD>\r\n <DT>Mail forgotton password button</DT>\r\n  <DD>The button that submits the username field for creation of a new password must be named \"mailpass\"</DD>\r\n</DL>','Accounts','default','en'),('login_error_message','%%norm_font%%<font color=\"#FF0000\"><b>Login Incorrect</b></font>%%norm_font_end%%<br>','2','<P>This is the error message displayed in the <B>login_box</B> if either the username or password (or both) are incorrect. This block contains the special key \"uname\" which is replaced with the username entered in the login form.</P>','Accounts','default','en'),('login_mailed_message','%%norm_font%%<font color=\"#FF0000\"><b>New password for %%uname%% mailed.</b></font>%%norm_font_end%%<br>','2','<P>This is the status message displayed in the <B>login_box</B> when a new password has successfully been mailed to the user. This block contains the special key \"uname\" which is replaced with the username entered in the login form.</P>','Accounts','default','en'),('login_mail_failed','%%norm_font%%<font color=\"#FF0000\"><b>Could not mail password for %%uname%%.</b></font>%%norm_font_end%%<br>','2','<P>This is the error message displayed in the <B>login_box</B> when Scoop could not send the email containing the user\'s new password as requested. This block contains the special key \"uname\" which is replaced with the username entered in the login form.</P>','Accounts','default','en'),('logo','<div class=\"site_logo\">\r\n<a style=\"text-decoration: none\" href=\"%%site_url%%%%rootdir%%/\">\r\n<img src=\"%%imagedir%%%%logo_image%%\">\r\n<img src=\"%%imagedir%%%%logo_text%%\">\r\n</a>\r\n</div>','2','','general','default','en'),('logo','<div class=\"site_logo\">\r\n<a style=\"text-decoration: none\" href=\"%%site_url%%%%rootdir%%/\">\r\nHulver\'s Site\r\n</a>\r\n</div>','2','','general','mobile','en'),('logout','Are you sure you want to logout?\r\n<p>\r\n<form method=\"post\" action=\"%%rootdir%%/logout\">\r\n<input type=\"submit\" value=\"Yes\">\r\n</form?','2','','display','default','en'),('logout_link','<a class=\"light\" href=\"%%rootdir%%/logout\" onClick=\"document.logout_form.submit(); return false;\">','2','','display','default','en'),('logo_graphics','/Holecow_Var01.jpg','2','','general','crap','en'),('logo_graphics','/Husicow_Var01-banner.jpg','2','','general','default','en'),('logo_text','/Hole_Text1.jpg,/Hole_Text2.jpg,/Hole_Text3.jpg,/Hole_Text4.jpg','2','','','crap','en'),('logo_text','/Husitext_Var01.jpg,/Husitext_Var02.jpg,/Husitext_Var03.jpg','2','','','default','en'),('macro_category_list','<tr>\r\n	<td>%%norm_font%%<a href=\"%%rootdir%%/admin/macros/%%item_url%%\">%%item%%</a>%%norm_font_end%%</td>\r\n	<td>%%norm_font%%<a href=\"%%rootdir%%/admin/macros/%%item_url%%\">%%item%%</a>%%norm_font_end%%</td>\r\n	<td>%%norm_font%%<a href=\"%%rootdir%%/admin/macros/%%item_url%%\">%%item%%</a>%%norm_font_end%%</td>\r\n</tr>\r\n',NULL,'One line of the macro category list.  Usually one table row.','Admin Pages','default','en'),('mail_ad_almost_done_msg','The ad that you submitted to %%sitename%% has is almost finished wth its campaign. You only have %%VIEWS_LEFT%% impressions left before its gone.  If you would like to not receive these reminders, please reply and let us know.\r\n\r\nAdvertisement details:\r\nTitle: %%TITLE%%\r\nText1: %%TEXT1%%\r\nURL: %%URL%%\r\n\r\nIf you have received this message in error, please reply and let us know.\r\n\r\n-%%sitename%%\r\n%%local_email%%\r\n','1','<P>This is the text of the email sent to the sponsor of an ad when his ad campaign is almost finished. Whether or not this email is sent at all is determined by the variable <B>mail_ad_reminders</B>. The number of impressions remaining when the email is sent is determined by the variable <B>mail_ad_reminder_on</B>. This block should have no HTML formatting, and recognizes no keys except the special keys listed below, as it is not sent through the normal page processing. The special keys recognized are:</P>\n<DL>\n <DT>sitename</DT>\n  <DD>The value of the sitename variable</DD>\n <DT>site_url</DT>\n  <DD>The value of the site_url variable</DD>\n <DT>local_email</DT>\n  <DD>The value of the local_email variable</DD>\n <DT>TITLE</DT>\n  <DD>The title of the advertisement</DD>\n <DT>TEXT1</DT>\n  <DD>The text field of the advertisement</DD>\n <DT>URL</DT>\n  <DD>The URL in the ads link</DD>\n <DT>VIEWS_LEFT</DT>\n  <DD>The number of impressions remaining until the ad expires</DD>\n <DT>AD_ID</DT>\n  <DD>The internal ID number of the ad</DD>\n</DL>','Ads,Emails','default','en'),('mail_ad_done_msg','The ad that you submitted to %%sitename%% has finished its campaign.  Thank you for advertising on our site, we look forward to doing business with you again.\r\n\r\nAdvertisement details:\r\nTitle: %%TITLE%%\r\nText1: %%TEXT1%%\r\nURL: %%URL%%\r\n\r\nIf you have received this message in error, please reply and let us know.\r\n\r\n-%%sitename%%\r\n%%local_email%%\r\n','1','<P>This is the text of the email sent to the sponsor of an ad when his ad campaign is finished. Whether or not this ad is sent at all is determined by the variable <B>mail_ad_reminders</B> and <B>mail_ad_finished_reminder</B>. Both must be on for the email to be sent. This reminder email is sent when the last impression is used up. For an advance warning, see the block <B>mail_ad_almost_done_msg</B>. This block should have no HTML formatting, and recognizes no keys except the special keys listed below, as it is not sent through the normal page processing. The special keys recognized are:</P>\n<DL>\n <DT>sitename</DT>\n  <DD>The value of the sitename variable</DD>\n <DT>site_url</DT>\n  <DD>The value of the site_url variable</DD>\n <DT>local_email</DT>\n  <DD>The value of the local_email variable</DD>\n <DT>TITLE</DT>\n  <DD>The title of the advertisement</DD>\n <DT>TEXT1</DT>\n  <DD>The text field of the advertisement</DD>\n <DT>URL</DT>\n  <DD>The URL in the ads link</DD>\n <DT>AD_ID</DT>\n  <DD>The internal ID number of the ad</DD>\n</DL>','Ads,Emails','default','en'),('main_css','/******************/\r\n\r\nBODY \r\n{\r\n	background-color: #FFFFFF;\r\n	background-image: none;\r\n	font-family: verdana, arial, helvetica, sans-serif;\r\n	color: #333333;\r\n}\r\n\r\n/******************\r\n   LINK STYLES\r\n******************/\r\nA { \r\n	text-decoration: none;\r\n	color: #2400F2;\r\n	font-family: verdana, arial, helvetica, sans-serif;\r\n	background-color: transparent;\r\n	background-image: none;\r\n}\r\n\r\nA.light, A.section_link {\r\n	color: #003767;\r\n}\r\n\r\nA:active {\r\n	color: #C0C0C0;\r\n}\r\n\r\nA:visited {\r\n	color: #4185AA;\r\n}\r\n\r\nA:hover { \r\n	color: #4185AA; \r\n	background-color: transparent;\r\n}\r\n\r\n.spoiler {\r\n	color: black;\r\n	background-color: black;\r\n}\r\n\r\n.spoiler:hover {\r\n	background-color: #FFFFFF;\r\n	color: #333333;\r\n}\r\n\r\nA.adverttitle {\r\n	font-weight: bold;\r\n	background-color: #006699;\r\n}\r\n\r\nA.adverttitle:link, A.adverttitle:visited { \r\n	background-color: transparent;\r\n}\r\n\r\nA.adverttitle:hover { \r\n	color: #9999FF; \r\n	background-color: transparent;\r\n}\r\n\r\nIMG { border: none; }\r\n\r\n/******************\r\n   SCOOP STYLES\r\n******************/\r\n\r\n\r\nTABLE\r\n{\r\n	border-style: none;\r\n}\r\n\r\n\r\n.box\r\n{\r\n	border-style: none;\r\n	margin: 0px 0px 15px 0px;\r\n	padding: 0px;\r\n	border-top: 0px;\r\n	border-left: 0px;\r\n	border-right: 0px;\r\n	border-bottom: 0px;\r\n	border-style: solid;\r\n	border-color: black;\r\n}\r\n\r\nTD\r\n{\r\n	background-image: none;\r\n	background-color: #FFFFFF;\r\n	color: #333333;\r\n	vertical-align: top;\r\n}\r\n\r\nTD.sitehead\r\n{\r\n	font-size: large;\r\n	font-weight: bold;\r\n}\r\n\r\n.container\r\n{\r\n	width: 98%;\r\n	margin: 10px 0px 0px 5px;\r\n}\r\n\r\n.main\r\n{\r\n	float: left;\r\n	width: 70%;\r\n}\r\n\r\n.menu\r\n{\r\n	float: right;\r\n	width: 28%;\r\n	padding: 0px 0px 10px 10px;\r\n}\r\n\r\n.sectiontitle\r\n{\r\n	background-color: #EEEEEE;\r\n	color: inherit;\r\n	font-weight: bold;\r\n	font-size: large;\r\n	margin: 0px 0px 10px 0px;\r\n	padding: 0px 0px 0px 10px;\r\n}\r\n\r\n.boxtitle\r\n{\r\n	background-color: #EEEEEE;\r\n	color: black;\r\n	font-size: medium;\r\n	border-top: 1px;\r\n	border-left: 1px;\r\n	border-right: 1px;\r\n	border-bottom: 1px;\r\n	border-style: solid;\r\n	border-color: black;\r\n	padding: 2px;\r\n}\r\n\r\n.boxcontent\r\n{\r\n	font-size: smaller;\r\n}\r\n\r\n.poll\r\n{\r\n	font-size: smaller;\r\n}\r\n\r\n.pollslash\r\n{\r\n	text-align: center;\r\n	font-size: smaller;\r\n	width: 15px;\r\n}\r\n\r\n.pollcomments\r\n{\r\n	text-align: right;\r\n	font-size: smaller;\r\n}\r\n\r\n.storytitle\r\n{\r\n	vertical-align: middle;\r\n	background-color: #EEEEEE;\r\n	color: inherit;\r\n	font-size: medium;\r\n	font-weight: bold;\r\n	width: 100%;\r\n}\r\n\r\n.storysummary\r\n{\r\n	padding-bottom: 20px;\r\n	padding-left: 0px;\r\n	padding-right: 0px;\r\n	padding-top: 0px;\r\n}\r\n\r\n.storynavbar\r\n{\r\n	margin: 1em 0px 10px 0px;\r\n	padding: 1px;\r\n	background-color: #EEEEEE;\r\n	width: 100%;\r\n	text-align: center;\r\n	font-size: small;\r\n}\r\n\r\n.printicon\r\n{\r\n	float: left;\r\n	padding-right: 4px;\r\n}\r\n\r\n.storyintro_info\r\n{\r\n	font-size: small;\r\n	text-align: left;\r\n	top: 0px;\r\n	padding-top: 2px;\r\n}\r\n\r\n.storyinfo\r\n{\r\n	font-size: small;\r\n	text-align: center;\r\n	top: 0px;\r\n	padding: 1px 0px;\r\n	clear: both;\r\n	background-color: #EEEEEE;\r\n	margin: 5px 0px;\r\n}\r\n\r\n.hotlist\r\n{\r\n	text-align: right;\r\n	float: right;\r\n	top: 0px;\r\n	right: 90%;\r\n}\r\n\r\n.topicimg\r\n{\r\n	top: 0px;\r\n}\r\n\r\n.storyintro\r\n{\r\n	font-size: small;\r\n	margin-top: 10px;\r\n}\r\n\r\n.storystuff\r\n{\r\n	font-size: small;\r\n}\r\n\r\n.storystats\r\n{\r\n	font-size: small;\r\n	padding-top: 5px;\r\n}\r\n\r\n.paidtextadtitle\r\n{\r\n	font-size: medium;\r\n	font-weight: bold;\r\n}\r\n\r\n.paidtextadbody\r\n{\r\n	font-size: medium;\r\n}\r\n\r\n.paidtextadheader\r\n{\r\n	border-color: #006699; \r\n	border-style: solid;\r\n	color: inherit;\r\n	padding: 2px;\r\n	border-width: 1px;\r\n	font-size: small;\r\n	width: 100%;\r\n}\r\n\r\n.textadtitle\r\n{\r\n	font-size: medium;\r\n	font-weight: bold;\r\n}\r\n\r\n.textadbody\r\n{\r\n	border-top: 0px;\r\n	border-left: 0px;\r\n	border-right: 0px;\r\n	border-bottom: 0px;\r\n	border-style: solid;\r\n	border-color: black;\r\n	font-size: medium;\r\n	border-width: 0px;\r\n}\r\n\r\n.commentheader\r\n{\r\n	border-color: #006699; \r\n	border-style: solid;\r\n	color: inherit;\r\n	padding: 2px;\r\n	border-width: 1px;\r\n	background-color: #EEEEEE;\r\n	font-size: small;\r\n	width: 100%;\r\n}\r\n\r\n.commentheaderedit\r\n{\r\n	border-color: #FF0000; \r\n	border-style: solid;\r\n	padding: 2px;\r\n	color: inherit;\r\n	border-width: 1px;\r\n	background-color: #EEEEEE;\r\n	font-size: small;\r\n	width: 100%;\r\n}\r\n\r\n.comment\r\n{\r\n	font-size: small;\r\n}\r\n\r\n.footer\r\n{\r\n	width: 100%;\r\n	text-align: center;\r\n	clear: both;\r\n}\r\n\r\n.copyright\r\n{\r\n	text-align: center;\r\n	background-color: inherit;\r\n	color: inherit;\r\n	font-size: smaller;\r\n}\r\n\r\n.story_edit_instructions\r\n{\r\n	background-color: #EEEEEE;\r\n	color: inherit;\r\n}\r\n\r\n.amazon_product\r\n{\r\n	font-size: smaller;\r\n	text-align: center;\r\n}\r\n\r\nA.amazon_link\r\n{\r\n	font-size: smaller;\r\n}\r\n\r\n.page_header\r\n{\r\n	font-family: verdana, arial, helvetica, sans-serif;\r\n	font-size: smaller;\r\n}\r\n\r\n.section_links\r\n{\r\n	float: right;\r\n	width: 15%;\r\n	text-align: right;\r\n	padding-right: 8px;\r\n}\r\n\r\n.new_user_box\r\n{\r\n	float: right;\r\n	width: 15%;\r\n	text-align: left;\r\n}\r\n\r\n.site_logo\r\n{\r\n	float:left;\r\n	width: 60%;\r\n	padding-left: 8px;\r\n}\n\n/* calendar stuff */\n\n.cal_head { background-color: %%comment_head_bg%%; }\n\n.cal_head UL { text-align: center; }\n\n.cal_head UL LI { display: inline;\n                  list-style-type: none; }\n\n.cal_head UL LI A#current { background-color: #ff0000;\n                            color: #ffffff;\n                            font-weight: bold; }\n\n.cal_body TD,TH { border: 1px solid black;\n                  padding: 3px; }\n\n.cal_body #today { background-color: #eeeeee; }\n\n.cal_body #other_month { background-color: #cccccc; }\n\n.date_number { font-weight: bold;\n               font-size: large; }\n\r\n\r\n/* tag-cloud styles */\r\n\r\n.cloud li { list-style-type: none; display: inline; margin-right: 8px; }\r\n\r\n.cloud .tag-popularity-1 { font-size: 80%; }\r\n\r\n.cloud .tag-popularity-5 { font-size: 90%; }\r\n\r\n.cloud .tag-popularity-10 { font-size: 100%; }\r\n\r\n.cloud .tag-popularity-15 { font-size: 110%; }','1','<P>This block contains the CSS stylesheet for the site. It should be what you\'d expect to find in a .css file on the filesystem, except it recognizes the standard keys for interpolation. There are no special keys. This is sent to the client via the URL |rootdir|/css/main - any other stylesheets you create must also have _css at the end of their name if you want them accessible via the css op.</p>','CSS','default','en'),('mark_Editors','<img class=\"sub-mark\" src=\"%%imagedir%%/editort.gif\">','2','<P>This block is inserted in the comment headers for users in the Subscribers group. It should be a small bit of self-contained HTML. It is placed with a special key in the blocks <B>comment</B> and <B>moderation_comment</B>. This block has no special keys.','Subscriptions','default','en'),('mark_Gold_Subcribers','<img class=\"sub-mark\" src=\"%%imagedir%%/goldt.gif\">','2','<P>This block is inserted in the comment headers for users in the Subscribers group. It should be a small bit of self-contained HTML. It is placed with a special key in the blocks <B>comment</B> and <B>moderation_comment</B>. This block has no special keys.','Subscriptions','default','en'),('mark_Subcribers','<img class=\"sub-mark\" src=\"%%imagedir%%/standardt.gif\">','2','<P>This block is inserted in the comment headers for users in the Subscribers group. It should be a small bit of self-contained HTML. It is placed with a special key in the blocks <B>comment</B> and <B>moderation_comment</B>. This block has no special keys.','Subscriptions','default','en'),('mark_Subscribers','(!)','1','<P>This block is inserted in the comment headers for users in the Subscribers group. It should be a small bit of self-contained HTML. It is placed with a special key in the blocks <B>comment</B> and <B>moderation_comment</B>. This block has no special keys.','Subscriptions','default','en'),('mark_Superuser','<img class=\"sub-mark\" src=\"%%imagedir%%/editort.gif\">','2','<P>This block is inserted in the comment headers for users in the Subscribers group. It should be a small bit of self-contained HTML. It is placed with a special key in the blocks <B>comment</B> and <B>moderation_comment</B>. This block has no special keys.','Subscriptions','default','en'),('max_intro_warning','<p>Hey, you didn\'t read the rules! You have too much text in the introtext box. Please edit your submission accordingly and use the bodytext box for the bulk of your diary.</p>','1','A warning message for users who have too much stuff in their intro.','Stories','default','en'),('menu_footer','<a class=\"light\" href=\"/scoop/special/faq\">faq</a> |\r\n<a class=\"light\" href=\"http://wiki.hulver.com/\">help</a> |\r\n<a class=\"light\" href=\"/scoop/story/2005/1/19/61940/1053\">accounts</a> %%BOX,search_link%%','2','','General','default','en'),('min_intro_warning','<p>Sorry, your story/diary is not long enough. Please edit it so it has more content.</p>\r\n\r\nThe minumum is __MININTRO__ __UNIT__.','1','','Stories','default','en'),('moderate_head','Current score:<b>%%score%%</b><br>\r\nTotal votes: <b>%%votes%%</b><p>\r\n','1','<P>This block is used at the top of the story moderation form, after the user has voted on a story in the queue. It should be self-contained HTML, and summarize the story\'s current standing in the queue. The special keys recognized are:</P>\r\n<DL>\r\n <DT>score</DT>\r\n  <DD>The story\'s current score.</DD>\r\n <DT>votes</DT>\r\n  <DD>The total number of votes cast.</DD>\r\n</DL>','Stories','default','en'),('moderate_template','%%doctype%%\r\n<HTML>\r\n<HEAD>\r\n%%stylesheet%%\r\n<TITLE>%%sitename%% || %%subtitle%%</TITLE>\r\n%%site_logo%%\r\n</HEAD>\r\n<BODY bgcolor=\"#FFFFFF\" text=\"#000000\" link=\"#006699\" vlink=\"#003366\">\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<TABLE BORDER=0 WIDTH=\"99%\" ALIGN=\"center\" CELLPADDING=0 CELLSPACING=10>\r\n	<!-- Main page block -->\r\n	<TR>\r\n		\r\n		<!-- Center content section -->\r\n		<TD VALIGN=\"top\" width=\"73%\">\r\n			%%CONTENT%%\r\n		</TD>\r\n		<!-- X center content section -->\r\n		\r\n		<!-- Right boxes column -->\r\n		<TD VALIGN=\"top\" WIDTH=\"27%\">\r\n                        %%BOX,user_box%%\r\n			%%BOX,hotlist_flex_box%%\r\n			%%BOX,admin_tools%%\r\n		\r\n		</TD>\r\n		<!-- X Right boxes column -->\r\n	</TR>\r\n	<!-- X main page block -->\r\n</TABLE>\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</BODY>\r\n</HTML>\r\n','2','This is the moderate submissions page.','templates','default','en'),('moderation_comment','<!-- start comment -->\r\n<div class=\"commentheaderedit\"><a class=\"light\" name=\"%%cid%%\"></a>\r\n    %%new%% <b>%%subject%%</b>\r\n%%rating_format%%\r\n<small>(<a class=\"light\" href=\"%%rootdir%%/comments/%%sid%%/%%cid%%#%%cid%%\">link</a>)</small><br>\r\n<a class=\"light\" href=\"%%rootdir%%/user/uid:%%uid%%\">%%name%%</a> (%%date%%) %%BOX,comment_ip_link,%%comment_ip%%%%\r\n</div>\r\n<div class=\"comment\"><br>\r\n    %%comment%%<br>%%sig%%<br>%%actions%%\r\n<br><br>\r\n</div>\r\n%%replies%%\r\n<!-- end comment -->\r\n','1','<P>This block is used to format each editorial comment attached to a story or poll.  It is not used directly in any block, but is called repeatedly in the code, once for each editorial comment displayed.  (Topical comments use the block <B>comment</B>).  This should be a self-contained chunk of HTML code that can be nested arbitrarily deep.  The special keys recognised are:</P>\r\n<DL>\r\n <DT>uid</DT>\r\n  <DD>The numeric user ID of the comment poster</DD>\r\n <DT>edit_user</DT>\r\n  <DD>The edit user link, only displayed if the user viewing the page has the perm <B>edit_user</B>.</DD>\r\n <DT>name</DT>\r\n  <DD>The nickname of the comment poster</DD>\r\n <DT>date</DT>\r\n  <DD>A formatted time/date string</DD>\r\n <DT>subject</DT>\r\n  <DD>The subject of the comment</DD>\r\n <DT>new</DT>\r\n  <DD>The contents of the block <B>new_comment_marker</B>, if the comment is not yet marked as read for the user viewing the comment.  Use this, not new_comment_marker, in this block.</DD>\r\n <DT>member</DT>\r\n  <DD>The contents of the block <B>mark_(groupname)</B>, if it exists for the poster\'s group</DD>\r\n <DT>sig</DT>\r\n  <DD>The user\'s signature, if one is set.</DD>\r\n <DT>rating_format</DT>\r\n  <DD>If ratings are turned off, or the user chooses not to see ratings, this is blanked; if ratings should be displayed, this is replaced with the contents of the block <B>rating_format</B> which may use the special keys <B>score</B> and <B>num_ratings</B> to display the current ratings.</DD>\r\n <DT>comment</DT>\r\n  <DD>The body of the comment</DD>\r\n <DT>cid</DT>\r\n  <DD>The comment ID. This plus the sid uniquely identifies each comment.</DD>\r\n <DT>actions</DT>\r\n  <DD>The parent, reply, delete, toggle, and dynamic mode expand and collapse links; each part according to permissions.</DD>\r\n <DT>user_info</DT>\r\n  <DD>A link to the comment poster\'s user info page.</DD>\r\n <DT>sid</DT>\r\n  <DD>The story ID.  This plus the cid uniquely identifies each comment; this alone uniquely identifies each story or poll.</DD>\r\n <DT>score</DT>\r\n  <DD>The comment\'s current score, an average of all the ratings.</DD>\r\n <DT>num_ratings</DT>\r\n  <DD>The number of ratings given to the comment.</DD>\r\n <DT>email</DT>\r\n  <DD>The user\'s \"fake email\" from their user preferences in a mailto: link, if present</DD>\r\n <DT>url</DT>\r\n  <DD>The user\'s homepage from their user preferences in a link, if present</DD>\r\n <DT>replies</DT>\r\n  <DD>All comment replies.  If in threaded or minimal, this is formatted as just the subject; if in nested, this is formatted as the full comment.</DD>\r\n</DL>','Comments','default','en'),('month_link_up','<LI><A href=\"%%rootdir%%%%usercal%%/calendar/monthly/%%cal_id%%/%%year%%-%%month%%\">This Month</A></LI>\r\n','1','<P>This block is the link used in weekly and daily calendar views to allow the user to move back up to monthly view. The following special keys are recognized:</P>\n<DL>\n <DT>usercal</DT>\n  <DD>If viewing another user\'s personal calendar view, the \"/user/nickname\" portion of the URL, otherwise blank</DD>\n <DT>cal_id</DT>\n  <DD>The calendar ID of the current calendar, or zero for the user\'s personal calendar view</DD>\n <DT>year</DT>\n  <DD>The currently selected year</DD>\n <DT>month</DT>\n  <DD>The currently selected month. If in weekly view and the week spans a month change, the Monday\'s month is used.</DD>\n</DL>','Calendars and Events','default','en'),('navbar','<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=0 CELLSPACING=0>\n  <TR BGCOLOR=\"%%story_nav_bg%%\">\n    <TD WIDTH=\"100%\" ALIGN=\"center\">\n      %%smallfont%%%%last%%%%sep%%%%next%%%%smallfont_end%%\n    </TD>\n  </TR>\n</TABLE>','1','<P>This provides the overall layout for the story navigation bar which links to the previous and next stories at the bottom of the story text and should be a self-contained block of HTML. This navigation bar can be turned off entirely using the Site Control <B>disable_story_navbar</B>. The special keys are:</P>\n<DL>\n <DT>last</DT>\n  <DD>The previous story. This is formatted using the block <B>navbar_last</B></DD>\n <DT>next</DT>\n  <DD>The next story. This is formatted using the block <B>navbar_next</B></DD>\n <DT>sep</DT>\n  <DD>A separator, only shown if both \"last\" and \"next\" above are used. (The most recent story, for example, will only have a \"last\" entry, as there is no \"next\" story yet.)</DD>\n</DL>','Stories','default','en'),('navbar_comments',' (%%num%% comments)','1','<P>This displays the number of comments attached to a story listed in the story navigation bar, if the current user can read comments in the story\'s section. The special key <B>num</B> is replaced with the number of comments in the relevant story.','Stories','default','en'),('navbar_last','<B>&lt;</B> <A HREF=\"%%rootdir%%/story/%%sid%%\">%%title%%</A> %%comments%%','1','<P>This formats the \"last story\" entry in the story navigation bar. The special keys are:</P>\n<DL>\n <DT>sid</DT>\n  <DD>The story ID of the \"last story\"</DD>\n <DT>title</DT>\n  <DD>The title of the \"last story\"</DD>\n <DT>comments</DT>\n  <DD>The contents of <B>navbar_comments</B>, if the user has permission to view comments on the \"last story\"</DD>\n</DL>','Stories','default','en'),('navbar_next','<A HREF=\"%%rootdir%%/story/%%sid%%\">%%title%%</A> %%comments%% <B>&gt;</B> ','1','<P>This formats the \"next story\" entry in the story navigation bar. The special keys are:</P>\n<DL>\n <DT>sid</DT>\n  <DD>The story ID of the \"next story\"</DD>\n <DT>title</DT>\n  <DD>The title of the \"next story\"</DD>\n <DT>comments</DT>\n  <DD>The contents of <B>navbar_comments</B>, if the user has permission to view comments on the \"next story\"</DD>\n</DL>','Stories','default','en'),('navbar_sep',' | ','1','<P>This is the divider used to separate the \"next\" and \"last\" stories in the story navigation bar, if both have an entry. (The most recent story, for example, will only have a \"last\" entry, as there is no \"next\" story yet.) There are no special keys.</P>','Stories','default','en'),('nav_system','<h1>%%title%%</h1>\r\n<p>%%actions%%</p>\r\n<p>%%content%%</p>','2','','general','default','en'),('newuser_confirm_page','<h2>User Created!</h2>\r\n<p>You should soon receive an email at %%EMAIL%%. This email will contain your password and further instructions.</p>\r\n<p>Thanks for creating an account at %%SITENAME%%!</p>\r\n<script type=\"text/javascript\">urchinTracker(\'/scoop/signupdone\')</script>','1','<P>This page is displayed when the user has successfully created an account and the email containing their password has been sent. It should be a self-contained bit of HTML telling the user to look for the email, and may contain any welcome message you like. The special keys recognised are:</P>\r\n<DL>\r\n <DT>EMAIL</DT>\r\n  <DD>The email address the confirmation email was sent to</DD>\r\n <DT>SITENAME</DT>\r\n  <DD>The name of the site, as set in the site control <B>sitename</B></DD>\r\n</DL>','Accounts','default','en'),('new_advertiser_html','<table><tr><td colspan=\"2\" bgcolor=\"%%title_bgcolor%%\">%%title_font%%<b>Upgrade to an Advertiser Account</b>%%title_font_end%%<p>\r\n<form name=\"adduser\" method=\"post\" action=\"%%rootdir%%/\">\r\n<input type=\"hidden\" name=\"tool\" value=\"writeuser\">\r\n<input type=\"hidden\" name=\"op\" value=\"newuser\">\r\n<input type=\"hidden\" name=\"formkey\" value=\"%%formkey%%\"></td></tr>\r\n<tr><td colspan=\"2\"><font color=\"#FF0000\"><h3><center>%%error%%</center></h3></font></td></tr>\r\n<tr><td colspan=\"2\"><input type=\"hidden\" name=\"advertiser\" value=\"1\">','1','<P>This block is displayed on the account signup page if the user is creating an advertising account. This is yet another unimplemented ad feature. Advertising accounts are only partly implemented; for now, there is no automated way to collect extra information from advertisers.</P>','Ads','default','en'),('new_comment_format_end','</B>','1','<P>This block is used to format the number of new comments in a story on the index page. It should be a closing HTML tag that matches the formatting tag used in the block <B>new_comment_format_start</B>.</P>','Fonts','default','en'),('new_comment_format_start','<B>','1','<P>This block is used to format the number of new comments in a story on the index page. It should be an opening HTML tag that matches the closing tag used in the block <B>new_comment_format_end</B>.</P>','Fonts','default','en'),('new_comment_marker','<FONT COLOR=\"#FF0000\"><B>[new]</B></FONT>','1','<P>This block is inserted in the comment if the user has not yet read this comment, according to Scoop\'s read-tracking system. It replaces the special key <TT>|new|</TT> in the blocks <B>comment</B> and <B>moderation_comment</B>.</P>','Comments','default','en'),('new_login_box','<FORM NAME=\"login\" ACTION=\"%%rootdir%%/\" METHOD=\"post\">\r\n<table><tr><td valign=\"middle\" align=\"right\">%%LOGIN_ERROR%% \r\n%%norm_font%%<SMALL>Username:</SMALL>%%norm_font_end%%\r\n%%norm_font%%<SMALL><INPUT TYPE=\"text\" SIZE=12 NAME=\"uname\"></SMALL>%%norm_font_end%%</td>\r\n<td valign=\"middle\" align=\"right\">\r\n%%norm_font%%<SMALL>Password:</SMALL>%%norm_font_end%%\r\n%%norm_font%%<SMALL><INPUT TYPE=\"password\" SIZE=12 NAME=\"pass\"></SMALL>%%norm_font_end%%</td></tr>\r\n<tr><td align=\"right\" valign=\"middle\">\r\n%%norm_font%%<INPUT TYPE=\"submit\" NAME=\"login\" VALUE=\"Login\"></td><td align=\"right\" valign=\"middle\">\r\n<INPUT TYPE=\"submit\" NAME=\"mailpass\" VALUE=\"Mail Password\">\r\n%%norm_font_end%%</td></tr></table>\r\n</FORM>','2','Not a box template. This is the content put into the user box if a visitor is not logged in.  This should contain a form with two text inputs, one named \"uname\" and one named \"pass\" for the visitor to input their username and password, respectively, and two submit buttons, one named \"login\" with a value of \"login\" and one named \"mailpass\" with a value of \"Mail Password\".','site_html','default','en'),('new_story_marker','=>','1','<P>This block is inserted in the story summary if the user has not yet read this story, according to Scoop\'s read-tracking system. It replaces the special key <TT>|new|</TT> in the block <B>story_summary</B>.</P>','Stories','default','en'),('new_user_email','Someone requested a new user account on %%url%%/\nand gave this email address as their contact.\n\nIf this was you, please use the following username and password to log\nin:\n\n	Username: %%nick%%\n	Password: %%pass%%\n%%showprefs%%\nIf it wasn\'t you, please ignore this email. Our system will delete the\naccount automatically if it remains unused. You will not get any\nfurther e-mail from us. The account is free.\n\nWe hope you enjoy %%sitename%%!\n\n-- %%from%%','1','<P>This block contains the body of the email send when new accounts are created. It should not have any HTML. Because this is an email it is not processed the way web pages are and the only keys recognized are:</P>\n<DL>\n <DT>url</DT>\n  <DD>The full URL to the front page of the site.</DD>\n <DT>nick</DT>\n  <DD>The nickname that was just created</DD>\n <DT>pass</DT>\n  <DD>The generated password sent to the new user</DD>\n <DT>showprefs</DT>\n  <DD>If the variable <B>show_prefs_on_first_login</B> is set to 1, the contents of the block <B>new_user_email_showprefs</B>, otherwise blank.</DD>\n <DT>from</DT>\n  <DD>The email address the newuser email was sent from. This is the variable <B>new_user_email_from</B> if set, and <B>local_email</B> otherwise.</DD>\n</DL>','Accounts,Emails','default','en'),('new_user_email_showprefs','After first logging in, you will be automatically redirected to your\nuser preferences page, where you can change your password if you want\nto.','1','<P>This block contains text that will be included in the block <B>new_user_email</B> if the site control <B>show_prefs_on_first_login</B> is set to 1. It should not have any HTML. Since emails are not sent through the usual page processing, this block cannot use any of the normal keys available to most blocks.</P>','Accounts,Emails','default','en'),('new_user_email_subject','Welcome to %%sitename%%','1','<P>This block defines the subject line for the email sent to new accounts. It should be short and not have any HTML. Because this is an email it is not processed the way web pages are and the only key recognized is the special key sitename, which is replaced with the contents of the site control <B>sitename</B></P>','Accounts,Emails','default','en'),('new_user_has_account','<P>Hey!  You already have an account!  I wouldn\'t worry about creating another.  You must have arrived here in error. Please email %%local_email%% if you\'re having troubles with this site.</P>','1','<P>This block is displayed if a logged-in user visits the user creation page. It should be a self-contained bit of HTML letting the user know that they can\'t create an account while logged in. There are no special keys.</P>','Accounts','default','en'),('new_user_html','<form name=\"adduser\" method=\"post\" action=\"%%rootdir%%/\">\r\n<input type=\"hidden\" name=\"tool\" value=\"writeuser\">\r\n<input type=\"hidden\" name=\"op\" value=\"newuser\">\r\n<input type=\"hidden\" name=\"formkey\" value=\"%%formkey%%\">\r\n<table>  <tr>\r\n   <td colspan=\"2\" bgcolor=\"%%title_bgcolor%%\">%%title_font%%\r\n   <b>Create New User Account</b>%%title_font_end%%<br><br>\r\n   </td>\r\n  </tr>\r\n  <tr><td colspan=\"2\"><font color=\"#FF0000\"><h3><center>%%error%%</center></h3></font></td></tr>\r\n  <tr><td colspan=\"2\">%%norm_font%%<p>\r\nIn order to create an account (which is free), fill out this form. You will receive an email containing your username and autogenerated password, at the address you provide here. Use this data to login. It\'s that easy.\r\n</p><p>\r\nWhy is the password autogenerated? First, random passwords are typically more secure than non-random ones. Second, by requiring you to log in using a password we send you, we can make sure that the email address is valid. This makes it harder for malicious users to abuse the account creation system by creating an arbitrary number of accounts and spamming the site with stories or comments. If you do not like your autogenerated password, you can easily change it after logging in.\r\n</p><p>\r\nAgain, your password will be mailed to the email address you enter here, so it <b>must</b> work. Do NOT enter a spam-protected or fake email address. \r\n</p><p>\r\nIf you are concerned about privacy, this email does not have to be in any way traceable to you. We will never use the email you provide here for anything else, ever. All it needs to be is working, and accessible to you, at the time the account is created. \r\n</p><p>\r\n  Now get started, and we hope you enjoy %%sitename%%!\r\n</p>%%norm_font_end%%</td></tr>\r\n  <tr><td colspan=\"2\">&nbsp;</td></tr>\r\n  <tr>\r\n   <td>\r\n   %%norm_font%%\r\n   Please enter your desired username:<br>\r\n   %%norm_font_end%%\r\n   </td>\r\n   <td>\r\n   %%norm_font%%<input type=\"text\" name=\"nickname\" size=\"30\" value=\"%%uname%%\">%%norm_font_end%%<br>\r\n   </td>\r\n  </tr>\r\n   <td colspan=\"2\">\r\n   %%smallfont%%(Legal characters: a-z, A-Z, 0-9, space. Names may not start or end with a space, and may not contain more than one space in a row.)%%smallfont_end%%\r\n   </td>\r\n  </tr>\r\n  <tr>\r\n   <td>\r\n   %%norm_font%%\r\n   and a working email (this will never be made public!):<br>\r\n   <b><font color=\"#FF0000\">Check this for typos!</font></b>\r\n   %%norm_font_end%%\r\n   </td>\r\n   <td>\r\n   %%norm_font%%<input type=\"text\" NAME=\"email\" value=\"%%email%%\" size=\"30\">%%norm_font_end%%\r\n   </td>\r\n  </tr>\r\n<tr><td colspan=\"2\">\r\n%%BOX,reCAPTCHA%%\r\n</td>\r\n</tr>\r\n<tr><td colspan=\"2\" align=\"right\">%%norm_font%%%%signup_prefs%%<br><input type=\"submit\" value=\"Create Account!\" size=\"30\">%%norm_font_end%%</td></tr></table>\r\n</form>','1','<P>This block contains the explanation of the account creation process as well as the form the user fills in to create an account. It should be reasonably self-contained.  It must contain the following form elements:</P>\r\n<DL>\r\n <DT>FORM</DT>\r\n  <DD>The form should post to your site\'s rootdir.</DD>\r\n <DT>op</DT>\r\n  <DD>This should be a hidden field with a value of \"newuser\".</DD>\r\n <DT>tool</DT>\r\n  <DD>This should be a hidden field with a value of \"writeuser\".</DD>\r\n <DT>formkey</DT>\r\n  <DD>This should be a hidden field with a value of \"|formkey|\" (see special keys, below).</DD>\r\n <DT>nickname</DT>\r\n  <DD>This should be a text field with a default value of \"|uname|\" (see special keys, below).</DD>\r\n <DT>email</DT>\r\n  <DD>This should be a text field with a default value of \"|email|\" (see special keys, below).</DD>\r\n <DT>button</DT>\r\n  <DD>A submit button to send the fields in.</DD>\r\n</DL>\r\n<P>The following special keys are recognized:</P>\r\n<DL>\r\n <DT>error</DT>\r\n  <DD>Any error messages (such as invalid characters in the nickname field).</DD>\r\n <DT>uname</DT>\r\n  <DD>Usually blank; if there is an error with the email field, this is the nickname entered by the user.</DD>\r\n <DT>email</DT>\r\n  <DD>Usually blank; if there is an error with the nickname field, this is the email address entered by the user.</DD>\r\n <DT>formkey</DT>\r\n  <DD>A code-generated formkey used to hinder scripts trying to make large numbers of accounts.</DD>\r\n</DL>','General','default','en'),('new_user_is_advertiser','<P>You already have an account that is enabled for advertising. You must have arrived here in error. Please email %%local_email%% if you\'re having troubles with this site.</P>','1','<P>This block is displayed if a logged-in advertiser visits the advertiser account creation page. It should be a self-contained bit of HTML letting the user know that they already have an advertiser account. This only applies if the site control <B>req_extra_advertiser_info</B> is set to 1. There are no special keys.</P>','Accounts','default','en'),('next_page_link','<a class=\"light\" href=\"%%LINK%%\">%%norm_font%%Next %%maxstories%% >>%%norm_font_end%%</a>','1','<P>This block is the text of the link displayed at the bottom of the front and section index pages if there are more stories published earlier than those displayed. It should be self-contained HTML. The following special key is recognized:</P>\n<DL>\n <DT>maxstories</DT>\n  <DD>The value of the variable <B>maxstories</B>, or the user preference \"Number of story summaries to show\" if set.</DD>\n</DL>','General','default','en'),('next_previous_links','<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n<tr>\n<td>%%PREVIOUS_LINK%%</td>\n<td align=\"right\">%%NEXT_LINK%%</td>\n</tr>\n</table>',NULL,'<P>This block is used to create the next and previous page links at the top and bottom of the section index pages.</P>\nFIXME: not implemented correctly. Links won\'t disappear if not needed. Leave blank for now and it\'ll work.','General','default','en'),('norm_font','<font face=\"%%norm_font_face%%\" size=\"%%norm_font_size%%\">',NULL,'<P>This block is used extensively in the default install. It should be a complete opening tag, or blank. It must match the closing tag set in the block <B>norm_font_end</b>. The following special keys are recognised:</p>\n<DL>\n <DT>norm_font_face</DT>\n  <DD>The font face specification set in a user\'s prefs or, if not set, the default value for that preference as set in the User Preferences Admin Tool.</DD>\n <DT>norm_font_size</DT>\n  <DD>The font size specification set in a user\'s prefs or, if not set, the default value for that preference as set in the User Preferences Admin Tool.</DD>\n</DL>','Fonts','default','en'),('norm_font_end','</font>',NULL,'<P>This block is used extensively in the default install. It should be a closing FONT tag, or otherwise close the tag opened in the block <B>norm_font</B>.</P>','Fonts','default','en'),('no_body_txt','Comments >>','1','<P>This block is used as the text of the link leading to the full story and comments, when there is no story body, only an intro. If there is a story body, the block <B>readmore_txt</B> is used instead.</P>','Stories','default','en'),('no_submit_ad_perm','<TABLE BORDER=0 CELLPADDING=1 CELLSPACING=1 WIDTH=\"99%\"> \r\n<TR><TD bgcolor=\"%%title_bgcolor%%\">%%title_font%% Submit Ad Error %%title_font_end%%</TD></TR>\r\n<TR><TD >%%norm_font%% Sorry, but you must have a user account or login before you can submit ads on this site.  You may login using the box to your right.  To create an account you may go <a href=\"%%rootdir%%/newuser\">here</a>%%norm_font_end%%</TD></TR>\r\n</TABLE>\r\n','1','<P>This block is displayed if a user without the submit_ad perm (set in the Groups Admin Tool) tries to submit an ad. It should be customized depending on which criteria your site uses to determine who may submit advertisements.</P>','Ads','default','en'),('no_sw_pats','<a href=\"http://nosoftwarepatents.com/\"><img src=\"%%imagedir%%/noswpat90x40_2.jpg\"></a>','2','','general','default','en'),('paypal_canceled','We\'re sorry you decided to cancel your order.','1','<P>This block is displayed when an ad purchase paid via paypal is canceled. It should be self-contained HTML and should indicate that the order has been canceled.</P>','Payments','default','en'),('paypal_donate','<span><form action=\"https://www.paypal.com/cgi-bin/webscr\" method=\"post\">\r\n<input type=\"hidden\" name=\"cmd\" value=\"_xclick\">\r\n<input type=\"hidden\" name=\"business\" value=\"hulver@hulver.com\">\r\n<input type=\"hidden\" name=\"item_name\" value=\"HuSi\">\r\n<input type=\"hidden\" name=\"item_number\" value=\"Beer and Hookers\">\r\n<input type=\"hidden\" name=\"no_shipping\" value=\"1\">\r\n<input type=\"hidden\" name=\"return\" value=\"http://www.hulver.com/scoop/special/donate_thanks\">\r\n<input type=\"hidden\" name=\"no_note\" value=\"1\">\r\n<input type=\"hidden\" name=\"currency_code\" value=\"GBP\">\r\n<input type=\"hidden\" name=\"tax\" value=\"0\">\r\n<input type=\"image\" src=\"http://www.hulver.com/images/x_click_butcc_donate.gif\" name=\"submit\" alt=\"Make payments with PayPal - it\'s fast, free and secure!\">\r\n</form></span>','2','Paypal donation button','general','default','en'),('paypal_finished','Thank you for your order! hulver will soon review your ad to ensure that it meets our guidelines. You will receive a notice by email when your ad is reviewed. If it is approved, it will begin running immediately.\r\n','1','<P>This block is displayed when an ad purchase paid via paypal is completed. It should be self-contained HTML and should indicate that payment has been received and the advertisement is pending approval by an administrator.</P>','Payments','default','en'),('pending_list_title','Pending Stories','1','','','default','en'),('personal_calendar_title','%%nick%%\'s Personal Calendar View','1','<P>The title used when in a user\'s personal calendar view. The special key <B>nick</B> is replaced with the user\'s nickname.</P>','Calendars and Events','default','en'),('ping_template','%%doctype%%\r\n<HTML>\r\n<HEAD>\r\n%%stylesheet%%\r\n<TITLE>%%slogan%%</TITLE>\r\n</HEAD>\r\n<BODY>Pong!</body>\r\n</html>','2','A page template - no header, footer, or content. This must be a complete HTML page.','templates','default','en'),('pm_sendto_block','<a href=\"%%rootdir%%/pm_send?to_uid=%%uid%%\">Send %%nickname%% a private message</a><br />','2','','','default','en'),('poll_block','<!-- Poll Block -->\r\n<table width=\"100%\" border=\"0\" cellpadding=\"1\" cellspacing=\"0\">\r\n	<tr>\r\n		<td bgcolor=\"%%title_bgcolor%%\" colspan=\"2\">\r\n			%%title_font%%<b>%%title%%</b></font>\r\n		</td>\r\n	</tr><tr><td><br></td></tr>\r\n	%%poll_image%%\r\n</table>\r\n<!-- X Poll Block -->','1','<P>This block is used to format the poll results when displayed as the main content of the page. The following special keys are recognized:</P>\r\n<DL>\r\n <DT>title</DT>\r\n  <DD>The poll question</DD>\r\n <DT>poll_image</DT>\r\n  <DD>The poll results, with poll answers beside images representing the votes. The image file used is set in the block <B>poll_img</B>, and the width used to represent 100% is set in the block <B>poll_img_width</B>.</DD>\r\n</DL>','Polls','default','en'),('poll_form_multi','<INPUT type=\"checkbox\" name=\"is_multiple_choice\" value=\"1\"%%allow_multiple%%> Allow multiple selections in poll','1','Allow multiple choice portion of the poll edit form. Included if var \"allow_multiple_choice\" is on.','Polls','default','en'),('poll_form_question','%%last_update%%\r\n%%attached_to%%\r\n%%current%%\r\n%%hidden_form_input%%\r\n%%multiple_choice%%\r\n<p>\r\nPoll Question:<br>\r\n<INPUT type=\"text\" size=\"30\" name=\"question\" value=\"%%question%%\"><br><br>\r\nPoll Answers:<br>\r\n\r\n','1','','Polls','default','en'),('poll_img','pollbar.gif',NULL,'<P>This is the name of the file to use when building the poll image. The file should be in the images directory. The value of this block should not have any path information. The image is stretched horizontally to the desired width, so it should not have any horizontal detail that may be deformed.</P>','Polls','default','en'),('poll_img_width','300','','<P>This block determines the maximum width in pixels of the poll bar, and the width of the bar used for the poll option with 100% of the votes. All poll bar widths are percentages of this value corresponding to the percentage of votes the option received. It should be a number only.</P>','Polls','default','en'),('post_message','<P><FONT SIZE=\"+1\">Your entry has been automatically posted</FONT></P>','1','<P>This block is displayed below the story body when it has been auto-posted. It should be self-contained HTML.</P>','Stories','default','en'),('preview_amazonlogo_ad_template','<table border=\"0\" width=\"100%\">\r\n<tr><td class=\"textaddbody\" align=\"center\">%%TEXT1%%</td></tr>\r\n<tr><td>%%smallfont%%%%COMMENTS%%%%smallfont_end%%</td></tr>\r\n</table><p>','2','The template used for text ads.','advertising,amazon','default','en'),('preview_donate_ad_template','<table border=\"0\" width=\"100%\">\r\n<tr><td class=\"paidtextadtitle\">%%TITLE%%</td></tr>\r\n<tr><td class=\"paidtextadbody\">%%TEXT1%%</TD></tr>\r\n<tr><td class=\"paidtextadbody\">%%smallfont%%%%COMMENTS%%%%smallfont_end%%</td></tr>\r\n</table><p>','2','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</P>\r\n<DL>\r\n <DT>FILE_PATH</DT>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</DD>\r\n <DT>TEXT1</DT>\r\n  <DD>The text the ad sponsor entered in the text1 field.</DD>\r\n <DT>TEXT2</DT>\r\n  <DD>The text the ad sponsor entered in the text2 field.</DD>\r\n <DT>TITLE</DT>\r\n  <DD>The text the ad sponsor entered in the title field.</DD>\r\n <DT>LINK_URL</DT>\r\n  <DD>The URL of the page being advertised.</DD>\r\n <DT>SID</DT>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</DD>\r\n <DT>REDIRECT_URL</DT>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</DD>\r\n</DL><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</P>','Ads','default','en'),('preview_text_ad_template','<table border=\"0\" width=\"100%\">\r\n<tr><td class=\"paidtextadtitle\"><a href=\"%%LINK_URL%%\" title=\"%%AD_URL%%\">%%TITLE%%</a></td></tr>\r\n<tr><td class=\"paidtextadbody\">%%TEXT1%%</td></tr>\r\n</table><p>','2','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</P>\r\n<DL>\r\n <DT>FILE_PATH</DT>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</DD>\r\n <DT>TEXT1</DT>\r\n  <DD>The text the ad sponsor entered in the text1 field.</DD>\r\n <DT>TEXT2</DT>\r\n  <DD>The text the ad sponsor entered in the text2 field.</DD>\r\n <DT>TITLE</DT>\r\n  <DD>The text the ad sponsor entered in the title field.</DD>\r\n <DT>LINK_URL</DT>\r\n  <DD>The URL of the page being advertised.</DD>\r\n <DT>SID</DT>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</DD>\r\n <DT>REDIRECT_URL</DT>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</DD>\r\n</DL><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</P>','Ads','default','en'),('preview_wonderful_ad_template','%%project_wonderful_square%%','2','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</P>\r\n<DL>\r\n <DT>FILE_PATH</DT>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</DD>\r\n <DT>TEXT1</DT>\r\n  <DD>The text the ad sponsor entered in the text1 field.</DD>\r\n <DT>TEXT2</DT>\r\n  <DD>The text the ad sponsor entered in the text2 field.</DD>\r\n <DT>TITLE</DT>\r\n  <DD>The text the ad sponsor entered in the title field.</DD>\r\n <DT>LINK_URL</DT>\r\n  <DD>The URL of the page being advertised.</DD>\r\n <DT>SID</DT>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</DD>\r\n <DT>REDIRECT_URL</DT>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</DD>\r\n</DL><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</P>','Ads','default','en'),('prev_page_link','<a class=\"light\" href=\"%%LINK%%\">%%norm_font%%<< Previous %%maxstories%%%%norm_font_end%%</a>','1','<P>This block is the text of the link displayed at the top and bottom of the front and section index pages if there are more stories published more recently than those displayed. It should be self-contained HTML. The following special key is recognized:</P>\n<DL>\n <DT>maxstories</DT>\n  <DD>The value of the variable <B>maxstories</B>, or the user preference \"Number of story summaries to show\" if set.</DD>\n</DL>','General','default','en'),('primary_calendar_marker','<B>*</B>','1','<P>The text used to indicate that a calendar is the event\'s primary calendar in the admin event list.</P>','Calendars and Events','default','en'),('print_template','%%doctype%%\r\n<HTML>\r\n<HEAD>\r\n%%stylesheet%%\r\n<TITLE>%%sitename%% || %%subtitle%%</TITLE>\r\n%%site_logo%%\r\n</HEAD>\r\n<BODY>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<TABLE CLASS=\"mainindexcontent\">\r\n        <!-- Center content section -->\r\n        <TD CLASS=\"centercontent\">\r\n            %%CONTENT%%\r\n        </TD>\r\n        <!-- X center content section -->\r\n    </TR>\r\n    <!-- X main page block -->\r\n</TABLE>\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</BODY>\r\n</HTML>\r\n','2','Template used by the \"Print story\" op.','templates','default','en'),('project_wonderful_square','<!-- Beginning of Project Wonderful ad code: -->\r\n<!-- Ad box ID: 34967 -->\r\n<script type=\"text/javascript\">\r\n<!--\r\nvar d=document;\r\nd.projectwonderful_adbox_id = \"34967\";\r\nd.projectwonderful_adbox_type = \"4\";\r\nd.projectwonderful_foreground_color = \"\";\r\nd.projectwonderful_background_color = \"\";\r\n//-->\r\n</script>\r\n<script type=\"text/javascript\" src=\"http://www.projectwonderful.com/ad_display.js\"></script>\r\n<noscript><map name=\"admap34967\" id=\"admap34967\"><area href=\"http://www.projectwonderful.com/out_nojs.php?r=0&amp;c=0&amp;id=34967&amp;type=4\" shape=\"rect\" coords=\"0,0,125,125\" title=\"\" alt=\"\" target=\"_blank\" /></map>\r\n<table cellpadding=\"0\" border=\"0\" cellspacing=\"0\" width=\"125\" bgcolor=\"#ffffff\"><tr><td><img src=\"http://www.projectwonderful.com/nojs.php?id=34967&amp;type=4\" width=\"125\" height=\"125\" usemap=\"#admap34967\" border=\"0\" alt=\"\" /></td></tr><tr><td bgcolor=\"#ffffff\" colspan=\"1\"><center><a style=\"font-size:10px;color:#0000ff;text-decoration:none;line-height:1.2;font-weight:bold;font-family:Tahoma, verdana,arial,helvetica,sans-serif;text-transform: none;letter-spacing:normal;text-shadow:none;white-space:normal;word-spacing:normal;\" href=\"http://www.projectwonderful.com/advertisehere.php?id=34967&amp;type=4\" target=\"_blank\">Ads by Project Wonderful!  Your ad here, right now: $0</a></center></td></tr><tr><td colspan=1 valign=\"top\" width=125 bgcolor=\"#000000\" style=\"height:3px;font-size:1px;padding:0px;max-height:3px;\"></td></tr></table>\r\n</noscript>\r\n<!-- End of Project Wonderful ad code. -->','2','','Ads','default','en'),('rating_format','(<a class=\"light\" href=\"%%rootdir%%/comments/%%sid%%/%%cid%%?mode=alone;showrate=1#%%cid%%\">%%score%% / %%num_ratings%%</a>)',NULL,'<P>This block is used in the <B>comment</B> and <B>moderation_comment</B> blocks for the rating value display. This allows the entire rating value to disappear if the user has turned off ratings in their user preferences. The following special keys are recognized:</P>\r\n<DL>\r\n <DT>sid</DT>\r\n  <DD>The story ID of the comment.</DD>\r\n <DT>cid</DT>\r\n  <DD>The comment ID</DD>\r\n <DT>score</DT>\r\n  <DD>The averaged score earned by the comment, or \"none\"</DD>\r\n <DT>num_ratings</DT>\r\n  <DD>The number of people who have rated this comment.</DD>\r\n</DL>','Comments','default','en'),('readmore_txt','Full Story','1','<P>This block is used as the text of the link leading to the full story and comments, when there is a story body. If there is no story body, the block <B>no_body_txt</B> is used instead.</P>','Stories','default','en'),('removed_comment_body','<p><em>This comment has been deleted by %%nick%%</em></p>\r\n<!-- Yes %%nick%% really deleted this comment -->','1','<P>The body of a removed comment. One special key, nick, contains the nickname of the admin who removed the comment. If you have jokers on your site who may claim that their comments have been wiped, I recommend putting something in this block that users can normally not put in their comments, as an \"authenticity\" marker.</P>','Comments','default','en'),('removed_comment_subject','(Comment Deleted)','1','<P>The subject of a removed comment. One special key, nick, contains the nickname of the admin who removed the comment.</P>','Comments','default','en'),('renew_ad_message','Renew an ad.  Right here!  Today!','1','<P>This block is displayed on the ad renewal page. It should contain a message encouraging people to renew their ads. There are no special keys. Ad renewals are yet another unimplemented ad feature.</P>','Ads','default','en'),('renew_ad_no_permission','%%norm_font%% Sorry, but you cannot renew another person\'s advertisement.  Please choose an ad from <a href=\"%%rootdir%%/my/ads\">your ad list</a> to renew.%%norm_font_end%%','1','<P>This block is displayed if a user tries to renew somebody else\'s ad. It should contain a message indicating that a given account can only renew ads submitted by that same account. There are no special keys. Ad renewals are yet another unimplemented ad feature.</P>','Ads','default','en'),('renew_choose_ad','%%norm_font%% You need to choose an ad to renew.  Check <a href=\"%%rootdir%%/my/ads\">your ad listing page</a> to \r\nchoose an ad to renew. %%norm_font_end%%','1','<P>This block is displayed if a user tries to visit the ad renewal page without specifying which ad to renew. It should contain instructions for finding the ad renewal link. There are no special keys. Ad renewals are yet another unimplemented ad feature.</P>','Ads','default','en'),('required_pref_marker','<FONT color=\"#ff0000\">*</FONT>','1','','Accounts','default','en'),('right_boxes','		<TD VALIGN=\"top\" WIDTH=\"25%\">\r\n			<!-- BOX,main_menu -->\r\n                        %%BOX,user_box%%\r\n			%%BOX,hotlist_flex_box%%\r\n			%%BOX,admin_tools%%\r\n			%%BOX,poll_box%%\r\n			%%BOX,related_links%%\r\n			%%BOX,mod_stats%%\r\n			%%BOX,story_hit_box%%\r\n		</TD>\r\n','2','','','default','en'),('rsvp_form','<FORM name=\"event_rsvp\" action=\"%%rootdir%%/event/%%eid%%\" method=\"POST\">\r\n<FIELDSET>\r\n<LEGEND>RSVP</LEGEND>\r\n<INPUT type=\"checkbox\" name=\"attend\" value=\"1\">I will attend\r\n%%volunteer%%\r\n<BR><INPUT type=\"submit\" name=\"rsvp\" value=\"Send RSVP\">\r\n</FIELDSET>\r\n</FORM>','1','<P>The form shown on the event display page for users who have not yet replied via this form for RSVP. The special keys are:</P>\n<DL>\n <DT>eid</DT>\n  <DD>The event ID number</DD>\n <DT>volunteer</DT>\n  <DD>If the event owner indicated that volunteers are needed, the contents of <B>rsvp_volunteer_form</B> is inserted.</DD>\n</DL>','Calendars and Events','default','en'),('rsvp_list','<P>%%number%% people signed up.</P>\r\n<UL>\r\n%%attending%%\r\n</UL>','1','<P>This is displayed in place of the RSVP form for the event owner, so the number and names of people signed up (and volunteering) can be easily seen. The special keys are:</P>\n<DL>\n <DT>number</DT>\n  <DD>The total number of people signed up</DD>\n <DT>attending</DT>\n  <DD>The list of people who have signed up via the RSVP form, and whether or not they have offered to help out, sorted with volunteers first. Formatted using <B>rsvp_list_item</B></DD>\n</DL>','Calendars and Events','default','en'),('rsvp_list_item','  <LI><A href=\"%%rootdir%%/user/%%nick%%\">%%nick%%</A> volunteering? %%volunteer%%</LI>','1','<P>This is one item in the list of people who have indicated that they are coming via the RSVP form. It is used in the block <B>rsvp_list</B>. The special keys are:</P>\n<DL>\n <DT>nick</DT>\n  <DD>The user\'s nickname</DD>\n <DT>urlnick</DT>\n  <DD>The user\'s nickname, url-escaped</DD>\n <DT>volunteer</DT>\n  <DD>Whether or not, and when, the user has offered to volunteer. This is usually \"during\", \"prior\", or \"no\".</DD>\n</DL>','Calendars and Events','default','en'),('rsvp_received','<P>You have indicated that you\'re coming to this event</P>','1','<P>This is shown in place of the RSVP form when a user has submitted that form.</P>','Calendars and Events','default','en'),('rsvp_volunteer_email','%%owner_nick%%:\r\n\r\n%%volunteer_nick%% has just volunteered to help out at the \r\nevent %%title%%.\r\n<%%url%%>\r\n\r\n%%volunteer_nick%% can be reached at %%volunteer_email%%\r\n\r\n-- %%sitename%%','1','<P>This is the text of the email sent to an event owner when somebody uses the RSVP form and indicates that they wish to volunteer. Because this is an email and does not go through the same processing as a normal Scoop page, only the keys listed below may be used. The following special keys are used:</P>\n<DL>\n <DT>owner_nick</DT>\n  <DD>The nickname of the event owner</DD>\n <DT>volunteer_nick</DT>\n  <DD>The nickname of the volunteer</DD>\n <DT>url</DT>\n  <DD>The URL for the event display page</DD>\n <DT>volunteer_email</DT>\n  <DD>The volunteer\'s \"real email\"</DD>\n <DT>sitename</DT>\n  <DD>The contents of the Site Control sitename</DD>\n</DL>\n<P>Any defined event property may also be used.</P>','Calendars and Events','default','en'),('rsvp_volunteer_form','<BR><INPUT type=\"checkbox\" name=\"volunteer\" value=\"during\">I would like to volunteer the day of the event\r\n<BR><INPUT type=\"checkbox\" name=\"volunteer\" value=\"before\">I would like to volunteer prior to the day of the event\r\n<BR><B>Note:</B> by signing up to volunteer, you give %%sitename%% permission to send your \"real email\" as set in <A href=\"%%rootdir%%/my/prefs/Protected\">your user preferences</A> to the organizer of this event.\r\n','1','<P>This is the portion of the RSVP form displayed when the event owner has indicated that volunteers would be appreciated. Since the system emails the volunteer\'s realemail to the event owner, and the realemail is generally considered secret information, a notice informing the user of this is strongly recommended.</P>','Calendars and Events','default','en'),('scoop_intro','<TABLE WIDTH=\"100%\" BORDER=1 CELLPADDING=2 CELLSPACING=0>\n	<TR>\n		<TD BGCOLOR=\"#006699\">\n			%%box_title_font%%Where to learn about Scoop%%box_title_font_end%%\n		</TD>\n	</TR>\n	<TR>\n		<TD>\n			%%norm_font%%\n<P>Holy Crap! You have your own <A HREF=\"http://scoop.kuro5hin.org\">Scoop</A> site now. Well, there\'s too many features for me to explain right here, but I can give you some places to look for help and whatnot.</P>\n<P>The main development site is at <A HREF=\"http://scoop.kuro5hin.org\">scoop.kuro5hin.org</A>. This contains links to all the other stuff, so poke around a little.</P>\n<P>For immediate help and assistance from the Scoop code monkeys, join the <A HREF=\"http://sourceforge.net/mail/?group_id=4901\">scoop-help mailing list</A>. This is practically a requirement for a pleasant Scoop administrative experience, as Scoop is rather complicated and it isn\'t always obvious where to find things.</P>\n<P>To help figure things out, there is a <A HREF=\"http://scoop.kuro5hin.org/guide/\">Scoop Admin Guide</A> which can hopefully answer most of your questions.</P>\n<P>Other things of note:</P>\n<UL>\n<LI> Many Scoop developers can often be found on IRC, channel #scoop at irc.slashnet.org.  If nobody is in that channel, try #kuro5hin\n<LI> The <A HREF=\"http://sourceforge.net/project/?group_id=4901\">main Sourceforge page</A> has some information on the project\n<LI> The latest code is always <A HREF=\"http://scoop.versionhost.com/viewcvs.cgi/\">in CVS</A> (username and password are both \"anonymous\")\n<LI> You can look at a convenient <A HREF=\"http://scoop.kuro5hin.org/special/sites\">list of other Scoop sites</A> to see what folks are doing with it\n</UL>\n			%%norm_font_end%%\n		</TD>\n	</TR>\n</TABLE>\n','1','<P>This block contains introductory information and is displayed in the left column of the front page when you first install Scoop. There is useful information on where to get help in this block, so make a note of it before deleting. This block should not be displayed on a live site, because its content is of no interest except to the administrator.</P>','General','default','en'),('search_archive','<INPUT type=\"checkbox\" name=\"search_archive\" value=\"yes\" %%CHECKED%%> Search Archive','2','','search','default','en'),('search_form_amazon','<!-- BEGIN search_form_amazon-->\r\n%%search_script%%\r\n<form NAME=\"Search\" ACTION=\"%%rootdir%%/\" METHOD=\"GET\">\r\n<input TYPE=\"hidden\" NAME=\"op\" VALUE=\"search\">\r\n<input TYPE=\"hidden\" NAME=\"offset\" VALUE=\"%%OFFSET%%\">\r\n<input TYPE=\"hidden\" NAME=\"old_count\" VALUE=\"%%COUNT%%\">\r\n<input TYPE=\"hidden\" NAME=\"type\" VALUE=\"user\">\r\n%%norm_font%%\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=0>\r\n<TR BGCOLOR=\"%%title_bgcolor%%\">\r\n  <TD ALIGN=\"center\" CLASS=\"sectiontitle\">Search Amazon</TD>\r\n</TR>\r\n<TR><TD style=\"background-color: #EEEEEE\" align=\"center\">\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=5>\r\n<TR>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></TD>\r\n<TD ALIGN=\"center\"><b><A HREF=\"%%rootdir%%/special/AmazonSearch\">Amazon</a></b></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/GoogleSearch\">Google</a></TD>\r\n</TR>\r\n</TABLE>\r\n</TD></TR>\r\n</TABLE>\r\n\r\n</FORM>\r\n<p>\r\n%%BOX,amazon_search_select%%\r\n<!-- END search_form_amazon-->','2','','amazon,search','default','en'),('search_form_author','<!-- BEGIN search_form_author-->\r\n%%search_script%%\r\n<form NAME=\"Search\" ACTION=\"%%rootdir%%/\" METHOD=\"GET\">\r\n<input TYPE=\"hidden\" NAME=\"op\" VALUE=\"search\">\r\n<input TYPE=\"hidden\" NAME=\"offset\" VALUE=\"%%OFFSET%%\">\r\n<input TYPE=\"hidden\" NAME=\"old_count\" VALUE=\"%%COUNT%%\">\r\n<input TYPE=\"hidden\" NAME=\"type\" VALUE=\"author\">\r\n%%norm_font%%\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=0>\r\n<TR BGCOLOR=\"%%title_bgcolor%%\">\r\n  <TD COLSPAN=2 ALIGN=\"center\" CLASS=\"sectiontitle\">Search for stories by specific Authors</TD>\r\n</TR>\r\n<TR><TD style=\"background-color: #EEEEEE\" align=\"center\" colspan=2>\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=5>\r\n<TR>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></TD>\r\n<TD ALIGN=\"center\"><b><A HREF=\"%%rootdir%%/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></b></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/AmazonSearch\">Amazon</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/GoogleSearch\">Google</a></TD>\r\n</TR>\r\n</TABLE>\r\n</TD></TR>\r\n<TR>\r\n <TD>\r\n<B>Author name:</B> <INPUT TYPE=\"text\" NAME=\"string\" VALUE=\"%%SEARCH_STRING%%\" SIZE=30>\r\n<INPUT TYPE=\"submit\" NAME=\"search\" VALUE=\"Search\"></td><td>%%PHRASE_SEARCH%% %%SEARCH_ARCHIVE%%</td>\r\n</tr><tr>\r\n<td COLSPAN=2>\r\n<B>In:</B> %%TOPIC_SELECT%% %%SECTION_SELECT%%\r\n</td>\r\n</tr>\r\n<tr>\r\n<td align=\"left\">\r\n\r\n<B>Results:</B>\r\n%%RESULT_SELECT%% %%STORY_VIEW%%</td>\r\n<td>\r\n%%RELEVANCE_RADIO%%</td>\r\n<tr><td colspan=2 style=\"border-width: 0px 0px 1px 0px; border-style: solid; border-color: black\"> </td>\r\n<tr><td colspan=2>\r\n <CENTER>\r\n %%PAGE_BUTTONS%%\r\n </CENTER>\r\n \r\n </TD>\r\n</TR>\r\n<TR>\r\n <TD colspan=2>%%norm_font%%Found %%RESULT_COUNT%% results.<P>\r\n %%RESULTS%%\r\n %%norm_font_end%%</TD>\r\n</TR>\r\n<TR>\r\n <TD ALIGN=\"center\" colspan=2>%%norm_font%%\r\n %%PAGE_BUTTONS%%\r\n %%norm_font_end%%\r\n </TD>\r\n</TR>\r\n</TABLE>\r\n%%norm_font_end%%\r\n</FORM>\r\n<!-- END search_form_author-->','2','','search','default','en'),('search_form_comment','<!-- BEGIN search_form_comment-->\r\n%%search_script%%\r\n<form NAME=\"Search\" ACTION=\"%%rootdir%%/\" METHOD=\"GET\">\r\n<input TYPE=\"hidden\" NAME=\"op\" VALUE=\"search\">\r\n<input TYPE=\"hidden\" NAME=\"offset\" VALUE=\"%%OFFSET%%\">\r\n<input TYPE=\"hidden\" NAME=\"old_count\" VALUE=\"%%COUNT%%\">\r\n<input TYPE=\"hidden\" NAME=\"type\" VALUE=\"comment\">\r\n%%norm_font%%\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=0>\r\n<TR BGCOLOR=\"%%title_bgcolor%%\">\r\n  <TD ALIGN=\"center\" CLASS=\"sectiontitle\" COLSPAN=2>Search comments</TD>\r\n</TR>\r\n<TR><TD style=\"background-color: #EEEEEE\" align=\"center\" colspan=2>\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=5>\r\n<TR>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></TD>\r\n<TD ALIGN=\"center\"><b><A HREF=\"%%rootdir%%/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></b></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/AmazonSearch\">Amazon</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/GoogleSearch\">Google</a></TD>\r\n</TR>\r\n</TABLE>\r\n</TD></TR>\r\n<TR>\r\n <TD>\r\n\r\n<B>Containing:</B> <INPUT TYPE=\"text\" NAME=\"string\" VALUE=\"%%SEARCH_STRING%%\" SIZE=30>\r\n<INPUT TYPE=\"submit\" NAME=\"search\" VALUE=\"Search\">\r\n</td><td>%%PHRASE_SEARCH%% %%SEARCH_ARCHIVE%% </td>\r\n</tr>\r\n<tr><td>\r\n<B>Results:</B>\r\n%%RESULT_SELECT%%\r\n%%HIDDEN_VIEW%%\r\n</td><td>\r\n%%RELEVANCE_RADIO%%\r\n</td></tr>\r\n<tr><td style=\"border-width: 0px 0px 1px 0px; border-style: solid; border-color: black\" colspan=2> </td></tr>\r\n<tr><td colspan=2>\r\n <CENTER>\r\n %%PAGE_BUTTONS%%\r\n </CENTER>\r\n %%norm_font_end%%\r\n </TD>\r\n</TR>\r\n<TR>\r\n <TD colspan=2>%%norm_font%%Found %%RESULT_COUNT%% results.<P>\r\n %%RESULTS%%\r\n %%norm_font_end%%</TD>\r\n</TR>\r\n<TR>\r\n <TD ALIGN=\"center\" colspan=2>%%norm_font%%\r\n %%PAGE_BUTTONS%%\r\n %%norm_font_end%%\r\n </FORM>\r\n </TD>\r\n</TR>\r\n</TABLE>\r\n%%norm_font_end%%\r\n</form>\r\n<!-- END search_form_comment-->','2','','search','default','en'),('search_form_comment_by','<!-- BEGIN search_form_comment_by-->\r\n%%search_script%%\r\n<form NAME=\"Search\" ACTION=\"%%rootdir%%/\" METHOD=\"GET\">\r\n<input TYPE=\"hidden\" NAME=\"op\" VALUE=\"search\">\r\n<input TYPE=\"hidden\" NAME=\"offset\" VALUE=\"%%OFFSET%%\">\r\n<input TYPE=\"hidden\" NAME=\"old_count\" VALUE=\"%%COUNT%%\">\r\n<input TYPE=\"hidden\" NAME=\"type\" VALUE=\"comment_by\">\r\n%%norm_font%%\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=0>\r\n<TR BGCOLOR=\"%%title_bgcolor%%\">\r\n  <TD ALIGN=\"center\" CLASS=\"sectiontitle\" COLSPAN=2>Search for comments by</TD>\r\n</TR>\r\n<TR>\r\n<TD style=\"background-color: #EEEEEE\" align=\"center\" colspan=2>\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=5>\r\n<TR>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></TD>\r\n<TD ALIGN=\"center\"><b><A HREF=\"%%rootdir%%/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></b></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/AmazonSearch\">Amazon</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/GoogleSearch\">Google</a></TD>\r\n</TR>\r\n</TABLE>\r\n</TD></TR>\r\n<TR>\r\n <TD>\r\n\r\n<B>Comment Author:</B> <INPUT TYPE=\"text\" NAME=\"string\" VALUE=\"%%SEARCH_STRING%%\" SIZE=30>\r\n<INPUT TYPE=\"submit\" NAME=\"search\" VALUE=\"Search\">\r\n</td><td>%%SEARCH_ARCHIVE%% </td>\r\n</tr>\r\n<tr><td>\r\n<B>Results:</B>\r\n%%RESULT_SELECT%%\r\n%%HIDDEN_VIEW%%\r\n</td><td>\r\n \r\n</td></tr>\r\n<tr><td style=\"border-width: 0px 0px 1px 0px; border-style: solid; border-color: black\" colspan=2> </td></tr>\r\n<tr><td colspan=2>\r\n <CENTER>\r\n %%PAGE_BUTTONS%%\r\n </CENTER>\r\n %%norm_font_end%%\r\n </TD>\r\n</TR>\r\n<TR>\r\n <TD colspan=2>%%norm_font%%Found %%RESULT_COUNT%% results.<P>\r\n %%RESULTS%%\r\n %%norm_font_end%%</TD>\r\n</TR>\r\n<TR>\r\n <TD ALIGN=\"center\" colspan=2>%%norm_font%%\r\n %%PAGE_BUTTONS%%\r\n %%norm_font_end%%\r\n </FORM>\r\n </TD>\r\n</TR>\r\n</TABLE>\r\n%%norm_font_end%%\r\n</form>\r\n<!-- END search_form_comment_by-->','2','','search','default','en'),('search_form_default','<!-- BEGIN search_form_default-->\r\n%%search_script%%\r\n<p>\r\n        <form name=\"Search\" action=\"%%rootdir%%/\" method=\"GET\">\r\n        <input type=\"hidden\" name=\"op\" value=\"search\">\r\n        <input type=\"hidden\" name=\"offset\" value=\"%%OFFSET%%\">\r\n        <input type=\"hidden\" name=\"old_count\" value=\"%%COUNT%%\">\r\n        <input type=\"hidden\" name=\"type\" value=\"story\"><p>\r\n		<table WIDTH=\"100%\" border=\"0\" cellpadding=\"5\" cellspacing=\"0\">\r\n                <tr bgcolor=\"%%title_bgcolor%%\">\r\n                        <td align=\"center\" CLASS=\"sectiontitle\">Search %%sitename%%</td>\r\n                </tr>\r\n                <tr>\r\n                        <td style=\"background-color: #EEEEEE; border-width: 0px 0px 1px 0px; border-style: solid; border-color: black\" align=\"center\">%%norm_font%%\r\n<table WIDTH=\"100%\" border=\"0\" cellpadding=\"5\" cellspacing=\"5\">\r\n<tr>\r\n<td align=\"center\"><b><a href=\"%%rootdir%%/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></b></td>\r\n<td align=\"center\"><a href=\"%%rootdir%%/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></td>\r\n<td align=\"center\"><a href=\"%%rootdir%%/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></td>\r\n<td align=\"center\"><a href=\"%%rootdir%%/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></td>\r\n<td align=\"center\"><a href=\"%%rootdir%%/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></td>\r\n<td align=\"center\"><a href=\"%%rootdir%%/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></td>\r\n<td align=\"center\"><a href=\"%%rootdir%%/special/AmazonSearch\">Amazon</a></td>\r\n<td align=\"center\"><a href=\"%%rootdir%%/special/GoogleSearch\">Google</a></td>\r\n</tr>\r\n</table>\r\n</td>\r\n<tr>\r\n<td align=\"center\">\r\n                        <input type=\"text\" name=\"string\" value=\"%%SEARCH_STRING%%\" size=\"30\">\r\n                        <input type=\"submit\" name=\"search\" value=\"Search Stories\"><BR>\r\n                        %%norm_font_end%%\r\n                        </td>\r\n                </tr>\r\n</table>\r\n</form>\r\n</p>\r\n<p> \r\n<p> \r\n<p> \r\n<p> \r\n<p> \r\n<!-- END search_form_default-->\r\n','2','','search','default','en'),('search_form_google','<!-- BEGIN search_form_google-->\r\n%%search_script%%\r\n<form NAME=\"Search\" ACTION=\"%%rootdir%%/\" METHOD=\"GET\">\r\n<input TYPE=\"hidden\" NAME=\"op\" VALUE=\"search\">\r\n<input TYPE=\"hidden\" NAME=\"offset\" VALUE=\"%%OFFSET%%\">\r\n<input TYPE=\"hidden\" NAME=\"old_count\" VALUE=\"%%COUNT%%\">\r\n<input TYPE=\"hidden\" NAME=\"type\" VALUE=\"user\">\r\n%%norm_font%%\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=0>\r\n<TR BGCOLOR=\"%%title_bgcolor%%\">\r\n  <TD ALIGN=\"center\" CLASS=\"sectiontitle\">Google Search</TD>\r\n</TR>\r\n<TR><TD style=\"background-color: #EEEEEE\" align=\"center\">\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=5>\r\n<TR>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/AmazonSearch\">Amazon</a></TD>\r\n<TD ALIGN=\"center\"><b><A HREF=\"%%rootdir%%/special/GoogleSearch\">Google</a></b></TD>\r\n</TR>\r\n</TABLE>\r\n</TD></TR>\r\n</TABLE>\r\n\r\n</FORM>\r\n<p>\r\n\r\n\r\n<!-- Search Google -->\r\n<center>\r\n<FORM method=GET action=\'http://www.google.com/custom\'>\r\n<TABLE bgcolor=\'#FFFFFF\'><tr><td nowrap=\'nowrap\' valign=\'top\' align=\'center\' height=\'32\'>\r\n<A HREF=\'http://www.google.com/\'>\r\n<IMG SRC=\'http://www.google.com/logos/Logo_25wht.gif\' border=0 ALT=\'Google\' align=\'absmiddle\'></A>\r\n<INPUT TYPE=text name=q size=25 maxlength=255 value=\'\'>\r\n<INPUT type=submit name=sa VALUE=\'Search\'>\r\n\r\n\r\n<input type=hidden name=client value=\'pub-8028642453271155\'>\r\n<input type=hidden name=forid value=\'1\'>\r\n<input type=hidden name=ie value=\'ISO-8859-1\'>\r\n<input type=hidden name=oe value=\'ISO-8859-1\'>\r\n<input type=hidden name=cof value=\'GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:50;LW:68;L:http://www.hulver.com/images/topics/husi-topic.png;S:http://www.hulver.com/scoop/special/GoogleSearch;FORID:1;\'>\r\n<input type=hidden name=hl value=\'en\'>\r\n</td></tr></TABLE>\r\n</FORM>\r\n</center>\r\n<!-- Search Google -->\r\n\r\n<!-- END search_form_google-->','2','','search','default','en'),('search_form_polls','<!-- BEGIN search_form_polls-->\r\n%%search_script%%\r\n<form NAME=\"Search\" ACTION=\"%%rootdir%%/\" METHOD=\"GET\">\r\n<input TYPE=\"hidden\" NAME=\"op\" VALUE=\"search\">\r\n<input TYPE=\"hidden\" NAME=\"offset\" VALUE=\"%%OFFSET%%\">\r\n<input TYPE=\"hidden\" NAME=\"old_count\" VALUE=\"%%COUNT%%\">\r\n<input TYPE=\"hidden\" NAME=\"type\" VALUE=\"polls\">\r\n%%norm_font%%\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=0>\r\n<TR BGCOLOR=\"%%title_bgcolor%%\">\r\n  <TD ALIGN=\"center\" CLASS=\"sectiontitle\">Search polls</TD>\r\n</TR>\r\n<TR><TD style=\"background-color: #EEEEEE\" align=\"center\">\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=5>\r\n<TR>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></TD>\r\n<TD ALIGN=\"center\"><b><A HREF=\"%%rootdir%%/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></b></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/AmazonSearch\">Amazon</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/GoogleSearch\">Google</a></TD>\r\n</TR>\r\n</TABLE>\r\n</TD></TR>\r\n<TR>\r\n <TD>\r\n\r\n<B>Containing:</B> <INPUT TYPE=\"text\" NAME=\"string\" VALUE=\"%%SEARCH_STRING%%\" SIZE=30>\r\n<INPUT TYPE=\"submit\" NAME=\"search\" VALUE=\"Search\"><BR>\r\n</tr><tr>\r\n<td>\r\n<B>Results:</B>\r\n%%RESULT_SELECT%%</td>\r\n<tr><td style=\"border-width: 0px 0px 1px 0px; border-style: solid; border-color: black\"> </td>\r\n<tr><td>\r\n <CENTER>\r\n %%PAGE_BUTTONS%%\r\n </CENTER>\r\n \r\n </TD>\r\n</TR>\r\n<TR>\r\n <TD>%%norm_font%%Found %%RESULT_COUNT%% results.<P>\r\n %%RESULTS%%\r\n %%norm_font_end%%</TD>\r\n</TR>\r\n<TR>\r\n <TD ALIGN=\"center\">%%norm_font%%\r\n %%PAGE_BUTTONS%%\r\n %%norm_font_end%%\r\n </TD>\r\n</TR>\r\n</TABLE>\r\n%%norm_font_end%%\r\n</FORM>\r\n<!-- END search_form_polls-->','2','','search','default','en'),('search_form_story','<!-- BEGIN search_form_story-->\r\n%%search_script%%\r\n<form NAME=\"Search\" ACTION=\"%%rootdir%%/\" METHOD=\"GET\">\r\n<input TYPE=\"hidden\" NAME=\"op\" VALUE=\"search\">\r\n<input TYPE=\"hidden\" NAME=\"offset\" VALUE=\"%%OFFSET%%\">\r\n<input TYPE=\"hidden\" NAME=\"old_count\" VALUE=\"%%COUNT%%\">\r\n<input TYPE=\"hidden\" NAME=\"type\" VALUE=\"story\">\r\n%%norm_font%%\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=0>\r\n<TR BGCOLOR=\"%%title_bgcolor%%\">\r\n  <TD COLSPAN=2 ALIGN=\"center\" CLASS=\"sectiontitle\">Search Stories on %%sitename%%</TD>\r\n</TR>\r\n<TR><TD style=\"background-color: #EEEEEE\" align=\"center\" colspan=2>\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=5>\r\n<TR>\r\n<TD ALIGN=\"center\"><b><A HREF=\"%%rootdir%%/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></b></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/AmazonSearch\">Amazon</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/GoogleSearch\">Google</a></TD>\r\n</TR>\r\n</TABLE>\r\n</TD></TR>\r\n<TR>\r\n <TD>\r\n<B>Containing:</B> <INPUT TYPE=\"text\" NAME=\"string\" VALUE=\"%%SEARCH_STRING%%\" SIZE=30>\r\n<INPUT TYPE=\"submit\" NAME=\"search\" VALUE=\"Search\"></td><td>%%PHRASE_SEARCH%% %%SEARCH_ARCHIVE%%</td>\r\n</tr><tr>\r\n<td COLSPAN=2>\r\n<B>In:</B> %%TOPIC_SELECT%% %%SECTION_SELECT%%<BR>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td align=\"left\">\r\n\r\n<B>Results:</B>\r\n%%RESULT_SELECT%% %%STORY_VIEW%%</td>\r\n<td>\r\n%%RELEVANCE_RADIO%%</td>\r\n<tr><td colspan=2 style=\"border-width: 0px 0px 1px 0px; border-style: solid; border-color: black\"> </td>\r\n<tr><td colspan=2>\r\n <CENTER>\r\n %%PAGE_BUTTONS%%\r\n </CENTER>\r\n \r\n </TD>\r\n</TR>\r\n<TR>\r\n <TD colspan=2>%%norm_font%%Found %%RESULT_COUNT%% results.<P>\r\n %%RESULTS%%\r\n %%norm_font_end%%</TD>\r\n</TR>\r\n<TR>\r\n <TD ALIGN=\"center\" colspan=2>%%norm_font%%\r\n %%PAGE_BUTTONS%%\r\n %%norm_font_end%%\r\n </TD>\r\n</TR>\r\n</TABLE>\r\n%%norm_font_end%%\r\n</FORM>\r\n<!-- END search_form_story-->','2','','search','default','en'),('search_form_user','<!-- BEGIN search_form_user-->\r\n%%search_script%%\r\n<form NAME=\"Search\" ACTION=\"%%rootdir%%/\" METHOD=\"GET\">\r\n<input TYPE=\"hidden\" NAME=\"op\" VALUE=\"search\">\r\n<input TYPE=\"hidden\" NAME=\"offset\" VALUE=\"%%OFFSET%%\">\r\n<input TYPE=\"hidden\" NAME=\"old_count\" VALUE=\"%%COUNT%%\">\r\n<input TYPE=\"hidden\" NAME=\"type\" VALUE=\"user\">\r\n%%norm_font%%\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=0>\r\n<TR BGCOLOR=\"%%title_bgcolor%%\">\r\n  <TD ALIGN=\"center\" CLASS=\"sectiontitle\">Search for users</TD>\r\n</TR>\r\n<TR><TD style=\"background-color: #EEEEEE\" align=\"center\">\r\n<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=5 CELLSPACING=5>\r\n<TR>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></TD>\r\n<TD ALIGN=\"center\"><b><A HREF=\"%%rootdir%%/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></b></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/AmazonSearch\">Amazon</a></TD>\r\n<TD ALIGN=\"center\"><A HREF=\"%%rootdir%%/special/GoogleSearch\">Google</a></TD>\r\n</TR>\r\n</TABLE>\r\n</TD></TR>\r\n<TR>\r\n <TD>\r\n\r\n<B>User name or email address contains:</B> <INPUT TYPE=\"text\" NAME=\"string\" VALUE=\"%%SEARCH_STRING%%\" SIZE=30>\r\n<INPUT TYPE=\"submit\" NAME=\"search\" VALUE=\"Search\"><BR>\r\n</tr><tr>\r\n<td>\r\n<B>Results:</B>\r\n%%RESULT_SELECT%%</td>\r\n<tr><td style=\"border-width: 0px 0px 1px 0px; border-style: solid; border-color: black\"> </td>\r\n<tr><td>\r\n <CENTER>\r\n %%PAGE_BUTTONS%%\r\n </CENTER>\r\n \r\n </TD>\r\n</TR>\r\n<TR>\r\n <TD>%%norm_font%%Found %%RESULT_COUNT%% results.<P>\r\n %%RESULTS%%\r\n %%norm_font_end%%</TD>\r\n</TR>\r\n<TR>\r\n <TD ALIGN=\"center\">%%norm_font%%\r\n %%PAGE_BUTTONS%%\r\n %%norm_font_end%%\r\n </TD>\r\n</TR>\r\n</TABLE>\r\n%%norm_font_end%%\r\n</FORM>\r\n<!-- END search_form_user-->','2','','search','default','en'),('search_hidden','<INPUT type=\"checkbox\" name=\"hidden_comments\" value=\"show\" %%CHECKED%%> View Hidden Comments','2','','search','default','en'),('search_new_template','%%doctype%%\r\n<html>\r\n<head>\r\n%%stylesheet%%\r\n<title>%%sitename%% || %%subtitle%%</title>\r\n%%site_logo%%\r\n<script type=\"text/javascript\">\r\nfunction toggleSearch()\r\n{\r\n	var el1, el2;\r\n	if( !document.getElementById )	return;\r\n	if( !( el1 = document.getElementById( \'srchAdv\' ) ) || !( el2 = document.getElementById( \'srchSimple\' ) ) )	return;\r\n	if( el1.style.display == \'none\' )\r\n	{\r\n		el1.style.display	= \'block\';\r\n		el2.style.display	= \'none\';\r\n	}\r\n	else\r\n	{\r\n		el1.style.display	= \'none\';\r\n		el2.style.display	= \'block\';\r\n	}\r\n	return false;\r\n}\r\nfunction toggleBetween( force )\r\n{\r\n	var el1, el2;\r\n	if( !document.getElementById )	return;\r\n	if( !( el1 = document.getElementById( \'h\' ) ) || !( el2 = document.getElementById( \'srchBetween\' ) ) )	return;\r\n	var val	= el1.options[el1.selectedIndex].value;\r\n	if( force || val != 10 )	el2.style.display	= \'none\';\r\n	else						el2.style.display	= \'block\';\r\n}\r\n</script>\r\n<style>.searchbox	{ width	: 280px;} .smalltxt	{ font-size:0.85em}</style>\r\n</head>\r\n<body>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<div class=\"container\">\r\n<div class=\"main\">\r\n<form name=\"Search\" action=\"%%rootdir%%\" method=\"get\">\r\n        <input name=\"op\" value=\"search\" type=\"hidden\">\r\n        <input name=\"offset\" value=\"0\" type=\"hidden\">\r\n        <input name=\"old_count\" value=\"30\" type=\"hidden\">\r\n\r\n        <input name=\"type\" value=\"story\" type=\"hidden\">\r\n		<table border=\"0\" cellpadding=\"0\" cellspacing=\"5\" width=\"100%\">\r\n                <tr bgcolor=\"#eeeeee\">\r\n                        <td class=\"sectiontitle\" align=\"center\">Search Hulver\'s site</td>\r\n                </tr>\r\n                </table>\r\n\r\n<div id=\"srchSimple\"> \r\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"5\" width=\"100%\">\r\n        <tr bgcolor=\"#eeeeee\">\r\n	<td align=\"center\" style=\"background-color: #eeeeee; border-width: 0px 0px 1px 0px; border-style: solid; border-color: black\">\r\n		<table border=\"0\" cellpadding=\"5\" cellspacing=\"0\" width=\"100%\">\r\n		<tr>\r\n		<td align=\"center\"><b><a href=\"http://www.hulver.com/scoop/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></b></td>\r\n		<td align=\"center\"><a href=\"http://www.hulver.com/scoop/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></td>\r\n		<td align=\"center\"><a href=\"http://www.hulver.com/scoop/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></td>\r\n		<td align=\"center\"><a href=\"http://www.hulver.com/scoop/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></td>\r\n		<td align=\"center\"><a href=\"http://www.hulver.com/scoop/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></td>\r\n		<td align=\"center\"><a href=\"http://www.hulver.com/scoop/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></td>\r\n\r\n		<td align=\"center\"><a href=\"http://www.hulver.com/scoop/special/AmazonSearch\">Amazon</a></td>\r\n		<td align=\"center\"><a href=\"http://www.hulver.com/scoop/special/GoogleSearch\">Google</a></td>\r\n		</tr>\r\n		</table>\r\n	</td>\r\n</tr>\r\n<tr>\r\n		<td align=\"center\">\r\n                        <input name=\"string\" value=\"\" size=\"30\" type=\"text\">\r\n                        <input name=\"search\" value=\"Search Stories\" type=\"submit\">\r\n                        <a href=\"advanced_search.html\" onclick=\"return toggleSearch()\">Advanced Search</a><br>\r\n                </td>\r\n\r\n</tr>\r\n</table>\r\n</div> <!--srchsimple-->\r\n\r\n<div id=\"srchAdv\" style=\"display:none\">\r\n<table cellpadding=\"0\" cellspacing=\"5\" border=\"0\">\r\n<tr>\r\n	<td align=\"right\">Search for</td>\r\n\r\n	<td><input name=\"a\" id=\"a\" value=\"\" size=\"30\" type=\"text\" class=\"searchbox\" /></td>\r\n</tr>\r\n<tr>\r\n	<td></td>\r\n	<td class=\"smalltxt\">\r\n		<input type=\"radio\" name=\"b\" id=\"b\" value=\"or\" checked=\"true\" />any word\r\n		<input type=\"radio\" name=\"b\" id=\"b\" value=\"and\" /> all words\r\n	</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\">Comments by</td>\r\n\r\n	<td><input name=\"d\" id=\"d\" value=\"\" size=\"30\" type=\"text\" class=\"searchbox\" /></td>\r\n</tr>\r\n<tr>\r\n	<td></td>\r\n	<td class=\"smalltxt\">Leave blank to search all comments</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\">Diaries</td>\r\n	<td><input name=\"e\" id=\"e\" value=\"\" size=\"30\" type=\"text\" class=\"searchbox\" /></td>\r\n</tr>\r\n\r\n<tr>\r\n	<td></td>\r\n	<td class=\"smalltxt\">Leave blank to search all diaries</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\">Sections</td>\r\n	<td>\r\n		<select name=\"g\" id=\"g\" class=\"searchbox\">\r\n			<option	value=\"1\">All Sections</option>\r\n\r\n			<option	value=\"2\">Public Diaries</option>\r\n			<option	value=\"3\">Hole</option>\r\n			<option	value=\"3\">Section Stories</option>\r\n			<option	value=\"3\">Furries</option>\r\n			<option	value=\"3\">Travel</option>\r\n			<option	value=\"3\">Whatnot</option>\r\n\r\n			<option	value=\"3\">...</option>\r\n		</select>\r\n	</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\">Posted</td>\r\n	<td>\r\n		<select name=\"h\" id=\"h\" class=\"searchbox\" onchange=\"toggleBetween()\">\r\n			<option	value=\"1\">Since the dawn of HuSi</option>\r\n\r\n			<option	value=\"1\">Last 24 hours</option>\r\n			<option	value=\"1\">Last 48 hours</option>\r\n			<option	value=\"1\">Last 7 days</option>\r\n			<option	value=\"1\">Last 30 days</option>\r\n			<option	value=\"10\">Between...</option>\r\n		</select>\r\n\r\n	</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\"></td>\r\n	<td>\r\n		<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" id=\"srchBetween\" style=\"display:none\">\r\n		<tr>\r\n			<td>\r\n				<select name=\"j\" id=\"j\">\r\n\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"1\">1</option>\r\n					<option	value=\"2\">2</option>\r\n					<option	value=\"3\">..</option>\r\n					<option	value=\"31\">31</option>\r\n				</select>\r\n			</td>\r\n\r\n			<td>\r\n				<select name=\"k\" id=\"k\">\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"1\">jan</option>\r\n					<option	value=\"2\">feb</option>\r\n					<option	value=\"3\">..</option>\r\n					<option	value=\"12\">dec</option>\r\n\r\n				</select>\r\n			</td>\r\n			<td>\r\n				<select name=\"l\" id=\"l\">\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"2003\">2003</option>\r\n					<option	value=\"2004\">..</option>\r\n					<option	value=\"2005\">2005</option>\r\n\r\n				</select>\r\n			</td>\r\n			<td>&nbsp;\r\n			and\r\n			&nbsp;</td>\r\n			<td>\r\n				<select name=\"m\" id=\"m\">\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"1\">1</option>\r\n\r\n					<option	value=\"2\">2</option>\r\n					<option	value=\"3\">..</option>\r\n					<option	value=\"31\">31</option>\r\n				</select>\r\n			</td>\r\n			<td>\r\n				<select name=\"n\" id=\"n\">\r\n\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"1\">jan</option>\r\n					<option	value=\"2\">feb</option>\r\n					<option	value=\"3\">..</option>\r\n					<option	value=\"12\">dec</option>\r\n				</select>\r\n			</td>\r\n\r\n			<td>\r\n				<select name=\"o\" id=\"o\">\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"1\">2003</option>\r\n					<option	value=\"1\">..</option>\r\n					<option	value=\"1\">2005</option>\r\n				</select>\r\n\r\n			</td>\r\n		</tr>\r\n		</table>\r\n	</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\"></td>\r\n	<td>\r\n		<input name=\"search\" value=\"Search Stories\" type=\"submit\">\r\n		<input name=\"clear\" value=\"Clear\" type=\"reset\" onclick=\"toggleBetween(1)\">\r\n\r\n		<a href=\"advanced_search.html\" onclick=\"return toggleSearch()\">Simple Search</a>\r\n	</td>\r\n</tr>\r\n\r\n</table>\r\n</div><!--srchAdv-->\r\n</form>\r\n</div><!--main-->\r\n\r\n<div class=\"menu\">\r\n%%BOX,user_box%%\r\n%%BOX,hotlist_flex_box%%\r\n%%BOX,admin_tools%%\r\n%%BOX,comment_controls%%\r\n</div><!--menu-->\r\n</div><!--container-->\r\n<!-- X Main layout -->\r\n<p></p>\r\n\r\n<!-- END search_form_default-->\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</body>\r\n</html>\r\n','2','<P>This block is used to build the story and comment display pages.  It must be a full HTML page. The special keys recognised are:</P>\r\n<DL>\r\n <DT>subtitle</DT>\r\n  <DD>This is replaced with an appropriate subtitle indicating which page is currently being viewed.</DD>\r\n <DT>dynamicmode_javascript</DT>\r\n  <DD>This is replaced with javascript for the dynamic comment display if the page template is being used for comment display.</DD>\r\n <DT>STORY</DT>\r\n  <DD>This is replaced with either the poll display or the story display, if either are being viewed.</DD>\r\n <DT>CONTENT</DT>\r\n  <DD>This is replaced with any other content specific to the page being requested.  It is provided by the function or box named in the Ops Admin Tool which handles the op (the first pseudo-directory) of the page.</DD>\r\n</DL>','Page Templates,search','default','en'),('search_page_buttons','<TABLE WIDTH=\"100%\" CELLPADDING=0 CELLSPACING=0 BORDER=0>\r\n                <TR>\r\n                <TD>%%norm_font%%\r\n                %%LAST_PAGE_BUTTON%%\r\n                %%norm_font_end%%\r\n                </TD>\r\n                <TD ALIGN=\"right\">\r\n                %%norm_font%%\r\n                %%NEXT_PAGE_BUTTON%%\r\n                %%norm_font_end%%\r\n                </TD>\r\n                </TR>\r\n</TABLE>','2','','search','default','en'),('search_script','<script language=\"JavaScript\">\r\n<!--\r\nfunction linkSubmit(searchType)\r\n{\r\n  document.forms[\'Search\'].type.value=searchType;\r\n  document.forms[\'Search\'].submit();\r\n  return false;\r\n}\r\n//-->\r\n</script>','2','','search','default','en'),('search_story_view','<INPUT type=checkbox name=\"story_view\" value=\"long\" %%CHECKED%%> View story summaries','2','','search','default','en'),('sectiononlystory_bg','#eeeeee','1','<P>This block is used as a row background colour in the Story List Admin Tool, for those stories that are published to section only, including ad stories and user diaries. This should be a hex colour value including the #, such as #000000 for black.','Colours','default','en'),('section_links','<a class=\"light\" href=\"%%rootdir%%/section/Diary\">Diaries</a>%%BOX,section_hole%%%%BOX,section_cellar%%<br><a class=\"light\" href=\"%%rootdir%%/section/__all__\">Everything</a><br><a class=\"light\" href=\"%%rootdir%%/whos_online\">Who\'s Online?</a><br><a class=\"light\" href=\"%%rootdir%%/special/faq\">FAQ</a> / \r\n<a class=\"light\" href=\"http://wiki.hulver.com/\">Help</a>\r\n','1','<P>This block contains the links to the different sections available on the site. It is typically displayed in the page header but can be used anywhere. Any sections that exist but aren\'t linked here are typically hard for visitors to find, so don\'t forget to update it when you change your sections.</p>','General','default','en'),('selectbox_pref','<DIV class=\"item\">\r\n<P><B>%%required%%%%title%%:</B> %%control%%\r\n<BR>%%description%%</P>\r\n</DIV>','1','<P>The preference item template generally used for selectboxes. This should be a self-contained bit of HTML as it is used to display a single user preference, both on the user info page and the preferences edit forms. The following special keys are recognised:</P>\n<DL>\n <DT>required</DT>\n  <DD>If the preference is required, the contents of <B>required_pref_marker</B>, otherwise blank</DD>\n <DT>title</DT>\n  <DD>The displayed title of the preference, as set in the User Preferences Admin Tool</DD>\n <DT>control</DT>\n  <DD>On the preferences edit form, this is the form field required for the preference, as set in the User Preferences Admin Tool. On the user info page, this is the value of the preference</DD>\n <DT>description</DT>\n  <DD>On the preferences edit form, this is the description as entered in the User Preferences Admin Tool. On the user info page, this is not displayed.</DD>\n <DT>allowed_html</DT>\n  <DD>If the preference supports HTML, displays the \"Allowed HTML\" string.</DD>\n</DL>','Accounts','default','en'),('share','<div style=\"padding: 5px;\">\r\n<!--\r\n<script type=\"text/javascript\">function fbs_click() {u=\'%%url%%\';t=document.title;window.open(\'http://www.facebook.com/sharer.php?u=\'+encodeURIComponent(u)+\'&t=\'+encodeURIComponent(t),\'sharer\',\'toolbar=0,status=0,width=626,height=436\');return false;}</script>\r\n-->\r\n<style> html .fb_share_link { padding:2px 0 0 20px; height:16px; background:url(http://static.ak.fbcdn.net/rsrc.php/zTPL2/m1/hash/4273uaqa.gif) no-repeat top left; }</style>\r\n<a href=\"http://www.facebook.com/share.php?u=%%url%%\" onclick=\"return fbs_click()\" target=\"_blank\" class=\"fb_share_link\">Share on Facebook</a></div>\r\n\r\n<div style=\"padding: 5px;\">\r\n<a href=\"http://twitter.com/share\" class=\"twitter-share-button\" data-count=\"horizontal\" data-via=\"hulver\">Tweet</a><script type=\"text/javascript\" src=\"http://platform.twitter.com/widgets.js\"></script></div>\r\n','2','Contents of the share box.\r\n<p><b>Special controls</b></p>\r\n<p>url - Url of the story\r\n<p>nick - Story author\r\n<p>title - Story title\r\n<p>shorttitle - Twitter length story title','general','default','en'),('share_old','<div style=\"padding: 5px;\">\r\n<!--\r\n<script>function fbs_click() {u=\'%%url%%\';t=document.title;window.open(\'http://www.facebook.com/sharer.php?u=\'+encodeURIComponent(u)+\'&t=\'+encodeURIComponent(t),\'sharer\',\'toolbar=0,status=0,width=626,height=436\');return false;}</script>\r\n-->\r\n<style> html .fb_share_link { padding:2px 0 0 20px; height:16px; background:url(http://static.ak.fbcdn.net/rsrc.php/zTPL2/m1/hash/4273uaqa.gif) no-repeat top left; }</style>\r\n<a href=\"http://www.facebook.com/share.php?u=%%url%%\" onclick=\"return fbs_click()\" target=\"_blank\" class=\"fb_share_link\">Share on Facebook</a></div>\r\n\r\n<div style=\"padding: 5px;\">\r\n<!--\r\n<script>function twit_click() {t=\'%%shorttitle%% - %%url%%\';window.open(\'http://twitter.com/home?status=\'+encodeURIComponent(t),\'\',\'\');return false;}</script>\r\n-->\r\n<a href=\"http://twitter.com/home?status=%%shorttitle%% - %%url%%\" onclick=\"return twit_click()\" target=\"_blank\" style=\"text-decoration:none;\" title=\"Post to Twitter\"><img src=\"%%imagedir%%/topics/twitter_s.gif\"> Post to Twitter</a></div>\r\n','2','Contents of the share box.\r\n<p><b>Special controls</b></p>\r\n<p>url - Url of the story\r\n<p>nick - Story author\r\n<p>title - Story title\r\n<p>shorttitle - Twitter length story title','general','default','en'),('site_logo','<link rel=\"icon\" href=\"%%imagedir%%/husi_ico.gif\" type=\"image/gif\">\r\n%%BOX,syndication_link%%\r\n<link rel=\"stylesheet\" href=\"/jquery/css/ui-lightness/jquery-ui-1.7.2.custom.css\">\r\n<script type=\"text/javascript\" src=\"/jquery/js/jquery-1.3.2.min.js\"></script>\r\n<script type=\"text/javascript\" src=\"/jquery/js/jquery-ui-1.7.2.custom.min.js\"></script>\r\n%%jquery_scripts%%','2','','general','default','en'),('site_logo','<link rel=\"icon\" href=\"%%imagedir%%/husi_ico.gif\" type=\"image/gif\">\r\n','2','','general','mobile','en'),('slogan','%%BOX,slogan_box%%',NULL,'<P>This block is used in the browser\'s title bar. It should contain a witty saying that describes your site and should not contain the name of the site or any HTML formatting commands. It is only used on the site\'s index pages.</P>','General','default','en'),('slogans','Step AWAY from the keyboard!\r\nA community where they don\'t troll newbies\r\nThe Home of Lonely White K5ian Geeks Who Browse Teh Intarweb A Lot\r\nfascist Nazi editor atreides HQ\r\nNortherners can admin scoop, too\r\nbecause you\'re worth a four digit uid\r\nwe don\'t need no clever slogans\r\nBeware the Admins\r\nNo Soliciting\r\nOur Mods Are Armed\r\nPants optional\r\nI want my badger dead. Not sick, not dying, dead.\r\nCheese is an Antidepressant\r\nBecause cows have feelings too\r\nIf it\'s too loud you\'re too old\r\nIt burns when we pee\r\nExtremely Tedious\r\nA discussion board dedicated to the Hussite movement of the 16th century\r\nMerely a front for the hole\r\nBecause we\'re afraid to quit our jobs.\r\nTechnology trolls and lowbrow culture, from trenchmouths.\r\nTitle Error #41226\r\nIt\'s not clear who\'s trolling whom.\r\nMind the Gap\r\nBecause children are our future\r\nBut this time next year we\'re going to have a new server Rodders.\r\nhot load of wordy jism','2','<P>This block is used in the browser\'s title bar. It\'s referenced by the box slogan_box, and a line is chosen at random. It should not contain the name of the site or any HTML formatting commands. It is only used on the site\'s index pages.</P>','General','default','en'),('smallfont','<FONT FACE=\"arial, Helvetica, Sans-Serif\" SIZE=2>','1','<P>This block should be a complete opening FONT tag. It must match the closing tag set in the block <B>smallfont_end</B>.</P>','Fonts','default','en'),('smallfont_end','</FONT>','1','<P>This block should be a closing FONT tag, or otherwise close the tag opened in the block <B>smallfont</B>.</P>','Fonts','default','en'),('special_edit_delete','<input type=\"checkbox\" name=\"delete\" value=\"1\" /> Delete this page<br />\r\n','1','Delete page line for Special page edit form.','Admin Pages','default','en'),('special_edit_form','<form name=\"special\" action=\"%%rootdir%%/admin/special\" method=\"post\" enctype=\"multipart/form-data\">\r\n<div class=\"title\">Edit Special Pages</div>\r\n\r\n<div class=\"error\">%%msg%%</div>\r\n\r\n<div>%%preview%%</div>\r\n\r\n<div>\r\n<b>Page:</b> %%page_list%% <input type=\"submit\" name=\"get\" value=\"Get Page\" />\r\n<br /><br />\r\n<b>Page ID:</b><br />\r\n<input type=\"text\" name=\"pageid\" value=\"%%pageid%%\" size=\"25\" />\r\n<br /><br />\r\n<b>Title:</b><br />\r\n<input type=\"text\" name=\"title\" value=\"%%title%%\" size=\"40\" />\r\n<br /><br />\r\n<b>Description:</b><br />\r\n<textarea cols=\"50\" rows=\"3\" name=\"description\" wrap=\"soft\">%%description%%</textarea>\r\n<br /><br />\r\n<b>Content:</b><br />\r\n<textarea cols=\"50\" rows=\"25\" name=\"content\" wrap=\"soft\">%%content%%</textarea><br />\r\n%%upload_page%%\r\n<br /><br />\r\n<b>Options:</b><br />\r\n<input type=\"checkbox\" name=\"direct_link\" value=\"1\"%%directlink_checked%% /> Create direct page link (i.e. http://example.com/pageid)<br />\r\n<input type=\"checkbox\" name=\"html_check\" value=\"1\"%%chkhtml_checked%% /> Check the HTML of this page<br />\r\n%%spellcheck%%\r\n%%delete%%\r\n<br /><br />\r\n<input type=\"submit\" name=\"write\" value=\"Save Page\"> <input type=\"reset\" />\r\n</div>\r\n</form>','1','The special page editing form.\r\n<p>\r\nKeys:\r\n<ul>\r\n<li> |msg|: For error or success messages\r\n<li> |preview|: When looking at a page, the view page link. Formatted with special_edit_preview\r\n<li> |page_list|: Select list of special pages. \r\n<li> |delete|: Delete page checkbox item. Formatted with special_edit_delete\r\n<li> |pageid|: The current page ID\r\n<li> |title|: The current page title\r\n<li> |description|: The current page description\r\n<li> |content|: the current page content\r\n<li> |upload_page|: The upload content form, if available\r\n<li> |directlink_checked|: Selected indicator for the direct-link options\r\n<li> |chkhtml_checked|: Selected indicator for the check html option\r\n<li> |spellcheck|: Spellcheck option form, if available\r\n</ul>','Admin Templates','default','en'),('special_edit_preview','View <a href=\"%%rootdir%%/special/%%pageid%%\" target=\"new\">%%title%%</a> (opens in new window)\r\n<br /><br />','1','Preview line for special page editing form.\r\n<p>\r\nKeys:\r\n<ul>\r\n<li> |pageid|: The page\'s ID for linking.\r\n<li> |title|: The page\'s title.\r\n</ul>','Admin Pages','default','en'),('special_edit_spellcheck','<input type=\"checkbox\" name=\"spell_check\" value=\"1\"%%splchk_checked%% /> Spellcheck this page<br />','1','Spellcheck option for special page edit form.\r\n<p>\r\nKeys: \r\n<ul>\r\n<li> |splchk_checked|: Checked indicator\r\n</ul>','Admin Pages','default','en'),('special_edit_upload','%%upload_form%%','1','Formatting for upload form for special page edit form.\r\n<p>\r\nKeys:\r\n<ul>\r\n<li> |upload_form|: The actual form to include.\r\n</ul>','Admin Pages','default','en'),('special_page_layout','<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH=100%>\n  <TR>\n    <TD\nBGCOLOR=\"%%title_bgcolor%%\">%%title_font%%<B>%%title%%</B>%%title_font_end%%</TD>\n  </TR>\n  <TR><TD>&nbsp;</TD></TR>\n  <TR>\n<TD>%%norm_font%%%%content%%%%norm_font_end%%</TD>\n  </TR>\n</TABLE>','1','<P>This is the structure all pages created in the Special Pages admin tool are formatted with. The special keys are:</P>\n<DL>\n <DT>title</DT>\n  <DD>The title of the special page, as set in the Special Pages admin tool</DD>\n <DT>content</DT>\n  <DD>The content of the special page, as set in the Special Pages admin tool</DD>\n</DL>','Page Templates','default','en'),('special_template','%%doctype%%\r\n<html>\r\n<head>\r\n%%stylesheet%%\r\n<title>%%sitename%% || %%subtitle%%</title>\r\n%%site_logo%%\r\n</head>\r\n<body>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout -->\r\n\r\n<div class=\"container\">\r\n\r\n<div class=\"main\">\r\n<div class=\"sectiontitle\">%%TITLE%%</div><!--title-->\r\n%%CONTENT%%\r\n</div><!--main-->\r\n<div class=\"menu\">\r\n%%BOX,user_box%%\r\n%%BOX,hotlist_flex_box%%\r\n%%BOX,admin_tools%%\r\n</div><!--menu-->\r\n</div><!--container-->\r\n<!-- X Main layout -->\r\n<p></p>\r\n%%footer%%\r\n</body>\r\n</html>','2','<P>This block is for the special pages.  It must be a full HTML page.  The special keys recognised are:</P>\r\n<DL>\r\n <DT>subtitle</DT>\r\n  <DD>This is replaced with an appropriate subtitle indicating which page is currently being viewed.</DD>\r\n <DT>TITLLE</DT>\r\n  <DD>This is the title of the special page.</DD>\r\n <DT>CONTENT</DT>\r\n  <DD>This is replaced with the special page content.</DD>\r\n</DL>','Page Templates','default','en'),('spellcheck_form_item','        <INPUT TYPE=\"submit\" NAME=\"preview\" VALUE=\"Spellcheck\"  onClick=\"return (openSpellChecker());\">\r\n','1','<P>This is the form element displayed when spellcheck is available. There is one special key, checked, which makes the checkbox pre-checked or not, depending on user action or preferences.</P>','Comments','default','en'),('spell_err','<font color=\"red\">','1','<P>This block is used to format misspelled words if the spellchecking system is installed and active. It should be a complete opening font tag or other formatting tag. It should match its closing tag set in the block <B>spell_err_end</B>.</P>','Fonts','default','en'),('spell_err_end','</font>','1','<P>This block is used to format misspelled words if the spellchecking system is installed and active. It should be a closing tag for whatever is in the block <B>spell_err</B>.</P>','Fonts','default','en'),('spell_suggest_script','<script type=\"text/javascript\" src=\"/speller/spellChecker.js\"></script>\r\n\r\n<script type=\"text/javascript\">\r\n// \r\n// openSpellChecker()\r\n//\r\n// this function is an example that illustrates the various ways you can invoke\r\n// the the Speller Pages spell-checking process\r\n//\r\nfunction openSpellChecker() {\r\n	\r\n	// Pass in the text inputs or textarea inputs that you \r\n	// want to spell-check to the object\'s constructor,\r\n	// then call the openChecker() method.\r\n	var speller = new spellChecker();\r\n	var spellerInputs = new Array();\r\n        if( document.editstory) {\r\n	for( var i = 0 ; i < document.editstory.elements.length; i++ ) {\r\n		if( document.editstory.elements[i].type.match( /^text/) ) {\r\n			spellerInputs[spellerInputs.length] = document.editstory.elements[i];\r\n		}\r\n	}\r\n        }\r\n        if( document.postcomment ) {\r\n	for( var i = 0 ; i < document.postcomment.elements.length; i++ ) {\r\n		if( document.postcomment.elements[i].type.match( /^text/) ) {\r\n			spellerInputs[spellerInputs.length] = document.postcomment.elements[i];\r\n		}\r\n	}\r\n        }\r\n	speller.textInputs = spellerInputs;\r\n	speller.openChecker();\r\n\r\n	return false;\r\n\r\n}\r\n\r\n</script>','2','','general','default','en'),('story_already_post_msg','<P><B>This story has already been posted. It must have gone up while you were voting. Thanks for your vote anyway!</B></P>','1','<P>This message is displayed when a user has just voted on a story that was posted after they started reading it but before they voted. There are no special keys.</P>','Stories','default','en'),('story_archived_msg','	<TR>\r\n		<TD align=\"center\">\r\n<B>This story has been archived. No new comments may be posted</B>		</TD>\r\n	</TR>\r\n','2','Message shown when an archived story is displayed. This block replaces the special var |story_archived| when an archived story is displayed.','general','default','en'),('story_autopost_message','<P><B>You were the last vote. We\'ve considered the votes and comments, and decided the story should be %%status%%. Thank you!</B></P>','1','<P>This message is displayed when a user has just voted and the auto-post calculations have been triggered. The special key <B>status</B> will contain either \"posted\" or \"hidden\", depending on the auto-post calculation results.','Stories','default','en'),('story_body','<div class=\"storystuff\">%%bodytext%%</div>','2','<P>This block is used to format the body (extended copy only) of a story. It should be self-contained HTML. It recognizes one special key, bodytext, which is replaced with the formatted contents of the extended copy field of the story.</P>','Stories','cellar','en'),('story_body','<div class=\"storystuff\">%%bodytext%%</div>','2','<P>This block is used to format the body (extended copy only) of a story. It should be self-contained HTML. It recognizes one special key, bodytext, which is replaced with the formatted contents of the extended copy field of the story.</P>','Stories','crap','en'),('story_body','<div class=\"storystuff\">%%bodytext%%</div>','1','<P>This block is used to format the body (extended copy only) of a story. It should be self-contained HTML. It recognizes one special key, bodytext, which is replaced with the formatted contents of the extended copy field of the story.</P>','Stories','default','en'),('story_delete_message','Story %%sid%% deleted.','1','','Stories','default','en'),('story_dumped_message','<P><b>You were the last vote,</b> and the voters have decided that this story will be hidden. Thank you for voting.</P>','1','<P>This message is displayed when a user has just voted and that vote caused the story to reach the hide threshold. There are no special keys.</P>','Stories','default','en'),('story_edit_dept','<tr>\r\n<td>department:</td>\r\n<td><INPUT TYPE=\"text\" NAME=\"dept\" VALUE=\"%%dept%%\" SIZE=50></td>\r\n</tr>','1','','Stories','default','en'),('story_edit_editqueue','<tr>\r\n<td></td>\r\n<td><INPUT TYPE=\"checkbox\" NAME=\"edit_in_queue\" VALUE=\"1\" %%check%%> Request editorial feedback</td>\r\n</tr>\r\n','1','','Stories','default','en'),('story_edit_edittxt','<br>INSERT <B>[ED]</B> to create an \"[editor\'s note]\"','1','','Stories','default','en'),('story_edit_notes','<TR>\r\n  <TD>\r\n    special functions:\r\n  </td>\r\n  <td>\r\n    INSERT <B>[UPDATE]</B> to create an \"[Update]\"<br>\r\n    INSERT <B>[ED]</B> to create an \"[editor\'s note]\"\r\n  </TD>\r\n</TR>','1','','Stories','default','en'),('story_edit_spellcheck','<tr>\r\n<td valign=\"top\">spellcheck:</td>\r\n<td valign=\"top\"><INPUT TYPE=\"checkbox\" NAME=\"spellcheck\" VALUE=\"on\"%%check%%></td>\r\n</tr>\r\n','1','','Admin Pages','default','en'),('story_edit_tags','<tr>\r\n<td valign=\"top\">tags (separate with a ,):</td>\r\n<td valign=\"top\"><input type=\"text\" name=\"tags\" value=\"%%value%%\" size=\"50\"></td>\r\n</tr>','1','Field for tag input in story edit form. This only shows up if the Site Control <B>use_tags</B> is set. \r\n<p>\r\nSpecial keys:\r\n<ul><li> value: the list of tags, as a comma-delimited string</ul>','Stories,Tags','default','en'),('story_edit_timeupdate','<tr>\r\n<td valign=\"top\">update timestamp:</td>\r\n<td valign=\"top\"><input type=\"checkbox\" name=\"timeupdate\" value=\"now\"></td>\r\n</tr>','1','','Stories','default','en'),('story_edit_updatetxt','<br>INSERT <B>[UPDATE]</B> to create an \"[Update]\"','1','','Stories','default','en'),('story_edit_upload','<tr>\r\n  <td>&nbsp;</td>\r\n  <td>%%form%%</td>\r\n</tr>','1','Story submit form element for file uploads. Special key |form| will be replaced with the form, if used.','','default','en'),('story_event_link','Attached to event <A href=\"%%rootdir%%/event/%%eid%%\">%%title%%</A>\r\n','1','<P>This is the text placed in the story_summary block if the story is attached to an event. Any defined event property may be used.</P>','Calendars and Events','default','en'),('story_hide_message','Story %%sid%% hidden.','1','','Stories','default','en'),('story_info','<!-- Story info -->\r\n\r\n<div class=\"storyinfo\">\r\n%%story_info%%\r\n%%story_archived%%\r\n</div>\r\n<!-- X Story info -->\r\n\r\n','1','<P>This block displays information about the story and links to some of the things you can do. It recognizes one special key, story_info, which is replaced with the story name, number and type of comments, and the \'post a comment\' and \'edit\' links as permissions allow.</P>','Stories','default','en'),('story_list_title','Story List','1','','','default','en'),('story_mod_bg','#EEEEEE','1','<P>This block is used as a row background colour in the story voting queue. It is applied to stories in the voting queue that the user has not yet voted on. It should be a hex colour value, including the #.</P>','Colours','default','en'),('story_nav_bar','<div class=\"storynavbar\">\r\n%%last_link%% %%seperator%% %%next_link%%\r\n</div><br>','2','This block contains the HTML for the story navigation bar (see disable_story_navbar and story_nav_bar_sections).<p>\r\nSpecial variables are lastlink, nextlink and seperator.','Stories','cellar','en'),('story_nav_bar','<div class=\"storynavbar\">\r\n%%last_link%% %%seperator%% %%next_link%%\r\n</div><br>','2','This block contains the HTML for the story navigation bar (see disable_story_navbar and story_nav_bar_sections).<p>\r\nSpecial variables are lastlink, nextlink and seperator.','Stories','crap','en'),('story_nav_bar','<div class=\"storynavbar\">\r\n%%last_link%% %%seperator%% %%next_link%%\r\n</div><br>','2','This block contains the HTML for the story navigation bar (see disable_story_navbar and story_nav_bar_sections).<p>\r\nSpecial variables are lastlink, nextlink and seperator.','Stories','default','en'),('story_nav_bg','#EEEEEE','1','<P>This block is used as the background colour for the story navigation bar, which provides links to the next and previous stories at the bottom of the current story body. It should be a hex colour value, including the #.</P>','Colours','default','en'),('story_post_message','<P><B>You\'re the straw that broke the camel\'s back!</B><BR>Your vote put this story over the threshold, and it should now appear on the %%where%% page. Enjoy!</P>','1','<P>This message is displayed when a user has just voted on a story and that vote caused the story to reach the post threshold. The special key <B>where</B> is replaced by either \"front\" or \"section\", depending on how the votes were cast.</P>','Stories','default','en'),('story_right_boxes','		<div class=\"menu\">\r\n			<!-- BOX,main_menu -->\r\n                        %%BOX,ad_box,1%%\r\n                        %%BOX,user_box%%\r\n			%%BOX,hotlist_flex_box%%\r\n			%%BOX,admin_tools%%\r\n			%%BOX,poll_box%%\r\n			%%BOX,related_links%%\r\n			%%BOX,amazon_products%%\r\n			%%BOX,story_hit_box%%\r\n			%%BOX,comment_controls_user%%\r\n		</div>','2','','','cellar','en'),('story_right_boxes','		<div class=\"menu\">\r\n			<!-- BOX,main_menu -->\r\n                        %%BOX,user_box%%\r\n			%%BOX,hotlist_flex_box%%\r\n			%%BOX,admin_tools%%\r\n			%%BOX,poll_box%%\r\n			%%BOX,related_links%%\r\n			%%BOX,amazon_products%%\r\n			%%BOX,story_hit_box%%\r\n			%%BOX,comment_controls_user%%\r\n		</div>','2','','','crap','en'),('story_right_boxes','		<div class=\"menu\">\r\n			<!-- BOX,main_menu -->\r\n                        %%BOX,ad_box,1%%\r\n                        %%BOX,user_box%%\r\n                        %%BOX,share%%\r\n			%%BOX,hotlist_flex_box%%\r\n			%%BOX,admin_tools%%\r\n			%%BOX,poll_box%%\r\n			%%BOX,related_links%%\r\n			%%BOX,amazon_products%%\r\n			%%BOX,trackback%%\r\n			%%BOX,mod_stats%%\r\n			%%BOX,story_vote%%\r\n			%%BOX,story_hit_box%%\r\n			%%BOX,comment_controls_user%%\r\n		</div>\r\n','2','','','default','en'),('story_separator','<hr>','2','<P>This block is placed between the <B>story_summary</B> and <B>story_body</B> blocks when building the story page. It can contain any HTML and is usually used when visual separation between the two parts of the story is wanted.</P>','Stories','cellar','en'),('story_separator','<hr>','2','<P>This block is placed between the <B>story_summary</B> and <B>story_body</B> blocks when building the story page. It can contain any HTML and is usually used when visual separation between the two parts of the story is wanted.</P>','Stories','crap','en'),('story_separator','<hr>\r\n','1','<P>This block is placed between the <B>story_summary</B> and <B>story_body</B> blocks when building the story page. It can contain any HTML and is usually used when visual separation between the two parts of the story is wanted.</P>','Stories','default','en'),('story_spam_vote_msg','<P><B>Your vote was recorded for consideration.</B></P>','1','<P>This message is displayed when a user has pressed the \"Spam\" button on a story in the edit queue. There are no special keys.</P>','Stories','default','en'),('story_summary','<!-- story_summary -->\r\n\r\n<div class=\"storysummary\">\r\n<div class=\"storytitle\">\r\n<span class=\"printicon\"><a href=\"%%rootdir%%/print/%%sid%%\"><img src=\"%%imagedir%%/printer.gif\" width=\"17\" height=\"14\" alt=\"Print Story\"></a></span>\r\n<span class=\"hotlist\">%%hotlist%%</span>\r\n%%title%%\r\n</div>\r\n\r\n<div class=\"storyintro_info\">\r\n<div class=\"topicimg\">%%topic_img%%</div>\r\nBy %%info%% (%%time%%) %%tags%%</div>\r\n\r\n<div class=\"storyintro\">\r\n%%introtext%% \r\n</div>\r\n<br>\r\n<div class=\"storystats\">\r\n%%stats%% %%readmore%%\r\n</div>\r\n</div>\r\n<p>\r\n<!-- X story_summary -->','2','<P>This block is used to format the story headlines and introtext, both on the index pages and the story pages. It should be a self-contained bit of HTML that lays out the story\'s information. The following special keys are recognized:</P>\r\n<DL>\r\n <DT>info</DT>\r\n  <DD>The author\'s name and the story\'s \"department\" (if used)</DD>\r\n <DT>title</DT>\r\n  <DD>The story\'s title</DD>\r\n <DT>introtext</DT>\r\n  <DD>The formatted contents of the story\'s introtext field</DD>\r\n <DT>hotlist</DT>\r\n  <DD>The link to either add or remove the story to the user\'s hotlist. Blank for anonymous users and stories that haven\'t been published yet.</DD>\r\n <DT>topic_img</DT>\r\n  <DD>The topic image, linked to the search results for that topic.</DD>\r\n <DT>topic_text</DT>\r\n  <DD>The alt text for the topic image as a text link, linked to the search results for that topic.</DD>\r\n <DT>time</DT>\r\n  <DD>The localized time the story was posted.</DD>\r\n <DT>sid</DT>\r\n  <DD>The story ID; can be used in custom links.</DD>\r\n <DT>section_icon</DT>\r\n  <DD>The file name of the section icon; can be used in an IMG tag to display an icon.</DD>\r\n <DT>section_title</DT>\r\n  <DD>The title of the section.</DD>\r\n <DT>aid</DT>\r\n  <DD>The nickname of the story author</DD>\r\n <DT>section</DT>\r\n  <DD>The title of the section.</DD>\r\n <DT>new</DT>\r\n  <DD>The new story marker; displays the contents of the block <B>new_story_marker</B> if the logged-in user has not yet read the story, otherwise blank.</DD>\r\n <DT>readmore</DT>\r\n  <DD>The link to the full story, drawing on either the block <B>readmore_txt</B> or <B>no_body_txt</B> as appropriate. Also the link to edit the story, if the user has the appropriate perms.</DD>\r\n <DT>stats</DT>\r\n  <DD>The number of comments and unread comments, and the number of words in the story.</DD>\r\n <DT>section_link</DT>\r\n  <DD>The section title as a link to the section index page</DD>\r\n</DL>','Stories','cellar','en'),('story_summary','<!-- story_summary -->\r\n\r\n<div class=\"storysummary\">\r\n<div class=\"storytitle\">\r\n<span class=\"printicon\"><a href=\"%%rootdir%%/print/%%sid%%\"><img src=\"%%imagedir%%/printer.gif\" width=\"17\" height=\"14\" alt=\"Print Story\"></a></span>\r\n<span class=\"hotlist\">%%hotlist%%</span>\r\n%%title%%\r\n</div>\r\n\r\n<div class=\"storyintro_info\">\r\n<div class=\"topicimg\">%%topic_img%%</div>\r\nBy %%info%% (%%time%%) %%tags%%</div>\r\n\r\n<div class=\"storyintro\">\r\n%%introtext%% \r\n</div>\r\n<br>\r\n<div class=\"storystats\">\r\n%%stats%% %%readmore%%\r\n</div>\r\n</div>\r\n<p>\r\n<!-- X story_summary -->','2','<P>This block is used to format the story headlines and introtext, both on the index pages and the story pages. It should be a self-contained bit of HTML that lays out the story\'s information. The following special keys are recognized:</P>\r\n<DL>\r\n <DT>info</DT>\r\n  <DD>The author\'s name and the story\'s \"department\" (if used)</DD>\r\n <DT>title</DT>\r\n  <DD>The story\'s title</DD>\r\n <DT>introtext</DT>\r\n  <DD>The formatted contents of the story\'s introtext field</DD>\r\n <DT>hotlist</DT>\r\n  <DD>The link to either add or remove the story to the user\'s hotlist. Blank for anonymous users and stories that haven\'t been published yet.</DD>\r\n <DT>topic_img</DT>\r\n  <DD>The topic image, linked to the search results for that topic.</DD>\r\n <DT>topic_text</DT>\r\n  <DD>The alt text for the topic image as a text link, linked to the search results for that topic.</DD>\r\n <DT>time</DT>\r\n  <DD>The localized time the story was posted.</DD>\r\n <DT>sid</DT>\r\n  <DD>The story ID; can be used in custom links.</DD>\r\n <DT>section_icon</DT>\r\n  <DD>The file name of the section icon; can be used in an IMG tag to display an icon.</DD>\r\n <DT>section_title</DT>\r\n  <DD>The title of the section.</DD>\r\n <DT>aid</DT>\r\n  <DD>The nickname of the story author</DD>\r\n <DT>section</DT>\r\n  <DD>The title of the section.</DD>\r\n <DT>new</DT>\r\n  <DD>The new story marker; displays the contents of the block <B>new_story_marker</B> if the logged-in user has not yet read the story, otherwise blank.</DD>\r\n <DT>readmore</DT>\r\n  <DD>The link to the full story, drawing on either the block <B>readmore_txt</B> or <B>no_body_txt</B> as appropriate. Also the link to edit the story, if the user has the appropriate perms.</DD>\r\n <DT>stats</DT>\r\n  <DD>The number of comments and unread comments, and the number of words in the story.</DD>\r\n <DT>section_link</DT>\r\n  <DD>The section title as a link to the section index page</DD>\r\n</DL>','Stories','crap','en'),('story_summary','<!-- story_summary -->\r\n<div class=\"storysummary\">\r\n<div class=\"storytitle\">\r\n<span class=\"printicon\"><a href=\"%%rootdir%%/print/%%sid%%\"><img src=\"%%imagedir%%/printer.gif\" width=\"17\" height=\"14\" alt=\"Print Story\"></a></span>\r\n<span class=\"hotlist\">%%hotlist%%</span>\r\n%%title%%\r\n</div>\r\n\r\n<div class=\"storyintro_info\">\r\n<div class=\"topicimg\">%%topic_img%%</div>\r\nBy %%info%% (%%time%%) %%tags%%</div>\r\n\r\n<div class=\"storyintro\">\r\n%%introtext%% \r\n</div>\r\n<br>\r\n<div class=\"storystats\">\r\n%%stats%% %%readmore%% %%BOX,event,%%sid%%%%\r\n</div>\r\n</div>\r\n<p>\r\n<!-- X story_summary -->','1','<P>This block is used to format the story headlines and introtext, both on the index pages and the story pages. It should be a self-contained bit of HTML that lays out the story\'s information. The following special keys are recognized:</P>\r\n<DL>\r\n <DT>info</DT>\r\n  <DD>The author\'s name and the story\'s \"department\" (if used)</DD>\r\n <DT>title</DT>\r\n  <DD>The story\'s title</DD>\r\n <DT>introtext</DT>\r\n  <DD>The formatted contents of the story\'s introtext field</DD>\r\n <DT>hotlist</DT>\r\n  <DD>The link to either add or remove the story to the user\'s hotlist. Blank for anonymous users and stories that haven\'t been published yet.</DD>\r\n <DT>topic_img</DT>\r\n  <DD>The topic image, linked to the search results for that topic.</DD>\r\n <DT>topic_text</DT>\r\n  <DD>The alt text for the topic image as a text link, linked to the search results for that topic.</DD>\r\n <DT>time</DT>\r\n  <DD>The localized time the story was posted.</DD>\r\n <DT>sid</DT>\r\n  <DD>The story ID; can be used in custom links.</DD>\r\n <DT>section_icon</DT>\r\n  <DD>The file name of the section icon; can be used in an IMG tag to display an icon.</DD>\r\n <DT>section_title</DT>\r\n  <DD>The title of the section.</DD>\r\n <DT>aid</DT>\r\n  <DD>The nickname of the story author</DD>\r\n <DT>section</DT>\r\n  <DD>The title of the section.</DD>\r\n <DT>new</DT>\r\n  <DD>The new story marker; displays the contents of the block <B>new_story_marker</B> if the logged-in user has not yet read the story, otherwise blank.</DD>\r\n <DT>readmore</DT>\r\n  <DD>The link to the full story, drawing on either the block <B>readmore_txt</B> or <B>no_body_txt</B> as appropriate. Also the link to edit the story, if the user has the appropriate perms.</DD>\r\n <DT>stats</DT>\r\n  <DD>The number of comments and unread comments, and the number of words in the story.</DD>\r\n <DT>section_link</DT>\r\n  <DD>The section title as a link to the section index page</DD>\r\n</DL>','Stories','default','en'),('story_template','%%doctype%%\r\n<html>\r\n<head>\r\n%%stylesheet%%\r\n<title>%%sitename%% || %%subtitle%%</title>\r\n%%site_logo%%\r\n</head>\r\n<body>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<div class=\"container\">\r\n<div class=\"main\">\r\n	<!-- Right boxes column -->\r\n	<!-- X Right boxes column -->\r\n	<!-- Main page block -->\r\n\r\n	<div class=\"storystuff\">\r\n	<!-- Story stuff -->\r\n	%%STORY%%\r\n	<!-- X story stuff -->\r\n	</div>\r\n	<!-- X center content section -->\r\n		\r\n	<!-- X main page block -->\r\n</div>\r\n%%story_right_boxes%%\r\n</div>\r\n\r\n<!-- comments -->\r\n	%%CONTENT%%\r\n	<!--BOX,comment_controls-->\r\n	%%COMMENTS%%\r\n	<!--BOX,comment_controls-->\r\n<!-- X comments -->\r\n\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</body>\r\n</html>\r\n','1','<P>This block is used to build the story and comment display pages.  It must be a full HTML page. The special keys recognised are:</P>\r\n<DL>\r\n <DT>subtitle</DT>\r\n  <DD>This is replaced with an appropriate subtitle indicating which page is currently being viewed.</DD>\r\n <DT>dynamicmode_javascript</DT>\r\n  <DD>This is replaced with javascript for the dynamic comment display if the page template is being used for comment display.</DD>\r\n <DT>STORY</DT>\r\n  <DD>This is replaced with either the poll display or the story display, if either are being viewed.</DD>\r\n <DT>CONTENT</DT>\r\n  <DD>This is replaced with any other content specific to the page being requested.  It is provided by the function or box named in the Ops Admin Tool which handles the op (the first pseudo-directory) of the page.</DD>\r\n</DL>','Page Templates','default','en'),('story_template','%%doctype%%\r\n<html>\r\n<head>\r\n%%stylesheet%%\r\n<title>%%sitename%% || %%subtitle%%</title>\r\n%%site_logo%%\r\n</head>\r\n<body>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<div class=\"main\">\r\n	<div class=\"storystuff\">\r\n	<!-- Story stuff -->\r\n	%%STORY%%\r\n	<!-- X story stuff -->\r\n	</div>\r\n</div>\r\n\r\n<!-- comments -->\r\n	%%CONTENT%%\r\n	<!--BOX,comment_controls-->\r\n	%%COMMENTS%%\r\n	<!--BOX,comment_controls-->\r\n<!-- X comments -->\r\n\r\n<div>\r\n%%story_right_boxes%%\r\n</div>\r\n\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</body>\r\n</html>\r\n','2','<P>This block is used to build the story and comment display pages.  It must be a full HTML page. The special keys recognised are:</P>\r\n<DL>\r\n <DT>subtitle</DT>\r\n  <DD>This is replaced with an appropriate subtitle indicating which page is currently being viewed.</DD>\r\n <DT>dynamicmode_javascript</DT>\r\n  <DD>This is replaced with javascript for the dynamic comment display if the page template is being used for comment display.</DD>\r\n <DT>STORY</DT>\r\n  <DD>This is replaced with either the poll display or the story display, if either are being viewed.</DD>\r\n <DT>CONTENT</DT>\r\n  <DD>This is replaced with any other content specific to the page being requested.  It is provided by the function or box named in the Ops Admin Tool which handles the op (the first pseudo-directory) of the page.</DD>\r\n</DL>','Page Templates','mobile','en'),('story_vote_email','The users of %%sitename%% have decided that your diary \r\n%%story_title%%\r\n%%story_url%%\r\nis good enough for the front page.\r\n\r\nIf you think it is as well, you should visit\r\n%%story_url%%\r\nand vote \"Yes\" to put it there.\r\n\r\nThanks for writing such a good diary.\r\n','2','','Storyvote,general','default','en'),('story_vote_form','<FORM NAME=\"storymoderate\" ACTION=\"%%rootdir%%/\" METHOD=\"POST\">\r\n	<INPUT TYPE=\"hidden\" NAME=\"op\" VALUE=\"displaystory\">\r\n	<INPUT TYPE=\"hidden\" NAME=\"sid\" VALUE=\"%%sid%%\">\r\n	<INPUT TYPE=\"hidden\" NAME=\"mode\" VALUE=\"moderate\">\r\n	%%formkey%%\r\n	<B>Your vote:</B> <SELECT NAME=\"vote\" SIZE=1>\r\n		<OPTION VALUE=\"1\">Post it to the Front page! (+1)\r\n		<OPTION VALUE=\"2\">Post it to Section page Only (+1)\r\n		<OPTION VALUE=\"0\" SELECTED>Abstain. (0)\r\n		<OPTION VALUE=\"-1\">Dump it! (-1)\r\n	</SELECT>\r\n	<INPUT TYPE=\"submit\" NAME=\"save\" VALUE=\"Vote\">\r\n</FORM>',NULL,'<P>This is the form used to vote on stories in the voting queue. The following form elements must be present:</P>\n<DL>\n <DT>FORM</DT>\n  <DD>The form should post to the sites rootdir</DD>\n <DT>op</DT>\n  <DD>This should be a hidden field, named op, with a value of \"displaystory\"</DD>\n <DT>sid</DT>\n  <DD>This should be a hidden field, named sid, with a value of \"|sid|\" (see special keys, below)</DD>\n <DT>mode</DT>\n  <DD>This should be a hidden field, named mode, with a value of \"moderate\"</DD>\n <DT>vote</DT>\n  <DD>This should be a select or other multi-value field, with possible values of 1, 2, 0, or -1, representing votes for front page, section only, abstention, or hiding, respectively. Options may be removed or renamed, but the basic meaning of the values cannot be changed.</DD>\n <DT>save</DT>\n  <DD>This submit button should have a value of \"Vote\"</DD>\n</DL>\n<P>The following special keys are recognized:</P>\n<DL>\n <DT>sid</DT>\n  <DD>The story ID</DD>\n <DT>formkey</DT>\n  <DD>A hidden field used for security and form validation, to help stop scripts.</DD>\n</DL>','Stories','default','en'),('story_vote_msg','<P><B>Your vote (%%vote%%) was recorded.</B><BR>This story currently has a total score of %%curr_score%%.</P>','1','<P>This message is displayed when a user votes on a story. There are two special keys:</P>\n<DL>\n <DT>vote</DT>\n  <DD>The vote cast by the user.</DD>\n <DT>curr_score</DT>\n  <DD>The story\'s current score.</DD>\n</DL>','Stories','default','en'),('story_vote_spam_warning','The story titled \"%%story_title%%\" has been marked as spam by the users of %%sitename%%.\r\n\r\nPlease visit the story and check if this is spam. If it is, delete the user as a spammer.\r\n\r\nIf the story is not spam, do nothing.\r\n\r\n%%story_url%%','2','','Storyvote,general','default','en'),('stylesheet','%%css_includes%%\r\n%%charset%%','1','','general','default','en'),('submission_guidelines','Thank you for taking the time to submit a story!<P>\r\nHere are some general guidelines for new stories:\r\n<UL>\r\n<LI>Pick the topic carefully! Try your best to match the topic with the story you\'re submitting.\r\n<LI>Only the html tags listed are allowed in story text. No HTML is allowed in \"title\"\r\n<LI>Images are not allowed in the Intro text. They will be displayed on preview, but changed to text on posting. Please don\'t use them in the intro text.\r\n<LI>You must preview at least once. Please read over your story carefully. <LI>Check all URLS!\r\n<LI>Check all facts! :-)\r\n<LI>This site is community-edited (mostly), so don\'t whine to the admins if your story doesn\'t get posted. If you\'re logged in, you\'ll see a \"Moderate Submissions\" link to the right. This is how you decide what gets posted here! Use it!\r\n</UL>\r\nNow post away!','1','<P>This block is displayed above the story submission form. It should be self-contained HTML and should explain the site\'s submission guidelines. Keep in mind that the majority of people will at most skim this when going to post a story, so put the most important points up top.</P>','Stories','default','en'),('submission_message','<div class=\"submission_message\">Thank you for your submission. This is a community-edited site, so hopefully your fellow readers will see fit to post your story. Good Luck!</div>','1','<P>This block is displayed below the story body when it has been submitted to the queue. It should be self-contained HTML and should explain what will happen to the user\'s story now that it has been submitted.</P>','Stories','default','en'),('submittedstory_bg','#c6dae4','1','<P>This block is used as a row background colour in the Story List Admin Tool and the moderation queue, for those stories that are in the voting queue awaiting votes. This should be a hex colour value including the #, such as #000000 for black.','Colours','default','en'),('submit_page_title','Submit Story','1','','','default','en'),('submit_rdf_message','Know of any good sites that syndicate their headlines, but aren\'t carried by this site yet? Well, most likely this is because the admins don\'t know about the site yet, or that they syndicate headlines with RDF. All it takes is for you to find a URL for the site where their RDF file is, and copy it to the form below. Once submitted, and admin will review it, and will either approve it or delete it.','1','<P>This block is displayed just above the form used to submit an RDF file explaining what the form is for.</P>','RDF','default','en'),('submit_template','%%doctype%%\r\n<HTML>\r\n<HEAD>\r\n%%stylesheet%%\r\n<TITLE>%%sitename%% || %%subtitle%%</TITLE>\r\n%%site_logo%%\r\n%%BOX,use_spell_suggest%%\r\n%%BOX,use_fckeditor%%\r\n</HEAD>\r\n<BODY>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<TABLE BORDER=0 WIDTH=\"99%\" ALIGN=\"center\" CELLPADDING=0 CELLSPACING=10>\r\n	<!-- Main page block -->\r\n	<TR>\r\n		\r\n		<!-- Center content section -->\r\n		<TD VALIGN=\"top\" width=\"75%\">\r\n			%%STORY%%\r\n			%%CONTENT%%\r\n		</TD>\r\n		<!-- X center content section -->\r\n		\r\n		<!-- Right boxes column -->\r\n		<TD VALIGN=\"top\" WIDTH=\"25%\">\r\n\r\n			<!-- BOX,main_menu -->\r\n                        %%BOX,user_box%%\r\n			%%BOX,hotlist_flex_box%%\r\n			%%BOX,user_files_list%%\r\n			%%BOX,admin_tools%%\r\n			%%BOX,poll_box%%\r\n		\r\n		</TD>\r\n		<!-- X Right boxes column -->\r\n	</TR>\r\n	<!-- X main page block -->\r\n</TABLE>\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</BODY>\r\n</HTML>\r\n','1','<P>This block is the page template used to build the story and ad submission forms. It must be a full HTML page. The special keys recognised are:</P>\r\n<DL>\r\n <DT>subtitle</DT>\r\n  <DD>This is replaced with an appropriate subtitle indicating which page is currently being viewed.</DD>\r\n <DT>STORY</DT>\r\n  <DD>This is replaced with either the poll display or the story display, if either are being viewed.</DD>\r\n <DT>CONTENT</DT>\r\n  <DD>This is replaced with any other content specific to the page being requested.  It is provided by the function or box named in the Ops Admin Tool which handles the op (the first pseudo-directory) of the page.</DD>\r\n</DL>','Page Templates','default','en'),('subscribe','<p>You are not currently a paid member. Why not <a href=\"%%rootdir%%/subscribe\">become one</a>?</p>','1','<P>This block is displayed on a user\'s preferences page if they are not already subscribed, if they have the <B>allow_subscription</B> perm, and if the variable <B>use_subscriptions</B> is on. This should be a short note encouraging users to subscribe and should provide a link to the subscription purchase page. There are no special keys.</P>','Subscriptions','default','en'),('subscribe_denied_message','Sorry, but you can\'t subscribe to %%sitename%% at this time.','1','<P>This block is displayed if a user attempts to subscribe while not having the appropriate permissions. It should be self-contained HTML and should explain why the user cannot subscribe.</P>','Subscriptions','default','en'),('subscribe_intro_text','Thanks for considering subscribing to hulver\'s site. Your payment will help keep the site running.<p>\r\nTo see where your money will go, you can look at the <a href=\"http://www.hulver.com/scoop/story/2005/1/19/61940/1053\">accounts page</a>.','1','<P>This block is displayed on the subscription page. It should be self-contained HTML and should describe the subscription options and what extra features are available to subscribers.</P>','Subscriptions','default','en'),('subscribe_template','%%doctype%%\r\n<html>\r\n<head>\r\n%%stylesheet%%\r\n<title>%%sitename%% || %%subtitle%%</title>\r\n%%site_logo%%\r\n</head>\r\n<body>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<div class=\"container\">\r\n<div class=\"main\">\r\n            %%CONTENT%%\r\n</div>\r\n%%story_right_boxes%%\r\n</div>\r\n\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</body>\r\n</html>\r\n',NULL,'<P>This block is the page template used for subscription signup and payment. It must be a full HTML page. The special keys recognized are:</P>\r\n<DL>\r\n <DT>subtitle</DT>\r\n  <DD>This is replaced with an appropriate subtitle indicating which page is currently being viewed.</DD>\r\n <DT>CONTENT</DT>\r\n  <DD>This is replaced with any other content specific to the page being requested.  It is provided by the function or box named in the Ops Admin Tool which handles the op (the first pseudo-directory) of the page.</DD>\r\n</DL>','Page Templates','default','en'),('sub_email_success','Thank you for subscribing!\r\n\r\nYou have added %%MONTHS%% months to your subscription, of \r\nthe type \"%%TYPE%%\". Your subscription will expire on\r\n%%EXP_DATE%%.\r\n\r\n','1','<P>This block is the body of an email sent to a user when Scoop has successfully added to their subscription. It should not contain any HTML formatting, and recognizes no keys except the special keys listed below, because it does not go through the normal page processing before being emailed. The special keys recognized are:</P>\n<DL>\n <DT>TYPE</DT>\n  <DD>The name of the type of subscription bought or renewed</DD>\n <DT>MONTHS</DT>\n  <DD>The number of months bought or renewed</DD>\n <DT>EXP_DATE</DT>\n  <DD>The new expiry date of the subscription</DD>\n <DT>sitename</DT>\n  <DD>The value of the variable sitename</DD>\n <DT>site_url</DT>\n  <DD>The value of the variable site_url</DD>\n <DT>local_email</DT>\n  <DD>The value of the variable local_email</DD>\n</DL>','Subscriptions,Emails','default','en'),('sub_manual_change_email','The user %%NICK%% has subscribed for %%MONTHS%% months of \r\nsubscription \"%%TYPE%%\". The user\'s existing group does \r\nnot allow group changes. Please review this user\'s request \r\nat %%URL%%.\r\n\r\n-%%sitename%%\r\n%%local_email%%','1','<P>This block is the body of an email sent to the site administrator (at the addresses in the variable <B>admin_alert</B>) notifying them of a user who has bought a subscription but cannot be placed in the subscriber group automatically. This is determined by the perm <B>sub_allow_group_change</B>. It should not contain any HTML formatting, and recognizes no keys except the special keys listed below, because it does not go through the normal page processing. The special keys recognized are:</P>\n<DL>\n <DT>NICK</DT>\n  <DD>The nickname of the user who bought the subscription</DD>\n <DT>TYPE</DT>\n  <DD>The name of the type of subscription bought or renewed</DD>\n <DT>MONTHS</DT>\n  <DD>The number of months bought or renewed</DD>\n <DT>URL</DT>\n  <DD>The URL the administrator should visit to review the subscription</DD>\n <DT>sitename</DT>\n  <DD>The value of the variable sitename</DD>\n <DT>site_url</DT>\n  <DD>The value of the variable site_url</DD>\n <DT>local_email</DT>\n  <DD>The value of the variable local_email</DD>\n</DL>','Subscriptions,Emails','default','en'),('sub_paypal_canceled','Sorry you canceled.','1','<P>This block is displayed when a user cancels a subscription purchase while using paypal. It should be self-contained HTML and should let the user know that the transaction has been canceled.</P>','Payments,Subscriptions','default','en'),('sub_paypal_finished','Thank you, your PayPal payment has been recieved.',NULL,'Message displayed in the body of the page after a user returns from making a paypal payment.','Ads,Subscriptions','default','en'),('tag_item_format','<a href=\"%%rootdir%%/tag/%%urltag%%\" class=\"light\">%%tag%%</a>','1','A single item in the list of tags. \r\n<p>\r\nSpecial keys:\r\n<ul>\r\n<li> tag: the tag\r\n<li> urltag: the tag, escaped for use in a url\r\n</ul>','Stories,Tags','default','en'),('tag_list_format',' %%tags_list%% (<a href=\"%%rootdir%%/tag\" class=\"light\">all tags</a>)','1','The overall formatting for the tag display list, used in story_summary. Only appears if the Site Control <B>use_tags</B> is set.\r\n<p>\r\nSpecial keys:\r\n<ul><li> list: The list of tags, formatted according to <B>tag_item_format</B> and joined together with <B>tag_list_joinwith</B>.</ul>','Stories,Tags','default','en'),('tag_list_joinwith',', ','1','When the tag list is built for display, the formatted tag items will be joined together with this block. Especially useful for commas and such, but whatever you can think of to do with it.','Stories,Tags','default','en'),('tag_page_format','%%title_font%%All Tags:%%title_font_end%%\r\n<ul class=\"cloud\">\r\n%%tags_list%%\r\n</ul>','1','Page formatting for the tags cloud page generated by the tag OP. The only special key found here is <b>tags_list</b>','Tags','default','en'),('tag_page_item','<li class=\"%%cssclass%%\"><a href=\"%%rootdir%%/tag/%%urltag%%\">%%tag%%</a> (%%num%%)</li>','1','A single item on the tags cloud page. Special keys:\n<ul><li>cssclass: the CSS class name taken from the site control <B>tag_threshold_classes</B></li>\n<li>tag: the tag</li>\n<li>urltag: the tag, filtered for use in a URL</li></ul>','Tags','default','en'),('tag_page_joinwith',' ','1','When the list of tags on the tags cloud page is built, the formatted tags will be joined together with this block.','Tags','default','en'),('test_block','<h1>This is a test</h1>','2','A test block, for testing something.','content','default','en'),('text_ad_template','<div class=\"box\">\r\n<div class=\"boxtitle\">%%BOX,hidebox_box,ad_box%% <a class=\"adverttitle\" href=\"%%rootdir%%/section/adverts\">Advertisement</a></div>\r\n<div class=\"paidtextadtitle\"><a href=\"%%LINK_URL%%\" title=\"%%AD_URL%%\">%%TITLE%%</a></div>\r\n<div class=\"paidtextadbody\">%%TEXT1%%</div>\r\n<div class=\"paidtextadbody\">%%smallfont%%%%COMMENTS%%%%smallfont_end%%</div>\r\n</div>','1','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</P>\r\n<DL>\r\n <DT>FILE_PATH</DT>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</DD>\r\n <DT>TEXT1</DT>\r\n  <DD>The text the ad sponsor entered in the text1 field.</DD>\r\n <DT>TEXT2</DT>\r\n  <DD>The text the ad sponsor entered in the text2 field.</DD>\r\n <DT>TITLE</DT>\r\n  <DD>The text the ad sponsor entered in the title field.</DD>\r\n <DT>LINK_URL</DT>\r\n  <DD>The URL of the page being advertised.</DD>\r\n <DT>SID</DT>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</DD>\r\n <DT>REDIRECT_URL</DT>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</DD>\r\n</DL><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</P>','Ads','default','en'),('text_pref','<DIV class=\"item\">\r\n<P><B>%%required%%%%title%%:</B> %%description%%\r\n<BR>%%allowed_html%%\r\n<BR>%%control%%</P>\r\n</DIV>','1','<P>The preference item template generally used for text boxes. This should be a self-contained bit of HTML as it is used to display a single user preference, both on the user info page and the preferences edit forms. The following special keys are recognised:</P>\n<DL>\n <DT>required</DT>\n  <DD>If the preference is required, the contents of <B>required_pref_marker</B>, otherwise blank</DD>\n <DT>title</DT>\n  <DD>The displayed title of the preference, as set in the User Preferences Admin Tool</DD>\n <DT>control</DT>\n  <DD>On the preferences edit form, this is the form field required for the preference, as set in the User Preferences Admin Tool. On the user info page, this is the value of the preference</DD>\n <DT>description</DT>\n  <DD>On the preferences edit form, this is the description as entered in the User Preferences Admin Tool. On the user info page, this is not displayed.</DD>\n <DT>allowed_html</DT>\n  <DD>If the preference supports HTML, displays the \"Allowed HTML\" string.</DD>\n</DL>','Accounts','default','en'),('theme_list','<form name=\"themes\" action=\"%%rootdir%%/admin/blocks/overview\" method=\"post\">\n<table border=\"0\" cellpadding=\"2\" cellspacing=\"0\" width=\"100%\">\n<tr><td bgcolor=\"%%title_bgcolor%%\">%%title_font%%Blocks: Themes Overview%%title_font_end%%</td></tr>\n<tr><td>%%norm_font%%<a href=\"%%rootdir%%/admin/blocks\">Back to blocks admin</a>%%norm_font_end%%</td></tr>\n<tr><td>%%norm_font%%%%themesel%%%%norm_font_end%%</td></tr>\n<tr><td>%%norm_font%%<input type=\"submit\" name=\"show\" value=\"Show Selected Themes\">%%norm_font_end%%</td></tr>\n</table>\n</form>\n<table border=1 cellpadding=1 cellspacing=0 width=\"100%\">\n  %%list%%\n</table>\n','1','<P>This block creates the admin tool structure for the block theme overview. It contains a form and two special keys. The form elements are:</P>\n<DL>\n <DT>FORM</DT>\n  <DD>The form should post to |rootdir|/admin/blocks/overview</DD>\n <DT>show</DT>\n  <DD>The submit button should have the name \"show\"</DD>\n</DL>\n<P>The following special keys are recognized:</P>\n<DL>\n <DT>themesel</DT>\n  <DD>A set of checkboxes, one for each theme, to allow the admin to select which themes to display in the overview.</DD>\n <DT>list</DT>\n  <DD>The list of all blocks in the selected theme. Matching blocks in two different themes are displayed in the same row, so you can see at a glance which blocks will be replaced when applying themes.</DD>\n</DL>','Admin Pages','default','en'),('titled_box','<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=2 WIDTH=\"100%\">\n	<TR>\n		<TD BGCOLOR=\"%%title_bgcolor%%\">%%title_font%%<B>%%title%%</B>%%title_font_end%%</TD>\n	</TR>\n	<TR>\n		<TD>\n			%%content%%\n		</TD>\n	</TR>\n</TABLE>\n','1','<P>This block is used as a box template, and is not used directly from other blocks. It should be self-contained HTML and provide a box with a title bar. The following special keys are recognized:</P>\n<DL>\n <DT>title</DT>\n  <DD>The title of the box; either a value explicitly returned by the box code, or the text in the box title field if nothing is explicitly returned.</DD>\n <DT>content</DT>\n  <DD>The content of the box; the text that the box code returns after running.</DD>\n</DL>','Box Templates','default','en'),('title_bgcolor','#EEEEEE','1','<P>This block is used anywhere a title bar needs a background (except in the sidebar boxes, which use <B>box_title_bg</B>). It should be a hex colour value, including the #.</P>','Colours','default','en'),('title_bgcolor','#aaaaaa','1','<P>This block is used anywhere a title bar needs a background (except in the sidebar boxes, which use <B>box_title_bg</B>). It should be a hex colour value, including the #.</P>','Colours','greyscale','en'),('title_font','<FONT FACE=\"verdana, arial, helvetica, sans-serif\" SIZE=3><B>',NULL,'<P>This block is used to format titles. It should be a complete opening font or other formatting tag. It must match the closing tags in the block <B>title_font_end</B>.</P>','Fonts','default','en'),('title_font_end','</B></FONT>',NULL,'<P>This block is used to format titles. It should be a closing font or other formatting tag. It must match the opening tags in the block <B>title_font</B>.</P>','Fonts','default','en'),('trackback_discovery','<!-- Trackback auto-discovery code\r\n<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\r\n          xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\r\n         \r\n xmlns:trackback=\"http://madskills.com/public/xml/rss/module/trackback/\">\r\n   <rdf:Description\r\n     rdf:about=\"%%site_url%%%%rootdir%%/story/%%sid%%\"\r\n     dc:identifier=\"%%site_url%%%%rootdir%%/story/%%sid%%\"\r\n     dc:title=\"%%title%%\"\r\n     trackback:ping=\"%%site_url%%%%rootdir%%/tb/%%sid%%\" />\r\n   </rdf:RDF>\r\n-->\r\n','2','Old text used for the trackback discovery code. Disabled due to spamming','Stories','default','en'),('trusted_info_message','You are a trusted user.  For more information on the extra rights and responsibilities of trusted users, please see \"<A href=\"%%rootdir%%/special/trusted\">Trusted User Guidelines</A>\".','1','<P>This block is displayed on a user\'s own user info page when they are a trusted user. (See the Scoop Admin Guide for more information on trusted and untrusted users and mojo, which determines trust level.) It should notify the user of their trusted status, and either explain what it means or link to a page that explains what it means.</P>','Comments','default','en'),('undisplayedstory_bg','#c0c0c0','1','<P>This block is used as the background colour for a line in the Story List Admin Tool for stories that have been voted down in the queue or hidden by an admin. It should be a hex colour value, including the #.','Colours','default','en'),('untrusted_post_message','You are an untrusted user. Your comment has been posted, but it must be reviewed by a trusted user before it will become visible. For more information, please see \"<A HREF=\"%%rootdir%%/special/untrusted\">Why am I untrusted?</A>\"','1','<P>This block is displayed above the comment posted message when an untrusted user posts a comment. (See the Scoop Admin Guide for more information on trusted and untrusted users and mojo, which determines trust level.) It should notify the user of their untrusted status, and either explain what it means or link to a page that explains what it means.</P>','Comments','default','en'),('userpage_template','%%doctype%%\r\n<HTML>\r\n<HEAD>\r\n%%stylesheet%%\r\n<TITLE>%%sitename%% || %%subtitle%%</TITLE>\r\n</HEAD>\r\n<BODY>\r\n\r\n%%header%%\r\n\r\n<!-- Main layout table -->\r\n<TABLE BORDER=0 WIDTH=\"99%\" ALIGN=\"center\" CELLPADDING=0 CELLSPACING=10>\r\n    <!-- Main page block -->\r\n    <TR>\r\n        <!-- Center content section -->\r\n        <TD CLASS=\"sectiontitle\">Your User Page.</TD>\r\n        <!-- X center content section -->\r\n\r\n        <!-- Right boxes column -->\r\n        <TD CLASS=\"rightboxes\" ROWSPAN=\"2\">\r\n            %%BOX,hotlist_flex_box%%\r\n            %%BOX,admin_tools%%\r\n        </TD>\r\n<!-- WTF? -->\r\n        <!-- X Right boxes column -->\r\n    </TR>        \r\n        \r\n    <TR>\r\n        <!-- Center content section -->\r\n        <TD CLASS=\"centercontent\">\r\n            <TABLE HEIGHT=\"650\" WIDTH=\"100%\" BORDER=0 CELLPADDING=0 CELLSPACING=0>\r\n            <TR><TD>\r\n            %%BOX,user_page_box%%\r\n            </TD></TR>\r\n            </TABLE>        \r\n        </TD>\r\n        <!-- X center content section -->\r\n    </TR>\r\n    <!-- X main page block -->\r\n</TABLE>\r\n<!-- X Main layout table -->\r\n<P>\r\n%%footer%%\r\n</BODY>\r\n</HTML>\r\n','2','A page template. This is typically the template used for the front page and section pages, but rarely anything else.','templates','default','en'),('userpref_oldpass_field','You must enter your account password to change protected settings.\r\n<BR><B>Password:</B><INPUT TYPE=\"password\" SIZE=\"30\" NAME=\"verify_me\"></P>\r\n','1','<P>This block is the description and form element in which the user enters his old password to change protected settings. On the user\'s first login, the block <B>userpref_oldpass_hidden</B> is used instead.</P>','Accounts','default','en'),('userpref_oldpass_hidden','<INPUT TYPE=\"hidden\" NAME=\"verify_me\" value=\"%%pass%%\">','1','<P>This block is the hidden form element containing the user\'s old password. It is only used on the user\'s first login; the block <B>userpref_oldpass_field</B> is used the rest of the time.</P>','Accounts','default','en'),('userpref_reset','<INPUT type=\"submit\" name=\"reset\" value=\"Reset Preferences\">','1','<P>This block contains the reset button for the userpref pages. The button must be named \"reset\" but you can otherwise change how it looks.</p>','Accounts','default','en'),('user_admin','<DIV class=\"admin_prefs\">\r\n<P><B>Nickname:</B> <INPUT type=\"text\" length=\"30\" name=\"nickname\" value=\"%%nickname%%\">\r\n</P>\r\n<P><B>User ID:</B> %%uid%%</P>\r\n<P><B>User group:</B> %%BOX,user_group_box,%%perm_group%%%%</P>\r\n<P><B>Original Email:</B> %%origemail%%</P>\r\n<P><B>Created At:</B> %%creation_time%%</P>\r\n<P><B>Original IP:</B> %%creation_ip%%</P>\r\n<P><B>User\'s current mojo:</B> %%mojo%%</P>\r\n</DIV>','1','<P>This block displays admin-only user info on the Protected user preference page. This should be a self-contained block of HTML. It is displayed just above the real email and password fields on the Protected user preference page for users with the <B>edit_user</B> perm only. The following special keys are recognised:</P>\n<DL>\n <DT>nickname</DT>\n  <DD>The nickname of the user being edited</DD>\n <DT>perm_group</DT>\n  <DD>The current group of the user being edited</DD>\n <DT>origemail</DT>\n  <DD>The email address used when the account was created</DD>\n <DT>creation_time</DT>\n  <DD>The date and time the account was created</DD>\n <DT>creation_ip</DT>\n  <DD>The IP address the account was created from</DD>\n <DT>mojo</DT>\n  <DD>The user\'s current mojo</DD>\n</DL>','Accounts','default','en'),('user_info_page','%%title_font%%User Info%%title_font_end%%\r\n%%BOX,userpref_menu%%\r\n<DIV>\r\n%%trusted_msg%%\r\n%%BOX,subscriber%%<br>\r\n%%BOX,diarysub_box%%\r\n%%BOX,pm_sendto%%\r\n%%itemlist%%\r\n%%BOX,erase_user%%\r\n%%BOX,lastfm_recent%%\r\n</DIV>','1','<P>This block contains the content column template for the displayed user info page. It should be self-contained HTML and contain the page title (the title bar most pages have, just under the header). The following special keys are recognised:</P>\r\n<DL>\r\n <DT>trusted_msg</DT>\r\n  <DD>If the user is trusted and viewing his own user info page, the contents of the block <B>trusted_info_message</B> are displayed.</DD>\r\n <DT>itemlist</DT>\r\n  <DD>Those user preferences which are visible and have some value, each formatted by their pref template</DD>\r\n</DL>','Accounts','default','en'),('user_pass','<DIV class=\"prefs\">\r\n<P><B><font color=\"#ff0000\">Protected settings</font></B>\r\n%%passwd%%\r\n<P><B>Real Email:</B> <INPUT type=\"text\" name=\"realemail\" value=\"%%realemail%%\">\r\n<BR>This is the address that will be used to email forgotten passwords. It will not be shown anywhere. Please do not insert any kind of spam protection here, or you will not be able to get a new password!</P>\r\n\r\n<P><B>New Password:</B> Leave both fields blank for no change. This is asked twice to detect typos.\r\n<BR>New Password: <INPUT TYPE=\"password\" SIZE=\"30\" NAME=\"pass1\">\r\n<BR>Confirm: <INPUT TYPE=\"password\" SIZE=\"30\" NAME=\"pass2\">\r\n</DIV>','1','<P>This block displays the user portion of the Protected user preferences page. The following special keys are recognised:</P>\n<DL>\n <DT>passwd</DT>\n  <DD>The entire form field for password entry. If it is a user\'s first login, the form field is hidden.</DD>\n <DT>realemail</DT>\n  <DD>The current value of the user\'s real email</DD>\n</DL>','Accounts','default','en'),('user_prefs_message','<TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 width=\"100%\">\r\n                <TR>\r\n                        <TD BGCOLOR=\"%%title_bgcolor%%\">\r\n                        %%title_font%%<B>Sorry!</B>%%title_font_end%%\r\n                        </TD>\r\n                </TR>\r\n                <TR>\r\n                        <TD>%%norm_font%%\r\n                        Sorry, you can only edit user preferences if you have a user account. Why not <A HREF=\"%%rootdir%%/?op=newuser\">make one</A>?\r\n                        %%norm_font_end%%\r\n                        </TD>\r\n                </TR>\r\n                </TABLE>','2','<P>This block is displayed instead of the form when a user who is not logged in tries to change his display or comment preferences. It should be self-contained HTML and explain that accounts are required to set preferences. There are no special keys.</P>','General','default','en'),('user_pref_page','%%title_font%%User Preferences: %%page%%%%title_font_end%%\r\n%%BOX,userpref_menu%%\r\n%%message%%\r\n<!-- user_pref_page -->\r\n<DIV>\r\n<FORM action=\"%%rootdir%%/user/%%nick%%/prefs/%%page%%\" method=\"post\">\r\n%%formkey%%\r\n\r\n%%itemlist%%\r\n\r\n<INPUT type=\"submit\" name=\"write\" value=\"Save Preferences\">\r\n%%userpref_reset%%\r\n</FORM>\r\n</DIV>','1','<P>This block contains the content column template for the user preference edit pages. It should be self-contained HTML and contain the page title (the title bar most pages have, just under the header). The following special keys are recognised:</P>\r\n<DL>\r\n <DT>page</DT>\r\n  <DD>The name of the preference page currently being edited</DD>\r\n <DT>nick</DT>\r\n  <DD>The nickname of the user currently being edited</DD>\r\n <DT>formkey</DT>\r\n  <DD>A formkey, for a bit of security (mostly against double-clicks on the save button)</DD>\r\n <DT>message</DT>\r\n  <DD>Any status or error messages generated by an attempt to save or reset the preferences</DD>\r\n <DT>itemlist</DT>\r\n  <DD>The preferences for this page, formatted by their pref item templates</DD>\r\n <DT>userpref_reset</DT>\r\n  <DD>The contents of the block <B>userpref_reset</B> (a reset button) if the current page is anything other than Protected; the Protected page has no reset button.</DD>\r\n</DL>','Accounts','default','en'),('var_category_list','<tr>\r\n	<td>%%norm_font%%<a href=\"%%rootdir%%/admin/vars/%%item_url%%\">%%item%%</a>%%norm_font_end%%</td>\r\n	<td>%%norm_font%%<a href=\"%%rootdir%%/admin/vars/%%item_url%%\">%%item%%</a>%%norm_font_end%%</td>\r\n	<td>%%norm_font%%<a href=\"%%rootdir%%/admin/vars/%%item_url%%\">%%item%%</a>%%norm_font_end%%</td>\r\n</tr>\r\n',NULL,'<P>This block is used on the Site Controls Admin Tool, to build the list of categories above the form. This should be one row of a table as many cells wide as desired. The special keys may be repeated; each time they are repeated they will be replaced with the values for a different category. The special keys recognized are:</P>\n<DL>\n <DT>item_url</DT>\n  <DD>The part of the URL after /admin/vars/ that will lead to the category overview form.</DD>\n <DT>item</DT>\n  <DD>The name of the category.</DD>\n</DL>\n<P>The special keys, if repeated, should all be repeated the same number of times, and each set should be associated, so as not to mix up the title and destination of the links.</P>','Admin Pages','default','en'),('vote_console','<!-- vote_console -->\r\n<div class=\"story_edit_instructions\">\r\nYour vote really does count! \r\n<B>You</B> decide whether this story ever sees the light of the front page. So vote!\r\n<p>\r\n%%vote_form%%\r\n</div>\r\n<!-- X vote_console -->\r\n','1','<P>This block is displayed below the story body for stories still in the voting queue. It should be self-contained HTML and explain what the voting is for. The special key vote_form is replaced with the actual form.</P>','Stories','default','en'),('week_link_up','<LI><A href=\"%%rootdir%%/calendar/weekly/%%cal_id%%/%%year%%-%%month%%-%%day%%\">This Week</A></LI>\r\n','1','<P>This block is the link used in the daily calendar view to allow the user to move back up to weekly view. The following special keys are recognized:</P>\n<DL>\n <DT>cal_id</DT>\n  <DD>The calendar ID of the current calendar, or zero for the user\'s personal calendar view</DD>\n <DT>year</DT>\n  <DD>The currently selected year</DD>\n <DT>month</DT>\n  <DD>The currently selected month.</DD>\n <DT>day</DT>\n  <DD>The currently selected day.</DD>\n</DL>','Calendars and Events','default','en'),('wonderful_ad_template','<div class=\"box\">\r\n<div class=\"boxtitle\">%%BOX,hidebox_box,ad_box%% <a class=\"adverttitle\" href=\"%%rootdir%%/section/adverts\">Advertisement</a></div>\r\n%%project_wonderful_square%%','2','<P>This block is used to provide the layout for the simple text ad type. It should be self-contained HTML. The special keys recognized are:</P>\r\n<DL>\r\n <DT>FILE_PATH</DT>\r\n  <DD>The path to the image file used in the ad. This does not include the value set in the variable ad_server_url.</DD>\r\n <DT>TEXT1</DT>\r\n  <DD>The text the ad sponsor entered in the text1 field.</DD>\r\n <DT>TEXT2</DT>\r\n  <DD>The text the ad sponsor entered in the text2 field.</DD>\r\n <DT>TITLE</DT>\r\n  <DD>The text the ad sponsor entered in the title field.</DD>\r\n <DT>LINK_URL</DT>\r\n  <DD>The URL of the page being advertised.</DD>\r\n <DT>SID</DT>\r\n  <DD>The story ID associated with the ad, if ad comments are active. See the Scoop Admin Guide for details on setting up ad comments.</DD>\r\n <DT>REDIRECT_URL</DT>\r\n  <DD>The URL used in the actual link of the ad, for clickthrough counting. The URL of the page advertised is not required in the actual link, but you may put it there in a dummy cgi variable (such as url=) so users know where they\'re going.</DD>\r\n</DL><P>The special keys used in the ad template become the required fields for the ad, as well as the only fields permitted.</P>','Ads,Ads','default','en');
/*!40000 ALTER TABLE `blocks` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2012-10-03 12:28:18
-- MySQL dump 10.11
--
-- Host: localhost    Database: scoop
-- ------------------------------------------------------
-- Server version	5.0.32-Debian_7etch8-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `box`
--

DROP TABLE IF EXISTS `box`;
CREATE TABLE `box` (
  `boxid` varchar(50) NOT NULL default '',
  `title` varchar(50) NOT NULL default '',
  `content` text NOT NULL,
  `description` text,
  `template` varchar(39) NOT NULL default '',
  `user_choose` int(1) default '0',
  PRIMARY KEY  (`boxid`),
  KEY `user_choose_idx` (`user_choose`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Dumping data for table `box`
--

LOCK TABLES `box` WRITE;
/*!40000 ALTER TABLE `box` DISABLE KEYS */;
INSERT INTO `box` VALUES ('accounts','','my $retval = \"%%norm_font%%\";\r\nmy $view;\r\n$view = $S->cgi->param(\'view\') if ($S->have_perm(\'accounts_editor\'));\r\n$view = \'summary\' if (!$view);\r\n\r\nif ($view eq \'summary\') {\r\nmy ($rv, $sth);\r\nmy $year = 2003;\r\nmy $summary;\r\nmy $search_date;\r\nmy $pre_years;\r\nmy $text_block;\r\n$rv = 1;\r\nmy $to_search = $S->cgi->param(\'year\');\r\nmy $search_year = $to_search;\r\nif ($search_year) {\r\n  $search_year =~ s/(....).*/$1/;\r\n}\r\nwhile ($rv > 0) {\r\n    $search_date = $year . \"-09-13\";\r\n    ($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => qq{sum(amt_out), sum(amt_in), DATE_FORMAT(date_add(\"$search_date\", INTERVAL 1 YEAR), \'%e %b %Y\')},\r\n	FROM => \"accounts\",\r\n	WHERE => qq{trans_date >= \"$search_date\" AND trans_date < date_add(\"$search_date\", INTERVAL 1 YEAR)}\r\n	});\r\n    my ($amt_out, $amt_in, $year_end) = $sth->fetchrow();\r\n    if (($amt_out == 0) && ($amt_in == 0)) {\r\n        $year --;\r\n        $search_date = $year . \"-09-13\";\r\n	$rv = 0;\r\n	$summary .= $text_block;\r\n    } else {\r\n        if ($search_year) {\r\n		if ($year <= $search_year) {\r\n			$pre_years .= $text_block;\r\n		} else {\r\n			$summary .= $text_block;\r\n		}\r\n	} else {\r\n		$pre_years .= $text_block;\r\n	}\r\n	$text_block = \"\";\r\n	my $profit;\r\n	if (($amt_in - $amt_out) < 0) {\r\n	  $profit .= \'<font color=\"red\">\'\r\n	}\r\n	$profit .= sprintf(\"%.2f\", $amt_in - $amt_out);\r\n	if (($amt_in - $amt_out) < 0) {\r\n	  $profit .= \'</font>\';\r\n	}\r\n	$text_block .= qq{<tr><td><a href=\"%%rootdir%%/story/2005/1/19/61940/1053?year=$search_date\">$year_end</a></td><td>Year end - Profit for year &pound; $profit</td><td align=\"right\">$amt_in</td><td align=\"right\">$amt_out</td></tr>};\r\n	$year ++;\r\n    }\r\n}\r\n\r\n$to_search = $search_date unless ($to_search);\r\n$to_search = $S->{DBH}->quote($to_search);\r\n\r\n($rv, $sth) = $S->db_select({\r\n    DEBUG => 0,\r\n    WHAT => \"DATE_FORMAT(trans_date,\'%e %b %Y\') as t_date, d.description AS description, sum(amt_in) as amt_in, sum(amt_out) as amt_out\",\r\n    FROM => \'accounts INNER JOIN accounts_desc as d on accounts.desc_id = d.desc_id\',\r\n    GROUP_BY => \'d.desc_id, trans_date\',\r\n    ORDER_BY => \'trans_date\',\r\n    WHERE => qq{trans_date >= $to_search AND trans_date < date_add($to_search, INTERVAL 1 YEAR)}});\r\n\r\nmy $acc_info;\r\n$retval .= qq{<table border=\"0\" width=\"100%\">\r\n<tr>\r\n<td><b>Date</b></td>\r\n<td><b>Description</b></td>\r\n<td align=\"right\"><b>In (£)</b></td>\r\n<td align=\"right\"><b>Out (£)</b></td>\r\n</tr>\r\n<tr>\r\n<td> </td>\r\n<td> </td>\r\n<td> </td>\r\n<td> </td></tr>\r\n$pre_years\r\n%%norm_font_end%%};\r\n\r\nwhile ($acc_info = $sth->fetchrow_hashref())\r\n{\r\n  $retval .= qq(<tr><td>$acc_info->{t_date}</td>\r\n<td>$acc_info->{description}</td><td align=\"right\"> );\r\n  if ($acc_info->{amt_in} != 0) {\r\n    $retval .= sprintf(\"%.2f\", $acc_info->{amt_in}); }\r\n\r\n  $retval .= \'</td><td align=\"right\"> \';\r\n\r\n  if ($acc_info->{amt_out} != 0) {\r\n    $retval .= sprintf(\"%.2f\", $acc_info->{amt_out}) ; }\r\n\r\n  $retval .= \'</td></tr>\';\r\n}\r\n$sth->finish();\r\n\r\n$retval .= qq{<tr>\r\n<td>&nbsp;</td>\r\n<td> </td>\r\n<td> </td>\r\n<td> </td>\r\n</tr>\r\n$summary\r\n</table>\r\n<p>};\r\n\r\nif ($S->have_perm(\'accounts_editor\')) {\r\n  $retval .= qq(<p><a href=\"/scoop/special/accounts?view=details\">Show Details</a>);\r\n};\r\n\r\n} elsif ($view eq \'details\') {\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n    DEBUG => 0,\r\n    WHAT => \"trans_id, DATE_FORMAT(trans_date,\'%e %b %Y\') as t_date, d.description AS description, amt_in, amt_out, uid, user_email\",\r\n    FROM => \'accounts INNER JOIN accounts_desc as d on accounts.desc_id = d.desc_id\',\r\n    ORDER_BY => \'trans_date\'});\r\n\r\n$retval = qq{<TABLE BORDER=0 WIDTH=\"100%\">\r\n<tr>\r\n<td><b>ID</b></td>\r\n<td><b>Date</b></td>\r\n<td><b>Description</b></td>\r\n<td align=\"right\"><b>In (£)</b></td>\r\n<td align=\"right\"><b>Out (£)</b></td>\r\n<td><b>UID</b></td>\r\n<td><b>EMail</b></td>\r\n</tr>\r\n<tr>\r\n<td> </td>\r\n<td> </td>\r\n<td> </td>\r\n<td> </td>\r\n<td> </td>\r\n<td> </td>\r\n<td> </td>};\r\n\r\nmy $acc_info;\r\nwhile ($acc_info = $sth->fetchrow_hashref()) {\r\n  $retval .= qq(<tr><td><a href=\"/scoop/special/Accounts?view=id&id=$acc_info->{trans_id}\">$acc_info->{trans_id}</a></td>\r\n<td>$acc_info->{t_date}</td>\r\n<td>$acc_info->{description}</td><td align=\"right\"> );\r\n\r\n  if ($acc_info->{amt_in} != 0) {\r\n    $retval .= sprintf(\"%.2f\", $acc_info->{amt_in}); }\r\n\r\n  $retval .= \'</td><td align=\"right\"> \';\r\n\r\n  if ($acc_info->{amt_out} != 0) {\r\n    $retval .= sprintf(\"%.2f\", $acc_info->{amt_out}) ; }\r\n\r\n  $retval .= \'</td><td>\';\r\n  if ($acc_info->{uid}) {\r\n    $retval .= \'<a href=\"/scoop/user/uid:\' . $acc_info->{uid} . \'\">\' . $acc_info->{uid} . \'</a></td>\';\r\n  };\r\n  $retval .= \'<td>\' . $acc_info->{user_email} . \'</td></tr>\';\r\n}\r\n$sth->finish();\r\n\r\n$retval .= \'</table><p><a href=\"/scoop/special/Accounts?view=id&id=0\">Add new record</a>\';\r\n\r\n} elsif ($view eq \'id\') {\r\n\r\nmy $id = $S->cgi->param(\'id\');\r\nmy $submit = $S->cgi->param(\'submit\');\r\nmy $confirm = $S->cgi->param(\'confirm\');\r\nmy ($date, $amt_in, $amt_out, $uid, $desc_id, $user_email);\r\nmy $deleted;\r\nmy $msg;\r\nmy ($rv, $sth);\r\n\r\nif ($submit eq \'Save\') {\r\n  $date = $S->cgi->param(\'date\');\r\n  $amt_in = $S->cgi->param(\'amt_in\');\r\n  $amt_out = $S->cgi->param(\'amt_out\');\r\n  $uid = $S->cgi->param(\'uid\');\r\n  $desc_id = $S->cgi->param(\'desc_id\');\r\n  $user_email = $S->cgi->param(\'user_email\');\r\n  my $s_date = $S->{DBH}->quote($date);\r\n  my $s_amt_in = $amt_in || \"NULL\";\r\n  my $s_amt_out = $amt_out || \"NULL\";\r\n  my $s_uid = $uid || \"NULL\";\r\n  my $s_user_email = $user_email || \"NULL\";\r\n  my $s_desc_id = $S->{DBH}->quote($desc_id);\r\n  $s_amt_in = $S->{DBH}->quote($s_amt_in) unless ($s_amt_in eq \'NULL\');\r\n  $s_amt_out = $S->{DBH}->quote($s_amt_out) unless ($s_amt_out eq \'NULL\');\r\n  $s_uid = $S->{DBH}->quote($s_uid) unless ($s_uid eq \'NULL\');\r\n  $s_user_email = $S->{DBH}->quote($s_user_email) unless ($s_user_email eq \'NULL\');\r\n  if ($id eq \'0\') {\r\n    my $insert = \"$s_date, $s_amt_in, $s_amt_out, $s_uid, $s_desc_id, $s_user_email\";\r\n    ($rv, $sth) = $S->db_insert({\r\n         DEBUG => 0,\r\n         VALUES => qq($insert),\r\n         COLS => \'trans_date, amt_in, amt_out, uid, desc_id, user_email\',\r\n         INTO => \'accounts\'\r\n         });\r\n  } else {\r\n    ($rv, $sth) = $S->db_update({\r\n         DEBUG => 0,\r\n         WHAT => \"accounts\",\r\n         SET => \"trans_date = $s_date, amt_in = $s_amt_in, amt_out = $s_amt_out, uid = $s_uid, desc_id = $s_desc_id, user_email = $s_user_email\",\r\n         WHERE => \"trans_id = $id\"\r\n         });\r\n  }\r\n  if ($rv) {\r\n    $msg = \'Update OK\';\r\n  } else {\r\n    $msg = \'Update failed\';\r\n  }\r\n} elsif ($submit eq \'Delete\') {\r\n  if ($confirm && ($id > 0)) {\r\n    # delete the record\r\n    my $s_id = $S->{DBH}->quote($id);\r\n    $S->db_delete({\r\n         DEBUG => 0,\r\n         FROM => \"accounts\",\r\n         WHERE => \"trans_id = $s_id\"\r\n	 });\r\n    $deleted = 1;\r\n  }\r\n} else {\r\n  ($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \'trans_date, desc_id, amt_in, amt_out, uid, user_email\',\r\n	FROM => \'accounts\',\r\n	WHERE => \'trans_id = \' . $id\r\n	});\r\n  ($date, $desc_id, $amt_in, $amt_out, $uid, $user_email) = $sth->fetchrow();\r\n  $sth->finish();\r\n};\r\n\r\n\r\nif ($deleted) {\r\n  $retval = qq(Transaction id : $id : Deleted<p><a href=\"/scoop/special/Accounts?view=details\">Return to detail view</a>);\r\n} else {\r\n  $retval = qq(<font color=\"red\">$msg</font><p>\\n) if ($msg);\r\n  $retval .= \'<form method=\"post\" action=\"/scoop/special/Accounts\">\' . \"\\nTransaction : $id<p>\";\r\n  my ($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \'desc_id, description\',\r\n	FROM => \'accounts_desc\'\r\n	});\r\n  $retval .= \'<input name=\"view\" value=\"id\" type=\"hidden\">\' . \"\\n\";\r\n  $retval .= \'<input name=\"id\" value=\"\' . $id . \'\" type=\"hidden\">\' . \"\\n\";\r\n  $retval .= \'Date : <input name=\"date\" value=\"\' . \"\\n\";\r\n  $retval .= $date .\'\" type=\"text\"><p>\' . \"\\n\";\r\n  $retval .= \'Description : <select name=\"desc_id\">\' . \"\\n\";\r\n  while (my ($temp_id, $temp_desc) = $sth->fetchrow()) {\r\n    $retval .= \'<option value=\"\'. $temp_id .\'\"\';\r\n    if ($temp_id eq $desc_id) { $retval .= \" SELECTED\" };\r\n    $retval .= \'>\' . $temp_desc . \"\\n\";\r\n  }\r\n  $sth->finish();\r\n  $retval .= \'</select><p>Amount In : <input name=\"amt_in\" type=\"text\" value=\"\' .$amt_in.\'\"><p>\' . \"\\n\";\r\n  $retval .= \'Amount Out : <input name=\"amt_out\" type=\"text\" value=\"\' . $amt_out . \'\"><p>\' . \"\\n\";\r\n  $retval .= \'User ID : <input name=\"uid\" type=\"text\" value=\"\'. $uid . \'\"><p>\' . \"\\n\";\r\n  $retval .= \'User EMail : <input name=\"user_email\" type=\"text\" value=\"\' . $user_email . \'\"><p>\' . \"\\n\";\r\n  $retval .= \'<input name=\"submit\" type=\"submit\" value=\"Save\"> <input name=\"submit\" type=\"submit\" value=\"Delete\">\' . \"\\n\";\r\n  $retval .= \'<input name=\"confirm\" type=\"checkbox\" value=\"1\"> Confirm delete\' . \"\\n\";\r\n  $retval .= \'</form><p><a href=\"/scoop/special/Accounts?view=details\">Back to details</a>\' . \"\\n\";\r\n\r\n};\r\n\r\n}\r\n\r\nreturn $retval;\r\n','Produce the details from the accounts table','empty_box',0),('activate','','return qq{You\'re already logged in! Your account is confirmed and active. Click <a href=\"%%rootdir%%/\">here</a> to go to the home page.} if ($S->{UID} > 0);\r\n\r\nmy $key = $S->cgi->param(\'key\');\r\nreturn \'Error: No key provided.\' unless $key;\r\n\r\nmy $q_key = $S->dbh->quote($key);\r\nmy ($rv, $sth) = $S->db_select({\r\n	WHAT => \'uid, nickname, creation_passwd\',\r\n	FROM => \'users\',\r\n	WHERE => qq{passwd = $q_key}\r\n});	\r\n\r\nmy ($uid, $nick, $pass) = $sth->fetchrow();\r\n$sth->finish();\r\n\r\nmy $help = $S->{UI}->{VARS}->{local_email};\r\n\r\nreturn qq{I\'m sorry, I can\'t find that key. Your account is probably already confirmed -- try logging in <a href=\"%%rootdir%%/login\">here</a> using the nickname and password you chose when you signed up. If that works, you\'re all set. If not, please email <a href=\"mailto:$help\">$help</a> for help.} unless ($uid && $nick && $pass);\r\n\r\nmy ($rv, $sth) = $S->db_update({\r\n	WHAT => \'users\',\r\n	SET => qq{passwd = newpasswd, creation_passwd = \"\", newpasswd = \"\"},\r\n	WHERE => qq{uid = $uid}\r\n});\r\n$sth->finish();	\r\n	\r\n$S->{PARAMS}->{\'uname\'} = $nick;\r\n$S->{PARAMS}->{\'pass\'} = $pass;\r\n\r\n$S->_check_user();\r\n\r\nmy $urlnick = $S->urlify($nick);\r\n\r\nmy $url = $S->{UI}->{VARS}->{site_url} . \"/\" .\r\n          $S->{UI}->{VARS}->{rootdir} . \"user/$urlnick/prefs?firstlogin=1\";\r\n\r\n$S->{APACHE}->headers_out->{\'Location\'} = $url;\r\n$S->{HEADERS_ONLY}=1;	  \r\n\r\nreturn;','The code to activate a new user\'s account when they click the emailed link.','empty_box',0),('addtag','','my $sid = $S->cgi->param(\'sid\');\r\nmy $tagsave = $S->cgi->param(\'tagsave\');\r\nmy $newtags = $S->cgi->param(\'newtags\');\r\nreturn \"Error! No sid provided!\" if !$sid;\r\nmy $content;\r\n\r\n# I would, of course, prefer not to give\r\n# TUs extra privileges, but sometimes I guess\r\n# it must be done.\r\nmy $alltags;\r\nmy $subval;\r\nif ($S->have_perm(\'edit_story_tags\')){\r\n    $newtags ||= $S->get_tags_as_string($sid);\r\n    $alltags = $newtags;\r\n    $subval = \"Add/Edit\";\r\n    }\r\nelse {\r\n    $alltags = $S->get_tags_as_string($sid) . \", $newtags\";\r\n    $subval = \"Add\";\r\n    }\r\n#my $alltags = $S->get_tags_as_string($sid) . \", #$newtags\";\r\n$alltags =~ s/,$//;\r\n\r\n# if we\'re adding tags, add them and clear the new\r\n# tags var\r\nif($tagsave && $newtags){\r\n    $S->save_tags($sid, $alltags);\r\n    $content .= \"<p>Tags <b>$newtags</b> added.</p>\";\r\n    $newtags = \'\';\r\n    # and if we\'ve added tags, we\'re heading\r\n    # back to whence we came.\r\n    my $url = $S->{UI}->{VARS}->{site_url}   \r\n        . $S->{UI}->{VARS}->{rootdir} . \"/\"\r\n        . \"story/$sid\";\r\n    $S->{APACHE}->headers_out->{\'Location\'} = $url;\r\n    $S->{HEADERS_ONLY}=1;\r\n    }\r\nmy $curtags = $S->tag_display($sid);\r\n$content = \"Current $curtags\" . $content;\r\n\r\nmy $tagform = qq~\r\n<p><form name=\"addtag\" action=\"%%rootdir%%/addtag\" method=\"POST\">$subval Tags: (use commas to separate tags) <input type=\"hidden\" name=\"sid\" value=\"$sid\"><input type=\"text\" name=\"newtags\" size=\"30\" value=\"$newtags\"> <input type=\"submit\" name=\"tagsave\" value=\"$subval Tags\"></p></form></p><p>\r\n\'/\' characters are not allowed in tags, and will be converted to \'-\'.</p>\r\n~;\r\nreturn $content . $tagform;','','empty_box',0),('admin_search','Search Admin Tools','# search terms?\r\nmy $query = $S->cgi->param(\'query\');\r\n\r\n# search where?\r\n# extract the chosen search locations\r\nmy $search_param = $S->cgi->param(\'search_in\');\r\nmy %search_in;\r\nmy $searches_selected = 0;\r\nforeach (ref($search_param) eq \'ARRAY\' ? @{$search_param} : ($search_param)) {\r\n	next unless $_;\r\n	$search_in{$_} = 1;\r\n	$searches_selected++;\r\n}\r\n\r\n# if they didn\'t select any searches, or this is a fresh load, then select all\r\nunless ($searches_selected) {\r\n	foreach (qw(blockval blockdesc boxval boxdesc specval vardesc)) {\r\n		$search_in{$_} = 1;\r\n	}\r\n}\r\n\r\nmy ($blockval, $blockdesc, $boxval, $boxdesc, $specval, $vardesc) = \"\";\r\nmy ($blocksearchwhere, $boxsearchwhere, $specsearchwhere, $varsearchwhere) = \"\";\r\nmy ($type_phrase, $type_any, $type_all) = \"\";\r\n\r\n# remember what was previously selected. yes, this is kind of ugly\r\n$blockval  = \' selected=\"selected\"\' if $search_in{blockval};\r\n$blockdesc = \' selected=\"selected\"\' if $search_in{blockdesc};\r\n$boxval    = \' selected=\"selected\"\' if $search_in{boxval};\r\n$boxdesc   = \' selected=\"selected\"\' if $search_in{boxdesc};\r\n$specval   = \' selected=\"selected\"\' if $search_in{specval};\r\n$vardesc   = \' selected=\"selected\"\' if $search_in{vardesc};\r\n\r\n# same thing for search type, though set a default of all\r\nif ($S->cgi->param(\'search_type\') eq \'phrase\') {\r\n	$type_phrase = \' checked=\"checked\"\';\r\n} elsif($S->cgi->param(\'search_type\') eq \'all\') {\r\n	$type_all = \' checked=\"checked\"\';\r\n} elsif($S->cgi->param(\'search_type\') eq \'any\') {\r\n	$type_any = \' checked=\"checked\"\';\r\n} else {\r\n	$type_all = \' checked=\"checked\"\';\r\n}\r\n\r\n# set up search fields\r\nmy $filter_query = $S->filter_param($query);\r\nmy $search_for_field = qq{<input type=\"text\" name=\"query\" value=\"$filter_query\"><input type=\"submit\" value=\"Search\">};\r\n\r\nmy $search_in_field = \'<select name=\"search_in\" multiple=\"multiple\" size=\"6\">\';\r\n$search_in_field .= qq{\r\n	<option value=\"blockval\"$blockval>Block values</option>\r\n	<option value=\"blockdesc\"$blockdesc>Block descriptions</option>} if $S->have_perm(\'edit_blocks\');\r\n\r\n$search_in_field .= qq{\r\n	<option value=\"boxval\"$boxval>Box code</option>\r\n	<option value=\"boxdesc\"$boxdesc>Box descriptions</option>} if $S->have_perm(\'edit_boxes\');\r\n\r\n$search_in_field .= qq{\r\n	<option value=\"specval\"$specval>Special Pages</option>} if $S->have_perm(\'edit_special\');\r\n\r\n$search_in_field .= qq{\r\n	<option value=\"vardesc\"$vardesc>Site Controls descriptions</option>} if $S->have_perm(\'edit_vars\');\r\n\r\n$search_in_field .= \"\\n</select>\";\r\n\r\nmy $search_opt_field = qq{<input type=\"radio\" name=\"search_type\" value=\"all\"$type_all> All words<br>\r\n<input type=\"radio\" name=\"search_type\" value=\"any\"$type_any> Any words<br>\r\n<input type=\"radio\" name=\"search_type\" value=\"phrase\"$type_phrase> Phrase};\r\n\r\nmy $content .= qq{\r\n<form method=\"get\" action=\"%%rootdir%%/admin/search\">\r\n<table border=\"0\">\r\n	<tr>\r\n		<td valign=\"top\" rowspan=\"2\">%%norm_font%%Search in:<br>$search_in_field%%norm_font_end%%</td>\r\n		<td>%%norm_font%%Search for:<br>$search_for_field%%norm_font_end%%</td>\r\n	</tr>\r\n	<tr>\r\n		<td>%%norm_font%%$search_opt_field%%norm_font_end%%</td>\r\n	</tr>\r\n</table>\r\n</form>\r\n   };\r\n\r\nif ($query) {\r\n	my ($blockresults, $boxresults, $specresults, $varresults) = (\"\",\"\",\"\",\"\");\r\n\r\n	# of the three column names which might be needed, these are used\r\n	# repeatedly, so stick them in a var instead of re-building them\r\n	my $content_string = &search_string($S, $query, \'content\');\r\n	my $desc_string    = &search_string($S, $query, \'description\');\r\n\r\n	$blocksearchwhere .= &search_string($S, $query, \'block\') if ($blockval);\r\n	$blocksearchwhere .= \' OR \' if ($blockdesc && $blockval);\r\n	$blocksearchwhere .= $desc_string if ($blockdesc);\r\n	$boxsearchwhere   .= $content_string if ($boxval);\r\n	$boxsearchwhere   .= \' OR \' if ($boxdesc && $boxval);\r\n	$boxsearchwhere   .= $desc_string if ($boxdesc);\r\n	$specsearchwhere  .= $content_string if ($specval);\r\n	$varsearchwhere   .= $desc_string if ($vardesc);\r\n\r\n	if ($blocksearchwhere && $S->have_perm(\'edit_blocks\')) {\r\n		my ($rv, $sth) = $S->db_select({\r\n			WHAT  => \'bid,description,theme\',\r\n			FROM  => \'blocks\',\r\n			WHERE => $blocksearchwhere\r\n		});\r\n		while (my $rec = $sth->fetchrow_hashref) {\r\n			my $desc = $rec->{description} || \"<i>(no description)</i>\";\r\n			$blockresults .= qq{\r\n	<dt><a href=\"%%rootdir%%/admin/blocks/edit/$rec->{theme}/$rec->{bid}\">$rec->{bid}</a></dt>\r\n	<dd>$desc</dd>}\r\n		}\r\n		$blockresults = \"<dl> $blockresults </dl>\" if $blockresults;\r\n	}\r\n\r\n	if ($boxsearchwhere && $S->have_perm(\'edit_boxes\')) {\r\n		my ($rv, $sth) = $S->db_select({\r\n			WHAT  => \'boxid, description\',\r\n			FROM  => \'box\',\r\n			WHERE => $boxsearchwhere\r\n		});\r\n		while (my $rec = $sth->fetchrow_hashref) {\r\n			my $desc = $rec->{description} || \"<i>(no description)</i>\";\r\n			$boxresults .= qq{\r\n	<dt><a href=\"%%rootdir%%/admin/boxes/$rec->{boxid}\">$rec->{boxid}</a></dt>\r\n	<dd>$desc</dd>}\r\n		}\r\n		$boxresults = \"<dl> $boxresults </dl>\" if $boxresults;\r\n	}\r\n\r\n	if ($specsearchwhere && $S->have_perm(\'edit_special\')) {\r\n		my ($rv, $sth) = $S->db_select({\r\n			WHAT => \'pageid,title,description\',\r\n			FROM => \'special\',\r\n			WHERE => $specsearchwhere\r\n		});\r\n		while (my $rec = $sth->fetchrow_hashref) {\r\n			my $desc = $rec->{description} || \"<i>(no description)</i>\";\r\n			$specresults .= qq{\r\n	<dt><a href=\"%%rootdir%%/admin/special?id=$rec->{pageid}\">$rec->{title}</a></dt>\r\n	<dd>$desc</dd>}\r\n		}\r\n		$specresults = \"<dl> $specresults </dl>\" if $specresults;\r\n	}\r\n\r\n	if ($varsearchwhere && $S->have_perm(\'edit_vars\')) {\r\n		my ($rv, $sth) = $S->db_select({\r\n			WHAT => \'name,description\',\r\n			FROM => \'vars\',\r\n			WHERE => $varsearchwhere\r\n		});\r\n		while (my $rec = $sth->fetchrow_hashref) {\r\n			my $desc = $rec->{description} || \"<i>(no description)</i>\";\r\n			$varresults .= qq{\r\n	<dt><a href=\"%%rootdir%%/admin/vars/edit/$rec->{name}\">$rec->{name}</a></dt>\r\n	<dd>$desc</dd>}\r\n		}\r\n		$varresults = \"<dl> $varresults </dl>\" if $varresults;\r\n	}\r\n\r\n	$content .= \"<H3>Blocks found:</H3>\\n%%norm_font%%$blockresults%%norm_font_end%%\" if $blockresults;\r\n	$content .= \"<H3>Boxes found:</H3>\\n%%norm_font%%$boxresults%%norm_font_end%%\" if $boxresults;\r\n	$content .= \"<H3>Special Pages found:</H3>\\n%%norm_font%%$specresults%%norm_font_end%%\" if $specresults;\r\n	$content .= \"<H3>Site Controls found:</H3>\\n%%norm_font%%$varresults%%norm_font_end%%\" if $varresults;\r\n	unless ($varresults || $blockresults || $boxresults || $specresults) {\r\n		$content .= \"%%norm_font%%Nothing matching your search phrase was found in the selected tools.%%norm_font_end%%\";\r\n	}\r\n}\r\n\r\n$content = \"<table width=\\\"100%\\\">\r\n	<tr width=\\\"100%\\\" bgcolor=\\\"%%title_bgcolor%%\\\"><td>%%title_font%%Search Admin Tools%%title_font_end%%</td></tr>\r\n	<tr><td>$content</td></tr>\r\n</table>\";\r\n\r\nreturn $content;\r\n\r\nsub search_string {\r\n	my ($S, $query, $field) = @_;\r\n\r\n	my $search_string;\r\n	if ($S->cgi->param(\'search_type\') eq \'phrase\') {\r\n		# easy enough\r\n		$search_string = \"$field LIKE \" . $S->dbh->quote(\"%${query}%\");\r\n	} else {\r\n		while ($query =~ /([\\w-]+)/g) {\r\n			if ($search_string) {\r\n				$search_string .= \' AND \'\r\n					if $S->cgi->param(\'search_type\') eq \'all\';\r\n				$search_string .= \' OR \'\r\n					if $S->cgi->param(\'search_type\') eq \'any\';\r\n			}\r\n			$search_string .= \"$field LIKE \" . $S->dbh->quote(\"%${1}%\");\r\n		}\r\n	}\r\n\r\n	return \"($search_string)\";\r\n}\r\n','Simple admin search tool for locating blocks by content or description. This is called from the admin tools menu.','blank_box',0),('admin_tools','Admin Tools','my $content;\r\n\r\nmy @tools = sort { $a->{pos} <=> $b->{pos} } values %{ $S->{ADMIN_TOOLS} };\r\n\r\nforeach my $t (@tools) {\r\n	if ( $S->have_perm($t->{perm}) ) {\r\n		$content .= qq|\r\n	%%dot%% <a class=\"light\" href=\"%%rootdir%%/admin/$t->{tool}\">$t->{menuname}</a><br>|;\r\n	}\r\n}\r\n\r\nif ($S->have_perm(\'edit_user\')) {\r\n $content .= qq{<br>\r\n <form name=\"uedit\" method=\"GET\" action=\"%%rootdir%%/\">\r\n Edit User:<br>\r\n <input type=\"hidden\" name=\"op\" VALUE=\"user\">\r\n <small><input type=\"text\" name=\"nick\" value=\"\" size=\"10\">\r\n <input type=\"SUBMIT\" name=\"tool\" VALUE=\"prefs\">\r\n <input type=\"SUBMIT\" name=\"tool\" VALUE=\"info\">\r\n </small></form>};\r\n}\r\n\r\nif ($S->have_perm(\'view_comment_ip\')) {\r\n $content .= qq{<br>\r\n  <form name=\"ip_view\" method=\"GET\" action=\"%%rootdir%%/special/ip_usage\">\r\n  IP Address: <br>\r\n  <input type=\"text\" name=\"ip\" value=\"\" size=\"15\">\r\n  <input type=\"SUBMIT\" value=\"IP Info\"></form>};\r\n}\r\n\r\n\r\nreturn \'\' unless $content;\r\n\r\nreturn $content;\r\n','Admin Tools box','box',0),('admin_users','HuSi Admins','return \'\' unless (($S->{GID} eq \'Admins\') || ($S->{GID} eq \'Editors\') || ($S->{GID} eq \'Superuser\'));\r\n\r\nmy $content;\r\nmy ($rv, $sth) = $S->db_select({\r\n	WHAT => \'nickname, perm_group\',\r\n	FROM => \'users\',\r\n	WHERE => \"perm_group = \'Admins\' OR perm_group = \'Editors\' OR perm_group = \'Superuser\'\",\r\n	ORDER_BY => \'uid\'});\r\n\r\nmy $users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n\r\nforeach my $user (@{$users}) {\r\n	my $urlnick = $S->{UI}->{VARS}->{rootdir};\r\n	$urlnick .= \'/user/\';\r\n	my $nick = $user->[0];\r\n	my $group = $user->[1];\r\n	$urlnick .= $nick;\r\n	$content .= qq{<a class=\"light\" href=\"$urlnick\">$nick</a> ($group)<br>\\n}\r\n}\r\n\r\nreturn ($content);','Show site admins','box',0),('ad_box','Advertisement','return \'\' if( $S->pref(\'showad\') eq \'off\' );\r\nreturn \'\' unless( $S->{UI}->{VARS}->{use_ads} );\r\nmy $sid = $S->{CGI}->param(\'sid\');\r\nreturn \'\' if (($sid eq \'2004/11/18/71113/240\') || ($sid eq \'2004/11/23/17253/990\') || ($sid eq \'2004/11/26/161614/67\') || ($sid eq \'2005/4/10/53513/1961\') || ($sid eq \'2005/4/10/22342/4915\') || ($sid eq \'2005/5/24/15223/6056\') || ($sid eq \'2005/7/7/54638/76993\') || ($sid eq \'2006/3/29/153454/458\') || ($sid eq \r\n\'2008/7/17/172814/482\') || ($sid eq \r\n\'2008/6/26/131112/907\'));\r\n\r\nmy $pos = $ARGS[0];\r\n$pos = 0 unless ($pos);\r\n\r\nmy $adhash = $S->get_next_ad($pos);\r\nreturn \'\' unless( defined $adhash );\r\n\r\nmy $content = $S->{UI}->{BLOCKS}->{$adhash->{ad_tmpl}};\r\n\r\nmy $subdir = ($adhash->{example} == 1) ? \'example\' : $adhash->{sponsor};\r\nmy $file_path = $subdir . \'/\' .  $adhash->{ad_file};\r\n\r\n$content =~ s/%%LINK_URL%%/%%rootdir%%\\/redirect\\/$adhash->{ad_id}?url=$adhash->{ad_url}/g;\r\n#$content =~ s/%%LINK_URL%%/$adhash->{ad_url}/g;\r\n$content =~ s/%%TITLE%%/$adhash->{ad_title}/g;\r\n$content =~ s/%%TEXT1%%/$adhash->{ad_text1}/g;\r\n$content =~ s/%%TEXT2%%/$adhash->{ad_text2}/g;\r\n$content =~ s/%%FILE_PATH%%/$file_path/g;\r\n$content =~ s/%%AD_URL%%/$adhash->{ad_url}/g;\r\n#if ($adhash->{ad_sid} =~ \"/[a..zA..Z0..9]+/\") {\r\nif ($adhash->{ad_sid}) {\r\n        my $stories = $S->getstories(\r\n          {-type => \'fullstory\',\r\n           -sid => $adhash->{ad_sid}});\r\n        my $story = $stories->[0];\r\n        my $storylink;\r\n\r\n        my $show = $S->{UI}->{VARS}->{show_new_comments};\r\n        my $num_new = $S->new_comments_since_last_seen($adhash->{ad_sid}) if ($show eq \"all\");\r\n        my $end_s = ($story->{commentcount} == 1) ? \'\' : \'s\';\r\nif ($story->{commentcount} > 0) {\r\n  $end_s .= \", $num_new new\";\r\n        my $storylink = \"|rootdir|\\/story\\/\" . $adhash->{ad_sid};\r\n\r\n\r\n}\r\n\r\n$content =~ s/%%COMMENTS%%/<a CLASS=\"light\" href=\\\"%%rootdir%%\\/story\\/$adhash->{ad_sid}\\\">($story->{commentcount} comment$end_s)<\\/a>/g;\r\n} else\r\n{\r\n$content =~ s/%%COMMENTS%%//g;\r\n}\r\n\r\nreturn { content => $content };\r\n','Simple ad box for the side of the page','empty_box',1),('ad_pay_cc','','my $ad_id = $S->filter_param($ARGS[0]);\r\nmy $count = $S->filter_param($ARGS[1]);\r\nmy $content;\r\n\r\n\r\n# If we\'re ordering, do it now.\r\nif ($S->cgi->param(\'final_pay\')) {\r\n	$content .= $S->cc_place_order();\r\n}\r\n\r\n\r\nunless ($content) {\r\n	my ($num, $price);\r\n	if ($count) {\r\n		# Get total price\r\n		my ($rv, $sth) = $S->db_select({\r\n			WHAT  => \'ad_types.cpm\',\r\n			FROM  => \'ad_info, ad_types\',\r\n			WHERE => \"ad_info.ad_id = $ad_id AND ad_info.ad_tmpl = ad_types.type_template\"\r\n		});\r\n		my ($cpm) = $sth->fetchrow();\r\n		$price = ($count/1000) * $cpm;\r\n		$num = $count;\r\n	} else {	\r\n		my ($rv, $sth) = $S->db_select({\r\n			WHAT => \'purchase_size,purchase_price\',\r\n			FROM => \'ad_info\',\r\n			WHERE => \"ad_id=$ad_id\"});\r\n\r\n		($num, $price) = $sth->fetchrow();\r\n		$sth->finish();\r\n	}\r\n	\r\n	$content .= qq{\r\n<b>Your ad:</b><br>\r\n<center>%%BOX,show_ad,$ad_id%%</center>\r\n<p>};\r\n	if ($S->cgi->param(\'pay\')) {\r\n    	$content .= $S->cc_preview_order($price,$num);\r\n	}\r\n\r\n	my $p_form = $S->cc_make_person_form();\r\n	my $c_form = $S->cc_make_card_form();\r\n\r\n	$content .= qq{\r\n	<p>\r\n	Please fill in the payment form below. Required fields are in <font color=\"#ff0000\">red</font>. When you are done, click \"Preview Order\". You will <b>not</b> be billed yet, and you will be able to change what you\'ve entered before confirming the order.\r\n	<form name=\"adpay\" ACTION=\"/special/adpay\" METHOD=\"POST\">\r\n	<input type=\"hidden\" name=\"ad_id\" value=\"$ad_id\">\r\n	<input type=\"hidden\" name=\"type\" value=\"cc\">\r\n	<input type=\"hidden\" name=\"count\" value=\"$count\">\r\n	<p>\r\n	<b>Billing Information:</b>\r\n	<p>\r\n	$p_form\r\n	<p>\r\n	<b>Credit/Debit Card Information:</b>\r\n	<p>\r\n	$c_form\r\n	<p>\r\n	<input type=\"submit\" name=\"pay\" value=\"Preview Order\">\r\n	</form>};\r\n}\r\n#\'\r\nreturn $content;','','blank_box',0),('ad_pay_paypal','Pay using paypal','my $ad_id = $ARGS[0];\r\nmy $count = $ARGS[1];\r\n$ad_id = $S->filter_param($ad_id);\r\n$count = $S->filter_param($count);\r\nmy $content;\r\nmy $site = $S->{UI}->{VARS}->{site_url}.$S->{UI}->{VARS}->{rootdir};\r\nmy $secure_site = $S->{UI}->{VARS}->{secure_site_url}.$S->{UI}->{VARS}->{rootdir};\r\nmy $business_id = $S->{UI}->{VARS}->{paypal_business_id};\r\n\r\nunless ($ad_id) {\r\n	return \"No ad id passed.\";\r\n}\r\n\r\nmy ($num, $price, $item);\r\nif ($count) {\r\n	# Get total price\r\n	my ($rv, $sth) = $S->db_select({\r\n		WHAT  => \'ad_types.cpm\',\r\n		FROM  => \'ad_info, ad_types\',\r\n		WHERE => \"ad_info.ad_id = $ad_id AND ad_info.ad_tmpl = ad_types.type_template\"\r\n	});\r\n	my ($cpm) = $sth->fetchrow();\r\n	$price = ($count/1000) * $cpm;\r\n	$price = sprintf(\"%1.2f\", $price);\r\n	$num = $count;\r\n	$item = \"Ad Renewal\";\r\n} else {\r\n	my ($rv, $sth) = $S->db_select({\r\n	  WHAT => \'purchase_size,purchase_price\',\r\n	  FROM => \'ad_info\',\r\n	  WHERE => \"ad_id=$ad_id\"});\r\n	($num, $price) = $sth->fetchrow();\r\n	$sth->finish();\r\n	$item = \"Advertisement\";\r\n}\r\n\r\nmy $finished = $S->cgi->param(\'finished\');\r\nmy $canceled = $S->cgi->param(\'canceled\');\r\n\r\nif ($finished) {\r\n	my $content = $S->{UI}->{BLOCKS}->{paypal_finished};	\r\n	return $content;\r\n} elsif ($canceled) {\r\n	my $content = $S->{UI}->{BLOCKS}->{paypal_canceled};\r\n	return $content;\r\n}\r\n\r\nmy $paypal_form = qq{\r\n<form action=\"https://www.paypal.com/cgi-bin/webscr\" method=\"post\">\r\n<input type=\"hidden\" name=\"cmd\" value=\"_xclick\">\r\n<input type=\"hidden\" name=\"business\" value=\"$business_id\">\r\n<input type=\"hidden\" name=\"notify_url\" value=\"$site/special/paypal_confirm\">\r\n<input type=\"hidden\" name=\"item_name\" value=\"$item\">\r\n<input type=\"hidden\" name=\"item_number\" value=\"$ad_id\">\r\n<input type=\"hidden\" name=\"no_shipping\" value=\"1\">\r\n<input type=\"hidden\" name=\"return\" value=\"$secure_site/special/adpay?type=paypal;ad_id=$ad_id;finished=1\">\r\n<input type=\"hidden\" name=\"cancel_return\" value=\"$secure_site/special/adpay?type=paypal;ad_id=$ad_id;canceled=1\">\r\n<input type=\"hidden\" name=\"amount\" value=\"$price\">\r\n<input type=\"hidden\" name=\"custom\" value=\"$num\">\r\n<input type=\"image\" src=\"%%imagedir%%/paypal.gif\" border=\"0\" name=\"submit\" alt=\"Make payments with PayPal - it\'s fast, free and secure!\">\r\n</form>};\r\n\r\n$content = qq{\r\n<b>Your ad:</b><br>\r\n<center></center>\r\n<p>\r\nYour purchase details are below. Click the Paypal button, and you will go to a page on Paypal where you will finish the payment process.\r\n<table border=0 cellpadding=1 cellspacing=0 bgcolor=\"#000000\" align=\"center\">\r\n  <tr>\r\n    <td>\r\n	  <table width=\"100%\" cellpadding=5 cellspacing=0 border=0 bgcolor=\"#eeeeee\">\r\n	    <tr>\r\n		  <td>\r\n			<FONT FACE=\"verdana, arial, helvetica, sans-serif\" SIZE=\"2\"><b>Impressions:</b></font>\r\n		  </td>\r\n		  <td>\r\n		    <FONT FACE=\"verdana, arial, helvetica, sans-serif\" SIZE=\"2\">$num</font>\r\n		  </td>\r\n		</tr>\r\n	    <tr>\r\n		  <td>\r\n			<FONT FACE=\"verdana, arial, helvetica, sans-serif\" SIZE=\"2\"><b>Total Price:</b></font>\r\n		  </td>\r\n		  <td>\r\n		    <FONT FACE=\"verdana, arial, helvetica, sans-serif\" SIZE=\"2\">\\$$price</font>\r\n		  </td>\r\n		</tr>\r\n		<tr>\r\n		  <td colspan=2 align=\"center\">\r\n		  <FONT FACE=\"verdana, arial, helvetica, sans-serif\" SIZE=\"2\">\r\n		  Click below to purchase.<br>\r\n		  $paypal_form\r\n		  </font>\r\n		  </td>\r\n		</tr>\r\n	  </table>\r\n	</td>\r\n  </tr>\r\n</table>};\r\n\r\nreturn $content;','','blank_box',0),('ad_pay_type_select','','my $type = $S->filter_param($S->cgi->param(\'type\'));\r\nmy $ad_id = $S->filter_param($S->cgi->param(\'ad_id\'));\r\nmy $renew = $S->filter_param($S->cgi->param(\'renew\'));\r\nmy $count = $S->filter_param($S->cgi->param(\'count\'));\r\n\r\nunless ($type && $ad_id) {\r\n  return \'Error: No payment type or ad ID.\';\r\n}\r\n\r\nreturn \"%%BOX,ad_pay_cc,$ad_id,$count%%\" if ($type eq \'cc\');\r\nreturn \"%%BOX,ad_pay_paypal,$ad_id,$count%%\" if ($type eq \'paypal\');','Implant the right payment type box','blank_box',0),('ad_story_format','Ad Story formatter','my $ad_id = $ARGS[0];\r\n\r\nmy $content = qq{\r\n%%BOX,show_ad,$ad_id%%\r\n};\r\n\r\nreturn { content => $content };','Use this to format the advertisments in the introtext of their stories.','blank_box',0),('ajax','','my $retval = \"\";\r\nmy $action;\r\nmy $sid;\r\nmy $function = $S->cgi->param(\'function\');\r\nmy $value = $S->cgi->param(\'value\');\r\n\r\nif ($function eq \'hotlist\') {\r\n    $action = $value;\r\n    $action =~ s/.*hotlist\\/([^\\/]*).*/$1/gs;\r\n    $sid = $value;\r\n    $sid =~ s/.*hotlist\\/[^\\/]*\\/([^\\/]*)\\/([^\\/]*)\\/([^\\/]*)\\/([^\\/]*)\\/([^\\/]*)\\/.*/$1\\/$2\\/$3\\/$4\\/$5/gs;\r\n    if ($action eq \'add\') {\r\n        $S->add_to_hotlist($sid);\r\n        $retval = \'{\"results\": [\"add\",\"remove\",\"-\"]}\';\r\n } else {\r\n        $S->remove_from_hotlist($sid);\r\n        $retval = \'{\"results\": [\"remove\",\"add\",\"+\"]}\';\r\n    }\r\n}\r\nif ($function eq \'hotlist-update\') {\r\n    $retval = \"%%BOX,hotlist_flex_hotlist%%\";\r\n}\r\n\r\nreturn $retval;','','empty_box',0),('amazon_delete','','my $sid = $ARGS[1];\r\n\r\n#return unless ($S->have_perm(\'\'));\r\n# should return here, but what perms?\r\n\r\nmy ($rv, $sth) = $S->db_delete({\r\n    FROM => \'amazon_story\',\r\n    WHERE => \'sid = ?\',\r\n    PARAMS => [$sid]});\r\n\r\nreturn \'\';','Hook run on story delete so the the amazon process will tidy up.','empty_box',0),('amazon_footer','','return \'\';\r\n# unless ($S->{UI}->{VARS}->{show_amazon});\r\n\r\nmy $show = $S->amazon_country(1) || \'None\';\r\nreturn \'\' if ($show eq \'None\');\r\n\r\nmy $retval = \"\";\r\n\r\nif ($show =~ /(UK|All)/) {\r\n  $retval .= \'%%amazon_logo_uk%%\';\r\n};\r\nif ($show eq \'All\') {\r\n  $retval .= \'</td><td>\';\r\n}\r\nif ($show =~ /(US|All)/) {\r\n  $retval .= \'%%amazon_logo%%\';\r\n}\r\nif ($show eq \'All\') {\r\n  $retval .= \'</td><td>\';\r\n}\r\nif ($show =~ /(CA|All)/) {\r\n  $retval .= \'%%amazon_logo_ca%%\';\r\n};\r\nif ($show eq \'All\') {\r\n  $retval .= \'</td><td>\';\r\n}\r\nif ($show =~ /(FR|All)/) {\r\n  $retval .= \'%%amazon_logo_fr%%\';\r\n};\r\nif ($show eq \'All\') {\r\n  $retval .= \'</td><td>\';\r\n}\r\nif ($show =~ /(DE|All)/) {\r\n  $retval .= \'%%amazon_logo_de%%\';\r\n};\r\n\r\nreturn $retval;','','empty_box',0),('amazon_logo_ad','','return \'\' unless ($S->{UI}->{VARS}->{show_amazon});\r\nmy $sid = $S->{CGI}->param(\'sid\');\r\nreturn \'\' if (($sid eq \'2004/11/18/71113/240\') || ($sid eq \'2004/11/23/17253/990\') || ($sid eq \'2004/11/26/161614/67\'));\r\n\r\nreturn \'\' unless( $S->{UI}->{VARS}->{use_ads} );\r\n\r\nmy $retval = \"\";\r\n\r\nmy $show = $S->amazon_country(0);\r\nreturn \'\' if ($show eq \'None\');\r\n\r\n$retval = $S->run_box(\"amazon_story_ad\");\r\n\r\nreturn $retval if ($retval);\r\n\r\nif ($show =~ /(UK|All)/) {\r\n#rand should be 1 more than available blocks\r\n  my $rand = int(rand(13));\r\n  $retval .= \"%%amazon_uk_$rand%%\";\r\n};\r\nif ($show eq \'All\') {\r\n  $retval .= \'<br>\';\r\n}\r\nif ($show =~ /(US|All)/) {\r\n  my $rand = int(rand(13));\r\n  $retval .= \"%%amazon_us_$rand%%\";\r\n}\r\nif ($show eq \'All\') {\r\n  $retval .= \'<br>\';\r\n}\r\nif ($show =~ /(CA|All)/) {\r\n  $retval .= \'%%amazon_logo_ca%%\';\r\n};\r\n\r\nreturn $retval;\r\n','','empty_box',0),('amazon_new','','my $sid = $ARGS[1];\r\n\r\nreturn unless ($S->have_perm(\'amazon_scan\'));\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n    WHAT => \'introtext, bodytext\',\r\n    FROM => \'stories\',\r\n    WHERE => \'sid = ?\',\r\n    PARAMS => [$sid]});\r\n\r\nif ($rv) {\r\n    my $row = $sth->fetchrow_arrayref();\r\n    $S->find_amazon_links($sid, $row->[0] . \' \' . $row->[1]);\r\n}\r\n$sth->finish();\r\n\r\nreturn \'\';','Hook run on story new so the the amazon process will check for new products.','empty_box',0),('amazon_products','Amazon products','my $sid = $S->{CGI}->param(\'sid\');\r\n$sid = $S->cgi->param(\'target\') unless ($sid);\r\n\r\nreturn unless ($sid);\r\n\r\n$S->amazon_check_story($sid);\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n DEBUG => 0,\r\n WHAT => \"p.prod_id, p.product_name, p.author, p.manufac, p.catalog, l.details_url, l.img_url_small, l.img_url_medium, l.img_url_large, t.country_code, l.asin, l.list_price, l.our_price, UNIX_TIMESTAMP() - UNIX_TIMESTAMP(l.price_date), l.local_id, p.sid\",\r\n FROM => \"amazon_story s, amazon_prod p, amazon_local l, amazon_sites t\",\r\n WHERE => \'s.sid = ? and p.prod_id = s.prod_id and l.prod_id = s.prod_id and l.site_id = t.site_id\',\r\n PARAMS => [$sid]});\r\n\r\n$rv = 0 if ($rv eq \'0E0\');\r\nunless ($rv) {\r\n	$sth->finish();\r\n	return;\r\n}\r\n\r\nmy $content;\r\nmy $assoc;\r\nmy $country = lc $S->amazon_country(0);\r\n\r\nmy @need_update;\r\n\r\nwhile (my $product = $sth->fetchrow_arrayref()) {\r\n	if ($product->[13] > 86300) {\r\n	#update out of date data\r\n		push (@need_update, $product->[14]);\r\n		next;\r\n	}\r\n	$content .= $S->{UI}->{BLOCKS}->{amazon_product};\r\n	my $prod_country = lc $product->[9];\r\n	my $temp;\r\n	my $list_price;\r\n	my $our_price;\r\n	my $saving;\r\n	my $comments;\r\n	my $url = $product->[5];\r\n	my $prod_sid = $product->[15];\r\n	if ($prod_sid) {\r\n		$url = \"%%rootdir%%/story/$prod_sid\";\r\n	        my $stories = $S->getstories(\r\n	          {-type => \'fullstory\',\r\n	           -sid => $prod_sid});\r\n	        my $story = $stories->[0];\r\n	        my $storylink;\r\n\r\n	        my $show = $S->{UI}->{VARS}->{show_new_comments};\r\n	        my $num_new = $S->new_comments_since_last_seen($prod_sid) if ($show eq \"all\");\r\n	        my $end_s = ($story->{commentcount} == 1) ? \'\' : \'s\';\r\n		if ($story->{commentcount} > 0) {\r\n		  $end_s .= \", $num_new new\";\r\n		}\r\n		$comments = \'(\' . $story->{commentcount} . \" comment$end_s)\";\r\n	}\r\n\r\n	my $mode = $S->get_amazon_mode($product->[4], $prod_country);\r\n	my $assoc;\r\n	if ($prod_country eq \'us\') {\r\n		$assoc = $S->{UI}->{VARS}->{\"affiliate\"};\r\n	} else {\r\n		$assoc = $S->{UI}->{VARS}->{\"affiliate-$prod_country\"};\r\n	}\r\n	my $temp = $S->{UI}->{BLOCKS}->{\"amazon_buy_$prod_country\"};\r\n	$temp =~ s/%%asin%%/$product->[10]/gs;\r\n	$temp =~ s/%%assoc%%/$assoc/gs;\r\n	$temp =~ s/%%dev_token%%/$S->{UI}->{VARS}->{\"developer-token\"}/gs;\r\n  $list_price = $product->[11];\r\n	$our_price = $product->[12];\r\n	$saving = \'\';\r\n	$list_price = \'\';\r\n	$list_price = \"List price: $list_price<br>\" if ($list_price);\r\n	$our_price = \"Our price: $our_price<br>\" if ($our_price);\r\n	$saving = \"Saving: $saving<br>\" if ($saving);\r\n	if ($prod_country ne $country) {\r\n		if ($mode) {\r\n			my $search = $product->[1];\r\n			my @words = split(\' \', $search);\r\n			@words = splice(@words, 0, 5); # 5 words max\r\n			$search = join(\' \', @words);\r\n\r\n			$temp .= $S->{UI}->{BLOCKS}->{\"amazon_search_$country\"};\r\n			if ($country eq \'us\') {\r\n				$assoc = $S->{UI}->{VARS}->{\"affiliate\"};\r\n			} else {\r\n				$assoc = $S->{UI}->{VARS}->{\"affiliate-$country\"};\r\n			}\r\n			$temp =~ s/%%assoc%%/$assoc/gs;\r\n			$temp =~ s/%%dev_token%%/$S->{UI}->{VARS}->{\"developer-token\"}/gs;\r\n			$temp =~ s/%%search_keyword%%/$search/gs;\r\n			$temp =~ s/%%mode%%/$mode/gs;\r\n		}\r\n	}\r\n\r\n	my $prod_by = $product->[2]; # we use author if available, otherwise manufacturer.\r\n	$prod_by = $product->[3] unless ($prod_by);\r\n	$content =~ s/%%detail_link%%/$url/gs;\r\n	$content =~ s/%%product_name%%/$product->[1]/gs;\r\n	$content =~ s/%%author%%/$product->[2]/gs;\r\n	$content =~ s/%%manufac%%/$product->[3]/gs;\r\n	$content =~ s/%%img_url_small%%/$product->[6]/gs;\r\n	$content =~ s/%%img_url_medium%%/$product->[7]/gs;\r\n	$content =~ s/%%img_url_large%%/$product->[8]/gs;\r\n	$content =~ s/%%list_price%%/$list_price/gs;\r\n	$content =~ s/%%our_price%%/$our_price/gs;\r\n	$content =~ s/%%saving%%/$saving/gs;\r\n	$content =~ s/%%product_by%%/$prod_by/gs;\r\n	$content =~ s/%%button%%/$temp/gs;\r\n	$content =~ s/%%comments%%/$comments/gs;\r\n};\r\n$sth->finish();\r\n\r\nmy $to_update = join (\',\',  @need_update);\r\n\r\nif ($to_update) {\r\n	$S->db_update({\r\n		WHAT => \'amazon_local\',\r\n		SET => \'need_update = 1\',\r\n		WHERE => \"local_id in ($to_update)\"});\r\n}\r\n\r\nreturn $content;','','box',1),('amazon_search_select','','my $retval = \"\";\r\n\r\nmy $show = $S->amazon_country(1);\r\n\r\nif ($show =~ /(UK)/) {\r\n  $retval .= \"%%amazon_searchform_uk%%\";\r\n} elsif ($show =~ /(CA)/) {\r\n  $retval .= \'%%amazon_searchform_ca%%\';\r\n} else {\r\n  $retval .= \"%%amazon_searchform_us%%\";\r\n}\r\n\r\nreturn $retval;\r\n','','empty_box',0),('amazon_story_ad','','my $sid = $S->{CGI}->param(\'sid\');\r\n$sid = $S->cgi->param(\'target\') unless ($sid);\r\n\r\nreturn unless ($sid);\r\n\r\nmy $country = $S->amazon_country(0);\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n DEBUG => 0,\r\n WHAT => \"p.prod_id, p.product_name, p.author, p.manufac, p.catalog, l.details_url, l.img_url_small, l.img_url_medium, l.img_url_large, t.country_code, l.asin, l.list_price, l.our_price, UNIX_TIMESTAMP() - UNIX_TIMESTAMP(l.price_date), l.local_id\",\r\n FROM => \"amazon_story s, amazon_prod p, amazon_local l, amazon_sites t\",\r\n WHERE => \'s.sid = ? and p.prod_id = s.prod_id and l.prod_id = s.prod_id and l.site_id = t.site_id and t.country_code = ?\',\r\n PARAMS => [$sid, $country]});\r\n\r\nif (($rv eq \'0E0\') or ($rv == 0)) {\r\n   $sth->finish();\r\n   ($rv, $sth) = $S->db_select({\r\n   DEBUG => 0,\r\n   WHAT => \"p.prod_id, p.product_name, p.author, p.manufac, p.catalog, l.details_url, l.img_url_small, l.img_url_medium, l.img_url_large, t.country_code, l.asin, l.list_price, l.our_price, UNIX_TIMESTAMP() - UNIX_TIMESTAMP(l.price_date), l.local_id\",\r\n   FROM => \"amazon_story s, amazon_prod p, amazon_local l, amazon_sites t\",\r\n   WHERE => \'s.sid = ? and p.prod_id = s.prod_id and l.prod_id = s.prod_id and l.site_id = t.site_id\',\r\n   PARAMS => [$sid]});\r\n}\r\n\r\nreturn if ($rv eq \'0E0\');\r\nreturn unless ($rv);\r\nmy $content;\r\n$country = lc($country);\r\n\r\nmy $toskip = int(rand($rv+1));\r\n\r\nwhile (my $product = $sth->fetchrow_arrayref()) {\r\n	if ($toskip > 0) {\r\n		$toskip--;\r\n		next;\r\n	}\r\n        $S->amazon_check_single($product->[10]);\r\n	$content .= $S->{UI}->{BLOCKS}->{amazon_product};\r\n	my $prod_country = lc $product->[9];\r\n	my $temp;\r\n	my $list_price;\r\n	my $our_price;\r\n	my $saving;\r\n	my $curr;\r\n	if (($prod_country eq \'us\') || ($prod_country eq \'ca\')) {\r\n		$curr = \'$ \';\r\n	} elsif ($prod_country eq \'uk\') {\r\n		$curr = \'£\';\r\n	} else {\r\n		$curr = \'€ \';\r\n	}\r\n	my $mode = $S->get_amazon_mode($product->[4], $prod_country);\r\n	my $assoc;\r\n	if ($country eq \'us\') {\r\n		$assoc = $S->{UI}->{VARS}->{\"affiliate\"};\r\n	} else {\r\n		$assoc = $S->{UI}->{VARS}->{\"affiliate-$prod_country\"};\r\n	}\r\n	$temp = $S->{UI}->{BLOCKS}->{\"amazon_buy_$prod_country\"};\r\n	$temp =~ s/%%asin%%/$product->[10]/gs;\r\n	$temp =~ s/%%assoc%%/$assoc/gs;\r\n	$temp =~ s/%%dev_token%%/$S->{UI}->{VARS}->{\"developer-token\"}/gs;\r\n	if (lc $prod_country eq \'de\') {\r\n		$list_price = $product->[11] / 100;\r\n		$our_price = $product->[12] / 100;\r\n	} else {\r\n		$list_price = $product->[11];\r\n		$our_price = $product->[12];\r\n	}\r\n	$list_price = sprintf(\"%.2f\",$list_price) if ($list_price);\r\n	$our_price = sprintf(\"%.2f\",$our_price) if ($our_price);\r\n	$saving = sprintf(\"%.2f\",$list_price - $our_price);\r\n	$saving = \'\' if ($saving <= 0.01);\r\n	if ((\"$list_price\" eq \"$our_price\") || ($list_price <= 0.00)) {\r\n		$list_price = \'\';\r\n	}\r\n	$list_price = \"List price: $curr $list_price<br>\" if ($list_price);\r\n	$our_price = \"Our price: $curr $our_price<br>\" if ($our_price);\r\n	$saving = \"Saving: $curr $saving<br>\" if ($saving);\r\n	if ($prod_country ne $country) {\r\n		if ($mode) {\r\n			my $search = $product->[1];\r\n			my @words = split(\' \', $search);\r\n			@words = splice(@words, 0, 5); # 5 words max\r\n			$search = join(\' \', @words);\r\n\r\n			$temp .= $S->{UI}->{BLOCKS}->{\"amazon_search_$country\"};\r\n			if ($country eq \'us\') {\r\n				$assoc = $S->{UI}->{VARS}->{\"affiliate\"};\r\n			} else {\r\n				$assoc = $S->{UI}->{VARS}->{\"affiliate-$country\"};\r\n			}\r\n			$temp =~ s/%%assoc%%/$assoc/gs;\r\n			$temp =~ s/%%dev_token%%/$S->{UI}->{VARS}->{\"developer-token\"}/gs;\r\n			$temp =~ s/%%search_keyword%%/$search/gs;\r\n			$temp =~ s/%%mode%%/$mode/gs;\r\n		}\r\n	}\r\n	my $prod_by = $product->[2]; # we use author if available, otherwise manufacturer.\r\n	$prod_by = $product->[3] unless ($prod_by);\r\n	$content =~ s/%%detail_link%%/$product->[5]/gs;\r\n	$content =~ s/%%product_name%%/$product->[1]/gs;\r\n	$content =~ s/%%author%%/$product->[2]/gs;\r\n	$content =~ s/%%manufac%%/$product->[3]/gs;\r\n	$content =~ s/%%img_url_small%%/$product->[6]/gs;\r\n	$content =~ s/%%img_url_medium%%/$product->[7]/gs;\r\n	$content =~ s/%%img_url_large%%/$product->[8]/gs;\r\n	$content =~ s/%%list_price%%/$list_price/gs;\r\n	$content =~ s/%%our_price%%/$our_price/gs;\r\n	$content =~ s/%%saving%%/$saving/gs;\r\n	$content =~ s/%%product_by%%/$prod_by/gs;\r\n	$content =~ s/%%button%%/$temp/gs;\r\n	last;\r\n};\r\n$sth->finish();\r\n\r\nreturn $content;','Used to pull a relavent amazon product out of the story, and advertise that, instead of a generic advert.','empty_box',0),('amazon_story_body','','my $sid = $S->{CGI}->param(\'sid\');\r\n$sid = $S->cgi->param(\'target\') unless ($sid);\r\n\r\nreturn unless ($sid);\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n DEBUG => 0,\r\n WHAT => \"p.prod_id as prod_id, p.product_name as prod_name, p.author as author,\r\n          p.manufac as manufac, p.catalog as catalog, l.details_url as details_url,\r\n          l.img_url_small as img_url_small, l.img_url_medium as img_url_medium,\r\n          l.img_url_large as img_url_large, t.country_code as country_code,\r\n          l.asin as asin, l.list_price as list_price, l.our_price as our_price,\r\n          UNIX_TIMESTAMP() - UNIX_TIMESTAMP(l.price_date) as price_update,\r\n          l.local_id as local_id, t.associate_id as associate_id\",\r\n FROM => \"amazon_prod p, amazon_local l, amazon_sites t\",\r\n WHERE => \'p.sid = ? and l.prod_id = p.prod_id and l.site_id = t.site_id\',\r\n PARAMS => [$sid]});\r\n\r\n$rv = 0 if ($rv eq \'0E0\');\r\nunless ($rv) {\r\n	$sth->finish();\r\n	return;\r\n}\r\n\r\nmy $content;\r\nmy $country = lc $S->amazon_country(0);\r\n\r\nwhile (my $product = $sth->fetchrow_hashref()) {\r\n  $S->amazon_check_single($product->{asin});\r\n	$content .= $S->{UI}->{BLOCKS}->{amazon_body};\r\n	my @temp = [$product->{asin},$product->{associate_id}];\r\n	my $prod_country = lc $product->{country_code};\r\n	my $temp;\r\n	my $list_price;\r\n	my $our_price;\r\n	my $saving;\r\n	my $mode = $S->get_amazon_mode($product->{catalog}, $prod_country);\r\n	my $assoc;\r\n	if ($prod_country eq \'us\') {\r\n		$assoc = $S->{UI}->{VARS}->{\"affiliate\"};\r\n	} else {\r\n		$assoc = $S->{UI}->{VARS}->{\"affiliate-$prod_country\"};\r\n	}\r\n	my $curr;\r\n	if (($prod_country eq \'us\') || ($prod_country eq \'ca\')) {\r\n		$curr = \'$ \';\r\n	} elsif ($prod_country eq \'uk\') {\r\n		$curr = \'£\';\r\n	} else {\r\n		$curr = \'€ \';\r\n	}\r\n	$temp = $S->{UI}->{BLOCKS}->{\"amazon_buy_$prod_country\"};\r\n	$temp =~ s/%%asin%%/$product->{asin}/gs;\r\n	$temp =~ s/%%assoc%%/$assoc/gs;\r\n	$temp =~ s/%%dev_token%%/$S->{UI}->{VARS}->{\"developer-token\"}/gs;\r\n	$list_price = $product->{list_price};\r\n	$our_price = $product->{our_price};\r\n	$list_price = \"List price: $list_price<br>\" if ($list_price);\r\n	$our_price = \"Our price: $our_price<br>\" if ($our_price);\r\n	$saving = \"Saving: $saving<br>\" if ($saving);\r\n	if ($prod_country ne $country) {\r\n		if ($mode) {\r\n			my $search = $product->{prod_name};\r\n			my @words = split(\' \', $search);\r\n			@words = splice(@words, 0, 5); # 5 words max\r\n			$search = join(\' \', @words);\r\n\r\n			$temp .= $S->{UI}->{BLOCKS}->{\"amazon_search_$country\"};\r\n			if ($country eq \'us\') {\r\n				$assoc = $S->{UI}->{VARS}->{\"affiliate\"};\r\n			} else {\r\n				$assoc = $S->{UI}->{VARS}->{\"affiliate-$country\"};\r\n			}\r\n			$temp =~ s/%%assoc%%/$assoc/gs;\r\n			$temp =~ s/%%dev_token%%/$S->{UI}->{VARS}->{\"developer-token\"}/gs;\r\n			$temp =~ s/%%search_keyword%%/$search/gs;\r\n			$temp =~ s/%%mode%%/$mode/gs;\r\n		}\r\n	}\r\n	my $prod_by = $product->{author}; # we use author if available, otherwise manufacturer.\r\n	$prod_by = $product->{manufac} unless ($prod_by);\r\n	$content =~ s/%%detail_link%%/$product->{details_url}/gs;\r\n	$content =~ s/%%product_name%%/$product->{prod_name}/gs;\r\n	$content =~ s/%%author%%/$product->{author}/gs;\r\n	$content =~ s/%%manufac%%/$product->{manufac}/gs;\r\n	$content =~ s/%%img_url_small%%/$product->{img_url_small}/gs;\r\n	$content =~ s/%%img_url_medium%%/$product->{img_url_medium}/gs;\r\n	$content =~ s/%%img_url_large%%/$product->{img_url_large}/gs;\r\n	$content =~ s/%%list_price%%/$list_price/gs;\r\n	$content =~ s/%%our_price%%/$our_price/gs;\r\n	$content =~ s/%%saving%%/$saving/gs;\r\n	$content =~ s/%%product_by%%/$prod_by/gs;\r\n	$content =~ s/%%button%%/$temp/gs;\r\n	my $reviews;\r\n  my ($rv2,$sth2) = $S->db_select({ WHAT => \'rating,summary,comment\',\r\n                                    FROM => \'amazon_review\',\r\n                                    WHERE => \'local_id = ?\',\r\n                                    DEBUG => 0,\r\n                                    PARAMS => [$product->{local_id}]});\r\n  while (my $rev = $sth2->fetchrow_hashref()) {\r\n		my $temp = $S->{UI}->{BLOCKS}->{amazon_review};\r\n		$temp =~ s/%%summary%%/$rev->{\'summary\'}/gs;\r\n		$temp =~ s/%%comment%%/$rev->{\'comment\'}/gs;\r\n		$temp =~ s/%%rating%%/$rev->{\'rating\'}/gs;\r\n		$reviews .= $temp;\r\n	}\r\n  $sth2->finish();\r\n	$content =~ s/%%reviews%%/$reviews/gs;\r\n};\r\n$sth->finish();\r\n\r\nreturn $content;','','empty_box',0),('amazon_story_intro','','my $sid = $S->{CGI}->param(\'sid\');\r\n$sid = $ARGS[0] unless ($sid);\r\n\r\nreturn unless ($sid);\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n DEBUG => 0,\r\n WHAT => \"p.prod_id, p.product_name, p.author, p.manufac, p.catalog,\r\n          l.details_url, l.img_url_small, l.img_url_medium, l.img_url_large,\r\n          t.country_code, l.asin, l.list_price, l.our_price,\r\n          UNIX_TIMESTAMP() - UNIX_TIMESTAMP(l.price_date) as price_update, l.local_id\",\r\n FROM => \"amazon_prod p, amazon_local l, amazon_sites t\",\r\n WHERE => \'p.sid = ? and l.prod_id = p.prod_id and l.site_id = t.site_id\',\r\n PARAMS => [$sid]});\r\n\r\n$rv = 0 if ($rv eq \'0E0\');\r\nunless ($rv) {\r\n	$sth->finish();\r\n	return;\r\n}\r\n\r\nmy $content;\r\nmy $country = lc $S->amazon_country(0);\r\n\r\nwhile (my $product = $sth->fetchrow_hashref()) {\r\n  $S->amazon_check_single($product->{asin});\r\n	$content .= $S->{UI}->{BLOCKS}->{amazon_story_intro_block};\r\n	my $prod_country = lc $product->{country_code};\r\n	my $temp;\r\n	my $list_price;\r\n	my $our_price;\r\n	my $saving;\r\n	my $mode = $S->get_amazon_mode($product->{catalog}, $country);\r\n	my $assoc;\r\n	if ($prod_country eq \'us\') {\r\n		$assoc = $S->{UI}->{VARS}->{\"affiliate\"};\r\n	} else {\r\n		$assoc = $S->{UI}->{VARS}->{\"affiliate-$prod_country\"};\r\n	}\r\n	$temp = $S->{UI}->{BLOCKS}->{\"amazon_buy_$prod_country\"};\r\n	$temp =~ s/%%asin%%/$product->{asin}/gs;\r\n	$temp =~ s/%%assoc%%/$assoc/gs;\r\n	$temp =~ s/%%dev_token%%/$S->{UI}->{VARS}->{\"developer-token\"}/gs;\r\n	$list_price = $product->{list_price};\r\n	$our_price = $product->{our_price};\r\n	$list_price = \"List price: $list_price<br>\" if ($list_price);\r\n	$our_price = \"Our price: $our_price<br>\" if ($our_price);\r\n	$saving = \"Saving: $saving<br>\" if ($saving);\r\n	if ($prod_country ne $country) {\r\n		if ($mode) {\r\n			my $search = $product->{product_name};\r\n			my @words = split(\' \', $search);\r\n			@words = splice(@words, 0, 5); # 5 words max\r\n			$search = join(\' \', @words);\r\n\r\n			$temp .= $S->{UI}->{BLOCKS}->{\"amazon_search_$country\"};\r\n			if ($country eq \'us\') {\r\n				$assoc = $S->{UI}->{VARS}->{\"affiliate\"};\r\n			} else {\r\n				$assoc = $S->{UI}->{VARS}->{\"affiliate-$country\"};\r\n			}\r\n			$temp =~ s/%%assoc%%/$assoc/gs;\r\n			$temp =~ s/%%dev_token%%/$S->{UI}->{VARS}->{\"developer-token\"}/gs;\r\n			$temp =~ s/%%search_keyword%%/$search/gs;\r\n			$temp =~ s/%%mode%%/$mode/gs;\r\n		}\r\n	}\r\n	my $prod_by = $product->{author}; # we use author if available, otherwise manufacturer.\r\n	$prod_by = $product->{manufac} unless ($prod_by);\r\n	$content =~ s/%%detail_link%%/$product->{details_url}/gs;\r\n	$content =~ s/%%product_name%%/$product->{product_name}/gs;\r\n	$content =~ s/%%author%%/$product->{author}/gs;\r\n	$content =~ s/%%manufac%%/$product->{manufac}/gs;\r\n	$content =~ s/%%img_url_small%%/$product->{img_url_small}/gs;\r\n	$content =~ s/%%img_url_medium%%/$product->{img_url_medium}/gs;\r\n	$content =~ s/%%img_url_large%%/$product->{img_url_large}/gs;\r\n	$content =~ s/%%list_price%%/$list_price/gs;\r\n	$content =~ s/%%our_price%%/$our_price/gs;\r\n	$content =~ s/%%saving%%/$saving/gs;\r\n	$content =~ s/%%product_by%%/$prod_by/gs;\r\n	$content =~ s/%%button%%/$temp/gs;\r\n};\r\n$sth->finish();\r\n\r\nreturn $content;','','empty_box',0),('box_make_sids','','my ($rv, $sth) = $S->db_select({\r\n	WHAT => \'u.nickname as nick, s.introtext as intro, s.bodytext as body, s.title as title, s.sid as sourcesid, a.sid as destsid\',\r\n	FROM => \'users u, stories s, amazon_prod a, amazon_story l\',\r\n	WHERE => \'u.uid = s.aid and s.sid = l.sid and a.prod_id = l.prod_id\'});\r\n\r\nwhile (my $totrack = $sth->fetchrow_hashref()) {\r\n	my $text = $totrack->{intro} . \'<br>\' . $totrack->{body};\r\n	my $nick = $totrack->{nick};\r\n\r\n	my $excerpt = $text;\r\n\r\n	my $max_intro = $S->{UI}->{VARS}->{rdf_max_intro} || 50;\r\n	if ($max_intro) {\r\n		my @intro = split(\' \', $excerpt);\r\n		@intro = splice(@intro, 0, $max_intro);\r\n		$excerpt = join(\' \', @intro) . \'...\';\r\n	}\r\n	$excerpt =~ s/<[p|br]>/\\n/g; #preserve line & para breaks\r\n	$excerpt =~ s/<.*?>//g;\r\n	# unfilter < and >, so that we don\'t turn them into &amp;lt;\r\n	$excerpt =~ s/&lt;/</g;\r\n	$excerpt =~ s/&gt;/>/g;\r\n	# filter &\r\n	$excerpt =~ s/&/&amp;/g;\r\n	# (re-)filter < and >\r\n	$excerpt =~ s/</&lt;/g;\r\n	$excerpt =~ s/>/&gt;/g;\r\n	# Filter out high-bit characters\r\n	$excerpt =~ s/([\\200-\\377])/\"&#\".ord($1).\";\"/eg;\r\n	$excerpt =~ s/\\n/<br>\\n/g;\r\n	my $blog_name = $nick . \' from \' . $S->{UI}->{VARS}->{sitename};\r\n	my $url = $S->{UI}->{VARS}->{site_url} . $S->{UI}->{VARS}->{rootdir} . \"/story/\" . $totrack->{sourcesid};\r\n	$S->db_insert({ INTO => \'trackback\',\r\n                COLS => \'sid, url, blog_name, title, excerpt, time\',\r\n                VALUES => \'?, ?, ?, ?, ?, NOW()\',\r\n                PARAMS => [$totrack->{destsid}, $url, $blog_name, $totrack->{title}, $excerpt]\r\n                });\r\n}\r\n$sth->finish();','','empty_box',0),('box_pref','','my @choice = @ARGS;\r\n\r\nmy %boxes = %{$S->{BOX_DATA}};\r\nmy $current_prefs;\r\nmy $return = \'\';\r\n\r\n# convert the comma-separated list into a hash\r\nforeach my $i (@choice) {\r\n  $current_prefs->{$i} = 1;\r\n}\r\n\r\nmy $col = 0;\r\n\r\nforeach my $c (keys %boxes) {\r\n  next unless $boxes{$c}->{user_choose};\r\n  $return .= qq{\r\n    <TR>} unless $col;\r\n  my $checked = $current_prefs->{$c} ? \" CHECKED\" : \"\";\r\n  $return .= qq{\r\n      <TD><input type=\"checkbox\" name=\"displayed_boxes\" value=\"$c\"$checked /></TD>\r\n      <TD>$boxes{$c}->{title}</TD>};\r\n  $return .= qq{\r\n    </TR>} if $col;\r\n  $col = ($col) ? \"0\" : \"1\";\r\n}\r\n\r\n$return .= \"<TD></TD><TD></TD></TR>\" if $col;\r\n\r\n$return = qq{\r\n<TABLE border=\"0\">\r\n$return\r\n</TABLE>};\r\n\r\nreturn $return;','','empty_box',0),('cabal_users','Cabal Members','return \'\' unless (($S->{GID} eq \'Admins\') || ($S->{GID} eq \'Editors\') || ($S->{GID} eq \'Superuser\') || ($S->{GID} eq \'Permanent TU\') || ($S->{GID} eq \'Cabal Demo\'));\r\n\r\nmy $content;\r\nmy ($rv, $sth) = $S->db_select({\r\n	WHAT => \'nickname, perm_group\',\r\n	FROM => \'users\',\r\n	WHERE => \"perm_group = \'Admins\' OR perm_group = \'Editors\' OR perm_group = \'Superuser\' OR perm_group = \'Permanent TU\' OR perm_group = \'Cabal Demo\'\",\r\n	ORDER_BY => \'nickname\'});\r\n\r\nmy $users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n\r\nforeach my $user (@{$users}) {\r\n	my $urlnick = $S->{UI}->{VARS}->{rootdir};\r\n	$urlnick .= \'/user/\';\r\n	my $nick = $user->[0];\r\n	my $group = $user->[1];\r\n	$urlnick .= $nick;\r\n	$content .= qq{<a CLASS=\"light\" href=\"$urlnick\">$nick</a><br>\\n}\r\n}\r\n\r\n($rv, $sth) = $S->db_select({\r\n	WHAT => \'nickname, perm_group\',\r\n	FROM => \'users\',\r\n	WHERE => \"perm_group = \'Users\' AND trustlev >= 2\",\r\n	ORDER_BY => \'nickname\'});\r\n\r\n$content .= \"<p><hr><p>Non Cabal members - Normal trusted users ($rv)<p>\\n\";\r\n\r\nmy $users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n\r\nforeach my $user (@{$users}) {\r\n	my $urlnick = $S->{UI}->{VARS}->{rootdir};\r\n	$urlnick .= \'/user/\';\r\n	my $nick = $user->[0];\r\n	$urlnick .= $nick;\r\n	$content .= qq{<a CLASS=\"light\" href=\"$urlnick\">$nick</a><br>\\n}\r\n}\r\n\r\n($rv, $sth) = $S->db_select({\r\n	WHAT => \'nickname, perm_group\',\r\n	FROM => \'users\',\r\n	WHERE => \"perm_group = \'Users\' AND trustlev = 0\",\r\n	ORDER_BY => \'nickname\'});\r\n\r\n$content .= \"<p><hr><p>Non Cabal members - Untrusted users ($rv)<p>\\n\";\r\n\r\nmy $users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n\r\nforeach my $user (@{$users}) {\r\n	my $urlnick = $S->{UI}->{VARS}->{rootdir};\r\n	$urlnick .= \'/user/\';\r\n	my $nick = $user->[0];\r\n	$urlnick .= $nick;\r\n	$content .= qq{<a CLASS=\"light\" href=\"$urlnick\">$nick</a><br>\\n}\r\n}\r\n\r\nreturn ($content);','Show cabal members.','box',0),('calendar_actions','','my ($sub_link, $content, $newevent, $modevents, $edit_cal);\r\nmy $cal_id = $S->cgi->param(\'calendar\') || $S->var(\'default_calendar_id\');\r\n$cal_id = $S->filter_param($cal_id);\r\n\r\nif ( $cal_id ) {\r\n  # viewing a particular calendar\r\n  if ($S->have_calendar_perm(\'edit\',$cal_id)) {\r\n    $edit_cal = qq{<A href=\"%%rootdir%%/editcalendar/settings/$cal_id\">Edit this calendar</A>};\r\n  }\r\n  if ($S->have_calendar_perm(\'submit\',$cal_id)) {\r\n    $newevent = qq{<A href=\"%%rootdir%%/submitevent/submit/$cal_id\">Submit new event</A>};\r\n  }\r\n  if ( $S->have_calendar_perm(\'moderate\',$cal_id) ) {\r\n    $modevents = qq{<A href=\"%%rootdir%%/editcalendar/moderate/$cal_id\">Moderate submitted events</A>};\r\n  }  \r\n} elsif ($S->have_perm(\'edit_own_calendar\')) {\r\n  # personal calendar view\r\n  $edit_cal = qq{<A href=\"%%rootdir%%/editcalendar\">Edit your calendar</A>} if $S->var(\'allow_user_calendars\');\r\n  my $cals = $S->_cal_submit_list();\r\n  my $use_submit = 0;\r\n  foreach ( @$cals ) {\r\n    if ( $S->pref(\"calendar_${_}_subscribe\") ) {\r\n      $use_submit = 1;\r\n      next;\r\n    }\r\n  }\r\n  if ( $use_submit ) {\r\n    $newevent = qq{<A href=\"%%rootdir%%/submitevent/submit\">Submit new event</A>};\r\n  }\r\n}\r\n\r\nmy @list;\r\nfor ($newevent, $modevents, $edit_cal, $sub_link) {\r\n	push @list, $_ if ($_);\r\n}\r\nmy $list = join(\' :: \', @list);\r\n$content = qq{\r\n<DIV class=\"cal_actions\">\r\n$list\r\n</DIV>};\r\n\r\nreturn $content;\r\n','Links to the various things you can do to/with a calendar','empty_box',0),('calendar_datenav','','my $content = \'\';\r\nmy $view = $S->cgi->param(\'view\') || $S->pref(\'calendar_view\');\r\nmy @date = $S->_get_date_array($S->cgi->param(\'date\'));\r\nmy $nav_items = $S->_calendar_date_navigation($view,@date);\r\n\r\nmy $prefix = \'&lt;&lt; \';\r\nmy $suffix = \'\';\r\nmy $stage = \'before\';\r\n\r\nforeach my $item (@$nav_items) {\r\n  warn \"Item is $item->{link_url}\\n\";\r\n  my $keys = {}; # keys for interpolation\r\n  my $string = $S->{UI}->{BLOCKS}->{calendar_navigation_item};\r\n  $keys->{link_url} = $item->{link_url};\r\n\r\n  #link text\r\n  my $text;\r\n  if ( $view eq \'monthly\' ) {\r\n    my $year = $date[0];\r\n	$year -= 1 if ($item->{date_array}->[1] > $date[1] && $stage eq \'before\');\r\n	$year += 1 if ($item->{date_array}->[1] < $date[1] && $stage eq \'after\');\r\n	$text = Date::Calc::Month_to_Text($item->{date_array}->[1]) . \" \" . $year;\r\n    warn \"Date is $text\\n\";\r\n  } else {\r\n    $text = Date::Calc::Date_to_Text(@{$item->{date_array}});\r\n  }\r\n  $keys->{nav_link} = \"$prefix$text$suffix\";\r\n\r\n  if ($item->{current}) {\r\n    $keys->{css_id} = $S->{UI}->{BLOCKS}->{calendar_navigation_hilight};\r\n    $keys->{nav_link} = $text;\r\n    $prefix = \'\';\r\n    $suffix = \' &gt;&gt;\';\r\n	$stage = \'after\'\r\n  }\r\n  $content .= $S->interpolate($string,$keys);\r\n}\r\n\r\n\r\nreturn $content;','The navigation bar for the three calendar views.','empty_box',0),('calendar_selectbox','','my $cals = $S->_cal_submit_list();\r\nmy $tool = $S->cgi->param(\'tool\') || \'submit\';\r\nmy $id = $S->cgi->param(\'id\');\r\n$id = $S->filter_param($id);\r\nmy ($current,$selected);\r\n\r\nif (  $tool eq \'edit\' || $tool eq \'invite\' || ($tool eq \'submit\' && $S->cgi->param(\'newchild\')) ) {\r\n  my $event = $S->get_event($id);\r\n  $current = $S->cgi->param(\'cal_id\') || $event->{cal_id};\r\n} else {\r\n  $current = $S->cgi->param(\'cal_id\') || $id;\r\n}\r\n$current = $S->filter_param($current);\r\n\r\nmy $content = qq{\r\n      <SELECT name=\"cal_id\" size=\"1\">\r\n        <OPTION value=\"\">Select a calendar</OPTION>};\r\nforeach ( @$cals ) {\r\n  my $cal = $S->get_calendar($_);\r\n  $selected = ($current == $cal->{cal_id}) ? \' SELECTED\' : \'\';\r\n  $content .= qq|\r\n        <OPTION value=\"$cal->{cal_id}\"$selected>$cal->{title}</OPTION>|;\r\n}\r\n$content .= qq{\r\n      </SELECT>};\r\nreturn $content;','selects the calendar an event is submitted to. Selectbox with all of the calendars a use has permission to submit events ','empty_box',0),('cal_day_select','','my $day = $ARGS[0];\nmy $select;\n\n$select = qq{<OPTION value=\"00\">DD</OPTION>\n};\nforeach (1..31) {\n  my $selected = ( $day == $_ ) ? \' SELECTED\' : \'\';\n  $select .= qq{<OPTION value=\"$_\"$selected>$_</OPTION>\n};\n}\n\nreturn $select;','The options in a selectbox for a day field. Does not include the <SELECT> tags, only the <OPTION> tags.','empty_box',0),('cal_month_select','','my $month = $ARGS[0];\nmy $select;\n\n$select = qq{<OPTION value=\"00\">MM</OPTION>\n};\nforeach (1..12) {\n  my $selected = ( $month == $_ ) ? \' SELECTED\' : \'\';\n  $select .= qq{<OPTION value=\"$_\"$selected>$_</OPTION>\n};\n}\n\nreturn $select;','The options in a selectbox for a month field. Does not include the <SELECT> tags, only the <OPTION> tags.','empty_box',0),('cal_year_select','','my $year = $ARGS[0];\nmy $select;\n\n$select = qq{<OPTION value=\"0000\">YYYY</OPTION>\n};\nforeach (2004..2014) {\n  my $selected = ( $year == $_ ) ? \' SELECTED\' : \'\';\n  $select .= qq{<OPTION value=\"$_\"$selected>$_</OPTION>\n};\n}\n\nreturn $select;','The options in a selectbox for a year field. Does not include the <SELECT> tags, only the <OPTION> tags.','empty_box',0),('cc_bill_orders','','my $DEBUG = 0;\r\nmy $err;\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n    WHAT => \'ad_payments.order_id, ad_payments.cost, ad_payments.ad_id\',\r\n    FROM => \'ad_payments, ad_info\',\r\n    WHERE => \'ad_payments.ad_id = ad_info.ad_id AND \r\n              ad_info.paid = 1 AND \r\n              ad_info.judged = 1 AND\r\n              ad_info.approved = 1 AND \r\n              ad_info.active = 0 AND \r\n              ad_info.example = 0 AND \r\n              ad_info.views_left > 0 AND \r\n              ad_payments.pay_type != \\\'paypal\\\' AND\r\n              ad_payments.paid IS NULL\'\r\n});\r\n\r\nmy $orders = [];\r\nwhile (my ($order_id, $cost, $ad_id) = $sth->fetchrow()) {\r\n	$err .=  \"Order: $order_id, Cost: $cost<br>\" if $DEBUG;\r\n	push @{$orders}, {\'ad_id\'   => $ad_id,\r\n	                  \'orderID\' => $order_id,\r\n	                  \'amount\'  => $cost};\r\n}\r\n$sth->finish();\r\n\r\nif ($#{$orders} >= 0) {	\r\n    $err = $S->cc_bill_approved_ads($orders);\r\n}\r\n\r\n\r\nreturn $err;\r\n		','Post-auth CC orders','blank_box',0),('clean_up_hole','Clean out old hole entries','my ($rv, $sth);\r\n\r\n($rv, $sth) = $S->db_update({WHAT => \"stories\",\r\n			     SET  => \"to_archive=\'2\'\",\r\n			     WHERE => \"section=\'Crap\' AND DATE_ADD(time,INTERVAL 1 MONTH) < NOW()\"});\r\n\r\n$sth = $S->{DBH}->prepare(\"DELETE comments FROM comments,stories WHERE comments.sid=stories.sid AND stories.to_archive=\'2\'\");\r\n$rv = $sth->execute();\r\n\r\n$sth = $S->{DBH}->prepare(\"DELETE storyvote FROM storyvote,stories WHERE storyvote.sid=stories.sid AND stories.to_archive=\'2\'\");\r\n$rv = $sth->execute();\r\n\r\n$sth = $S->{DBH}->prepare(\"DELETE storymoderate FROM storymoderate,stories WHERE storymoderate.sid=stories.sid AND stories.to_archive=\'2\'\");\r\n$rv = $sth->execute();\r\n\r\n$sth = $S->{DBH}->prepare(\"DELETE commentratings FROM commentratings,stories WHERE commentratings.sid=stories.sid AND stories.to_archive=\'2\'\");\r\n$rv = $sth->execute();\r\n\r\n$sth = $S->{DBH}->prepare(\"DELETE pollanswers FROM pollanswers,stories WHERE pollanswers.qid=stories.attached_poll AND stories.to_archive=\'2\'\");\r\n$rv = $sth->execute();\r\n\r\n$sth = $S->{DBH}->prepare(\"DELETE pollvoters FROM pollvoters,stories WHERE pollvoters.qid=stories.attached_poll AND stories.to_archive=\'2\'\");\r\n$rv = $sth->execute();\r\n\r\n$sth = $S->{DBH}->prepare(\"DELETE pollquestions FROM pollquestions,stories WHERE pollquestions.qid=stories.attached_poll AND stories.to_archive=\'2\'\");\r\n$rv = $sth->execute();\r\n\r\n$sth = $S->{DBH}->prepare(\"DELETE viewed_stories FROM viewed_stories,stories WHERE viewed_stories.sid=stories.sid AND stories.to_archive=\'2\'\");\r\n$rv = $sth->execute();\r\n\r\n$sth = $S->{DBH}->prepare(\"DELETE story_tags FROM story_tags,stories WHERE story_tags.sid=stories.sid AND stories.to_archive=\'2\'\");\r\n$rv = $sth->execute();\r\n\r\n$sth = $S->{DBH}->prepare(\"DELETE FROM stories WHERE stories.to_archive=\'2\'\");\r\n$rv = $sth->execute();\r\n$S->log_activity(\'hole_cleanup\',\"$rv entries deleted\",\'\');\r\n\r\n\r\nreturn 1;','Delete hole entries over 1 month old','empty_box',0),('commentmode_overflow_pref','','my $choice = $ARGS[0];\r\n\r\nmy %choices = ( \"minimal\", \"Minimal\", \"threaded\", \"Threaded\", \"nested\", \"Nested\", \"flat\", \"Flat\", \"flat_unthread\", \"Flat (unthread)\" );\r\n\r\nif ( $S->var(\'allow_dynamic_comment_mode\') && $S->pref(\'dynamic_interface\') eq \'on\' ) {\r\n  $choices{\'dminimal\'} = \"Dynamic Minimal\";\r\n  $choices{\'dthreaded\'} = \"Dynamic Threaded\";\r\n} else {\r\n  $choice =~ s/^d//;\r\n}\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"commentmode_overflow\" size=\"1\">};\r\n\r\nforeach my $c (sort keys %choices) {\r\n  my $checked = ($c eq $choice) ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"$c\"$checked>$choices{$c}</OPTION>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>};\r\n\r\nreturn $select;','','empty_box',0),('commentmode_pref','','my $choice = $ARGS[0];\r\n\r\nmy %choices = ( \"use_overflow\", \"Always use overflow mode\", \"minimal\", \"Minimal\", \"threaded\", \"Threaded\", \"nested\", \"Nested\", \"flat\", \"Flat\", \"flat_unthread\", \"Flat (unthreaded)\" );\r\n\r\nif ( $S->var(\'allow_dynamic_comment_mode\') && $S->pref(\'dynamic_interface\') eq \'on\' ) {\r\n  $choices{\'dminimal\'} = \"Dynamic Minimal\";\r\n  $choices{\'dthreaded\'} = \"Dynamic Threaded\";\r\n} else {\r\n  $choice =~ s/^d//;\r\n}\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"commentmode\" size=\"1\">};\r\n\r\nforeach my $c (sort keys %choices) {\r\n  my $checked = ($c eq $choice) ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"$c\"$checked>$choices{$c}</OPTION>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>};\r\n\r\nreturn $select;','','empty_box',0),('comment_controls','Comment Controls','my $op = $S->{CGI}->param(\'op\');\r\nmy $tool = $S->{CGI}->param(\'tool\');\r\nreturn \'\' unless ($op eq \'displaystory\' || \r\n                            $op eq \'comments\' ||\r\n                            $op eq \'view_poll\'  ||\r\n                            $op eq \'poll_vote\' );\r\nreturn \'\' if( $op eq \'comments\' && $tool eq \'post\' );\r\n\r\nmy $sid = $S->filter_param($S->{CGI}->param(\'sid\'));\r\nmy $pid = $S->filter_param($S->{CGI}->param(\'pid\'));\r\nmy $cid = $S->filter_param($S->{CGI}->param(\'cid\'));\r\nmy $qid = $S->filter_param($S->{CGI}->param(\'qid\'));\r\n\r\nreturn \'\' unless ($S->{STORIES}->{$sid}->{commentstatus} == 0);\r\n\r\nreturn \'\' unless( $S->have_section_perm(\'norm_read_comments\',$S->_get_story_section($sid)));\r\n\r\nmy $form_extra;\r\nmy $anchor = qq{#$cid};\r\nif ($cid) {\r\n    $form_extra = qq{\r\n	<INPUT TYPE=\"hidden\" NAME=\"cid\" VALUE=\"$cid\">};\r\n} elsif ($pid) {\r\n    $form_extra = qq{\r\n	<INPUT TYPE=\"hidden\" NAME=\"pid\" VALUE=\"$pid\">};\r\n}\r\n\r\nmy $commentmode_select = $S->_comment_mode_select();\r\nmy $comment_order_select = $S->_comment_order_select();\r\nmy $comment_rating_select = $S->_comment_rating_select();\r\nmy $rating_choice = $S->_comment_rating_choice();\r\nmy $comment_type_select = $S->_comment_type_select();\r\n\r\nmy $form_op = \'op\';\r\nmy $form_op_value = $op;\r\nmy $id = \'sid\';\r\n\r\nif ( $qid ) {\r\n	$form_op = \'op\';\r\n	$form_op_value = \'view_poll\';\r\n	$id = \'qid\';\r\n	$sid = $qid;\r\n}\r\n\r\n$form_extra .= qq|\r\n		<INPUT TYPE=\"hidden\" NAME=\"$form_op\" VALUE=\"$form_op_value\">\r\n		<INPUT TYPE=\"hidden\" NAME=\"$id\" VALUE=\"$sid\">\r\n|;\r\n\r\nmy $comment_rate_choice;\r\nif ($S->have_perm( \'comment_rate\' )) {\r\n	$comment_rate_choice .= qq|\r\n	Rate?\r\n	$rating_choice|;\r\n}\r\n\r\nmy $comment_sort = $S->{UI}->{BLOCKS}->{comment_controls};\r\n	\r\n$comment_sort =~ s/%%anchor%%/$anchor/gi;\r\n$comment_sort =~ s/%%hidden_inputs%%/$form_extra/gi;\r\n$comment_sort =~ s/%%commenttype_select%%/$comment_type_select/gi;\r\n$comment_sort =~ s/%%commentmode_select%%/$commentmode_select/gi;\r\n$comment_sort =~ s/%%commentrating_select%%/$comment_rating_select/gi;\r\n$comment_sort =~ s/%%commentorder_select%%/$comment_order_select/gi;\r\n$comment_sort =~ s/%%commentrating_choice%%/$comment_rate_choice/gi;\r\n\r\nreturn { content => $comment_sort };','Comment display prefs','empty_box',0),('comment_controls_user','Comment Controls','return \'%%BOX,comment_controls%%\';','','box',1),('comment_ip_link','','return \'\' unless ($S->have_perm(\'view_comment_ip\'));\r\nmy $content;\r\nmy $ip = $ARGS[0];\r\n$ip =~ s/(Poster\\\'s IP\\: )(.*)/<a CLASS=\"light\" href=\"%%rootdir%%\\/special\\/ip_usage?ip=$2\"\\>$2<\\/a>/;\r\n$content = $ip;\r\n\r\nreturn $content;\r\n','','empty_box',0),('cookie_expire_pref','','my $choice = $ARGS[0];\r\n\r\nmy %choices = ( \"3600\", \"1 hour\", \"86400\", \"1 day\", \"604800\", \"1 week\", \"1209600\", \"2 weeks\", \"2592000\", \"1 month (30 days)\", \"5184000\", \"2 months\" );\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"cookie_expire\" size=\"1\">};\r\n\r\nforeach my $c (sort {$a <=> $b} keys %choices) {\r\n  my $checked = ($c eq $choice) ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"$c\"$checked>$choices{$c}</OPTION>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>};\r\n\r\nreturn $select;','','empty_box',0),('cron_edit_queue','','#main sub\r\n\r\n# Get the expire time\r\nmy $expire = $S->{UI}->{VARS}->{queue_edit_max_time};\r\nmy $factors = {\r\n	d => \'86400\',\r\n	h => \'3600\',\r\n	m => \'60\',\r\n	s => \'1\'\r\n};\r\n$expire =~ s/([^\\d])$//;\r\nmy $time_sub = $expire * $factors->{$1};\r\n\r\nmy $select = {\r\n	DEBUG => 0,\r\n	WHAT => \"sid, score, time, displaystatus\",\r\n	FROM => \'stories\',\r\n	WHERE => \"displaystatus = -3 AND UNIX_TIMESTAMP(NOW()) - UNIX_TIMESTAMP(time) >= $time_sub\",\r\n	ORDER_BY => \'time DESC\'\r\n};\r\n\r\nmy ($rv, $sth) = $S->db_select($select);\r\n\r\nmy $sid_move_to_moderate;\r\nwhile (my $story = $sth->fetchrow_hashref()) {\r\n	# only move if the time has expired\r\n	$sid_move_to_moderate = $story->{sid};\r\n	$S->move_story_to_voting($story->{sid});\r\n}\r\n\r\n$sth->finish();\r\n\r\nreturn 1;\r\n','','empty_box',0),('css','css','my $content;\r\n\r\nmy $file = $S->cgi->param(\'file\');\r\nmy $block = $file.\"_css\";\r\n\r\n$content = $S->{UI}->{BLOCKS}->{$block};\r\n$S->apache->content_type(\'text/css\');\r\n\r\nreturn {content => $content};','Returns a block with type text/css','empty_box',0),('delete_comment_reply','','my $sid = $ARGS[1];\r\nmy $cid = $ARGS[2];\r\n\r\nmy $where = \'sid = ? and new_cid = ?\';\r\n\r\n	my ($rv, $sth) = $S->db_delete({\r\n		FROM	=> \'message_list\',\r\n		WHERE	=> $where,\r\n		PARAMS	=> [$sid,$cid]});\r\n\r\n\r\nreturn \'\';','Delete new comment replys.','empty_box',0),('detect_agent','','\r\nmy $agent = $S->{APACHE}->headers_in->{ \'User-Agent\' };\r\nmy $ver = substr $agent, 0, 4;\r\nif (($agent =~ /android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile|o2|opera mini|palm( os)?|plucker|pocket|pre\\/|psp|smartphone|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce; (iemobile|ppc)|xiino/i) ||\r\n   ($ver =~ /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|e\\-|e\\/|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\\-|2|g)|yas\\-|your|zeto|zte\\-/i))\r\n{\r\n	$agent = \"mobile\";\r\n} else\r\n{\r\n	$agent = \"\";\r\n}\r\n\r\nreturn $agent;','detects user agent, returns a code string.','blank_box',0),('diarysub_box','','## START diarysub_box ##\r\n my $op = $S->cgi->param(\'op\');\r\nmy $user = $S->cgi->param(\'user\');\r\nmy $content;\r\nif($S->{GID} ne \'Anonymous\'){\r\n  my $subscriptions;\r\n  map {$subscriptions->{$_}=1;} split(/,/,$S->pref(\'diary_sub\'));\r\n  if($op eq \'diary\'){\r\n    if(exists $subscriptions->{$user}){\r\n      delete $subscriptions->{$user};\r\n    }else{$subscriptions->{$user}=1;}\r\n    $S->_save_pref($S->user_data($S->{UID}),\'diary_sub\',join(\',\',keys %$subscriptions));\r\n    if ($S->{UI}->{VARS}->{hotlist_cache}) {\r\n      my $cache_file = $S->{UI}->{VARS}->{hotlist_cache_path};\r\n      $cache_file .= \"/hotlist-diaries.\" . $S->{UID};\r\n      open (NEWCACHE, \">$cache_file\");\r\n      print NEWCACHE $content;\r\n      close NEWCACHE;\r\n    }\r\n\r\n    $S->{APACHE}->headers_out->{\'Location\'} = $S->{REFERER} || \"$S->{UI}->{VARS}->{rootdir}/section/Diary\";\r\n$S->{APACHE}->headers_out->{\'Connection\'} = \'close\';\r\n    $S->{APACHE}->status(301); $S->{HEADER_ONLY}=1;\r\n  } else{\r\n    my $nick = $S->cgi->param(\'nick\');\r\n    $nick = $ARGS[0] unless ($nick);\r\n    my $text=($subscriptions->{$nick})?\'Unwatch\':\'Watch\';\r\n    $content=qq{<a href=\"%%rootdir%%/diary/$nick\">$text</a> $nick}. \"\'s diary\";\r\n    return{content=>$content};\r\n  }\r\n}\r\n\r\n## END diarysub_box ##\r\n','Diary subscription link to sub/unsub diaries','empty_box',0),('donate','Donate to HuSi','return \'\';\r\n#return \'%%donate_text%%\';','Begging bowl','box',1),('embed_youtube','Embeded youtube videos','my $origarg = $ARGS[0];\r\nmy $pref = $S->pref(\'youtube\');\r\nmy $embedarg = $origarg;\r\n\r\nmy $output;\r\nif ($embedarg =~ m/name\\=\\\"movie\\\"/) {\r\n	$embedarg =~ s/.+value=\"http:\\/\\/www\\.youtube\\.com\\/v\\/([\\w-]+).+/$1/;\r\n} elsif ($embedarg =~ m/http:\\/\\/www\\.youtube\\.com\\/watch/) {\r\n	$embedarg =~ s/.*http:\\/\\/www\\.youtube\\.com\\/watch\\?v=([\\w-]+).*/$1/;\r\n} else {\r\n	#warn \"didn\'t match anything, returning filtered text\\n\";\r\n	return $S->filter_subject($embedarg);\r\n}\r\n\r\nif (lc($pref) eq \"yes\") {\r\n	$output = \'<object width=\"425\" height=\"355\"><param name=\"movie\" value=\"http://www.youtube.com/v/%%VID%%&color1=0x3a3a3a&color2=0x999999\"></param><param name=\"wmode\" value=\"transparent\"></param><embed src=\"http://www.youtube.com/v/%%VID%%&color1=0x3a3a3a&color2=0x999999\" type=\"application/x-shockwave-flash\" wmode=\"transparent\" width=\"425\" height=\"355\"></embed></object>\';\r\n} else {\r\n	$output = \'<a href=\"http://www.youtube.com/watch?v=%%VID%%\">http://www.youtube.com/watch?v=%%VID%%</a>\';\r\n}\r\n$output =~ s/%%VID%%/$embedarg/g;\r\n#warn \"Output is : $output\\n\";\r\n\r\nreturn \"$output\";','','empty_box',0),('erase_user','','return unless $S->have_perm(\'erase_user\');\r\n\r\nmy $uid = $S->cgi->param(\'uid\');\r\nmy $nick = $S->cgi->param(\'nick\');\r\nunless ($uid) {\r\n$uid = $S->get_uid_from_nick($nick);\r\n}\r\nmy $erase = $S->cgi->param(\'erase\');\r\nmy $confirm = $S->cgi->param(\'confirm\');\r\n\r\n#warn \"Nick is: $nick, uid is $uid\\n\";\r\nreturn unless ($uid);\r\n\r\nmy $return;\r\n\r\nif ($erase && $confirm && $uid) {\r\n$return = \"Erasing $nick...<br>\";\r\n\r\n# First, wipe user ratings\r\n$S->undo_user_ratings($uid);\r\n$return .= \'Wiped ratings...<br>\';\r\n\r\n# Make anonymous\r\nmy ($rv, $sth) = $S->db_update({\r\nWHAT => \"users\",\r\nSET => qq{perm_group = \"Banished\"},\r\nWHERE => \"uid = $uid\"});\r\n$sth->finish();\r\n$return .= \'Anonymized account...<br>\';\r\n\r\n$rv = $S->db_delete({\r\n                FROM => \'userprefs\',\r\n                WHERE => \"uid = $uid\"});\r\n$return .= \'Removed user settings...<br>\';\r\n\r\n# Remove all comments\r\n($rv, $sth) = $S->db_select({\r\nWHAT => \'sid, cid, pid\',\r\nFROM => \'comments\',\r\nWHERE => \"uid = $uid\"});\r\nmy $i = 0;\r\nmy ($sid, $cid, $pid) = $sth->fetchrow();\r\nwhile ($cid) {\r\n$i++;\r\n$S->_delete_comment($sid, $cid, $pid);\r\n($sid, $cid, $pid) = $sth->fetchrow();\r\n}\r\n$sth->finish();\r\n$return .= \"Erased $i comments...<br>\";\r\n\r\n# Hide stories\r\n($rv, $sth) = $S->db_update({\r\nWHAT => \'stories\',\r\nSET => \"displaystatus = \'-1\'\",\r\nWHERE => \"aid = $uid\"\r\n});\r\n$return .= \"Hid all stories...<br>\";\r\n$return .= \"Done.\";\r\n$S->log_activity(\'erase_user\',\"$nick erased\",$return);\r\n} else {\r\n#my $urlnick = $S->urlify($nick);\r\n$return = qq{\r\n<form name=\"eraseuser\" method=\"GET\" action=\"%%rootdir%%/erase\">%%norm_font%%\r\n<input type=\"hidden\" name=\"nick\" value=\"$nick\">\r\n<input type=\"submit\" name=\"erase\" value=\"Erase $nick\">\r\n<input type=\"checkbox\" name=\"confirm\"> Are you sure?\r\n%%norm_font_end%%</form>};\r\n}\r\n\r\nreturn $return;','','empty_box',0),('event','','return if $S->cgi->param(\'op\') eq \'event\';\r\n\r\nmy $sid = $ARGS[0];\r\nmy $q_sid = $S->dbh->quote($sid);\r\n\r\nmy ($rv,$sth) = $S->db_select({\r\n   DEBUG => 0,\r\n   WHAT => \'eid\',\r\n   FROM => \'event_story\',\r\n   WHERE => qq{sid = $q_sid}\r\n});\r\n\r\nreturn if ( $rv == 0 );\r\n\r\nmy ($eid) = $sth->fetchrow_array();\r\nmy $event = $S->get_event($eid);\r\n\r\nmy $link = $S->{UI}->{BLOCKS}->{story_event_link};\r\nreturn $S->interpolate($link,$event);','displays the link to the event, if the story is associated with an event','empty_box',0),('event_calendar_invitations','','my $hook = $ARGS[0];\nmy $uid = $ARGS[1];\nmy $pref = $ARGS[2];\nmy $value = $ARGS[3];\n\nif ( $pref =~ /event_(.*)_invite/ && $value eq \'on\' ) {\n  $S->_invite_notify(\'event\',$1,$uid);\n} elsif ( $pref =~ /calendar_(.*)_invite/ && $value eq \'on\' ) {\n  $S->_invite_notify(\'calendar\',$1,$uid);\n}\n\n# not either of those, so don\'t do anything','handles notification of invitation for calendars and events (tied to pref_change hook)','empty_box',0),('event_invitations','New Invitations','my $content;\n\nmy ($rv,$sth) = $S->db_select({\n   WHAT => \'eid\',\n   FROM => \'event_watch\',\n   WHERE => qq@uid = $S->{UID} AND last_viewed = 0@\n});\n\nwhile ( my ($eid) = $sth->fetchrow_array() ) {\n  my $event = $S->get_event($eid);\n  $content .= qq@%%dot%% <A href=\"%%rootdir%%/event/$eid\">$event->{title}</A><BR>@;\n}\n\nreturn $content;','Shows a list of events to which the user is invited if they haven\'t yet followed the link','box',0),('event_notify','Event Updates','my $content;\nmy ($rv,$sth) = $S->db_select({\n  WHAT => \'*\',\n  FROM => \'event_watch LEFT JOIN events USING (eid)\',\n  WHERE => \"uid=$S->{UID} AND subscribed=1\"\n});\n\nwhile ( my $item = $sth->fetchrow_hashref() ) {\n  next unless ( $item->{last_update} > $item->{last_viewed} );\n  my $event = $S->get_event($item->{eid});\n  $content .= qq@%%dot%% <A href=\"%%rootdir%%/event/$item->{eid}\">$event->{title}</A><BR>@;\n}\n\nreturn $content;','a disappearing/reappearing box that notifies users if an event that they\'ve subscribed to has been changed since they last saw it.','box',0),('event_stories','','my $eid = $S->cgi->param(\'eid\');\r\nmy $event = $S->get_event($eid);\r\nmy $page;\r\n\r\nif ( $event->{is_parent} ) {\r\n  # get the stories for all the child events too\r\n  my @eids = ($eid);\r\n  my ($rv,$sth) = $S->db_select({\r\n       DEBUG => 0,\r\n       WHAT => \'eid\',\r\n       FROM => \'events\',\r\n       WHERE => \"parent = $eid\"\r\n  });\r\n  while ( my ($e) = $sth->fetchrow_array() ) {\r\n    push @eids, $e;\r\n  }\r\n  my $sql_eids = join(\',\',map {$S->dbh->quote($_)} @eids );\r\n  $page = $S->frontpage_view(\'summaries\', \"eid IN ($sql_eids)\", \'left join event_story e on s.sid = e.sid\');\r\n} else {\r\n  # get only the stories for this one event\r\n  $page = $S->frontpage_view(\'summaries\', \"eid = $eid\", \'left join event_story e on s.sid = e.sid\');\r\n}\r\n\r\nreturn $page;','displays the formatted stories attached to this event','empty_box',0),('expire_subs','expire_subs','# Get list of subscribers \r\nmy ($rv, $sth) = $S->db_select({ \r\n    WHAT => \'uid\', \r\n    FROM => \'subscription_info\', \r\n    WHERE => \'UNIX_TIMESTAMP(NOW()) > expires AND active = 1\' }); \r\nmy @users; \r\nwhile (my $r = $sth->fetchrow()) { \r\n    push @users, $r;\r\n    } \r\n$sth->finish(); \r\n# Deactivate subscriptions \r\n($rv, $sth) = $S->db_update({ \r\n    WHAT => \'subscription_info\', \r\n    SET => qq{active = 0, last_updated = NOW(), updated_by = \'system\'}, \r\n    WHERE => \'UNIX_TIMESTAMP(NOW()) > expires AND active = 1\' }); \r\n$sth->finish(); \r\n# Change users group back \r\n#my $gid = $S->_get_default_group(); \r\nmy $gid = \'Permanent TU\'; \r\nmy $where = \'uid = \' . join(\' OR uid = \', @users); \r\n($rv, $sth) = $S->db_update({ \r\n    WHAT => \'users\', \r\n    SET => qq{perm_group = \'$gid\'}, \r\n    WHERE => $where }); \r\n$sth->finish(); ','Expire subscriptions','blank_box',0),('faq_allowed_html','','my $content;\r\nmy $type = $ARGS[0];\r\n$type = \'comment\' unless ($type);\r\n\r\n$content = $S->html_checker->allowed_html_as_string($type);\r\n\r\nreturn $content;','Shows allowed html in the FAQ','empty_box',0),('fckfiles','','my $uid = $S->{UID};\r\n\r\nmy $header = qq{<?xml version=\"1.0\" encoding=\"utf-8\" ?>\\n};\r\nmy $command = $S->filter_subject($S->cgi->param(\'Command\'));\r\nmy $resourcetype = $S->filter_subject($S->cgi->param(\'Type\'));\r\nmy $content = \"\";\r\n\r\nmy $file_link = $S->var(\'upload_link_user\') . $uid . \'/\';\r\n\r\n$S->apache->content_type(\'text/xml\');\r\n\r\nmy $err = 0;\r\nmy $errdesc = \"\";\r\n\r\nif (($command eq \'FileUpload\') || ($command eq \'CreateFolder\')) {\r\n	$err = 1;\r\n	$errdesc = \"The $command isn\'t allowed.\";\r\n} else {\r\n	$content = $header;\r\n	$content .= qq{<Connector command=\"$command\" resourceType=\"$resourcetype\">};\r\n\r\n	$content .= qq{<CurrentFolder path=\"/\" url=\"$file_link\" />};\r\n	if ($command eq \'GetFolders\') {\r\n		$content .= \"<Folders>\\n</Folders>\";\r\n	}\r\n	if ($command eq \'GetFoldersAndFiles\') {\r\n		$content .= \"<Folders>\\n</Folders>\";\r\n		$content .= \"<Files>\\n\";\r\n		my @files = $S->get_file_list($uid, \'user\');\r\n		my $file_total_count = scalar @files;\r\n		my $file_counter = 0;\r\n		@files = sort { lc($a) cmp lc($b) } @files;\r\n\r\n		while ($file_counter < $file_total_count ) {\r\n			my $file_name = $files[$file_counter];\r\n			$content .= qq{<File name=\"$file_name\" size=\"0\" />\\n};\r\n			$file_counter++;\r\n		}\r\n		$content .= \"</Files>\\n\";\r\n	}\r\n	$content .= \"</Connector>\";\r\n}\r\n\r\nif ($err != 0) {\r\n	$content = $header . \"<Connector>\\n\";\r\n	$content .= qq{<Error number=\"$err\" text=\"$errdesc\" />\\n};\r\n	$content .= \"</Connector>\";\r\n}\r\n\r\nreturn $content;','FCKEditor file connector','empty_box',0),('file_location','','my $content = $S->{UI}->{VARS}->{upload_link_user};\r\n\r\n$content .= $S->{UID} . \'/\';\r\n\r\nreturn $content;','Returns the users file location.','empty_box',0),('fortune_box','Inspiration','my $content = `/usr/games/fortune -s`;\r\n$content =~ s/\\n\\s+-/%%norm_font_end%%<\\/I><\\/TD><\\/TR><TR><TD ALIGN=\"right\" BGCOLOR=\"%%box_content_bg%%\">%%norm_font%%<I>/g;\r\n\r\nreturn \"%%norm_font%%<I>$content</I>%%end_norm_font%%\";\r\n','Output of the fortune program, for kicks.','box',0),('google_adlinks','Google','my $sid = $S->{CGI}->param(\'sid\');\r\nreturn \'\' if (($sid eq \'2004/11/18/71113/240\') || ($sid eq \'2004/11/23/17253/990\') || ($sid eq \'2004/11/26/161614/67\') || ($sid eq \'2005/4/10/53513/1961\') || ($sid eq \'2005/4/10/22342/4915\') || ($sid eq \'2005/5/24/15223/6056\') || ($sid eq \'2005/7/7/54638/76993\') || ($sid eq \'2006/3/29/153454/458\') || ($sid eq \r\n\'2008/7/17/172814/482\') || ($sid eq \r\n\'2008/6/26/131112/907\'));\r\nreturn qq{\r\n<script type=\"text/javascript\"><!--\r\ngoogle_ad_client = \"pub-8028642453271155\";\r\ngoogle_ad_width = 180;\r\ngoogle_ad_height = 90;\r\ngoogle_ad_format = \"180x90_0ads_al_s\";\r\ngoogle_ad_channel =\"\";\r\n//--></script>\r\n<script type=\"text/javascript\"\r\n  src=\"http://pagead2.googlesyndication.com/pagead/show_ads.js\">\r\n</script><p>};','Displayed in stories under the related links box','box',1),('google_ad_box','','my $sid = $S->param(\'sid\');\r\nreturn \'\' if (($sid eq \'2004/11/18/71113/240\') || ($sid eq \'2004/11/23/17253/990\') || ($sid eq \'2004/11/26/161614/67\') || ($sid eq \'2005/4/10/53513/1961\') || ($sid eq \'2005/4/10/22342/4915\') || ($sid eq \'2005/5/24/15223/6056\') || ($sid eq \'2005/7/7/54638/76993\') || ($sid eq \'2006/3/29/153454/458\') || ($sid eq \r\n\'2008/7/17/172814/482\') || ($sid eq \r\n\'2008/6/26/131112/907\'));\r\nreturn \'%%google_ad_user%%\' if($S->{GID} ne \'Anonymous\');\r\nreturn \'%%google_ad_anon%%\';','','empty_box',0),('google_analytics_adsense_box','','my $content = $S->{UI}->{BLOCKS}->{google_analytics_adsense};\r\nreturn $content if($S->{GID} eq \'Anonymous\');\r\nreturn \'\';','Returns the google_analytics block if the user is not logged in.','empty_box',0),('google_analytics_box','','my $content = $S->{UI}->{BLOCKS}->{google_analytics};\r\nreturn $content if($S->{GID} eq \'Anonymous\');\r\nreturn \'\';','Returns the google_analytics block if the user is not logged in.','empty_box',0),('google_banner_box','','return \'\' if($S->{GID} ne \'Anonymous\');\r\nmy $sid = $S->{CGI}->param(\'sid\');\r\nreturn \'\' if (($sid eq \'2004/11/18/71113/240\') || ($sid eq \'2004/11/23/17253/990\') || ($sid eq \'2004/11/26/161614/67\') || ($sid eq \'2005/4/10/53513/1961\') || ($sid eq \'2005/4/10/22342/4915\') || ($sid eq \'2005/5/24/15223/6056\') || ($sid eq \'2005/7/7/54638/76993\') || ($sid eq \'2006/3/29/153454/458\') || ($sid eq \r\n\'2008/7/17/172814/482\') || ($sid eq \r\n\'2008/6/26/131112/907\'));\r\nreturn \'%%google_ad_banner%%\';','','empty_box',0),('google_banner_loggedin_box','Google In-Story Ad Banner','return \'\' if($S->{GID} eq \'Anonymous\');\r\nmy $sid = $S->{CGI}->param(\'sid\');\r\nreturn \'\' if (($sid eq \'2004/11/18/71113/240\') || ($sid eq \'2004/11/23/17253/990\') || ($sid eq \'2004/11/26/161614/67\') || ($sid eq \'2005/4/10/53513/1961\') || ($sid eq \'2005/4/10/22342/4915\') || ($sid eq \'2005/5/24/15223/6056\') || ($sid eq \'2005/7/7/54638/76993\') || ($sid eq \'2006/3/29/153454/458\') || ($sid eq \r\n\'2008/7/17/172814/482\') || ($sid eq \r\n\'2008/6/26/131112/907\'));\r\nreturn qq{%%google_ad_banner_loggedin%%};','','empty_box',1),('google_site_verification','','return \'google-site-verification: google71a415f79eb74390.html\'','','empty_box',0),('hidebox_box','','## START hidebox_box ##\r\n# Requires an image name to be defined in the variable \'hidebox_icon\'\r\n# This box should be called from within the box template \'box\'\r\n# The call should be of the form:\r\n# %%BOX,hidebox_box,%%bid%%%%\r\n# an example box closer icon can be seen at:\r\n# http://beta.evilplans.net/images/x.gif\r\n\r\n### Really Start Hidebox Box ###\r\n# Display a Box CLoser \'X\' in box templates\r\n# Version 0.1 by hillct\r\n\r\nmy($content);\r\nmy $uri=$S->filter_param($S->apache->uri);\r\nmy $arg = $S->filter_param($S->apache->args());\r\n$arg =~ s/hide-box=\\w+//g;\r\n$arg =~ s/;$//;\r\nmy $redirect=($arg)?\"$uri?$arg\":$uri;\r\nmy $input = $S->filter_param($ARGS[0]);\r\n$uri .= ($arg) ? \"?$arg;hide-box=$input\" : \"?hide-box=$input\";\r\n\r\nif($S->{GID} ne \'Anonymous\') {	# If logged in\r\n  if($S->cgi->param(\'hide-box\')=~/$ARGS[0]/){\r\n# Change the user pref for display of this box\r\n    $S->pref(displayed_boxes=>$S->pref(\'displayed_boxes\').\',\'.$ARGS[0]);\r\n# Redirect because we\'re actually running the box\r\n    $S->apache->header_out(\'location\',$redirect);\r\n    $S->apache->header_out(\'connection\',\'close\');\r\n    $S->apache->status(301); $S->{HEADER_ONLY}=1;\r\n  } else {\r\n# Display an \'X\' with a link to \'URI\' if allowed\r\n    if($S->{BOX_DATA}{$ARGS[0]} && $S->{BOX_DATA}{$ARGS[0]}{user_choose}){\r\n      $content.=qq{<span class=\"hidebox\"><a href=\"$uri\"><img src=\"$S->{UI}->{VARS}->{\'imagedir\'}/x.gif\" border=\"0\" alt=\"close\" style=\"vertical-align: top; float: right\"></a></span>};\r\n    }\r\n  }\r\n  return {content => $content};\r\n}\r\n\r\n## END hidebox_box ##','','empty_box',0),('hosting_controls','Hosting Controls','return;','Hosting controls','blank_box',0),('hotlist_box','Old style Hotlist','if ($S->{HOTLIST} && $#{$S->{HOTLIST}} >= 0) {\r\n	my $box_content;\r\n\r\n	foreach my $sid (@{$S->{HOTLIST}}) {\r\n		my $stories = $S->getstories(\r\n			{-type => \'fullstory\',\r\n			-sid => $sid});\r\n		my $story = $stories->[0];\nnext unless ($story);\n\r\n\r\n		my $show = $S->{UI}->{VARS}->{show_new_comments};\r\n		my $num_new = $S->new_comments_since_last_seen($sid) if ($show eq \"hotlist\" || $show eq \"all\");\r\n\r\n		my $end_s = ($story->{commentcount} == 1) ? \'\' : \'s\';\r\n		$box_content .= qq~%%dot%% <A CLASS=\"light\" HREF=\"|rootdir|/story/$sid\">$story->{title}</a> ($story->{commentcount} comment$end_s~;\r\n		$box_content .= \", $num_new new\" if defined($num_new);\r\n		$box_content .= \")<BR>\";\r\n	}\r\n\r\n	return unless $box_content;\nmy $title = \"$S->{NICK}\'s Hotlist\";\r\n	return {title => $title, content => $box_content };\r\n}\r\n','the hotlist box','box',0),('hotlist_box_new','Your Hotlist','return unless ($S->{HOTLIST} && $#{$S->{HOTLIST}} >= 0);\n\nmy $box_content;\nmy $sids;\nmy $stories = $S->story_data($S->{HOTLIST});\nmy $show = $S->var(\'show_new_comments\');\nforeach my $story (@$stories) {\n   my $num_new = $story->{comments} - $story->{lastseen} if ($show eq \"hotlist\" || $show eq \"all\");\n   my $end_s = ($story->{comments} == 1) ? \'\' : \'s\';\n   $box_content .= qq~%%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/story/$story->{sid}\">$story->{title}</a> ($story->{comments} comment$end_s~;\n   $box_content .= \", $num_new new\" if defined($num_new);\n   $box_content .= \")<BR>\";\n}\n\nreturn unless $box_content;\nmy $title = \"$S->{NICK}\'s Hotlist\";\nreturn {title => $title, content => $box_content};\n','Replacement hotlist box for new story fetching code','box',0),('hotlist_flex_box','Your Hotlist','## START hotlist_flex+diaries K5 style ##\r\n## START hotlist_flex+diary ##\r\n\r\n# Display Hotlist, Stories and unread replies to user comments\r\n# Version 0.3.1 by hillct\r\n# Version 0.4.0 by hulver\r\n# Version 0.5.0 by hulver\r\n\r\nreturn unless ($S->have_perm(\'hotlist_flex\'));\r\nmy($view,$content,$item);\r\nmy $dynamic = ($S->cgi->param(\'op\') eq \'dyn_hotlist\');\r\nmy $uri=$S->filter_param($S->{APACHE}->uri);\r\nmy $arg = $S->filter_param($S->apache->args());\r\n$arg =~ s/toggle-hotlist=\\w+//g;\r\n$arg =~ s/;$//;\r\n\r\n$uri .= ($arg) ? \"?$arg;\" : \'?\';\r\n\r\n\r\nif($S->{GID} ne \'Anonymous\') {	# Only if we\'re logged in\r\n  my $view = $S->pref(\'hotlist-exclude\');\r\n  if ($dynamic) {\r\n    $view = \',hotlist,diary,replies\';\r\n  }\r\n  my $toggle = $S->{CGI}->param(\'toggle-hotlist\');\r\n#  my $warning;\r\n  $toggle = \"\" unless ($toggle =~ /[hotlist|diary|replies]/);\r\n  if ($toggle && ($view =~ /,?$toggle/i)) {\r\n    $view =~ s/,?$toggle//i;\r\n  } elsif ($toggle) {\r\n    $view .= \",$toggle\";\r\n  }\r\n#  if (length($view) == 0) {\r\n#    if ($toggle =~ /diary/) {\r\n#      $view = \',replies\';\r\n#    } else {\r\n#      $view = \',diary\';\r\n#    }\r\n#    $warning = qq{<br>Cannot display all 3 hotlists} if ($toggle);\r\n#  }\r\n  my $expand = qq{<img src=\"%%imagedir%%/dyn_exp.gif\" width=\"12\" height=\"16\" ALT=\"+\" border=\"0\">};\r\n  my $collapse = qq{<img src=\"%%imagedir%%/dyn_col.gif\" width=\"12\" height=\"16\" ALT=\"-\" border=\"0\">};\r\n  if ($view ne $S->pref(\'hotlist-exclude\') && !$dynamic) {\r\n    $S->_save_pref($S->user_data($S->{UID}),\'hotlist-exclude\',$view);\r\n  }\r\n  $content .= qq{<div id=\"hotlist-flex-hotlist\">} unless ($dynamic);\r\n  if ($view =~ /hotlist/) {\r\n    $content .= qq{<b><a class=\"light\" href=\"$uri} . qq{toggle-hotlist=hotlist\">$expand Hotlist</a></b><br>};\r\n  } else {\r\n    $content .= qq{<b><a class=\"light\" href=\"$uri} . qq{toggle-hotlist=hotlist\">$collapse Hotlist</a></b><br>\r\n%%BOX,hotlist_flex_hotlist%%<br>};\r\n  }\r\n  $content .= qq{</div>\\n} unless ($dynamic);\r\n  $content .= qq{<div id=\"hotlist-flex-diary\">} unless ($dynamic);\r\n  if ($view =~ /diary/) {\r\n    $content .= qq{<b><a class=\"light\" href=\"$uri} . qq{toggle-hotlist=diary\">$expand Watchlist</a></b><br>};\r\n  } else {\r\n    $content .= qq{<b><a class=\"light\" href=\"$uri} . qq{toggle-hotlist=diary\">$collapse Watchlist</a></b><br>\r\n%%BOX,hotlist_flex_diaries%%<br>};\r\n  }\r\n  $content .= qq{</div>\\n} unless ($dynamic);\r\n  $content .= qq{<div id=\"hotlist-flex-replies\">} unless ($dynamic);\r\n  if ($view =~ /replies/) {\r\n    $content .= qq{<b><a class=\"light\" href=\"$uri} . qq{toggle-hotlist=replies\">$expand New replies</a></b><br>};\r\n  } else {\r\n    $content .= qq{<b><a class=\"light\" href=\"$uri} . qq{toggle-hotlist=replies\">$collapse New replies</a></b><br>\r\n%%BOX,hotlist_flex_replies%%<br>};\r\n  }\r\n  $content .= qq{</div>} unless ($dynamic);\r\n#  $content .= $warning;\r\n  $content .= qq{<iframe width=0 height=0 border=0 style=\"width:0;height:0;border:0\" id=\"dyn_hotlist\" name=\"dyn_hotlist\" src=\"about:blank\"></iframe>};\r\n  \r\n  return {title => \"$S->{NICK}\'s Hotlist\", content => $content};\r\n}\r\n\r\n## END hotlist_flex+diary ##\r\n\r\n## END hotlist_flex+diaries K5 style ##\r\n','the flex hotlist box','box',1),('hotlist_flex_diaries','New Diaries','## START hotlist_flex+diaries K5 style ##\r\n## START hotlist_flex+diary ##\r\n\r\n # Display Hotlist, Stories and unread replies to user comments\r\n# Version 0.3.1 by hillct\r\n# Version 0.4.0 by hulver\r\n\r\nreturn unless ($S->have_perm(\'hotlist_flex\'));\r\nreturn if ($S->{GID} eq \'Anonymous\');\r\nmy($view,$content,$item,$cache_file);\r\n\r\nmy $uri=$S->filter_param($S->{APACHE}->uri);\r\nmy $arg = $S->filter_param($S->apache->args());\r\n$arg =~ s/set-view=\\w+//g;\r\n$arg =~ s/clear=\\w+//g;\r\n$arg =~ s/;$//;\r\n\r\n$uri .= ($arg) ? \"?$arg;\" : \'?\';\r\n\r\nmy $clear = $S->{CGI}->param(\'clear\');\r\nmy $show_only_new = $S->{CGI}->param(\'show_only_new\');\r\n\r\nif ($S->{UI}->{VARS}->{hotlist_cache}) {\r\n  $cache_file = $S->{UI}->{VARS}->{hotlist_cache_path};\r\n  $cache_file .= \"/hotlist-diaries.\" . $S->{UID};\r\n  my $op = $S->{CGI}->param(\'op\');\r\n  if (($op eq \'diary\') || $clear || $show_only_new) {\r\n    $content = \'\';\r\n  } else {\r\n    my @cache_stat = stat($cache_file);\r\n    if ((time() - $S->{UI}->{VARS}->{hotlist_cache_age}) < $cache_stat[9]) {\r\n      open(CACHE,\"<$cache_file\");\r\n      while(<CACHE>){\r\n        $content .= $_;\r\n      }\r\n      close CACHE;\r\n      $content .= \" <!-- diary_cached -->\";\r\n      if (($op eq \'comments\') || ($op eq \'displaystory\') || ($op eq \'view_poll\')) {\r\n        my $sid = $S->{CGI}->param(\'sid\') || $S->{CGI}->param(\'qid\');\r\n        # ditch the cache if we\'re looking at a story mentioned in the replies list\r\n        if ($content =~ /$sid/) {\r\n          $content = \"\";\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return $content if ($content);\r\n}\r\n\r\nmy $clear_link;\r\nmy $clearall_link = $S->{APACHE}->uri . \"?clear=_all_\";\r\n$clearall_link=qq{<p><center><b><a href=\"$clearall_link\" class=\"light\">Clear All</a></b></center><p>\\n};\r\nmy @subscriptions=split(/,/,$S->pref(\'diary_sub\'));\r\n@subscriptions=sort { lc($a) cmp lc($b) } @subscriptions;\r\nmy $authors;\r\nmy @sids;\r\nmy $titles;\r\nmy $sections;\r\nmy $uid;\r\nmy $where;\r\n\r\nif ($show_only_new eq \'y\') {\r\n  $S->_save_pref($S->user_data($S->{UID}),\'show_only_new\',\'y\');\r\n} elsif ($show_only_new) {\r\n  $S->_save_pref($S->user_data($S->{UID}),\'show_only_new\',\'\');\r\n}\r\n$show_only_new = $S->pref(\'show_only_new\');\r\nmy $show_link = $S->filter_param($S->{APACHE}->uri) . \"?show_only_new\";\r\nif ($show_only_new) {\r\n  $content.=qq{<b><a href=\"$show_link=n\" class=\"light\">Show all users</a></b><p>\\n};\r\n} else {\r\n  $content.=qq{<b><a href=\"$show_link=y\" class=\"light\">Show only new entries</a></b><p>\\n};\r\n}\r\n\r\nforeach my $auth (@subscriptions) {\r\n    $where .= \", \" if ($where);\r\n    $where .= $S->{DBH}->quote(lc($auth));\r\n}\r\nif ($where) {\r\n	$where = \"lower(users.nickname) in (\" . $where . \")\";\r\n	my ($rv, $sth) = $S->db_select({\r\n	     DEBUG=> 0,\r\n	     WHAT => \'users.nickname, sid, title, section\',\r\n	     FROM => \'stories inner join users on aid=uid\',\r\n	     WHERE => qq{$where AND time >= DATE_SUB(NOW(), INTERVAL 30 DAY) and (section = \'Diary\' or section = \'Crap\' or section = \'cellar\')},\r\n	     ORDER_BY => \'time desc\'\r\n	     });\r\n	\r\n	while (my ($auth, $sid, $title, $section) = $sth->fetchrow()) {\r\n	  next if (defined $S->story_last_seen($sid));\r\n	  if (($clear eq $auth) || ($clear eq \'_all_\')) {\r\n	    $S->update_seen_if_needed($sid);\r\n	    next;\r\n	  }\r\n	  push @sids, $sid;\r\n	  push @{$authors->{$auth}}, $sid;\r\n	  if (length($title) > 25) {\r\n	    $title =~ s/^(.{22}).*$/$1.../;\r\n	  }\r\n	  $titles->{$sid} = $title;\r\n	  $sections->{$sid} = $section;\r\n	}\r\n	$sth->finish();\r\n}\r\nmy $shown = 0;\r\n\r\nforeach my $author (@subscriptions) {\r\n  my $l_author = $S->urlify($author);\r\n  my $new = 0;\r\n  my $a_content;\r\n  #warn \"Author is $author, new is $new\\n\";\r\n  $a_content.=qq{<b><a class=\"light\" href=\"%%rootdir%%/diary/$l_author\">%%hotlist_remove_link%%</a> };\r\n  $a_content.=qq{<a class=\"light\" href=\"%%rootdir%%/user/$l_author/diary\">$author</a></b>};\r\n\r\n  my $title_links;\r\n  foreach my $posted_sid (@{$authors->{$author}}) {\r\n    my $dot;\r\n    #warn \"SID is $posted_sid, New is $new\\n\";\r\n    $new++;\r\n    if ($sections->{$posted_sid} eq \'Crap\') {\r\n      $dot = \"%%hole_image%%\";\r\n    } else {\r\n      $dot = \"%%dot%%\"; \r\n    } \r\n    $title_links .= qq{<br>$dot <a class=\"light\" href=\"%%rootdir%%/story/$posted_sid\">$titles->{$posted_sid}</a>};\r\n  }\r\n	  \r\n  if ($new) {\r\n    $clear_link = $S->{APACHE}->uri . \"?clear=$l_author\";\r\n    $a_content .= qq{ (<b>$new</b> new) (<a href=\"$clear_link\" class=\"light\">clear</a>) $title_links<br>};\r\n  } else {\r\n    $a_content .= qq{ (0 new)<br>};\r\n  }\r\n  $a_content .= \"\\n\";\r\n  if (($new && $show_only_new) || (!$show_only_new)) {\r\n    $content .= $a_content;\r\n    $shown = 1;\r\n  }\r\n}\r\nif ($shown && ($#subscriptions >= 0)) {\r\n  $content = $clearall_link . $content;\r\n} elsif ($#subscriptions >= 0) {\r\n  $content = \"<p>$content\" . \"There are no new entries to show\";\r\n} else {\r\n  $content =\"<p>You have no users on your watch list\";\r\n}\r\n$content .=\"</p>\";\r\n\r\nif ($cache_file) {\r\n  open (NEWCACHE, \">$cache_file\");\r\n  print NEWCACHE $content;\r\n  close NEWCACHE;\r\n}\r\n\r\nreturn ($content);\r\n\r\n## END hotlist_flex+diary ##\r\n\r\n## END hotlist_flex+diaries K5 style ##\r\n','The hotlist replies box','empty_box',0),('hotlist_flex_hotlist','','# Version 0.4.0 by hulver\r\n# Version 0.5.0 by hulver\r\n\r\n\r\nreturn unless ($S->have_perm(\'hotlist_flex\'));\r\nreturn if ($S->{GID} eq \'Anonymous\');\r\nmy($content,$item);\r\n\r\n$content .= \'<p>\';\r\n\r\nif ($S->{HOTLIST} && $#{$S->{HOTLIST}} >= 0) {\r\n  $content .= qq{\r\n<div class=\"hotlist-hotlist\">};\r\n\r\nforeach my $sid (@{$S->{HOTLIST}}) {\r\n  my $stories = $S->getstories(\r\n    {-type => \'fullstory\',\r\n     -sid => $sid});\r\n  my $story = $stories->[0];\r\n  my $show = $S->{UI}->{VARS}->{show_new_comments};\r\n  my $num_new = $S->new_comments_since_last_seen($sid) if ($show eq \"hotlist\" || $show eq \"all\");\r\n  if (defined($story->{commentcount})) {\r\n    my $end_s = ($story->{commentcount} == 1) ? \'\' : \'s\';\r\n    my $popup = qq{$story->{commentcount} Comment$end_s};\r\n    $content .= qq{ <div class=\"hotlistitem\">\r\n<a class=\"hotlist-flex\" href=\"%%rootdir%%/hotlist/remove/$sid/displaystory\" class=\"light\">%%hotlist_remove_link%%</a> <a href=\"%%rootdir%%/story/$sid\" class=\"light\" title=\"$popup\">$story->{title}</a> (<span class=\"commentcount\" title=\"$popup\">$story->{commentcount}</span>};\r\n		$content .= \", <b>$num_new</b> new\" if ($num_new);\r\n		$content .= \")</div>\\n\";\r\n  }\r\n}\r\n$content .= qq{</div>};\r\n\r\n} else { \r\n  $content.=\"No Hotlisted Stories\"; \r\n}\r\n$content .= \"</p>\";\r\nreturn $content;\r\n\r\n## END hotlist_flex+diary ##\r\n\r\n## END hotlist_flex+diaries K5 style ##\r\n','The hotlist box','empty_box',0),('hotlist_flex_old','Old hotlist','## START hotlist_flex+diaries K5 style ##\r\n## START hotlist_flex+diary ##\r\n\r\n # Display Hotlist, Stories and unread replies to user comments\r\n# Version 0.3.1 by hillct\r\n# Version 0.4.0 by hulver\r\n\r\nreturn unless ($S->have_perm(\'hotlist_flex\'));\r\nmy($view,$content,$item);\r\nmy $uri=$S->{APACHE}->uri;\r\nmy $arg = $S->apache->args();\r\n$arg =~ s/set-view=\\w+//g;\r\n$arg =~ s/;$//;\r\n\r\n$uri .= ($arg) ? \"?$arg;\" : \'?\';\r\n\r\nif($S->{GID} ne \'Anonymous\') {	# Only if we\'re logged in\r\n  if($S->{CGI}->param(\'set-view\')=~/Hotlist|Replies|Stories|Diaries/){\r\n    $view=$S->{CGI}->param(\'set-view\');\r\n    $S->session(\'hotlist-view\',$view);\r\n  } else {$view = $S->session(\'hotlist-view\') || \'Hotlist\';}\r\n  my $clear = $S->{CGI}->param(\'clear\');\r\n\r\n  $content=\"<center>\";\r\n  for (\'Hotlist\',\'Replies\',\'Stories\',\'Diaries\'){\r\n    $content.=(($_ eq $view)?\"<b>$_</b> | \":\"<a \r\nhref=\\\"$uri\".\"set-view=$_\\\" CLASS=\\\"light\\\">$_</a> | \");\r\n  } \r\n  $content =~ s/\\|\\s$//; \r\n  $content.=\"</center>\";\r\n  \r\n  if($view eq \'Hotlist\'){\r\n	$content .= \'<p>\';\r\n\r\n		\r\n	if ($S->{HOTLIST} && $#{$S->{HOTLIST}} >= 0) {\r\n	  	$content .= qq{\r\n		<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=1 CELLSPACING=0>};\r\n\r\n      foreach my $sid (@{$S->{HOTLIST}}) {\r\n        my $stories = $S->getstories(\r\n          {-type => \'fullstory\',\r\n           -sid => $sid});\r\n        my $story = $stories->[0];\r\n\r\n        my $show = $S->{UI}->{VARS}->{show_new_comments};\r\n        my $num_new = $S->new_comments_since_last_seen($sid) if \r\n($show eq \"hotlist\" || $show eq \"all\");\r\n\r\n        my $end_s = ($story->{commentcount} == 1) ? \'\' : \'s\';\r\n        $content .= qq{ \r\n		<TR>\r\n	  		<TD VALIGN=\"top\"><A HREF=\"%%rootdir%%/hotlist/remove/$sid/displaystory\" CLASS=\"light\">%%hotlist_remove_link%%</A></TD><TD>%%norm_font%%<A HREF=\"%%rootdir%%/story/$sid\" CLASS=\"light\">$story->{title}</A><BR>($story->{commentcount} comment$end_s};\r\n		$content .= \", <B>$num_new</B> new\" if defined($num_new);\r\n		$content .= qq{)%%norm_font_end%%</TD>\r\n		</TR>};\r\n      }\r\n	  $content .= qq{\r\n		</TABLE>};\r\n\r\n    } else{ $content.=\"<font size=1>No Hotlisted Stories</font>\"; }\r\n  }elsif($view eq \'Replies\'){\r\n    $content .= \'<p>\';\r\n\r\n    my($results,$comment,$sid);\r\n    my ($rv, $sth) = $S->db_select({\r\n      WHAT => \'c1.sid,c2.cid,c2.subject\',\r\n      FROM => \'comments AS c1 LEFT JOIN comments as c2 on c2.sid=c1.sid \r\nAND c2.pid=c1.cid LEFT JOIN viewed_stories ON viewed_stories.sid=c1.sid \r\nAND viewed_stories.uid=c1.uid\',\r\n      WHERE => qq{c1.uid=$S->{UID} AND c2.sid IS NOT NULL AND c2.date > DATE_SUB(NOW(), INTERVAL 14 DAY) AND (c2.cid > viewed_stories.highest_idx or viewed_stories.highest_idx is null)}\r\n    });\r\n\r\n    while ($comment = $sth->fetchrow_hashref()) {\r\n      $results->{$comment->{\'sid\'}}.=qq{\r\n           <br>%%dot%%\r\n         <a CLASS=\"light\" href=\"%%rootdir%%/comments/$comment->{\'sid\'}/$comment->{\'cid\'}#$comment->{\'cid\'}\"><font size=\"1\">$comment->{\'subject\'}</font></a> };\r\n    }\r\n    my $reply_txt;\r\n    for $sid (keys %$results){\r\n        next if ($S->_check_story_mode($sid) == -1);\r\n        next unless($S->_does_poll_exist($sid) || $S->have_section_perm(\'norm_read_comments\',$S->_get_story_section( $sid ))  );\r\n	my $title;\r\n	my $path;\r\n        if( $S->_does_poll_exist($sid) ) {\r\n                $title = $S->get_poll_hash($sid)->{question};\r\n		$path = \"/poll/\";\r\n        } else {\r\n                $title = $S->_get_story_title($sid);\r\n		$path = \"/story/\";\r\n        }\r\n	$reply_txt .= qq{\r\n	  	<p>\r\n        <a CLASS=\"light\" href=\"%%rootdir%%$path$sid\"><font\r\n        size=\"2\">$title</font></a>\r\n		$results->{$sid}\r\n		</p>\r\n      };\r\n	  \r\n    }\r\n\r\n    $content .= $reply_txt || qq{<font size=\"1\">No New Replies to your Comments</font>};\r\n\r\n  }elsif($view eq \'Stories\'){\r\n	$content.=\'<p>\';\r\n    my ($results,$story);\r\n    my $uid = $S->get_uid_from_nick($S->{NICK});\r\n    my ($rv, $sth) = $S->db_select({\r\n      WHAT => \'stories.title,stories.sid,stories.section,COUNT(comments.cid) AS commentcount\',\r\n      FROM => \'stories LEFT JOIN comments ON comments.sid=stories.sid\',\r\n      #WHERE => qq{aid=\'$S->{NICK}\' AND time >= DATE_SUB(NOW(), INTERVAL 30 DAY) AND displaystatus != \'-1\'},\r\n      WHERE => qq{aid=\'$uid\' AND time >= DATE_SUB(NOW(), INTERVAL 30 DAY) AND displaystatus != \'-1\'},\r\n      GROUP_BY => \'stories.sid\',\r\n      ORDER_BY => \'time DESC\'\r\n    });\r\n	\r\n	my $linknick = $S->urlify($S->{NICK});\r\n	my $stories_text;\r\n	my ($story_count, $diary_count);\r\n    while ($story = $sth->fetchrow_hashref()) {\r\n      my $sid=$story->{sid};\r\n	  if ($story->{section} eq \'Diary\') {\r\n	  	$diary_count++;\r\n	  } elsif ($story->{section} ne \'advertisements\') {\r\n	  	$story_count++;\r\n	  }\r\n      my $show = $S->{UI}->{VARS}->{show_new_comments};\r\n      my $num_new = $S->new_comments_since_last_seen($sid) if \r\n($show eq \"hotlist\" || $show eq \"all\");\r\n\r\n      my $end_s = ($story->{commentcount} == 1) ? \'\' : \'s\';\r\n      $stories_text .= qq{		\r\n	    <TR>\r\n	  	  <TD VALIGN=\"top\">%%dot%%</td>\r\n		  <td valign=\"top\">%%norm_font%%<a class=\"light\" href=\"%%rootdir%%/story/$sid\">$story->{title}</a><br>($story->{commentcount} \r\ncomment$end_s};\r\n      $stories_text .= qq{, <b>$num_new</b> new} if defined($num_new);\r\n      $stories_text .= qq{)%%norm_font_end%%</td></tr>};\r\n    }\r\n\r\n	if ($stories_text) {\r\n		$content .= qq{\r\n		<TABLE WIDTH=\"100%\" BORDER=0 CELLPADDING=1 CELLSPACING=0>\r\n		$stories_text\r\n		</TABLE>\r\n		<p>\r\n		Older: <a CLASS=\"light\" href=\"%%rootdir%%/?op=search&offset=$story_count&old_count=0&type=author&topic=&section=&string=$linknick&count=30&next=Next+Page+%3E%3E\">Stories</a>, \r\n		       <a CLASS=\"light\" href=\"%%rootdir%%/?op=search&offset=$diary_count&old_count=0&type=diary_by&topic=&section=&string=$linknick&count=30&next=Next+Page+%3E%3E\">Diaries</a>};\r\n	} else {\r\n	    $content.=\"<font size=1>You have written no stories in the last 30 days.</font>\";\r\n	}\r\n#\"\r\n  }elsif($view eq \'Diaries\'){\r\n	$content.=\'<p>\';\r\n	my $clear_link = $S->{APACHE}->uri . \"?clear=_all_\";\r\n	$content.=qq{<center><b><a href=\"$clear_link\" class=\"light\">Clear All</a></b></center><p>};\r\n        my @subscriptions=split(/,/,$S->pref(\'diary_sub\'));\r\n        @subscriptions=sort { lc($a) cmp lc($b) } @subscriptions;\r\n        my $authors;\r\n	my @sids;\r\n	my $titles;\r\n	my $uid;\r\n	my $where;\r\n	foreach my $auth (@subscriptions) {\r\n	    $where .= \", \" if ($where);\r\n	    $where .= $S->{DBH}->quote($auth);\r\n        }\r\n	$where = \"users.nickname in (\" . $where . \")\";\r\n#    	    $uid = $S->get_uid_from_nick($auth);\r\n        my ($rv, $sth) = $S->db_select({\r\n          DEBUG=> 0,\r\n	  WHAT => \'users.nickname, sid, title\',\r\n	  FROM => \'stories inner join users on aid=uid\',\r\n	  WHERE => qq{$where AND time >= DATE_SUB(NOW(), INTERVAL 30 DAY) AND section=\'Diary\'},\r\n	  ORDER_BY => \'time desc\'\r\n	});\r\n	\r\n	while (my ($auth, $sid, $title) = $sth->fetchrow()) {\r\n	    next if (defined $S->story_last_seen($sid));\r\n	    if (($clear eq $auth) || ($clear eq \'_all_\')) {\r\n		$S->update_seen_if_needed($sid);\r\n		next;\r\n	    }\r\n	    push @sids, $sid;\r\n	    push @{$authors->{$auth}}, $sid;\r\n	    if (length($title) > 25) {\r\n		$title =~ s/^(.{22}).*$/$1.../;\r\n	    }\r\n	    $titles->{$sid} = $title;\r\n	}\r\n	$sth->finish();\r\n\r\n	foreach my $author (@subscriptions) {\r\n	  my $l_author = $S->urlify($author);\r\n	  my $new = 0;\r\n	  #warn \"Author is $author, new is $new\\n\";\r\n	  $content.=qq{<b><a CLASS=\"light\" href=\"%%rootdir%%/diary/$l_author\">%%hotlist_remove_link%%</a> };\r\n          $content.=qq{<a CLASS=\"light\" href=\"%%rootdir%%/user/$l_author/diary\">$author</a></b>};\r\n\r\n	  my $title_links;\r\n	  foreach my $posted_sid (@{$authors->{$author}}) {\r\n	  	#warn \"SID is $posted_sid, New is $new\\n\";\r\n		$new++;\r\n		$title_links .= qq{<br>%%dot%% <a CLASS=\"light\" href=\"%%rootdir%%/story/$posted_sid\">$titles->{$posted_sid}</a>};\r\n	  }\r\n	  \r\n	  if ($new) {\r\n	      $clear_link = $S->{APACHE}->uri . \"?clear=$l_author\";\r\n	      $content .= qq{ (<b>$new</b> new) (<a href=\"$clear_link\" class=\"light\">clear</a>) %%smallfont%%$title_links%%smallfont_end%%<br>};\r\n	  } else {\r\n	  	  $content .= qq{ (0 new)<br>};\r\n      }\r\n\r\n\r\n    }\r\n    $content.=\"<font size=1>You have no diaries on your watch list</font>\" if $#subscriptions==-1;\r\n  }else{$content.=\"This error should never occur.\";}\r\n  return {title => \"$S->{NICK}\'s $view\", content => $content};\r\n}\r\n\r\n## END hotlist_flex+diary ##\r\n\r\n## END hotlist_flex+diaries K5 style ##\r\n','the old flex hotlist box','box',0),('hotlist_flex_replies','New Replies','## START hotlist_flex+diaries K5 style ##\r\n## START hotlist_flex+diary ##\r\n\r\n # Display Hotlist, Stories and unread replies to user comments\r\n# Version 0.3.1 by hillct\r\n# Version 0.4.0 by hulver\r\n# Version 0.5.0 by hulver\r\n\r\nreturn unless ($S->have_perm(\'hotlist_flex\'));\r\nreturn if ($S->{GID} eq \'Anonymous\');\r\n\r\nmy $content = \'<p>\';\r\n\r\nmy $reply_txt;\r\nmy $stuff;\r\n\r\n$stuff = $S->get_comment_replys();\r\n\r\nmy $sid;\r\nmy $path, $title;\r\nforeach my $row (@$stuff) {\r\n	if ($sid ne $row->{sid}) {\r\n		$sid = $row->{sid};\r\n		$reply_txt .= qq{</p>} if ($reply_txt);\r\n		if( $S->_does_poll_exist($sid) ) {\r\n			$title = $S->get_poll_hash($sid)->{question};\r\n			$path = \"/poll/\";\r\n		} else {\r\n			#$title = $row->{title};\r\n			$title = $S->_get_story_title($sid);\r\n			$path = \"/story/\";\r\n		}\r\n		$reply_txt .= qq{<p>\r\n        <a class=\"light\" href=\"%%rootdir%%$path$sid\">$title</a>}\r\n	}\r\n	$reply_txt .= qq{\r\n       <br>%%dot%% <a class=\"light\" href=\"%%rootdir%%/comments/$sid/$row->{new_cid}#$row->{new_cid}\">$row->{subject}</a> };\r\n}\r\n$reply_txt .= \'</p>\' if $reply_txt;\r\n\r\n$content .= $reply_txt || qq{No New Replies to your Comments};\r\n$content .= \'</p>\';\r\n\r\nreturn ($content);\r\n\r\n## END hotlist_flex+diary ##\r\n\r\n## END hotlist_flex+diaries K5 style ##\r\n','The hotlist replies box','empty_box',0),('hotlist_flex_replies_old','New Replies','## START hotlist_flex+diaries K5 style ##\r\n## START hotlist_flex+diary ##\r\n\r\n # Display Hotlist, Stories and unread replies to user comments\r\n# Version 0.3.1 by hillct\r\n# Version 0.4.0 by hulver\r\n\r\nreturn unless ($S->have_perm(\'hotlist_flex\'));\r\nreturn if ($S->{GID} eq \'Anonymous\');\r\nmy($content,$item);\r\nmy $cache_file;\r\n\r\nif ($S->{UI}->{VARS}->{hotlist_cache}) {\r\n  $cache_file = $S->{UI}->{VARS}->{hotlist_cache_path};\r\n  $cache_file .= \"/hotlist-replies.\" . $S->{UID};\r\n  my @cache_stat = stat($cache_file);\r\n  if ((time() - $S->{UI}->{VARS}->{hotlist_cache_age}) < $cache_stat[9]) {\r\n    open(CACHE,\"<$cache_file\");\r\n    while(<CACHE>){\r\n      $content .= $_;\r\n    }\r\n    close CACHE;\r\n    $content .= \" <!-- comment_cached -->\";\r\n    my $op = $S->{CGI}->param(\'op\');\r\n    if (($op eq \'comments\') || ($op eq \'displaystory\') || ($op eq \'view_poll\')) {\r\n      my $sid = $S->{CGI}->param(\'sid\') || $S->{CGI}->param(\'qid\');\r\n# ditch the cache if we\'re looking at a story mentioned in the replies list\r\n      if ($content =~ /$sid/) {\r\n        $content = \"\";\r\n      }\r\n    }\r\n    return $content if ($content);\r\n  }\r\n}\r\n\r\n$content .= \'<p>\';\r\n\r\nmy($results,$comment,$sid);\r\nmy ($rv, $sth) = $S->db_select({\r\n      WHAT => \'c1.sid,c2.cid,c2.subject\',\r\n      FROM => \'comments AS c1 LEFT JOIN comments as c2 on c2.sid=c1.sid \r\nAND c2.pid=c1.cid LEFT JOIN viewed_stories ON viewed_stories.sid=c1.sid \r\nAND viewed_stories.uid=c1.uid\',\r\n      WHERE => qq{c1.uid=$S->{UID} AND c2.sid IS NOT NULL AND c2.date > DATE_SUB(NOW(), INTERVAL 14 DAY) AND (c2.cid > viewed_stories.highest_idx or viewed_stories.highest_idx is null)}\r\n    });\r\n\r\nwhile ($comment = $sth->fetchrow_hashref()) {\r\n  $results->{$comment->{\'sid\'}}.=qq{\r\n       <br>%%dot%%\r\n     <a class=\"light\" href=\"%%rootdir%%/comments/$comment->{\'sid\'}/$comment->{\'cid\'}#$comment->{\'cid\'}\">$comment->{\'subject\'}</a> };\r\n}\r\nmy $reply_txt;\r\nfor $sid (keys %$results){\r\n    next if ($S->_check_story_mode($sid) == -1);\r\n    next unless($S->_does_poll_exist($sid) || $S->have_section_perm(\'norm_read_comments\',$S->_get_story_section( $sid ))  );\r\n    my $title;\r\n    my $path;\r\n    if( $S->_does_poll_exist($sid) ) {\r\n       $title = $S->get_poll_hash($sid)->{question};\r\n       $path = \"/poll/\";\r\n    } else {\r\n       $title = $S->_get_story_title($sid);\r\n       $path = \"/story/\";\r\n    }\r\n    $reply_txt .= qq{\r\n	  	<p>\r\n        <a class=\"light\" href=\"%%rootdir%%$path$sid\">$title</a>\r\n		$results->{$sid}\r\n		</p>\r\n                    };\r\n}\r\n\r\n$content .= $reply_txt || qq{No New Replies to your Comments};\r\n\r\nif ($cache_file) {\r\n  open (NEWCACHE, \">$cache_file\");\r\n  print NEWCACHE $content;\r\n  close NEWCACHE;\r\n}\r\n\r\nreturn ($content);\r\n\r\n## END hotlist_flex+diary ##\r\n\r\n## END hotlist_flex+diaries K5 style ##\r\n','The hotlist replies box','empty_box',0),('hulvercam_box','Hulver cam','return \"\";\r\nmy $content = \"\r\n<a href=\\\"/images/webcam.jpg\\\"><img border=0 width=\\\"160\\\" height=\\\"120\\\" align=\\\"center\\\" src=\\\"/images/webthumb.jpg\\\"></a>\";\r\n\r\nreturn $content;','Oh my God!','box',0),('img_server_pref','','my $current = $ARGS[0];\r\n\r\nreturn unless $S->var(\'image_mirrors\');\r\nmy @mirrors = split /\\n/, $S->var(\'image_mirrors\');\r\nmy $default_imgdir = $S->{PREF_ITEMS}->{imagedir}->{default_value};\r\n\r\nmy (%servers, $name, $url);\r\n\r\nforeach my $server (@mirrors) {\r\n ($name, $url) = split /,/, $server;\r\n $url =~ s/\\r//;\r\n $servers{$name} = $url;\r\n}\r\n\r\nmy $selected = ( $current eq $default_imgdir ) ? \' SELECTED\' : \'\';\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"imagedir\" size=\"1\">\r\n        <OPTION value=\"$default_imgdir\"$selected>Default</OPTION>};\r\n\r\nforeach my $server (sort keys %servers) {\r\n  $selected = ( $current eq $servers{$server} ) ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n         <OPTION value=\"$servers{$server}\"$selected>$server</A>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>};\r\n\r\nreturn $select;','','empty_box',0),('iplookup','','my $content;\r\nmy $ip = $S->cgi->param(\'iplook\');\r\n$ip = $S->filter_param($ip);\r\n\r\n$content = \"<table><tr><td><b>Users created from IP address $ip:</b></td></tr>\";\r\n\r\n# Get list of users created from this IP address\r\nmy ($rv, $sth) = $S->db_select({\r\n   WHAT => \'nickname, perm_group\',\r\n   FROM => \'users\',\r\n   WHERE => qq~creation_ip = \'$ip\'~\r\n   });\r\n\r\nwhile (my $user = $sth->fetchrow_hashref()){\r\n    $content .= qq~\r\n        <tr><td><a href=\"/user/$user->{\'nickname\'}\">$user->{\'nickname\'}</A> </td><td>$user->{\'perm_group\'}</td></tr>~;\r\n    }\r\n$sth->finish;\r\n\r\n# figure out the basic subnet\r\nmy @net = split(/\\./, $ip);\r\nmy $sub = $net[0] . \".\" . $net[1] . \".\" . $net[2] . \".\";\r\n\r\n$content .= qq~<tr><td><b>Users created from ${sub}*:</b></td></tr>~;\r\n\r\n($rv, $sth) = $S->db_select({\r\n   WHAT => \'nickname, perm_group\',\r\n   FROM => \'users\',\r\n   WHERE => qq~creation_ip like \'${sub}%\'~\r\n   });\r\n\r\nwhile (my $user = $sth->fetchrow_hashref()){\r\n    $content .= qq~\r\n        <tr><td><a href=\"/user/$user->{\'nickname\'}\">$user->{\'nickname\'}</A> </td><td>$user->{\'perm_group\'}</td></tr>~;\r\n    }\r\n$sth->finish;\r\n\r\n# comments, if we\'re keeping track of that sort\r\n# of thing\r\nif($S->{UI}->{VARS}->{\'comment_ip_log\'}){\r\n    $content .= \"<tr><td><b>Users who have posted from $ip:</b></td></tr>\";\r\n    ($rv, $sth) = $S->db_select({\r\n        WHAT => \'comments.commentip, users.nickname, users.perm_group\',\r\n        FROM => \'comments left join users on comments.uid = users.uid\',\r\n        WHERE => qq~commentip = \'$ip\'~,\r\n        GROUP_BY => \'comments.uid\'\r\n        });\r\n    while (my $c = $sth->fetchrow_hashref()){\r\n        $content .= qq~<tr><td><a href=\"/user/$c->{\'nickname\'}\">$c->{\'nickname\'}</a></td><td>$c->{\'perm_group\'}</td></tr>~;\r\n        }\r\n    $sth->finish;\r\n    $content .= \"<tr><td><b>Users who have posted from ${sub}*:</b></td></tr>\";\r\n    ($rv, $sth) = $S->db_select({\r\n        WHAT => \'comments.commentip, users.nickname, users.perm_group\',\r\n        FROM => \'comments left join users on comments.uid = users.uid\',\r\n        WHERE => qq~commentip like \'${sub}%\'~,\r\n        GROUP_BY => \'comments.uid\'\r\n        });\r\n    while (my $c = $sth->fetchrow_hashref()){\r\n        $content .= qq~<tr><td><a href=\"/user/$c->{\'nickname\'}\">$c->{\'nickname\'}</a></td><td>$c->{\'perm_group\'}</td></tr>~;\r\n        }\r\n    $sth->finish;\r\n    }\r\n\r\n$content .= \"</table>\";\r\n\r\n# get the whois info. NOTE: for this to work\r\n# right, you need to have the whois command \r\n# installed. Normally, this shouldn\'t be a\r\n# problem\r\n$content .= \"<P><b>WHOIS info for $ip</b><P>\";\r\nmy $whois = `/usr/bin/whois $ip`;\r\n# sigh, gotta format it right\r\n#my @z = split /\\n/, $whois;\r\n#while (my $line = @z){\r\n#    $content .= \"$line<br>\";\r\n#    }\r\n$content .= \"<pre>$whois</pre>\";\r\n\r\nreturn $content;','','empty_box',0),('ip_usage_box','','#use Geo::IP;\r\n\r\nreturn \'\' unless ($S->have_perm(\'view_comment_ip\'));\r\n\r\nmy $ip = $S->cgi->param(\'iplook\');\r\n\r\n$ip = $S->cgi->param(\'ip\') unless($ip);\r\n$ip = $S->filter_param($ip);\r\n\r\nmy $tip = $ip;\r\n\r\n$ip = $S->{DBH}->quote($ip);\r\n\r\n#my $gi = Geo::IP->new(GEOIP_STANDARD);\r\n#my $country = $gi->country_code_by_addr($tip);\r\nmy $country = \"\";\r\n\r\nmy $content = qq{<h1>IP Usage for $ip $country <a href=\"http://www.find-ip-address.org/ip-blacklist-lookup.php?ip=$tip\">IP Spam Check</a></h1>};\r\n\r\n$tip =~ s/(\\d+)\\.(\\d+)\\.(\\d+).+/$1.$2.$3./;\r\n\r\nmy $q_tip = $S->{DBH}->quote($tip);\r\n$q_tip =~ s/(.+)\'$/$1%\'/;\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \'uid, nickname, perm_group\',\r\n	FROM => \'users\',\r\n	WHERE => \"creation_ip = $ip\",\r\n	ORDER_BY => \'creation_time desc\'});\r\n\r\nmy $users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n$rv = 0 if {\"$rv\" eq \"0E0\"};\r\n\r\n$content .= \"<hr><p><h2>$rv Users registered from $ip</h2>\\n\";\r\n\r\nforeach my $user (@{$users}) {\r\n	$content .= qq{\r\n	<b><a href=\"/scoop/user/uid:$user->[0]\">$user->[1]</a> ($user->[2])</b> - <a href=\"/scoop/user/uid:$user->[0]/prefs\">Edit user</a><br>};\r\n}\r\n\r\n\r\n($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \'uid, nickname, perm_group\',\r\n	FROM => \'users\',\r\n	WHERE => \"creation_ip like $q_tip\",\r\n	ORDER_BY => \'creation_time desc\'});\r\n\r\n$users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n$rv = 0 if {\"$rv\" eq \"0E0\"};\r\n\r\n$content .= \"<p><h2>$rv Users registered from \'$tip*\'</h2>\\n\";\r\n\r\nforeach my $user (@{$users}) {\r\n	$content .= qq{\r\n	<b><a href=\"/scoop/user/uid:$user->[0]\">$user->[1]</a> ($user->[2])</b> - <a href=\"/scoop/user/uid:$user->[0]/prefs\">Edit user</a><br>};\r\n}\r\n\r\n($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \'c.uid, u.nickname, u.perm_group\',\r\n	FROM => \'comments as c, users as u\',\r\n	WHERE => \"(u.uid=c.uid) and c.commentip = $ip\",\r\n	DISTINCT => 1});\r\n\r\n$users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n$rv = 0 if {\"$rv\" eq \"0E0\"};\r\n\r\n$content .= \"<hr><p><h2>$rv Users using $ip to post comments</h2>\\n\";\r\n\r\n\r\nforeach my $user (@{$users}) {\r\n	$content .= qq{\r\n	<b><a href=\"/scoop/user/uid:$user->[0]\">$user->[1]</a> ($user->[2])</b> - <a href=\"/scoop/user/uid:$user->[0]/prefs\">Edit user</a><br>};\r\n}\r\n\r\n($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \'c.uid, u.nicknam, u.perm_groupe\',\r\n	FROM => \'comments as c, users as u\',\r\n	WHERE => \"(u.uid=c.uid) and c.commentip like $q_tip\",\r\n	DISTINCT => 1});\r\n\r\n$users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n$rv = 0 if {\"$rv\" eq \"0E0\"};\r\n\r\n\r\n$content .= \"<p><h2>$rv Users using \'$tip*\' to post comments</h2>\\n\";\r\n\r\nforeach my $user (@{$users}) {\r\n	$content .= qq{\r\n	<b><a href=\"/scoop/user/uid:$user->[0]\">$user->[1]</a> ($user->[2])</b> - <a href=\"/scoop/user/uid:$user->[0]/prefs\">Edit user</a><br>};\r\n}\r\n\r\n\r\n($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \'c.uid, u.nickname, u.perm_group\',\r\n	FROM => \'commentratings as c, users as u\',\r\n	WHERE => \"(u.uid=c.uid) and c.rater_ip = $ip\",\r\n	DISTINCT => 1});\r\n\r\n$users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n$rv = 0 if {\"$rv\" eq \"0E0\"};\r\n\r\n$content .= \"<hr><p><h2>$rv Users using $ip to rate comments</h2>\\n\";\r\n\r\n\r\nforeach my $user (@{$users}) {\r\n	$content .= qq{\r\n	<b><a href=\"/scoop/user/uid:$user->[0]\">$user->[1]</a> ($user->[2])</b> - <a href=\"/scoop/user/uid:$user->[0]/prefs\">Edit user</a><br>};\r\n}\r\n\r\n($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \'c.uid, u.nickname, u.perm_group\',\r\n	FROM => \'commentratings as c, users as u\',\r\n	WHERE => \"(u.uid=c.uid) and c.rater_ip like $q_tip\",\r\n	DISTINCT => 1});\r\n\r\n$users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n$rv = 0 if {\"$rv\" eq \"0E0\"};\r\n\r\n\r\n$content .= \"<p><h2>$rv Users using \'$tip*\' to rate comments</h2>\\n\";\r\n\r\nforeach my $user (@{$users}) {\r\n	$content .= qq{\r\n	<b><a href=\"/scoop/user/uid:$user->[0]\">$user->[1]</a> ($user->[2])</b> - <a href=\"/scoop/user/uid:$user->[0]/prefs\">Edit user</a><br>};\r\n}\r\n\r\nif ($S->{UID} == 2) {\r\n($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \'c.uid, u.nickname,u. perm_group\',\r\n	FROM => \'whos_online as c, users as u\',\r\n	WHERE => \"(u.uid=c.uid) and c.ip like $q_tip\",\r\n	DISTINCT => 1});\r\n\r\n$users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n$rv = 0 if {\"$rv\" eq \"0E0\"};\r\n\r\n$content .= \"<p><h2>$rv Users using \'$tip*\' to login</h2>\\n\";\r\n\r\nforeach my $user (@{$users}) {\r\n	$content .= qq{\r\n	<b><a href=\"/scoop/user/uid:$user->[0]\">$user->[1]</a> ($user->[2])</b> - <a href=\"/scoop/user/uid:$user->[0]/prefs\">Edit user</a><br>};\r\n}\r\n\r\n\r\n}\r\n\r\n\r\nreturn $content;\r\n','Displays useful IP related information.','blank_box',0),('lastfm_recent','last.fm Recently played','# Get the uid for the page we\'re viewing\r\nmy $uid = $S->cgi->param(\'uid\');\r\nmy $nick = $S->cgi->param(\'nick\');\r\nunless ($uid) {\r\n	$uid = $S->get_uid_from_nick($nick);\r\n}\r\n\r\n# Look up the pref for lastfm_user for that uid\r\nmy $lastfm_user = $S->user_data($uid)->{prefs}->{lastfm_user};\r\n\r\n\r\n# filter that pref.\r\n$lastfm_user =~ s/[^A-Za-z1234567890\\-_\\.]//g;\r\n\r\nif (length($lastfm_user) == 0) {return \'\'};\r\n\r\n# Display the block \'lastfm_recent\' with \'lastfm_user\' replaced with the pref\r\nmy $content = $S->{UI}->{BLOCKS}->{\'lastfm_recent\'};\r\n$content =~ s/%%lastfm_user%%/$lastfm_user/gi;\r\n\r\nreturn ($content);','','empty_box',0),('logout_box','Logout','if ($S->{APR}->method() eq \'POST\') {\r\n	$S = $S->reset_user;\r\n\r\n	my $logout_url = $S->{UI}->{VARS}->{logout_url}\r\n	|| ($S->{UI}->{VARS}->{rootdir} . \'/\');\r\n\r\n	$S->{EXPIRE_SESSION} = 1;\r\n\r\n	$S->{APACHE}->headers_out->{\'Location\'} = \"$logout_url\";\r\n\r\n	# the following is probably unessesary, but just in case...\r\n	return { content => qq{Redirecting to <a href=\"$logout_url\">$logout_url</a>} }\r\n} else {\r\n	return $S->{UI}->{BLOCKS}->{logout};	\r\n}\r\n','This logs a user out.  For /logout','box',0),('logo_box','','my @logos = split(/,/,$S->{UI}->{BLOCKS}->{logo_graphics});\r\nmy $size = @logos;\r\nmy $rand = int(rand($size));\r\nmy $logo = $logos[$rand];\r\nmy @texts = split(/,/,$S->{UI}->{BLOCKS}->{logo_text});\r\n\r\n$size = @texts;\r\n$rand = int(rand($size));\r\nmy $text = $texts[$rand];\r\n\r\nmy $retval = $S->{UI}->{BLOCKS}->{logo};\r\n\r\n$logo =~ s/\\n//g;\r\n$text =~ s/\\n//g;\r\n\r\n$retval =~ s/%%logo_image%%/$logo/gi;\r\n$retval =~ s/%%logo_text%%/$text/gi;\r\n\r\nreturn $retval;','','empty_box',0),('main_menu','Menu','my $submit = \'\';\r\nmy $acct = \'\';\r\n\r\nif ( $S->have_perm(\'story_post\') ) {\r\n    $submit = qq{%%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/submit\">submit story</A><BR>};\r\n}\r\nif ($S->{UID} < 0) {\r\n    $acct = \'%%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/newuser\">create account</A><BR>\';\r\n}\r\n\r\nmy $content = qq{\r\n$submit\r\n$acct\r\n%%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/special/faq\">faq</A><BR>\r\n%%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/search\">search</A>};\r\n\r\nreturn $content;','The menu block-- variable for perms','box',0),('mark_ads_inactive','','my ($rv, $sth) = $S->db_update({\r\n    WHAT => \'ad_info\',\r\n    SET  => \'active = 0\',\r\n    WHERE => \'views_left <= 0 AND perpetual != 1 AND active = 1 and approved = 1\'\r\n});\r\n$sth->finish();\r\n','Mark ads inactive after they\'ve run out of views.','blank_box',0),('message_replies','Replies','my $stuff;\r\n\r\n$stuff = $S->get_comment_replys();\r\n\r\nmy $sid;\r\nmy $retval;\r\nmy $path, $title;\r\nforeach my $row (@$stuff) {\r\n	if ($sid ne $row->{sid}) {\r\n		$sid = $row->{sid};\r\n		$retval .= qq{</p>} if ($retval);\r\n		if( $S->_does_poll_exist($sid) ) {\r\n			$title = $S->get_poll_hash($sid)->{question};\r\n			$path = \"/poll/\";\r\n		} else {\r\n			$title = $row->{title};\r\n			$path = \"/story/\";\r\n		}\r\n		$retval .= qq{<p>\r\n        <a class=\"light\" href=\"%%rootdir%%$path$sid\">$title</a>}\r\n	}\r\n	$retval .= qq{\r\n       <br>%%dot%% <a class=\"light\" href=\"%%rootdir%%/comments/$sid/$row->{new_cid}#$row->{new_cid}\">$row->{subject}</a> };\r\n}\r\n$retval .= \'</p>\' if $retval;\r\n\r\nreturn ($retval);','','empty_box',0),('meta_information','','my $content = \"\";\r\nmy $sid = $S->cgi->param(\'sid\');\r\n$sid = $S->filter_param($sid);\r\n\r\nmy $story;\r\nmy $stories = $S->story_data([$sid]);\r\nif ($stories) {\r\n     $story = $stories->[0];\r\n} else {\r\n     return \"\";\r\n}\r\n\r\n$story->{introtext} =~ s/[\\n\\r]/ /g;\r\nforeach (qw(title introtext)) {\r\n	# (crudely) remove HTML\r\n	$story->{$_} =~ s/<.*?>//g;\r\n	# unfilter < and >, so that we don\'t turn them into &amp;lt;\r\n	$story->{$_} =~ s/&lt;/</g;\r\n	$story->{$_} =~ s/&gt;/>/g;\r\n	# filter &\r\n	$story->{$_} =~ s/&/&amp;/g;\r\n	# (re-)filter < and >\r\n	$story->{$_} =~ s/</&lt;/g;\r\n	$story->{$_} =~ s/>/&gt;/g;\r\n}\r\n\r\n\r\n$content .= \'<meta name=\"medium\" content=\"blog\" />\';\r\nmy $title = $story->{nick} . \" - \" .$story->{title};\r\nmy $desc = $S->filter_subject($story->{introtext});\r\nmy $img = \"%%imagedir%%%%logo_graphics%%\";\r\n$content .= \"\\n\";\r\n$content .= qq{<meta name=\"title\" content=\"$title\" />\\n};\r\n$content .= qq{<meta name=\"description\" content=\"$desc\" />\\n};\r\n$content .= qq{<link rel=\"image_src\" href=\"$img\" />\\n};\r\n\r\nreturn $content;','','empty_box',0),('mini_calendar','Events','return unless $S->var(\'use_calendars\');\nreturn\nmy @today = $S->time_localize_array(Date::Calc::Today_and_Now(),1);\nmy $keys;\nmy $cal = $S->{UI}->{BLOCKS}->{calendar_body_monthly_mini};\nmy ($cal_ids,$view_cals);\nmy ($day_link,$day_link_end);\n\nif ( $S->var(\'allow_personal_calendar_view\') ) {\n  $cal_ids = $S->_personal_calendar_list($S->{UID});\n}\nif ( !$cal_ids ) {\n  $cal_ids->[0] = $S->var(\'default_calendar_id\');\n}\n$view_cals = $S->_calendar_can_view($cal_ids);\nreturn unless $view_cals;\n\n$S->_get_months_events($today[0],$today[1],$view_cals);\n\n# properly blank out the structure, so unused \n# calendar squares don\'t collapse\nforeach my $a (1..7) {\n  foreach my $b (1..5) {\n    $keys->{\"wk${b}_d$a\"} = \'<TD>&nbsp;</TD>\';\n  }\n}\n\n# fill in the basic keys\n$keys->{month} = Date::Calc::Month_to_Text($today[1]);\n$keys->{year} = $today[0];\n\n# now the keys for each day\nmy $i = 0;\nmy @date = @today;\nmy ($dow,$wom);\nwhile ( $i++ < Date::Calc::Days_in_Month($today[0],$today[1]) ) {\n  $dow = Date::Calc::Day_of_Week($today[0],$today[1],$i);\n  $wom = int(($i + Date::Calc::Day_of_Week($today[0],$today[1],1) - 2) /7)+1;\n  my $hilight = ($i == $today[2]) ? \' id=\"today\"\' : \'\';\n  $date[2] = $i;\n\n  my $eventlist = $S->_get_days_events(@date[0,1,2],$view_cals) if $view_cals;\n  if ( $eventlist ) {\n    $day_link_end = \'</A>\';\n    if ( @$eventlist > 1 ) {\n      $day_link = qq{<A href=\"%%rootdir%%/calendar/daily/0/$date[0]-$date[1]-$date[2]\">};\n    } else {\n      $day_link = qq{<A href=\"%%rootdir%%/event/$eventlist->[0]\">};\n    }\n  } else {\n    $day_link = \'\';\n    $day_link_end = \'\';\n  }\n\n  $keys->{\"wk${wom}_d$dow\"} = qq{<TD$hilight>$day_link$i$day_link_end</TD>};\n}\n\nreturn $S->interpolate($cal,$keys);\n','','box',0),('mod_stats','Moderation Stats','my $sid = $ARGS[0];\r\n$sid = $S->{CGI}->param(\'sid\') unless $sid;\r\nreturn unless $sid;\r\nmy $archive = $S->_check_archivestatus($sid);\r\nmy $q_sid = $S->{DBH}->quote($sid);\r\n\r\nmy ($rv, $t_sth) = $S->db_select({\r\n    ARCHIVE => $archive,\r\n    WHAT => \'displaystatus, section\',\r\n    FROM => \'stories\',\r\n    WHERE => qq{sid = $q_sid}});\r\n\r\nreturn unless ($rv);\r\n\r\nmy $story = $t_sth->fetchrow_hashref;\r\nmy $disp = $story->{displaystatus};\r\nmy $section = $story->{section};\r\n\r\nreturn if ($section eq \'Diary\' || $section eq \'adverts\');\r\n\r\nmy ($totalvotes, $score) = $S->_get_total_votes($sid);\r\n\r\nif ($score > $S->{UI}->{VARS}->{hide_story_threshold}) {\r\n    my ($stat, $trash) = $S->_mod_or_show($sid);\r\n    return unless ($stat eq \'show\' || $disp > -1);\r\n}\r\n\r\nmy $sth = $S->_get_story_mods($sid);\r\n\r\nmy $head = $S->{UI}->{BLOCKS}->{moderate_head};\r\n\r\n$head =~ s/%%votes%%/$totalvotes/g;\r\n$head =~ s/%%score%%/$score/g;\r\n\r\nmy ($this_row, $user);\r\n\r\nmy $for = qq{<FORM NAME=\"mod_stat_show\" ACTION=\"%%rootdir%%/\" METHOD=\"get\">\r\n<INPUT TYPE=\"hidden\" NAME=\"op\" VALUE=\"user\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tool\" VALUE=\"info\">};\r\nmy $against = qq{<FORM NAME=\"mod_stat_show\" ACTION=\"%%rootdir%%/\" METHOD=\"get\">\r\n<INPUT TYPE=\"hidden\" NAME=\"op\" VALUE=\"user\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tool\" VALUE=\"info\">};\r\nmy $neutral = qq{<FORM NAME=\"mod_stat_show\" ACTON=\"%%rootdir%%/\" METHOD=\"get\">\r\n<INPUT TYPE=\"hidden\" NAME=\"op\" VALUE=\"user\">\r\n<INPUT TYPE=\"hidden\" NAME=\"tool\" VALUE=\"info\">};\r\n#\'\r\nmy $f = 0;\r\nmy $a = 0;\r\nmy $n = 0;\r\n\r\n$for .= qq{<small>\r\n	<SELECT NAME=\"uid\" SIZE=1>\r\n	<OPTION VALUE=\"\">Voted for: (%%for%%)};\r\n$against .= qq{<small>\r\n	<SELECT NAME=\"uid\" SIZE=1>\r\n	<OPTION VALUE=\"\">Voted against: (%%against%%)};\r\n$neutral .= qq{<small>\r\n	<SELECT NAME=\"uid\" SIZE=1>\r\n	<OPTION VALUE=\"\">Didn\'t care: (%%neutral%%)};	\r\n\r\nwhile (my $mod_rec = $sth->fetchrow_hashref) {\r\n	my $nick = $S->get_nick($mod_rec->{uid});\r\n	$nick =~ s/^(.{0,20})/$1/;\r\n	my $link = qq{\r\n	<OPTION VALUE=\"$mod_rec->{uid}\">$nick};\r\n	if ($mod_rec->{vote} == 1) {\r\n		$for .= qq|\r\n		$link|;\r\n		$f++;\r\n	} elsif ($mod_rec->{vote} == 0) {\r\n		$neutral .= qq|\r\n		$link|;\r\n		$n++;\r\n	} elsif ($mod_rec->{vote} == -1) {\r\n		$against .= qq|\r\n		$link|;\r\n		$a++;\r\n	}\r\n}\r\n$sth->finish;\r\n\r\n$for .= qq{</SELECT> <INPUT TYPE=\"submit\" NAME=\"get\" VALUE=\"Get User Info\"></small></FORM>};\r\n$against .= qq{</SELECT> <INPUT TYPE=\"submit\" NAME=\"get\" VALUE=\"Get User Info\"></small></FORM>};\r\n$neutral .= qq{</SELECT> <INPUT TYPE=\"submit\" NAME=\"get\" VALUE=\"Get User Info\"></small></FORM>};\r\n\r\n$for =~ s/%%for%%/$f/;\r\n$against =~ s/%%against%%/$a/;\r\n$neutral =~ s/%%neutral%%/$n/;\r\n\r\nmy $content = $head.\'%%smallfont%%\'.$for.$against.$neutral.\'%%smallfont_end%%\';\r\n\r\nreturn { content => $content };','Show the stats for story mod','box',0),('most_recent_comments','Most recent comments','## START new_section_stories ##\r\nmy $content;\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n	WHAT => \'sid, cid, subject, users.nickname as nick\',\r\n	FROM => \'comments, users\',\r\n	WHERE => \"users.uid = comments.uid\",\r\n	ORDER_BY => \'date desc\',\r\n	LIMIT => \'7\'});\r\n\r\nmy $comments = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n\r\nforeach my $comment (@{$comments}) {\r\n	$content .= qq($comment->{nick}<br>);\r\n}\r\n\r\n\r\nreturn {content => $content};\r\n## END new_section_stories ##\r\n','','',0),('my_ips','You\'ve logged in from the following IP(s)','my $uid = $S->{UID};\r\n\r\nmy $date_format = $S->date_format(\'last_visit\');\r\nmy ($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \"ip, $date_format\",\r\n	FROM => \'whos_online\',\r\n	WHERE => \"uid = ?\",\r\n	ORDER_BY => \"last_visit DESC\",\r\n	PARAMS => [$uid]});\r\n\r\nmy $ips = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n\r\nmy $content = \"<p><h2>You\'ve logged in from the following IP(s)</h2>\\n<p>\";\r\n\r\nforeach my $ip (@{$ips}) {\r\n	$content .= qq{\r\n	$ip->[0] ($ip->[1])<br>};\r\n}\r\n\r\nreturn $content;\r\n','Show IP\'s I\'ve logged in from','empty_box',0),('newest_users','New users to HuSi','my $content;\r\n\r\nmy $cache = $S->cache->fetch(\"newest_users\");\r\n\r\nif (($cache->{TIME}) &&\r\n    ($cache->{TIME} > (time - 200))) {\r\n	return ($cache->{CONTENT} . \"\\n<!-- cached -->\");\r\n}\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n	WHAT => \'count(*)\',\r\n	FROM => \'users\',\r\n	WHERE => \"is_new_account = 0 and perm_group <> \'Banished\'\"});\r\n\r\nmy $count = $sth->fetchrow();\r\n$sth->finish();\r\n\r\n($rv, $sth) = $S->db_select({\r\n	WHAT => \'nickname\',\r\n	FROM => \'users\',\r\n	WHERE => \"is_new_account = 0 and perm_group <> \'Banished\'\",\r\n	ORDER_BY => \'creation_time desc\',\r\n	LIMIT => \'7\'});\r\n\r\nmy $users = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n\r\nforeach my $user (@{$users}) {\r\n	my $urlnick = $S->{UI}->{VARS}->{rootdir};\r\n	$urlnick .= \'/user/\';\r\n	my $nick = $user->[0];\r\n	$urlnick .= $nick;\r\n	$content .= qq{<a class=\"light\" href=\"$urlnick\">$nick</a><br \\>\\n}\r\n}\r\n$content .= qq[<br \\><small>$count total registered users</small>];\r\n\r\n$cache->{CONTENT} = $content;\r\n$cache->{TIME}    = time;\r\n$S->cache->store(\"newest_users\",$cache);\r\n\r\nreturn ($content);','Shows the latest users to register.','box',1),('new_admin_news','','return unless ($S->{UID} > 0);\r\n\r\nreturn unless ($S->have_section_perm(\'norm_read_stories\',\'Admins\'));\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n WHAT => \'sid\',\r\n FROM => \'stories\',\r\n WHERE => \'section = \"Admins\"\',\r\n LIMIT => 1,\r\n ORDER_BY => \'time DESC\'});\r\nmy $sid = $sth->fetchrow();\r\n$sth->finish();\r\n\r\nreturn unless $sid;\r\n\r\n$S->story_last_seen($sid);\r\n\r\nreturn if (defined($S->{LAST_SEEN}->{$sid}->{lastseen}));\r\n\r\nreturn {content => qq{<table cellpadding=3 cellspacing=0 border=0 width=\"100%\"><tr><td align=\"center\"><b>There is <A HREF=\"%%rootdir%%/story/$sid\">a new Administration Story</A>.</b></td></tr></table>}};','','empty_box',0),('new_comment_reply','','my $sid = $ARGS[1];\r\nmy $cid = $ARGS[2];\r\n\r\n$S->check_comment_reply($sid,$cid);\r\n\r\nreturn \'\';','Comment new to flag new comment replys.','empty_box',0),('new_diaries_box','New Diaries','## START new_section_stories ##\r\nmy $content;\r\n# = qq{<b><a class=\"light\" href=\"/scoop/special/browse/\">Browse all the newest headlines by section</a></b><p>};\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n	WHAT => \'sid, title, aid, section, tid\',\r\n	FROM => \'stories\',\r\n	WHERE => \"displaystatus = 1 AND section = \'Diary\'\",\r\n	ORDER_BY => \'time desc\',\r\n	LIMIT => \'7\'});\r\n\r\nmy $stories = $sth->fetchall_arrayref();\r\n$sth->finish();\r\nmy $author;\r\n\r\nforeach my $story (@{$stories}) {\r\n	$author = $S->get_nick_from_uid($story->[2]);\r\n	#my $urlnick = $S->urlify($story->[2]);\r\n	my $urlnick = $S->urlify($author);\r\n	$author =~ s/(\\S{20})/$1- /g;\r\n	$story->[1] =~ s/(\\S{20})/$1 /g;\r\n	$content .= qq{\r\n	<b><a class=\"light\" href=\"/scoop/story/$story->[0]\">$story->[1]</a></b><br>\r\n	<font size=\"-2\">by <a class=\"light\" href=\"/scoop/user/$urlnick\">$author</a></font><p>};\r\n}\r\n\r\n\r\nreturn {content => $content};\r\n## END new_diaries ##\r\n','','box',1),('new_section_stories_box','New Section Stories','## START new_section_stories ##\r\nmy $content;\r\n# = qq{<b><a class=\"light\" href=\"/scoop/special/browse/\">Browse all the newest headlines by section</a></b><p>};\r\n\r\n\r\n        my $excl_sect_sql = $S->get_disallowed_sect_sql(\'norm_read_stories\');\r\n        my $excl_sect_sql_wAND = \' AND \' . $excl_sect_sql;\r\n        $excl_sect_sql_wAND = \'\' if( $excl_sect_sql_wAND eq \' AND \' );\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n	WHAT => \'sid, title, aid, section, tid\',\r\n	FROM => \'stories\',\r\n	WHERE => \"displaystatus = 1 AND section != \'Diary\' AND section != \'Adverts\' AND section != \'Crap\' $excl_sect_sql_wAND\",\r\n	ORDER_BY => \'time desc\',\r\n	LIMIT => \'7\'});\r\n\r\nmy $stories = $sth->fetchall_arrayref();\r\n$sth->finish();\r\nmy $author;;\r\n\r\nforeach my $story (@{$stories}) {\r\n	$author = $S->get_nick_from_uid($story->[2]);\r\n	my $urlnick = $S->urlify($author);\r\n	$author =~ s/(\\S{20})/$1- /g;\r\n	$story->[1] =~ s/(\\S{20})/$1 /g;\r\n	$content .= qq{\r\n	<b><a class=\"light\" href=\"/scoop/story/$story->[0]\">$story->[1]</a></b><br>\r\n	by <a class=\"light\" href=\"/scoop/user/$urlnick\">$author</a><br> \r\n	<a class=\"light\" href=\"/scoop/section/$story->[3]\">$S->{SECTION_DATA}->{$story->[3]}->{title}</a>\r\n	<p>};\r\n}\r\n\r\n\r\n#return {content => $content};\r\nreturn $content;\r\n## END new_section_stories ##\r\n','','box',1),('new_user_box','Login','my $content;\r\n\r\nif ($S->{UID} > 0) {\r\n  if ($S->have_perm(\'moderate\')) {\r\n    my ($nstories, $tstories, $estories) = $S->_count_new_sub();\r\n    $content .= qq{<a class=\"light\" href=\"%%rootdir%%/modsub\">Moderate</a> };\r\n    if (($nstories > 0) || ($tstories > 0) || ($estories > 0)) {\r\n      $content .= qq{($tstories/};\r\n      if ($estories > 0) {\r\n        $content .= qq{<font color=\"blue\">$estories</font>/}\r\n      } else {\r\n        $content .= qq{$estories/};\r\n      };\r\n      if ($nstories > 0) {\r\n        $content .= qq{<font color=\"red\">$nstories</font>}\r\n      } else {\r\n        $content .= qq{$nstories};\r\n      };\r\n      $content .= \")\";\r\n    };\r\n    $content .= \"<br>\";\r\n  };\r\n  $content .= qq{\r\n      <a class=\"light\" href=\"%%rootdir%%/submitstory/Diary\">New Diary Entry</a> <br>\r\n      <a class=\"light\" href=\"%%rootdir%%/submitstory/Crap\">New Hole Entry</a> <br>\r\n      <a class=\"light\" href=\"%%rootdir%%/submitstory/cellar\">New Cellar Entry</a> <br>\r\n      %%logout_link%%Logout $S->{NICK}</a> <br> };\r\n} else {\r\n     $content =~ s/%%LOGIN_ERROR%%/$S->{LOGIN_ERROR}/;\r\n}\r\nreturn {content => $content };','the login box','empty_box',0),('new_user_hook_box','','my $nick = $ARGS[1];\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \'creation_ip\',\r\n	FROM => \'users\',\r\n	WHERE => \"nickname = \'$nick\'\"});\r\nmy $ip = $sth->fetchrow();\r\n\r\nif (($ip =~ /^113\\.162\\./) || ($ip =~ /^66\\.123\\.65\\./) || ($ip =~ /^67\\.121\\.239\\./) || ($ip =~ /^82\\.230\\.79\\./) || ($ip =~ /^67\\.42\\.33\\./) || ($ip =~ /^154\\.35\\.47\\./) || ($ip =~ /^61\\.163\\.2\\./) || ($ip =~ /^87\\.217\\.79\\./) || ($ip =~ /^61\\.163\\.2/) || ($ip =~ /^194\\.114.\\13/) || ($nick =~ m/hugin/)) {\r\n \r\n$S->log_activity(\'banned_user\',\"New user $nick banned\",\"\");\r\n\r\n ($rv, $sth) = $S->db_update({\r\nDEBUG => 1,\r\nSET => \'perm_group = \"Banished\"\',\r\nWHAT => \'users\',\r\nWHERE => \"nickname = \'$nick\'\"});\r\nwarn \"Banning $nick\";\r\n} else {\r\n$S->log_activity(\'new_user\',\"New user $nick created\",\"\");\r\n}\r\n\r\nreturn \"\";','','empty_box',0),('num_results','','my $num = $S->cgi->param(\'count\') || 30;\r\n$num = $S->filter_param($num);\r\nmy $out;\r\n$out = qq{\r\n   <SELECT name=\"count\" size=\"1\">};\r\n\r\nforeach ( (10,20,30,50) ) {\r\n   my $selected = ( $_ == $num ) ? \' SELECTED\' : \'\';\r\n   $out .= qq{\r\n     <OPTION value=\"$_\"$selected>$_</OPTION>};\r\n}\r\n$out .= qq{\r\n   </SELECT>};\r\n\r\nreturn $out;','number of results for search form','empty_box',0),('olderlist_box_new','Front Page','my $section = $S->{CGI}->param(\'section\') || \'front\';\nmy $stories = [];\nmy $params;\n$params->{limit} = $S->pref(\'maxtitles\');\n$params->{offset} = $S->pref(\'maxstories\');\n\nif ($section eq \'front\') {\n    $params->{displaystatus} = 0;\n} else {\n    $params->{displaystatus} = [0,1];\n    $params->{section} = $section;\n}\nmy $sids = $S->get_sids($params);\n$stories = $S->story_data($sids);\n\nreturn unless $stories;\n\nmy $box_content;\n\nmy $date = undef;\nforeach my $story (@{$stories}) {\n    if (($story->{wmdtime} ne $date) || !$date) {\n        $date = $story->{wmdtime};\n        $box_content .= qq|\n               <B>$story->{wmdtime}</B>|;\n    }\n    $box_content .= qq|\n    <BR>%%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/story/$story->{sid}\">$story->{title}</A> ($story->{comments} comments)|;\n    \nif ($S->have_perm(\'story_list\')) {\n        $box_content .= qq| [<A CLASS=\"light\" HREF=\"%%rootdir%%/admin/story/$story->{sid}\">edit</A>]|;\n    }\n}\n\nmy $offset = $S->{UI}->{VARS}->{maxstories} + length(@$stories) if $stories;\n\nmy $search_url = qq{%%rootdir%%/?op=search;offset=$offset};\n$search_url .= \';section=\'.$section if ($section ne \'front\');\n\n$box_content .= qq|\n            <P>\n            <A CLASS=\"light\" HREF=\"$search_url\">Older Stories...</A>\n            </P>|;\nmy $return = {content => \"%%smallfont%%$box_content%%smallfont_end%%\"};\nif ($section ne \'front\' && $section ne \'__all__\') {\n    $return->{title} = $S->{SECTION_DATA}->{$section}->{title};\n} elsif ($section eq \'__all__\') {\n    $return->{title} = \'All Stories\';\n}\n\nreturn $return;','Replacement older list box for new story fetching code','box',0),('older_list_box','Older Front Page Stories','my $section = $S->{CGI}->param(\'section\') || \'front\';\r\nmy $stories = [];\r\n\r\nif ($section eq \'front\') {\r\n    $stories = $S->getstories({-type => \'titlesonly\', -displaystatus => \'0\'});\r\n} elsif ($section eq \'__all__\') {\r\n    $stories = $S->getstories({-type => \'titlesonly\', -section => \'!Diary\'});\r\n} else {\r\n    $stories = $S->getstories({-type => \'titlesonly\', -section => $section});\r\n}\r\nmy $box_content;\r\n\r\nmy $date = undef;\r\nforeach my $story (@{$stories}) {\r\n    if (($story->{ftime} ne $date) || !$date) {\r\n        $date = $story->{ftime};\r\n        $box_content .= qq|\r\n	<P>\r\n                <B>$story->{ftime}</B>|;\r\n    }\r\n    $box_content .= qq|\r\n    <br>%%dot%% <a class=\"light\" href=\"%%rootdir%%/story/$story->{sid}\">$story->{title}</a> ($story->{commentcount} comments)|;\r\n    \r\n	if ($S->have_perm(\'story_list\')) {\r\n        $box_content .= qq| [<a class=\"light\" href=\"%%rootdir%%/admin/story/$story->{sid}\">edit</a>]|;\r\n    }\r\n}\r\n\r\nmy $offset = $S->{UI}->{VARS}->{maxstories} + $#{$stories};\r\nmy $search_url = qq{%%rootdir%%/?op=search;offset=$offset};\r\n$search_url .= \';section=\'.$section if ($section ne \'front\');\r\n\r\n$box_content .= qq|\r\n            <p>\r\n            <a class=\"light\" href=\"$search_url\">Older Stories...</a>\r\n            </p>|;\r\nmy $return = {content => \"$box_content\"};\r\nif ($section ne \'front\' && $section ne \'__all__\') {\r\n    $return->{title} = $S->{SECTION_DATA}->{$section}->{title};\r\n} elsif ($section eq \'__all__\') {\r\n    $return->{title} = \'All Stories\';\r\n}\r\n\r\nreturn $return;','\"Older stories\" list','box',1),('paypal_bill_orders','Bill paypal orders','my $DEBUG = 0;\r\nmy $err;\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n	WHAT => \'ad_payments.order_id, ad_payments.cost, ad_payments.ad_id, ad_info.approved\',\r\nDEBUG => $DEBUG,\r\n    FROM => \'ad_payments, ad_info\',\r\n    WHERE => \'ad_payments.ad_id = ad_info.ad_id AND \r\n              ad_info.paid = 1 AND \r\n              ad_info.judged = 1 AND\r\n              ad_info.active = 0 AND \r\n              ad_info.example = 0 AND \r\n              ad_info.views_left > 0 AND \r\n              ad_payments.pay_type = \\\'paypal\\\' AND\r\n              ad_payments.paid IS NULL\'\r\n});\r\n\r\nmy @orders;\r\nwhile (my $o = $sth->fetchrow_hashref()) {\r\n	push @orders, $o;\r\n}\r\n$sth->finish();\r\n\r\nmy @disapproved_oids;\r\nforeach my $order (@orders) {\r\n	my ($paid, $active);\r\n	if ($order->{approved} == 0) {\r\n		push @disapproved_oids, $order->{order_id};\r\n		$paid = 0;\r\n		$active = 0;\r\n	} else {\r\n		$paid = 1;\r\n		$active = 1;\r\n	}\r\n\r\n	my ($rv, $sth) = $S->db_update({\r\n		WHAT  => \'ad_payments\',\r\n		SET   => \"paid=$paid, final_date=NOW()\",\r\nDEBUG => $DEBUG,\r\n		WHERE => \"ad_id=$order->{ad_id}\"});\r\n	$sth->finish();\r\n	\r\n	($rv, $sth) = $S->db_update({\r\n		WHAT  => \'ad_info\',\r\n		SET   => \"active=$active\",\r\nDEBUG => $DEBUG,\r\n		WHERE => \"ad_id=$order->{ad_id}\"});\r\n	$sth->finish();\r\n\r\n	if ($active) {\r\n		($rv, $sth) = $S->db_select({\r\n				WHAT => \'ad_sid\',\r\n				FROM => \'ad_info\',\r\nDEBUG => $DEBUG,\r\n				WHERE => qq{ad_id = $order->{ad_id}}});\r\n		my $sid = $sth->fetchrow();\r\n			\r\n		if ($sid) {\r\n			$S->activate_ad_story($sid);\r\n		}\r\n	}\r\n}\r\n\r\nif ($#disapproved_oids >= 0) {\r\n	my $subject = \'Paypal Order Refund Alert\';\r\n	my $message = qq{\r\nThe following paypal orders were disapproved and need a refund.\r\n};\r\n	\r\n	foreach my $oid (@disapproved_oids) {\r\n		$message .= qq{\r\nhttps://www.paypal.com/vst/id=$oid};\r\n	}\r\n	\r\n	foreach my $to (split /,/, $S->{UI}->{BLOCKS}->{admin_alert}) {\r\n		$S->mail($to, $subject, $message);\r\n	}\r\n\r\n}\r\n\r\nreturn 1;','','blank_box',0),('paypal_confirm','','my $DEBUG = 0;\r\n\r\n\r\nmy $answer = $S->paypal_ipn_confirm();\r\n\r\nif ($answer ne \'VERIFIED\') {\r\n	$S->paypal_invalid_mail($answer);\r\n	return;\r\n}\r\n\r\nmy $vars = $S->cgi->Vars();\r\n# Check payment status\r\nmy $stat = $vars->{\'payment_status\'};\r\nreturn unless ($stat =~ /completed/i);\r\n\r\n# Check that it\'s an ad or a renewal. Add in subscription notify later\r\nif ($vars->{item_name} eq \'Advertisement\') {\r\n\r\n	$S->paypal_activate_ad($vars);\r\n\r\n} elsif ($vars->{item_name} eq \'Ad Renew\') {\r\n\r\n	$S->paypal_do_renewal($vars);\r\n\r\n\n} elsif ($vars->{item_name} eq \'Subscription\') {\n	$S->paypal_do_sub($vars);\n} elsif ($vars->{item_name} eq \'Donation\') {\n	$S->paypal_do_donate($vars);\n} else {\n	warn \"paypal_confirm called with unknown item_name: $vars->{item_name}\\n\";\n}\r\n\r\n\r\nreturn;','','blank_box',0),('pm_sendto','','my $nick = $S->{CGI}->param(\'nick\');\r\nreturn \"\" unless $nick;\r\nmy $retval;\r\nmy $uid = $S->get_uid_from_nick($nick);\r\nmy $user = $S->user_data($uid);\r\nif ( ($S->have_perm(\'private_messages\') ) && ($S->have_perm(\'private_messages\',$user->{perm_group})) && ($S->{UID} != $uid)) {\r\n  $retval = $S->{UI}->{BLOCKS}->{pm_sendto_block};\r\n  $retval =~ s/%%nickname%%/$nick/g;\r\n  $retval =~ s/%%uid%%/$uid/g;\r\n}\r\nreturn $retval;','','blank_box',0),('poll_box','Poll','my $pollqid = shift @ARGS;\r\nmy $preview = 0;\r\n\r\nmy ($pollqid, $action) = $S->get_qid_to_show();\r\n$preview = 1 if ($action eq \'preview\');\r\nreturn \'\' if ($pollqid == 0);\r\n\r\n# if this is an attached poll, don\'t display if the story is hidden, unless\r\n# the current user can view all polls. also make sure the current user has\r\n# permission to view stories in this section\r\nif (my $sid = $S->get_sid_from_qid($pollqid)) {\r\n	return \'\'\r\n		if (($S->_check_story_mode($sid) == -1) && !$S->have_perm(\'list_polls\'))\r\n		|| (!$S->have_section_perm(\'norm_read_stories\', $S->_get_story_section($sid)));\r\n}\r\n\r\nmy $poll_hash = $S->get_poll_hash( $pollqid, $action );\r\n\r\n# first get the poll form all set up except for the answers\r\nmy $poll_form = qq|\r\n	<!-- begin poll form -->\r\n	<FORM ACTION=\"%%rootdir%%/\" METHOD=\"POST\">\r\n    <INPUT TYPE=\"hidden\" NAME=\"op\" VALUE=\"view_poll\">\r\n    <INPUT TYPE=\"hidden\" NAME=\"qid\" VALUE=\"$poll_hash->{\'qid\'}\">\r\n    <INPUT type=\"hidden\" name=\"ispoll\" value=\"1\">|;\r\n\r\n$poll_form .= \"<b>$poll_hash->{\'question\'}</b><br>\";\r\n\r\n# here is where all the answer fields get filled in\r\nmy $answer_array = $S->get_poll_answers($poll_hash->{\'qid\'}, $action);\r\n\r\n# now check if they have already voted or haven\'t logged in\r\nmy $row;\r\nif ( $S->_can_vote($poll_hash->{\'qid\'}) ) {\r\n    my $polltype = ($S->_is_poll_multiple_choice($poll_hash->{\'qid\'}) || ($preview && $S->{CGI}->param(\'is_multiple_choice\'))) ? \'checkbox\' : \'radio\';\r\n    foreach $row ( @{$answer_array} ) {	\r\n        $poll_form .= qq|\r\n   	        <INPUT TYPE=\"$polltype\" NAME=\"aid\" VALUE=\"$row->{\'aid\'}\"> $row->{\'answer\'}<BR>|;\r\n   	}\r\n} else {\r\n    my $total_votes = $poll_hash->{\'voters\'};\r\n\r\n    if($total_votes == 0) {\r\n        $total_votes = 1;  # so we don\'t get a divide by 0 error\r\n    }\r\n\r\n	$poll_form .= qq|\r\n		<TABLE BORDER=0 CELLPADDING=2 CELLSPACING=0>|;\r\n\r\n	foreach $row ( @{$answer_array} ) {\r\n		my $percent = int($row->{\'votes\'} / $total_votes * 100);\r\n		$poll_form .= qq|\r\n			<TR>\r\n				<TD valign=\"top\">%%norm_font%%%%dot%%%%norm_font_end%%</TD>\r\n				<TD valign=\"top\">%%norm_font%%$row->{\'answer\'}%%norm_font_end%%</TD>\r\n				<TD valign=\"top\">%%norm_font%% $percent% %%norm_font_end%%</TD>\r\n			</TR>|;\r\n   	}\r\n	$poll_form .= qq|\r\n		</TABLE>|;\r\n		\r\n}\r\n\r\n# get the # of comments\r\nmy $sid = $S->get_sid_from_qid($poll_hash->{\'qid\'});\r\nmy $comment_num;\r\n$comment_num = $S->poll_comment_num($sid) if ($sid);\r\n$comment_num = $S->poll_comment_num($poll_hash->{\'qid\'}) unless ($sid);\r\n   \r\n# only show the vote button if they havn\'t voted\r\nif ( $S->_can_vote($poll_hash->{\'qid\'}) && ! $preview ) {\r\n	$poll_form .= qq|<BR><INPUT TYPE=\"submit\" name=\"vote\" VALUE=\"Vote\">|;\r\n}\r\n\r\n\r\n# now finish up the form\r\nmy $op = $S->{CGI}->param(\'op\');\r\nmy $comm_disp = ($op ne \'displaystory\') ? \r\n	qq{\r\n	<TD>%%norm_font%%Votes: <b>$poll_hash->{\'voters\'}</b>%%norm_font_end%%</TD>\r\n	<TD ALIGN=\"center\" WIDTH=15>%%norm_font%%|%%norm_font_end%%</TD>\r\n	<TD ALIGN=\"right\">%%norm_font%% Comments: <b>$comment_num</b>%%norm_font_end%%</TD></TR>\r\n	} : \r\n	qq{\r\n	<TD COLSPAN=\"3\" ALIGN=\"center\">%%norm_font%%Votes: <b>$poll_hash->{\'voters\'}</b>%%norm_font_end%%</TD>\r\n	};\r\n\r\n$poll_form .= qq{\r\n	</FORM>\r\n	<!-- end poll form -->\r\n	<P>\r\n	%%norm_font%%\r\n    <TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 ALIGN=\"center\">\r\n	<TR>\r\n		$comm_disp\r\n	<TR> };\r\n\r\nif( $preview ) {\r\n    $poll_form .= qq{\r\n	<TD>%%norm_font%%Results%%norm_font_end%%</TD>\r\n	<TD ALIGN=\"center\" WIDTH=15>%%norm_font%%|%%norm_font_end%%</TD>\r\n    <TD ALIGN=\"right\">%%norm_font%% Other Polls%%norm_font_end%%</TD></TR>\r\n	};\r\n\r\n} else {\r\n    $poll_form .= qq{\r\n	<TD>%%norm_font%%<a href=\"%%rootdir%%/poll/$poll_hash->{\'qid\'}\">Results</a>%%norm_font_end%%</TD>\r\n	<TD ALIGN=\"center\" WIDTH=15>%%norm_font%%|%%norm_font_end%%</TD>\r\n    <TD ALIGN=\"right\">%%norm_font%% <a href=\"%%rootdir%%/?op=search;type=polls;search=Search\">Other Polls</a>%%norm_font_end%%</TD></TR>\r\n	};\r\n}\r\n\r\n$poll_form .= qq{\r\n	</TABLE>\r\n	%%norm_font_end%%\r\n	<!-- end poll content -->};\r\n\r\n## don\'t forget to tell them its a poll preview if it is\r\nif( $preview ) {\r\n	$title = \"Poll Preview\";\r\n}\r\n\r\nif ($poll_form) {\r\n	return {content => qq{%%norm_font%%$poll_form%%norm_font_end%%}, title => $title};\r\n} else {\r\n	return \'\';\r\n}\r\n','Box to display polls.','box',1),('postmode_pref','','my $choice = $ARGS[0];\r\n\r\nmy %choices = ( \"text\", \"Plain Text\", \"html\", \"HTML Formatted\", \"auto\", \"Autoformat\" );\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"posttype\" size=\"1\">};\r\n\r\nforeach my $c (keys %choices) {\r\n  my $checked = ($c eq $choice) ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"$c\"$checked>$choices{$c}</OPTION>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>};\r\n\r\nreturn $select;','','empty_box',0),('pref_checkbox','','my $prefname = $ARGS[0];\r\nmy $choice = $ARGS[1];\r\n\r\nmy $selected = ($choice eq \'on\') ? \' CHECKED\' : \'\';\r\n\r\nreturn qq{<INPUT type=\"checkbox\" name=\"$prefname\" value=\"on\"$selected>};','a generic checkbox. Takes two arguments, the pref name and the current pref value.','empty_box',0),('pref_selectbox','','my $prefname = shift @ARGS;\r\nmy $choice = shift @ARGS;\r\nmy @choices = @ARGS;\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"$prefname\" size=\"1\">};\r\n\r\nforeach my $c (@choices) {\r\n  my $checked = ($c eq $choice) ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"$c\"$checked>$c</OPTION>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>};\r\n\r\nreturn $select;','Generic select box for user preferences. takes parameters name,value,option1,option2,...\r\nNot suitable for select boxes with code-generated option lists.','empty_box',0),('print_story','','my $sid = $S->cgi->param(\'sid\');\r\n$sid = $S->filter_param($sid);\r\n\r\nmy ($story_data, $story) = $S->displaystory($sid);\r\n\r\n$story .= qq{\r\n<p>\r\n<center>%%norm_font%%Full discussion: <A HREF=\"%%site_url%%%%rootdir%%/story/$sid\">%%site_url%%%%rootdir%%/story/$sid</A>%%norm_font_end%%</center>\r\n};\r\n\r\nreturn {content => $story };','','blank_box',0),('rating_order_pref','','my $choice = $ARGS[0];\r\n\r\nmy %choices = ( \"unrate_highest\", \"Unrated, then Highest\", \"highest\", \"Highest rated first\", \"lowest\", \"Lowest rated first\", \"dontcare\", \"Ignore ratings\" );\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"commentrating\" size=\"1\">};\r\n\r\nforeach my $c (keys %choices) {\r\n  my $checked = ($c eq $choice) ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"$c\"$checked>$choices{$c}</OPTION>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>};\r\n\r\nreturn $select;','','empty_box',0),('rating_type_selectbox','','my $choice = $ARGS[0];\r\n\r\nmy %choices = ( \"drop\", \"Drop down box\", \"radio\", \"Radio Buttons\" );\r\n\r\nmy $select = qq{\r\n      <select name=\"rating_type\" size=\"1\">};\r\n\r\nforeach my $c (keys %choices) {\r\n  my $checked = ($c eq $choice) ? \' selected\' : \'\';\r\n  $select .= qq{\r\n        <option value=\"$c\"$checked>$choices{$c}</option>};\r\n}\r\n\r\n$select .= qq{\r\n      </select>};\r\n\r\nreturn $select;','','empty_box',0),('rdf_feeds','External Feeds','return unless $S->{UI}->{VARS}->{use_rdf_feeds};\r\n\r\nmy $to_display = {};\r\nif (@ARGS || $S->{CGI}->param(\'rdf\')) {\r\n	my $rdf_arg = $S->{CGI}->param(\'rdf\');\r\n	@ARGS = split(/,/, $rdf_arg) if $rdf_arg;\r\n	foreach (@ARGS) {\r\n		$to_display->{$_} = 1;\r\n	}\r\n}\r\n\r\nmy $content;\r\nmy $channels = $S->rdf_channels();\r\nmy $user_feeds = $S->rdf_get_prefs() unless @ARGS;\r\nmy $item_limit = (@ARGS && (@ARGS->[0] eq \'all\')) ?\r\n	150 :\r\n	defined($S->{prefs}->{rdf_max_headlines}) ?\r\n	$S->{prefs}->{rdf_max_headlines} :\r\n	defined($S->{UI}->{VARS}->{rdf_max_headlines}) ?\r\n	$S->{UI}->{VARS}->{rdf_max_headlines} : 15;\r\n\r\nif ($S->have_perm(\'submit_rdf\')) {\r\n	$content = qq| %%dot%% <a class=\"light\" href=\"%%rootdir%%/submitrdf\">Submit Feed</a><br><br>\\n|;\r\n}	\r\n\r\nforeach my $c (@{$channels}) {\r\n	if (@ARGS) {\r\n		next unless ($to_display->{ $c->{rid} }) || (@ARGS->[0] eq \'all\');\r\n	} else {\r\n		next unless $user_feeds->{ $c->{rid} };\r\n	}\r\n	next unless $c->{title};\r\n	unless ($S->have_perm(\'rdf_admin\')) {\r\n		next if $c->{submitted} || !$c->{enabled};\r\n	}\r\n	$content .= qq~<div class=\"rdf\">~;\r\n	if ($S->{UI}->{VARS}->{rdf_use_images} && $c->{image_url}) {\r\n		$content .= qq~<a href=\"$c->{image_link}\"><img src=\"$c->{image_url}\" alt=\"$c->{image_title}\" border=\"1\"></a><br>\\n~;\r\n	} else {\r\n		$content .= qq~<b><a class=\"light\" href=\"$c->{link}\">$c->{title}</a></b><br>\\n~;\r\n	}\r\n\r\n	my $items = $S->rdf_items($c->{rid}, $item_limit);\r\n	foreach my $i (@{$items}) {\r\n		$content .= qq~%%dot%% <a class=\"light\" href=\"$i->{link}\">$i->{title}</a><br>\\n~;\r\n	}\r\n\r\n	if ($S->{UI}->{VARS}->{rdf_use_forms} && $c->{form_link}) {\r\n		$content .= qq~<form action=\"$c->{form_link}\" method=\"GET\">$c->{form_title}: <input type=\"text\" name=\"$c->{form_name}\"></form><br>\\n~;\r\n	}\r\n\r\n	$content .= \"</div><br>\\n\";\r\n}\r\n\r\nreturn $content;\r\n','contains RDF feeds from other sites','box',1),('rdf_pref','','my @choice = @ARGS;\r\n\r\nmy $channels = $S->rdf_channels();\r\nmy $current_prefs;\r\nmy $return = \'\';\r\n\r\n# convert the comma-separated list into a hash\r\nforeach my $i (@choice) {\r\n  $current_prefs->{$i} = 1;\r\n}\r\n\r\nmy $col = 0;\r\n\r\nforeach my $c (@{$channels}) {\r\n  $return .= qq{\r\n    <TR>} unless $col;\r\n  next unless $c->{enabled} && $c->{title} && !$c->{submitted};\r\n  my $checked = $current_prefs->{$c->{rid}} ? \" CHECKED\" : \"\";\r\n  $return .= qq{\r\n      <TD><input type=\"checkbox\" name=\"rdf_feeds\" value=\"$c->{rid}\"$checked /></TD>\r\n      <TD><a href=\"%%rootdir%%/special/rdf_preview/?rdf=$c->{rid}\">$c->{title}</a></TD>};\r\n  $return .= qq{\r\n    </TR>} if $col;\r\n  $col = ($col) ? \"0\" : \"1\";\r\n}\r\n\r\n$return .= \"<TD></TD><TD></TD></TR>\" if $col;\r\n\r\n$return = qq{\r\n<TABLE border=\"0\">\r\n$return\r\n</TABLE>};\r\n\r\nreturn $return;','','empty_box',0),('reCAPTCHA','reCAPTCHA','use Captcha::reCAPTCHA;\r\n\r\nmy $result = \"\";\r\nif ($S->{UI}->{VARS}->{\'use_captcha\'}) {\r\nmy $c = Captcha::reCAPTCHA->new;\r\n\r\n# Output form\r\n$result = $c->get_html( $S->{UI}->{VARS}->{\'captcha-public\'} );\r\n}\r\n\r\nreturn $result;','reCAPTCHA','empty_box',0),('reindex','','my ($rv, $sth) = $S->db_select({\r\n  WHAT => \'sid\',\r\n  FROM => \'stories\'});\r\nmy $count;\r\nmy $retval;\r\nwhile (my $sid = $sth->fetchrow()) {\r\n  $S->index_text($sid);\r\n  $count++;\r\n}\r\n$retval .= \"$count stories indexed : \";\r\n$count = 0;\r\n($rv, $sth) = $S->db_select({\r\n  WHAT => \'sid, cid\',\r\n  FROM => \'comments\'});\r\nwhile (my ($sid, $cid) = $sth->fetchrow_array()) {\r\n  $S->index_text($sid, $cid);\r\n  $count++;\r\n}\r\n$retval .= \"$count comments indexed : \";\r\nreturn $retval;\r\n','','',0),('related_links','Related Links','my $sid = $S->{CGI}->param(\'sid\');\r\n\r\nmy $cache = $S->cache->fetch(\"related_\".$sid);\r\n\r\nmy $time = $S->cache->refresh_one($sid.\"_mod\");\r\n\r\nunless ($time) {\r\n	if ($cache->{TIME}) {\r\n		$time = $cache->{TIME};\r\n	} else {\r\n		$time = time;\r\n	}\r\n}\r\n\r\nif (($cache->{TIME}) &&\r\n    ($cache->{TIME} == $time)) {\r\n	return { content => $cache->{CONTENT} . \"\\n<!-- cached -->\"};\r\n}\r\n\r\n$cache->{TIME} = $time;\r\n\r\nmy $db_name = $S->{CONFIG}->{db_name};\r\nmy $f_sid = $S->{DBH}->quote($sid);\r\nmy $archive = $S->_check_archivestatus($sid);\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n ARCHIVE => $archive,\r\n WHAT => \'introtext, bodytext, aid, section, tid, u.nickname AS nick\',\r\n FROM => \"stories s LEFT JOIN $db_name.users u ON s.aid = u.uid\",\r\n WHERE => qq|sid = $f_sid|});\r\n\r\nmy $data = $sth->fetchrow_hashref;\r\n$sth->finish;\r\n\r\nmy $text = $data->{introtext}.\' \'.$data->{bodytext};\r\n\r\n$data->{nick} = $S->{UI}->{VARS}->{anon_user_nick} if $data->{aid} == -1;\r\nmy @link_arr;\r\n\r\n$text =~ s/<a.*?href.*?>/1/gi;  # remove links from autorelated search\r\n\r\nmy @first_related = split /\\n/, $S->{UI}->{VARS}->{autorelated};\r\nmy (%related, $word, $url, %wordcount);\r\n\r\nforeach my $rel (@first_related) {\r\n ($word, $url) = split /,/, $rel;\r\n $url =~ s/\\r//;\r\n $related{$word} = qq|<A CLASS=\"light\" HREF=\"$url\">|;\r\n $wordcount{$word} ++;\r\n}\r\n\r\nforeach $word (keys %related) {\r\n if ($text =~ /$word/gi) {\r\n  push @link_arr, $word, $related{$word};\r\n }\r\n}\r\n\r\n$text = $data->{introtext}.\' \'.$data->{bodytext};\r\n\r\nwhile ( $text =~ /(<a href.*?>)(.*?)<\\/a>/gis ) {\r\n my $start = $1;\r\n my $word = $2;\r\n $start =~ s/<A( HREF.*?)/<A CLASS=\"light\"$1/i;\r\n $word =~ s/<.*?>//g;  # remove tags from word\r\n $word =~ s/(\\S{10})/$1<wbr>/g;\r\n $word =~ s/\"/\"/g;\r\n if (lc($related{$word}) ne lc($start)) {\r\n  $wordcount{$word} ++;\r\n  $related{$word} .= $start;\r\n  if ($wordcount{$word} > 1) {\r\n    $word .= \" [$wordcount{$word}]\";\r\n  }\r\n  push @link_arr, $word, qq|$start| unless ($start =~ /http:\\/\\/www.amazon/i);\r\n }\r\n}\r\n\r\nmy $auth_urlenc = $data->{nick};\r\n$auth_urlenc =~ s/\\s/%20/g;\r\n\r\nif ($data->{\'section\'} eq \'Diary\') {\r\n  if ($S->{UI}->{VARS}->{allow_user_host}) {\r\n    my $newnick = $data->{nick};\r\n    $newnick =~ s/ /-/g;\r\n    $newnick .= \".\" . $S->{UI}->{VARS}->{default_domain};\r\n    push @link_arr, \"$data->{nick}\'s Diary\", qq(<A CLASS=\"light\" HREF=\"http://$newnick%%rootdir%%/\">);\r\n  } else {\r\n   push @link_arr, \"$data->{nick}\'s Diary\", qq(<A CLASS=\"light\" HREF=\"%%rootdir%%/user/$auth_urlenc/diary\">); \r\n  }\r\n} else {\r\n my $t = $S->get_topic($data->{\'tid\'});\r\n push @link_arr, \"More on $t->{alttext}\", qq(<A CLASS=\"light\" HREF=\"%%rootdir%%/?op=search;topic=$data->{tid}\">) if $S->{UI}->{VARS}->{use_topics};\r\n push @link_arr, \"Also by $data->{nick}\", qq(<A CLASS=\"light\" HREF=\"%%rootdir%%/search/author/$auth_urlenc\">);\r\n}\r\n\r\n\r\nmy $content;\r\nmy $i = 0;\r\nwhile ($i <= $#link_arr) {\r\n  $content .= qq(%%dot%% $link_arr[$i+1]$link_arr[$i]</A><BR>\\n);\r\n  $i += 2;\r\n}\r\n\r\n$cache->{CONTENT} = $content;\r\n$S->cache->store(\"related_\".$sid,$cache);\r\n\r\nreturn {content => $content };','The Related links box which appears with stories','box',1),('renewad_box','Renew Advertisement','my $content = \'\';\r\nmy $err = \'\';\r\nmy $ad_id = $S->filter_param($S->cgi->param(\'ad_id\')) || 0;\r\nmy $confirm = $S->filter_param($S->cgi->param(\'confirm\')) || \'nope\';\r\nmy $purchase = $S->filter_param($S->cgi->param(\'purchase\')) || \'nope\';\r\nmy $cgi_amount = $S->filter_param($S->cgi->param(\'amount\')) || \'0.00\';\r\nmy $confirm_amt = $S->filter_param($S->cgi->param(\'confirm_amt\')) || \'1.11\'; # 1.11 so that it != $cgi_amount\r\n\r\n# first get the page set up\r\n$content = qq{\r\n<form name=\"buyimpressions\" action=\"%%rootdir%%/renew\" method=\"POST\" enctype=\"multipart/form-data\">\r\n<input type=\"hidden\" name=\"confirm_amt\" value=\"$cgi_amount\">\r\n<table border=\"0\" cellpadding=\"1\" cellspacing=\"1\" width=\"99%\"> \r\n<tr><td colspan=\"2\" bgcolor=\"%%title_bgcolor%%\">%%title_font%% Renew Advertisement %%title_font_end%%</td></tr>\r\n<tr><td colspan=\"2\"> <input type=\"hidden\" name=\"ad_id\" value=\"$ad_id\"> &nbsp; </td></tr>\r\n};\r\n\r\n###########################################\r\n### Check to make sure they can renew the ad, then renew\r\n###  else show error message.  SEt up links on user ad list\r\n###  make sure they all direct to the right box\r\n###  get cron from rusty to set up to handle renewals right\r\n###  make sure db fields are there.\r\n###  maybe write some functions to handle renewals\r\n\r\nmy $ad_hash = $S->get_ad_hash($ad_id, \'db\');\r\n\r\n# first make sure they have chosen an ad\r\nunless( $ad_id ) {\r\n	$content .= qq{ <tr><td colspan=\"2\">%%norm_font%% %%renew_choose_ad%% %%norm_font_end%%</td></tr>\r\n</table></form>};\r\n	return { content => $content };\r\n}\r\n\r\nunless( $ad_hash->{sponsor} eq $S->{UID} ) {\r\n	$content .= qq{ <tr><td colspan=\"2\">%%norm_font%% %%renew_ad_no_permission%% %%norm_font_end%%</td></tr>\r\n</table></form>};\r\n	return { content => $content };\r\n}\r\n\r\n# check if confirm, and if so, change the action \r\nif( $purchase && $purchase eq \'Purchase\' && ($confirm_amt == $cgi_amount) ) {\r\n	return qq[%%BOX,submit_ad_pay_box,renew,$ad_hash->{ad_id},$confirm_amt%%];\r\n}\r\nelsif( $purchase && $purchase eq \'Purchase\' && ($confirm_amt != $cgi_amount) )  {\r\n	# they changed their amount, let them know why they\'re at the same page again.\r\n	$err = qq|<font color=\"ff0000\"> You have changed the amount you wanted to purchase, please click Purchase again to purchase the new amount</font>|;\r\n}\r\n\r\n\r\n# if we get here, and they clicked either button, then mark it as confirmed.\r\n# its possible that they changed their amount w/out confirming again.\r\nmy $purchase_button = \'\';\r\nmy $confirmed = 0;\r\nif( ($confirm && $confirm eq \'Confirm\') or ($purchase && $purchase eq \'Purchase\') ) {\r\n	$purchase_button = q{<input type=\"submit\" name=\"purchase\" value=\"Purchase\">};\r\n	$confirmed = 1;\r\n}\r\n\r\n# need to check the input a little and generate the amount to populate the form with\r\nmy $ad_type = $S->get_ad_tmpl_info( $ad_hash->{ad_tmpl} );\r\nmy $min_impressions = $ad_type->{min_purchase_size};\r\nmy $cpm = $ad_type->{cpm};\r\nmy $amount = \'\';\r\nif( $confirmed && $cgi_amount && $cgi_amount !~ /^\\d+$/ ) {\r\n	$err = qq{<font color=\"ff0000\"> \'$cgi_amount\' is not a valid number of ads to purchase, you must purchase at least $min_impressions ad impressions</font>};\r\n	$purchase_button = \'\';\r\n}\r\nelsif( $confirmed && $cgi_amount && ($cgi_amount < $min_impressions) ) {\r\n	$err = qq{<font color=\"ff0000\"> $cgi_amount is not a valid purchase amount, the minimum amount you may purchase is $min_impressions ad impressions</font>};\r\n	$purchase_button = \'\';\r\n}\r\nelsif( $confirmed ) {\r\n	$amount = $cgi_amount;\r\n}\r\n\r\nmy $confirm_msg = $S->{UI}->{BLOCKS}->{confirm_ad_renew};\r\n$confirm_msg = \'\' unless $confirmed;\r\n\r\n$content .= qq{\r\n<tr><td colspan=\"2\"> &nbsp; </td></tr>\r\n<tr><td colspan=\"2\"> %%BOX,show_ad,$ad_id%% </td></tr>\r\n<tr><td colspan=\"2\"> %%norm_font%% $err %%norm_font_end%% </td></tr>\r\n<tr><td colspan=\"2\"> %%norm_font%% %%renew_ad_message%% %%norm_font_end%% </td></tr>\r\n<tr><td colspan=\"2\"> &nbsp; </td></tr>\r\n<tr><td align=\"left\" valign=\"top\"> %%norm_font%% <b>Order Size:</b> %%norm_font_end%% </td>\r\n<td align=\"left\" valign=\"top\"> %%norm_font%% <input type=\"text\" name=\"amount\" value=\"$amount\"> %%norm_font_end%%</td>\r\n</tr>\r\n<tr><td colspan=\"2\"> %%norm_font%% <i>Minimum order size is $min_impressions impressions</i> %%norm_font_end%%</td></tr>\r\n<tr><td colspan=\"2\"> %%norm_font%% $confirm_msg %%norm_font_end%% </td></tr>\r\n<tr><td colspan=\"2\"> &nbsp; </td></tr>\r\n<tr><td colspan=\"2\" align=\"center\"> %%norm_font%% <input type=\"submit\" name=\"confirm\" value=\"Confirm\"> $purchase_button </td></tr>\r\n};\r\n\r\n$content .= q{</table></form>};\r\n\r\n\r\n\r\n\r\nreturn { content => $content };\r\n','A page to let users renew the impressions on their ads.','blank_box',0),('rss_box','','use XML::RSS;\r\n	\r\nmy $nickname = $ARGS[1];\r\n$nickname = $S->cgi->param(\'nick\') unless ($nickname);\r\n$nickname = $S->filter_param($nickname);\r\nmy $section_name = $ARGS[2];\r\n$section_name = $S->cgi->param(\'section\') unless ($section_name);\r\n\r\nif ($nickname ne \'_all_\') {\r\n	return unless ($S->get_uid_from_nick($nickname) > 0);\r\n}\r\n\r\nif ($section_name ne \'__all__\') {\r\n	return unless ($S->have_section_perm(\'read_stories\',$section_name));\r\n}\r\n\r\nmy $rss = XML::RSS->new(version => \'1.0\',\r\n			encoding => $S->{UI}->{VARS}->{charset});\r\n\r\n$rss->add_module(prefix=>\'dc\', uri=>\'http://purl.org/dc/elements/1.1/\');\r\n\r\nmy $title;\r\nmy $desc;\r\nif ($nickname eq \'_all_\') {\r\n	$title = $S->{UI}->{VARS}->{sitename};\r\n	$desc = $S->{UI}->{VARS}->{slogan};\r\n} else {\r\n	$title = $nickname .\"\'s Diary\";\r\n	$desc = $nickname . \"\'s Diary on \" . $S->{UI}->{VARS}->{sitename};\r\n}\r\n\r\nmy $datetime = $S->_rss_datetime;\r\nmy $url = \"$S->{UI}->{VARS}->{site_url}$S->{UI}->{VARS}->{rootdir}/\";\r\nmy $user_url = $url;\r\nif ($nickname ne \'_all_\') {\r\n	if ($S->{UI}->{VARS}->{allow_user_host}) {\r\n		my $nick = $nickname;\r\n		$nick =~ s/ /-/g;\r\n		$user_url = \"http://$nick.\" . $S->{UI}->{VARS}->{default_domain} . \"/\";\r\n	} else {\r\n		$user_url .= \"user/$nickname/Diary\";\r\n	}\r\n} else {\r\n	$user_url .= \"section/Diary\";\r\n}\r\n\r\n$rss->channel(\r\n	title       => $title,\r\n	description => $desc,\r\n	link        => $user_url,\r\n	dc => { date => $datetime,\r\n		subject => $desc,\r\n		creator => $title,\r\n		language    => \'en-us\',\r\n		rights   => $S->{UI}->{VARS}->{rdf_copyright},\r\n		}\r\n);\r\n\r\n\r\n$rss->image(\r\n	title => $S->{UI}->{VARS}->{sitename},\r\n	url   => $S->{UI}->{VARS}->{rdf_image},\r\n	link  => $url\r\n);\r\n\r\nmy $story_params;\r\n$story_params = {-type => \'section\'};\r\n$story_params->{-section} = $section_name;\r\n$story_params->{-user} = $nickname unless ($nickname eq \'_all_\');\r\n\r\nmy $stories = $S->getstories($story_params);\r\n\r\nforeach my $story (@{$stories}) {\r\n        $story->{introtext} =~ s/[\\n\\r]/ /g;\r\n        foreach (qw(title introtext)) {\r\n		# (crudely) remove HTML\r\n		$story->{$_} =~ s/<.*?>//g;\r\n		# unfilter < and >, so that we don\'t turn them into &amp;lt;\r\n		$story->{$_} =~ s/&lt;/</g;\r\n		$story->{$_} =~ s/&gt;/>/g;\r\n		# filter &\r\n		$story->{$_} =~ s/&/&amp;/g;\r\n		# (re-)filter < and >\r\n		$story->{$_} =~ s/</&lt;/g;\r\n		$story->{$_} =~ s/>/&gt;/g;\r\n        }\r\n\r\n        my $link = $url . \"story/$story->{sid}\";\r\n        my $title;\r\n        $title = $story->{nick} . \": \" if ($nickname eq \'_all_\');\r\n        $title .= $story->{title};\r\n        $rss->add_item(\r\n                title => $title,\r\n                link  => $link,\r\n                description => $story->{introtext},\r\n		dc => { date => $story->{w3c_time} }\r\n );\r\n}\r\n\r\nmy $content;\r\n\r\neval {$content = $rss->as_string};\r\n\r\nif ($@) {\r\n	my $error = $@;\r\n	chomp($error);\r\n	return $error;\r\n}\r\n\r\nreturn { content => $content };\r\n\r\n','','empty_box',0),('rss_replies','','use XML::RSS;\r\n	\r\nreturn unless ($S->have_perm(\'hotlist_flex\'));\r\nreturn if ($S->{GID} eq \'Anonymous\');\r\n\r\nmy $rss = XML::RSS->new(version => \'1.0\',\r\n			encoding => $S->{UI}->{VARS}->{charset});\r\n\r\n$rss->add_module(prefix=>\'dc\', uri=>\'http://purl.org/dc/elements/1.1/\');\r\n\r\nmy $title = \"Replies to \". $S->{NICK} .\"\'s Comments\";\r\nmy $desc = \"Replies to \". $S->{NICK} .\"\'s Comments on \" . $S->{UI}->{VARS}->{sitename};\r\n\r\nmy $datetime = $S->_rss_datetime;\r\nmy $url = \"$S->{UI}->{VARS}->{site_url}$S->{UI}->{VARS}->{rootdir}/\";\r\n\r\n$rss->channel(\r\n	title       => $title,\r\n	description => $desc,\r\n	link        => $url,\r\n	dc => { date => $datetime,\r\n		subject => $desc,\r\n		creator => $title,\r\n		language    => \'en-us\',\r\n		rights   => $S->{UI}->{VARS}->{rdf_copyright},\r\n		}\r\n);\r\n\r\n$rss->image(\r\n	title => $S->{UI}->{VARS}->{sitename},\r\n	url   => $S->{UI}->{VARS}->{rdf_image},\r\n	link  => $url\r\n);\r\n\r\nmy $stuff = $S->get_comment_replys();\r\n\r\nforeach my $row (@$stuff) {\r\n        my $link = $url . \"comments/$row->{sid}/$row->{new_cid}#$row->{new_cid}\";\r\n        my $title = $row->{subject};\r\n        $rss->add_item(\r\n                title => $title,\r\n                link  => $link,\r\n                description => \"See site for content\",\r\n );\r\n}\r\n\r\nmy $content;\r\n\r\neval {$content = $rss->as_string};\r\n\r\nif ($@) {\r\n	my $error = $@;\r\n	chomp($error);\r\n	return $error;\r\n}\r\n\r\nreturn { content => $content };\r\n\r\n','','empty_box',0),('search_link','','return \'\' unless $S->have_perm(\'search\');\r\nreturn \' | <a class=\"light\" href=\"/scoop/search\">search</a>\';','','empty_box',0),('section_cellar','null','my $content = \'\';\r\n\r\n$content .= qq{<br><a class=\"light\" href=\"%%rootdir%%/section/cellar\">The Whine Cellar</a>} if ($S->have_section_perm(\'norm_read_stories\',\'cellar\'));\r\n\r\nreturn {\'content\' => $content };','Display section link if available','empty_box',0),('section_hole','null','my $content = \'\';\r\n\r\n$content .= qq{<br><a class=\"light\" href=\"%%rootdir%%/section/Crap\">The Hole</a>} if ($S->have_section_perm(\'norm_read_stories\',\'Crap\'));\r\n\r\nreturn {\'content\' => $content };','Display section link if available','empty_box',0),('section_title','null','my $content = \'\';\r\n\r\nmy $op = $S->{CGI}->param(\'op\');\r\nmy $page_num = $S->cgi->param(\'page\');\r\n$page_num = $S->cgi->param(\'start\') unless ($page_num);\r\n$page_num = $S->filter_param($page_num);\r\nmy $page = \'\';\r\nif ($page_num && $page_num != 1) {\r\n  $page = \"(page $page_num)\";\r\n}\r\n\r\nif ($op eq \'section\') {\r\n  my $user = $S->{CGI}->param(\'user\');\r\n  $user = $S->filter_param($user);\r\n  $user .= \"\'s \" if ($user);\r\n  my $section = $S->{CGI}->param(\'section\');\r\n  $content = ($user . $S->{SECTION_DATA}->{$section}->{title}) || \'All Stories\' unless($S->have_section_perm(\'hide_read_stories\',$section))\r\n} elsif ($op eq \'zerod\') {\r\n  $content = \'Review zeroed comments\';\r\n} else {\r\n  $content = \'\';\r\n}\r\n\r\nreturn {\'content\' => \"$content $page\" };','Display title of current section','empty_box',0),('section_title_subsections','null','my $content;\nmy $op = $S->{CGI}->param(\'op\');\nmy $section = $S->cgi->param(\'section\');\nif($op eq \'section\'){\n  return unless $S->have_section_perm(\'norm_read_stories\', $section);\n  if($S->{UI}->{VARS}->{enable_subsections}){\n    my @paths=$S->section_paths($section);\n    while(my $path=shift(@paths)){\n      $path=~s/\\/?$section$//;       # Remove if Current Section\n      $path=~s/([^\\/]+)/<\\/b>%%norm_font_end%%<a href=\"%%rootdir%%\\/section\\/$1\">%%norm_font%%<b>$S->{SECTION_DATA}->{$1}->{title}<\\/b>%%norm_font_end%%<\\/a>%%norm_font%%<b>/g;\n      $path=~s/^<\\/b>%%norm_font_end%%//;   # Clean Up After Ourselves\n      $path=($path)?\"%%norm_font%%<b>/</b>%%norm_font_end%%$path\":\'\';\n      $content.=qq{<a href=\"%%rootdir%%/\">%%norm_font%%<b>Home</b>%%norm_font_end%%</a>$path%%norm_font%%<b>/$S->{SECTION_DATA}->{$section}->{title}</b>%%norm_font_end%%<br>\\n};\n    } $content=~s/<\\/br>$//;\n  } else {\n    $content = $S->{SECTION_DATA}->{$section}->{title} || \'All Stories\';\n    $content = \"%%title_font%%$content%%title_font_end%%\";\n  }\n} else{ $content = \'%%title_font%%Latest News%%title_font_end%%\'; }\nreturn { content=>$content }\n','Display title of current section','blank_box',0),('share','Share this entry','my $content = \"\";\r\nmy $sid = $S->cgi->param(\'sid\');\r\n$sid = $S->filter_param($sid);\r\n\r\nmy $nick = \"\";\r\nmy $title = \"\";\r\nmy $shorttitle = \"\";\r\nmy $url = \"\";\r\n\r\nmy $story;\r\nmy $stories = $S->story_data([$sid]);\r\nif ($stories) {\r\n     $story = $stories->[0];\r\n} else {\r\n     return \"\";\r\n}\r\n\r\nif ($story) {\r\n	$story->{introtext} =~ s/[\\n\\r]/ /g;\r\n	foreach (qw(title introtext)) {\r\n		# (crudely) remove HTML\r\n		$story->{$_} =~ s/<.*?>//g;\r\n		# unfilter < and >, so that we don\'t turn them into &amp;lt;\r\n		$story->{$_} =~ s/&lt;/</g;\r\n		$story->{$_} =~ s/&gt;/>/g;\r\n		# filter &\r\n		$story->{$_} =~ s/&/&amp;/g;\r\n		# (re-)filter < and >\r\n		$story->{$_} =~ s/</&lt;/g;\r\n		$story->{$_} =~ s/>/&gt;/g;\r\n	}\r\n	$nick = $story->{nick};\r\n	$title = $story->{title};\r\n	$url = $S->{UI}->{VARS}->{site_url};\r\n	$url .= $S->{UI}->{VARS}->{rootdir};\r\n	$url .= \"/story/$sid\";\r\n	my $len = 137 - length($url);\r\n	\r\n	$shorttitle = $S->cut_title($title,$len);\r\n	$nick =~ s/\'/\\\'/g;\r\n	$title =~ s/\'/\\\'/g;\r\n	$shorttitle =~ s/\'/\\\'/g;\r\n	$url =~ s/\'/\\\'/g;\r\n}\r\n\r\n$content = $S->{UI}->{BLOCKS}->{share};\r\n$content =~ s/%%nick%%/$nick/g;\r\n$content =~ s/%%title%%/$title/g;\r\n$content =~ s/%%url%%/$url/g;\r\n$content =~ s/%%shorttitle%%/$shorttitle/g;\r\n\r\nreturn $content;','Shows various links to share stories on other sites.','box',1),('show_ad','Show Advertisement','my $arg0 = $ARGS[0];\r\nmy $ad_id;\r\nmy $adhash = {};\r\n\r\n# if the ad_id is in the url, use the url\r\nif( $arg0 eq \'fromurl\' || $arg0 eq \'allcgi\' ) {\r\n $ad_id = $S->{CGI}->param(\'ad_id\');\r\n\r\n# else if ad_id is specified in template, use that\r\n} elsif( $arg0 =~ /\\d/ ) {\r\n $ad_id = $arg0;\r\n}\r\n\r\n\r\nunless( defined( $ad_id ) || $arg0 eq \'allcgi\' ) {\r\n  warn \"returning due to no ad_id in show_ad box\";\r\n  return \'\';\r\n}\r\n\r\n# if we need everything from cgi, let get_ad_hash know\r\nmy $source = \'db\';\r\n$source = \'cgi\' if( $arg0 eq \'allcgi\' );\r\n\r\n$adhash = $S->get_ad_hash($ad_id, $source);\r\n\r\nmy $image = $adhash->{ad_file};\r\nmy $subdir = $adhash->{sponsor};\r\n$subdir = \'example\' if( $adhash->{example} == 1 );\r\n\r\nmy $image_path = $subdir . \'/\' . $image;\r\n\r\nmy $content = \'\';\r\nif( exists $S->{UI}->{BLOCKS}->{ \"preview_\".$adhash->{ad_tmpl} } ) {\r\n   $content = $S->{UI}->{BLOCKS}->{ \"preview_\" . $adhash->{ad_tmpl} };\r\n} else {\r\n        $content = $S->{UI}->{BLOCKS}->{ $adhash->{ad_tmpl} };\r\n}\r\n\r\n#$content =~ s/%%LINK_URL%%/%%rootdir%%\\/redirect\\/$adhash->{ad_id}/g;\r\n$content =~ s/%%LINK_URL%%/$adhash->{ad_url}/g;\r\n$content =~ s/%%TITLE%%/$adhash->{ad_title}/g;\r\n$content =~ s/%%TEXT1%%/$adhash->{ad_text1}/g;\r\n$content =~ s/%%TEXT2%%/$adhash->{ad_text2}/g;\r\n$content =~ s/%%FILE_PATH%%/$adhash->{ad_file}/g;\r\n$content =~ s/%%COMMENTS%%//g;\r\n\r\n\r\n#$content =~ s/%%FILE_PATH%%/$image_path/g;\r\n#$content =~ s/%%TEXT1%%/$adhash->{ad_text1}/g;\r\n#$content =~ s/%%TEXT2%%/$adhash->{ad_text2}/g;\r\n#$content =~ s/%%TITLE%%/$adhash->{ad_title}/g;\r\n#$content =~ s/%%LINK_URL%%/%%rootdir%%\\/redirect\\/$adhash->{ad_id}/g;\r\n\r\nreturn { content => $content };\r\n','Just a simple box that will show the ad specified','blank_box',0),('show_comment_raters','Others have rated this comment as follows:','my $content = qq{\r\n	<table width=\"100%\" border=0 cellpadding=2 cellspacing=0>};\r\n\r\nmy $cid = $S->{CGI}->param(\'cid\');\r\nmy $sid = $S->{CGI}->param(\'sid\');\r\nmy $archive = $S->_check_archivestatus($sid);\r\n\r\nmy $f_cid = $S->{DBH}->quote($cid);\r\nmy $f_sid = $S->{DBH}->quote($sid);\r\n\r\n#Check for hidden\r\nmy ($rv, $sth) = $S->db_select({\r\n        ARCHIVE => $archive,\r\n	WHAT => \'points\',\r\n	FROM => \'comments\',\r\n	WHERE => qq{sid = $f_sid AND cid = $f_cid}});\r\n\r\nmy $points = $sth->fetchrow();\r\n$sth->finish();\r\n\r\nif ( ($points < $S->{UI}->{VARS}->{rating_min}) && \r\n	!( ($S->{TRUSTLEV} == 2) || ($S->have_perm(\'super_mojo\')))) {\r\n	return \'\';\r\n}\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n        ARCHIVE => $archive,\r\n	WHAT => \'uid, rating, rater_ip\',\r\n	FROM => \'commentratings\',\r\n	WHERE => qq{sid = $f_sid AND cid = $f_cid}});\r\n\r\nmy $zeros = 0;\r\nmy $trusted = 0;\r\nif (($S->{TRUSTLEV} == 2) || ($S->have_perm(\'super_mojo\'))) {\r\n  $trusted = 1;\r\n}\r\n\r\nwhile (my $rating = $sth->fetchrow_hashref()) {\r\n	my $user = $S->user_data($rating->{uid});\r\n	\r\n	if ( ($rating->{\'rating\'} < $S->{UI}->{VARS}->{rating_min}) && ($trusted == 0) ) {\r\n		$zeros++;\r\n	} else {\r\n		$content .= qq{\r\n			<tr>\r\n			<td>%%norm_font%%<A CLASS=\"light\" HREF=\"%%rootdir%%/user/uid:$rating->{uid}\">$user->{nickname}</A>%%norm_font_end%%</td>\r\n			<td>%%norm_font%%$rating->{rating}%%norm_font_end%%</td>};\r\n		if ($S->have_perm(\'view_comment_ip\')) {\r\n			$content .= qq{\r\n			<td>%%norm_font%%<A CLASS=\"light\" HREF=\"%%rootdir%%/special/ip_usage?ip=$rating->{rater_ip}\">$rating->{rater_ip}</A>%%norm_font_end%%</td>};\r\n		};\r\n		$content .= qq{\r\n			</tr>};\r\n	}\r\n}\r\n\r\n$sth->finish();\r\n\r\nif ($zeros) {\r\n	my $word = ($zeros == 1) ? \"Rating\" : \"Ratings\";\r\n	\r\n	$content .= qq{\r\n		<tr>\r\n			<td colspan=2>%%norm_font%%Zero $word: $zeros%%norm_font_end%%</td>\r\n		</tr>};\r\n}\r\n\r\n$content .= qq{\r\n    </table>};\r\n\r\nreturn {\'content\' => $content};\r\n','Display who rated a comment what','box',0),('show_hidden_pref','','my $current = $ARGS[0];\r\n\r\nmy $choices = {\r\n    \'yes\' => \'Yes\',\r\n    \'no\' => \'No\',\r\n    \'untilrating\' => \"Show until I\'ve rated\"\r\n};\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"hidingchoice\" size=\"1\">};\r\n\r\nforeach my $choice (keys %{$choices}) {\r\n    my $selected = $choice eq $current ? \' SELECTED\' : \'\';\r\n    $select .= qq{\r\n        <OPTION value=\"$choice\"$selected>$choices->{$choice}</OPTION>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>};\r\n\r\nreturn $select;','','empty_box',0),('show_images_extra','Show images in stories and comments','my $pref = $S->pref(\'show_images\');\r\nmy $img = $ARGS[0];\r\nmy $desc = $ARGS[1];\r\n\r\n$img =~ s/\'/`/g;\r\n$desc =~ s/\'/`/g;\r\n$img =~ s/\"/\"/g;\r\n$desc =~ s/\"/\"/g;\r\n\r\nreturn qq{<img src=\"%%upload_link_user%%$img\" alt=\"$desc\" title=\"$desc\">} if (lc($pref) eq \'yes\');\r\n\r\nreturn qq{<a href=\"%%upload_link_user%%$img\"><img src=\"%%imagedir%%%%topics%%/wrkhmp.gif\" alt=\"$desc\" title=\"$desc\" onclick=\"return toggleHiddenImage(this,\\\'%%upload_link_user%%$img\\\');\"></a>};\r\n','','empty_box',0),('signup_password','','return \'\' unless $S->{UI}->{VARS}->{\'signup_with_password\'};\r\n\r\nreturn qq{\r\n<TR><TD class=\"smalltext\">\r\n<b>Please choose a password:</b>\r\n</TD>\r\n<TD>\r\n<INPUT TYPE=\"password\" NAME=\"pass1\" VALUE=\"%%pass1%%\" SIZE=30>\r\n</TD>\r\n</TR>\r\n<TR><TD class=\"smalltext\">\r\n<b>Type password again:</b>\r\n</TD>\r\n<TD>\r\n<INPUT TYPE=\"password\" NAME=\"pass2\" VALUE=\"%%pass2%%\" SIZE=30>\r\n</TD>\r\n</TR>};\r\n\r\n\r\n','Generate the new user password form, if desired','empty_box',0),('slogan_box','','my @poss = split(/\\n/,$S->{UI}->{BLOCKS}->{slogans});\r\n\r\nmy $size = @poss;\r\n\r\nmy $rand = int(rand($size));\r\n\r\nreturn $poss[$rand];\r\n\r\n#return \"demo.hulver.com\";','','empty_box',0),('speller','','my $retval;\r\n\r\nreturn \'\' unless $S->spellcheck_enabled();\r\n\r\nmy $spellercss = \'/speller/spellerStyle.css\';\r\nmy $wordWindowSrc = \'/speller/wordWindow.js\';\r\nmy @textinputs = $S->cgi->param(\'textinputs[]\'); # array\r\n\r\n$retval .= qq|<html>\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\r\n<link rel=\"stylesheet\" type=\"text/css\" href=\"$spellercss\"/>\r\n<script language = \"javascript\" src=\"$wordWindowSrc\"></script>\r\n<script language = \"javascript\">\r\nvar suggs = new Array();\r\nvar words = new Array();\r\nvar textinputs = new Array();\r\nvar error;\r\n|;\r\n\r\nfor( my $i = 0; $i <= $#textinputs; $i++ ) {\r\n	my $temp = $textinputs[$i];\r\n	$temp =~ s/\'/\\\\\'/g;\r\n        $retval .= \"textinputs[$i] = decodeURIComponent(\'\" . $temp .\"\');\\n\";\r\n}\r\n\r\nmy $wordIdx = 0;\r\nmy $unhandledText;\r\n\r\nfor ( my $textInputIdx = 0; $textInputIdx <= $#textinputs; $textInputIdx++ ){\r\n#warn \"Checking : \" . $textinputs[$textInputIdx] . \" \\n\";\r\nmy @words;\r\nmy $temp = $textinputs[$textInputIdx];\r\n$temp =~ s/\\+/ /g;\r\n$temp =~ s/%([a-fA-F0-9]{2})/pack \"H2\", $1/eg;\r\n#warn \"Temp is : $temp\\n\";\r\n$S->spellcheck_html($temp,sub{ my $word = shift; push(@words,$word);});\r\n\r\n#warn \"Got following words: \" . @words;\r\n$retval .= \"words[$textInputIdx] = [];\\n\";\r\n$retval .= \"suggs[$textInputIdx] = [];\\n\";\r\n$wordIdx = 0;\r\nforeach my $ret (@words) {\r\n	#warn \"Checking word : $ret\\n\";\r\n	$S->spellchecker->set_option(\'sug-mode\',\'fast\');\r\n	my @suggs = $S->spellchecker->suggest( $ret );\r\n	$ret =~ s/\'/\\\\\'/g;\r\n	\r\n	$retval .= \"words[$textInputIdx][$wordIdx] = \'$ret\';\\n\";\r\n	$retval .= \"suggs[$textInputIdx][$wordIdx] = [\";\r\n	for my $i ( 0..$#suggs ) {\r\n		my $replace = $suggs[$i];\r\n		$replace =~ s/\'/\\\\\'/g;\r\n		$retval .= \"\'\" . $replace . \"\'\";\r\n		if( $i < $#suggs ) {\r\n			$retval .= \", \";\r\n		}\r\n	}\r\n	$retval .= \"];\\n\";\r\n	$wordIdx++;\r\n}\r\n}\r\n\r\n$retval .= qq|\r\nvar wordWindowObj = new wordWindow();\r\nwordWindowObj.originalSpellings = words;\r\nwordWindowObj.suggestions = suggs;\r\nwordWindowObj.textInputs = textinputs;\r\n\r\n\r\nfunction init_spell() {\r\n	// check if any error occured during server-side processing\r\n	if( error ) {\r\n		alert( error );\r\n	} else {\r\n		// call the init_spell() function in the parent frameset\r\n		if (parent.frames.length) {\r\n			parent.init_spell( wordWindowObj );\r\n		} else {\r\n			error = \"This page was loaded outside of a frameset. \"; \r\n			error += \"It might not display properly\";\r\n			alert( error );\r\n		}\r\n	}\r\n}\r\n\r\n</script>\r\n\r\n</head>\r\n<body onLoad=\"init_spell();\">\r\n\r\n<script type=\"text/javascript\">\r\nwordWindowObj.writeBody();\r\n</script>\r\n</body>\r\n</html>\r\n|;','Allows spelling suggestions.','blank_box',0),('startpage_pref','','my $choice = $ARGS[0];\r\n\r\nmy @choices = sort keys %{ $S->{SECTION_DATA} };\r\nunshift(@choices, \'__main__\', \'__all__\');\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"start_page\" size=\"1\"};\r\n\r\nforeach my $c (@choices) {\r\n  my $name;\r\n  if ( $c eq \'__main__\' ) {\r\n    $name = \'Front Page\';\r\n  } elsif ( $c eq \'__all__\' ) {\r\n    $name = \'Everything\';\r\n  } else {\r\n    $name = $S->{SECTION_DATA}->{$c}->{title};\r\n  }\r\n  my $checked = ($c eq $choice) ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"$c\"$checked>$name</OPTION>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>};\r\nreturn $select;','','empty_box',0),('startpage_validation','','if ( $S->{SECTION_DATA}->{$ARGS[1]} || $ARGS[1] eq \'__main__\' || $ARGS[1] eq \'__all__\' ) {\n  return \'\';\n} else {\n  return \"Start Page not valid<BR>\";\n}','validates the start page pref','empty_box',0),('story_hit_box','Hit Counter','## START story_hit_box ##\r\n# story_hit_box\r\n# NOTE: you might want to add an index to your\r\n# viewed_stories table to make this run quite\r\n# a bit faster, especially if your site is more\r\n# than just a little busy\r\n# mysql> create index sid_idx on viewed_stories (sid);\r\n# ALSO, this doesn\'t cache yet, it will in the future.\r\n#  Shouldn\'t be a problem for small sites.\r\nmy $sid = $S->{CGI}->param(\'sid\');\r\n\r\nif ($S->_check_archivestatus($sid)) {\r\n	return;\r\n}\r\n\r\n$sid = $S->{DBH}->quote($sid);\r\n\r\nmy ($rv,$sth) = $S->db_select({\r\n	FROM	=> \'viewed_stories\',\r\n	WHAT	=> \'count(uid) as c\',\r\n	WHERE	=> \"sid = $sid\"\r\n	});\r\n\r\nmy $count = 0;\r\nif( $rv ) {\r\n	$count = $sth->fetchrow;\r\n}\r\nmy $s = \'s have\';\r\n$s = \' has\' if $count == 1;\r\n\r\nmy $content = qq[%%norm_font%%<b>$count</b> Husi user$s viewed this.%%norm_font_end%%];\r\n\r\nif ($S->have_perm(\'story_admin\')) {\r\n	$sth->finish();\r\n	($rv, $sth) = $S->db_select({\r\n		FROM	=> \'viewed_stories\',\r\n		WHAT	=> \'count(uid) as c\',\r\n		WHERE	=> \"sid = $sid and hide = 1\",\r\n		});\r\n	my $hidden = 0;\r\n	if ($rv) {\r\n		$hidden = $sth->fetchrow;\r\n	}\r\n\r\n	my $percent;\r\n\r\n	if ($count > 10) {\r\n	  $percent = sprintf(\"%.0f\", ($hidden / $count) * 100);\r\n	  $percent = 0 if (($hidden / $count) * 100) < 8;\r\n	}\r\n\r\n	if ($percent) {\r\n		$content .= \"<br>%%norm_font%%<b>$hidden</b> user\";\r\n		$content .= \"s ($percent%) have \" if ($hidden > 1);\r\n		$content .= \" ($percent%) has \" if ($hidden == 1);\r\n		$content .= \"hidden this.%%norm_font_end%%\";\r\n	}\r\n}\r\n\r\nreturn { content => $content };\r\n\r\n\r\n## END story_hit_box ##\r\n\r\n','Box to show how many users have viewed a story','box',1),('story_vote','Vote story?','return unless ($S->{UID} > 0);\r\nreturn unless ($S->have_perm(\'moderate\'));\r\n\r\nmy $sid = $S->{CGI}->param(\'sid\');\r\n\r\nreturn unless $sid;\r\nreturn if ($sid eq \'preview\');\r\n\r\nmy $content;\r\n\r\nmy ($rv, $sth) = $S->db_select({WHAT => \'vote\',\r\n				FROM => \'storyvote\',\r\n				WHERE => \'sid = ? and uid = ?\',\r\n				PARAMS => [$sid, $S->{UID}]});\r\n\r\nmy $currvote;\r\nmy $author_vote = 0;\r\n\r\nif ($rv == 1) {\r\n	$currvote = $sth->fetchrow();\r\n	$author_vote = 1;\r\n}\r\n\r\n$sth->finish();\r\n\r\nmy $stories = $S->getstories({\'-type\' => \'fullstory\',\r\n			    \'-sid\' => $sid});\r\nmy $story;\r\n\r\nif ($stories) {\r\n  $story = $stories->[0];\r\n} else {\r\n  return;\r\n}\r\n\r\nmy @sections = split \',\', $S->{UI}->{VARS}->{story_vote_sections};\r\nforeach my $section (@sections) {\r\n  if ($story->{section} eq $section) {\r\n    $story->{useme} = 1;\r\n  }\r\n}\r\n\r\nreturn if (($story->{displaystatus} != 1) || ($story->{useme} != 1));\r\n\r\nif ($story->{aid} == $S->{UID}) {\r\n	return unless ($author_vote);\r\n} else {\r\n	$author_vote = 0;\r\n}\r\n\r\nmy $vote = $S->{CGI}->param(\'vote\');\r\n\r\nif ((\"$vote\" =~ /[-1|0|1]/) && $S->check_formkey()) {\r\n  if ($author_vote) {\r\n    if (\"$vote\" eq \"1\") {\r\n        my ($rv, $sth) = $S->db_update({\r\n                WHAT => \'stories\',\r\n                SET => \'displaystatus = 0\',\r\n                WHERE => \'sid = ?\',\r\n		PARAMS => [$sid]});\r\n	$S->log_activity(\'move_frontpage\',$sid,$S->{UID});\r\n	return \"Story has been posted to the front page\";\r\n    } else {\r\n	$S->db_update({ WHAT => \'storyvote\',\r\n		SET => \'vote = ?, time = now()\',\r\n		WHERE => \'sid = ? and uid = ?\',\r\n		PARAMS => [$vote, $sid, $S->{UID}]});\r\n    }\r\n  } else {\r\n	  ($rv, $sth) = $S->db_insert({ INTO => \'storyvote\',\r\n				COLS => \'sid, uid, time, vote\',\r\n				VALUES => \'?, ?, now(), ?\',\r\n				PARAMS => [$sid, $S->{UID}, $vote]});\r\n	  unless ($rv == 1) {\r\n		$S->db_update({ WHAT => \'storyvote\',\r\n			SET => \'vote = ?, time = now()\',\r\n			WHERE => \'sid = ? and uid = ?\',\r\n			PARAMS => [$vote, $sid, $S->{UID}]});\r\n	  }\r\n  }\r\n} else {\r\n  $vote = $currvote;\r\n}\r\n\r\nmy $formkey = $S->get_formkey_element();\r\n\r\nmy ($down, $net, $up);\r\n\r\n$down = qq{\"-1\"};\r\n$net = qq{\"0\"};\r\n$up = qq{\"1\"};\r\n$down .= \" CHECKED\" if ($vote eq \"-1\");\r\n$net .= \" CHECKED\" if ($vote eq \"0\");\r\n$up .= \" CHECKED\" if ($vote eq \"1\");\r\n\r\n$content .= qq{<form action=\"%%rootdir%%/story/$sid\" method=\"post\">\r\n$formkey\r\n<label><input type=\"radio\" name=\"vote\" value=$up>Front Page Material</label><br>\r\n<label><input type=\"radio\" name=\"vote\" value=$down>Spam</label><br>\r\n<label><input type=\"radio\" name=\"vote\" value=$net>Don\'t care</label><br>\r\n<input type=\"submit\" value=\"Vote!\"></form>};\r\n\r\nreturn $content;','Decide to vote this story to the front page.','box',1),('story_vote_cron','','my $count = $S->{UI}->{VARS}->{story_vote_count} || 5;\r\nmy $votes = $S->{UI}->{VARS}->{story_vote_votes} || 15;\r\nmy $spam = $S->{UI}->{VARS}->{story_vote_spam} || 5;\r\nmy $spam_address =  $S->{UI}->{VARS}->{story_vote_spam_address};\r\n\r\nmy ($rv, $sth) = $S->db_select({ WHAT => \'v.sid,count(v.vote) as cvote,sum(v.vote) as vote,s.aid,s.title, s.displaystatus\',\r\n				FROM => \'storyvote v, stories s\',\r\n				WHERE => \'s.sid=v.sid and (date_add(s.time, interval 2 day) > now()) and s.displaystatus > 0\',\r\n				GROUP_BY => \'v.sid\',\r\n				HAVING => \'(vote > ? or vote <= ?) and cvote > ? \',\r\n				PARAMS => [$votes, $spam, $count]});\r\nmy @sids;\r\n\r\nwhile (my $row = $sth->fetchrow_hashref()) {\r\n	#my ($rv2, $sth2) = $S->db_select({ WHAT => \'sum(hide)\',\r\n	#				FROM => \'viewed_stories\',\r\n	#				WHERE => \'sid = ?\',\r\n	#				PARAMS => [$row->{\'sid\'}]});\r\n	#my $hide = 0;\r\n	#$hide = $sth2->fetchrow() if ($rv2);\r\n	#$sth2->finish();\r\n	#if (($row->{\'vote\'} - $hide) < $votes) {\r\n	#	warn \"Skipping \".$row->{\'sid\'}.\": Too many hides\\n\";\r\n	#	next;\r\n	#}\r\n	my $aid = $row->{\'aid\'};\r\n	my ($rv2, $sth2) = $S->db_select({ WHAT => \'vote\',\r\n					FROM => \'storyvote\',\r\n					WHERE => \'uid = ? and sid=?\',\r\n					PARAMS => [$aid,$row->{\'sid\'}]});\r\n	unless ($rv2 == 1) {\r\n		push(@sids,{ sid => $row->{\'sid\'},\r\n			     aid => $aid,\r\n			     title => $row->{\'title\'},\r\n				 votes => $row->{\'vote\'}});\r\n	}\r\n	$sth2->finish();\r\n}\r\n$sth->finish();\r\n\r\nforeach my $story (@sids) {\r\n	my $url = \"$S->{UI}->{VARS}->{site_url}$S->{UI}->{VARS}->{rootdir}/story/\" . $story->{sid};\r\n	my $title = $story->{title};\r\n	if ($story->{votes} <= $spam) {\r\n		$S->log_activity(\'story_spam\',$story->{sid},$story->{aid});\r\n		my $subject = \"A story on $S->{UI}->{VARS}->{sitename} has been marked as spam\";\r\n		my $msg = $S->{UI}->{BLOCKS}->{story_vote_spam_warning};\r\n		$msg =~ s/%%story_url%%/$url/g;\r\n		$msg =~ s/%%story_title%%/$title/g;\r\n		$msg =~ s/%%sitename%%/$S->{UI}->{VARS}->{sitename}/g;\r\n        my ($rv, $sth) = $S->db_update({\r\n                WHAT => \'stories\',\r\n                SET => \'displaystatus = -1\',\r\n                WHERE => \'sid = ?\',\r\n		PARAMS => [$story->{sid}]});\r\n		$S->mail($spam_address, $subject, $msg);\r\n	} else {\r\n		my $email = $S->get_email_from_uid($story->{aid});\r\n		my $subject = \"Your diary on $S->{UI}->{VARS}->{sitename} has been voted to the front page\";\r\n		my $msg = $S->{UI}->{BLOCKS}->{story_vote_email};\r\n		$msg =~ s/%%story_url%%/$url/g;\r\n		$msg =~ s/%%story_title%%/$title/g;\r\n		$msg =~ s/%%sitename%%/$S->{UI}->{VARS}->{sitename}/g;\r\n		my ($rv, $sth) = $S->db_insert({\r\n							INTO   => \'storyvote\',\r\n							COLS   => \'sid, uid, time, vote\',\r\n							VALUES => \'?, ?, now(), 0\',\r\n				PARAMS => [$story->{sid},$story->{aid}]});\r\n		if ($rv == 1) {\r\n			$S->log_activity(\'frontpage_offer\',$story->{sid},$story->{aid});\r\n			$S->mail($email, $subject, $msg);\r\n		}\r\n	}\r\n}\r\n\r\nreturn 1;','','empty_box',0),('submit_ad_pay_box','Ad Submitted','my $action = $ARGS[0];\r\nmy $ad_id = $ARGS[1];\r\n\r\nmy $q_id = $S->dbh->quote($ad_id);\r\nmy ($num, $price);\r\nmy $args;\r\nmy $content;\r\n\r\nif ($action eq \'renew\') {\r\n        $num = $ARGS[2];\r\n        unless ($num) {\r\n                return \'Error! No impression count was submitted.\';\r\n        }\r\n        # Get total price\r\n        my ($rv, $sth) = $S->db_select({\r\n                WHAT  => \'ad_types.cpm\',\r\n                FROM  => \'ad_info, ad_types\',\r\n                WHERE => \"ad_info.ad_id = $q_id AND ad_info.ad_tmpl =\r\nad_types.type_template\"\r\n        });\r\n        my ($cpm) = $sth->fetchrow();\r\n        $price = ($num/1000) * $cpm;\r\n        $args=\";ad_id=$ad_id;renew=1;count=$num\";\r\n	$content = $S->{UI}->{BLOCKS}->{ad_renewed_message};\r\n} else {\r\n        my ($rv, $sth) = $S->db_select({\r\n                WHAT => \'purchase_size, purchase_price\',\r\n                FROM => \'ad_info\',\r\n                WHERE => \"ad_id=$q_id\"});\r\n\r\n        ($num, $price) = $sth->fetchrow();\r\n        $sth->finish();\r\n	$args=\";ad_id=$ad_id\";\r\n	$content = $S->{UI}->{BLOCKS}->{ad_submitted_message};\r\n}\r\n\r\nmy ($pay_cc_block, $pay_pal_block, $pay_free_block);\r\n\r\n$price = sprintf(\"%1.2f\", $price);\r\nif ($price ne \'0.00\') {\r\n  $pay_cc_block = $S->{UI}->{BLOCKS}->{ad_pay_cc_msg} if ($S->{UI}->{VARS}->{payment_use_cc});\r\n  $pay_pal_block = $S->{UI}->{BLOCKS}->{ad_pay_paypal_msg} if ($S->{UI}->{VARS}->{payment_use_paypal});\r\n} else {\r\n  $pay_free_block = $S->{UI}->{BLOCKS}->{ad_free_msg};\r\n  #// update the advert here for number of impressions.\r\n  if ($action eq \'renew\') {\r\n    $S->cc_finish_renewal($ad_id, \'\', 0, \'free\', $num);\r\n  } else {\r\n    $S->cc_finish_ad_sale($ad_id, \'\', 0, \'free\');\r\n  }\r\n}\r\n$content =~ s/%%AD_CC_PAY%%/$pay_cc_block/;\r\n$content =~ s/%%AD_PAYPAL_PAY%%/$pay_pal_block/;\r\n$content =~ s/%%AD_FREE_MESSAGE%%/$pay_free_block/g;\r\n$content =~ s/%%num_impressions%%/$num/g;\r\n$content =~ s/%%price%%/$price/g;\r\n$content =~ s/%%payment_args%%/$args/g;\r\n\r\nreturn { content => $content };\r\n','This generates the page the user will see when they have successfully submitted or renewed an ad. If they still need to pay for the advert it will display the various payment options, depending on the ads_use_cc and ads_use_paypal vars. If the advert is free, it will call the relevent functions to mark it as paid. Depends on the blocks ad_renewed_message, ad_submitted_message, ad_pay_cc_msg, ad_pay_paypal_msg & ad_free_msg','box',0),('submit_ad_pay_box_old','Ad Submitted','my $action = $ARGS[0];\r\nmy $ad_id = $ARGS[1];\r\n\r\nmy $q_id = $S->dbh->quote($ad_id);\r\nmy ($num, $price);\r\nmy $args;\r\n\r\nif ($action eq \'renew\') {\r\n        $num = $ARGS[2];\r\n        unless ($num) {\r\n                return \'Error! No impression count was submitted.\';\r\n        }\r\n        # Get total price\r\n        my ($rv, $sth) = $S->db_select({\r\n                WHAT  => \'ad_types.cpm\',\r\n                FROM  => \'ad_info, ad_types\',\r\n                WHERE => \"ad_info.ad_id = $q_id AND ad_info.ad_tmpl =\r\nad_types.type_template\"\r\n        });\r\n        my ($cpm) = $sth->fetchrow();\r\n        $price = ($num/1000) * $cpm;\r\n        $args=\";ad_id=$ad_id;renew=1;count=$num\";\r\n} else {\r\n        my ($rv, $sth) = $S->db_select({\r\n                WHAT => \'purchase_size, purchase_price\',\r\n                FROM => \'ad_info\',\r\n                WHERE => \"ad_id=$q_id\"});\r\n\r\n        ($num, $price) = $sth->fetchrow();\r\n        $sth->finish();\r\n	$args=\";ad_id=$ad_id\";\r\n}\r\n\r\nmy $content = $S->{UI}->{BLOCKS}->{ad_submitted_message};\r\n\r\nmy $pay_block;\r\n$price = sprintf(\"%1.2f\", $price);\r\nif ($price ne \'0.00\') {\r\n  $pay_block = $S->{UI}->{BLOCKS}->{ad_pay_cc_msg} if ($S->{UI}->{VARS}->{ads_use_cc});\r\n  $content =~ s/%%AD_CC_PAY%%/$pay_block/;\r\n  $pay_block = $S->{UI}->{BLOCKS}->{ad_pay_paypal_msg} if ($S->{UI}->{VARS}->{ads_use_paypal});\r\n  $content =~ s/%%AD_PAYPAL_PAY%%/$pay_block/;\r\n  $content =~ s/%%AD_FREE_MESSAGE%%//g;\r\n} else {\r\n  $content =~ s/%%AD_CC_PAY%%//;\r\n  $content =~ s/%%AD_PAYPAL_PAY%%//;\r\n  $pay_block = $S->{UI}->{BLOCKS}->{ad_free_msg};\r\n  $content =~ s/%%AD_FREE_MESSAGE%%/$pay_block/g;\r\n  #// update the advert here for number of impressions.\r\n  if ($action eq \'renew\') {\r\n    $S->cc_finish_renewal($ad_id, \'\', 0, \'free\', $num);\r\n  } else {\r\n    $S->cc_finish_ad_sale($ad_id, \'\', 0, \'free\');\r\n  }\r\n}\r\n$content =~ s/%%num_impressions%%/$num/g;\r\n$content =~ s/%%price%%/$price/g;\r\n$content =~ s/%%payment_args%%/$args/g;\r\n\r\nreturn { content => $content };\r\n','This generates the page the user will see when they have successfully submitted an ad.  This should direct them on how to pay for the ad, and\r\nexplain the details of what will happen now. ','box',0),('submit_rdf','Submit Feed','return \"Sorry, you don\'t have permission to submit a feed.\"\r\n\r\nunless $S->have_perm(\'submit_rdf\');\r\n\r\nmy $action = $S->{CGI}->param(\'action\') || \'showform\';\r\n\r\nif ($action eq \'showform\') {\r\n\r\nreturn &disp_form();\r\n\r\n} elsif ($action eq \'save\') {\r\n\r\nmy $url = $S->{CGI}->param(\'url\');\r\n\r\nreturn (\'Please fill in the URL field\') unless $url;\r\n\r\n# check to see if this RDF already exists\r\n\r\nmy $is_dup = 0;\r\n\r\nmy $channels = $S->rdf_channels;\r\n\r\nforeach my $c (@{$channels}) {\r\n\r\n$is_dup = 1 if $c->{rdf_link} eq $url;\r\n\r\n}\r\n\r\nreturn &disp_form(\'That RDF already exists, or has been submitted already.\') if $is_dup;\r\n\r\n\r\n\r\nmy $do_fetch = $S->{UI}->{VARS}->{allow_rdf_fetch} ? 1 : 0;\r\n\r\nmy ($id, $res) = $S->rdf_add_channel($url, $do_fetch, $S->{NICK});\r\n\r\nunless ($res) {\r\n\r\n$S->rdf_remove_channel($id);\r\n\r\nreturn &disp_form(\'Error adding RDF file: $res\');\r\n\r\n}\r\n\r\nmy $fetched_msg = qq|\r\n\r\n%%norm_font%%Your RDF has been fetched. An admin will check it out as soon as possible%%norm_font_end%%|;\r\n\r\nreturn $fetched_msg;\r\n\r\n}\r\n\r\n\r\n\r\nsub disp_form {\r\n\r\nmy $form = qq|\r\n\r\n%%norm_font%% %%submit_rdf_message%% %%norm_font_end%%\r\n\r\n<p>\r\n\r\n<form action=\"%%rootdir%%/?\" method=\"GET\">\r\n\r\n<input type=\"hidden\" name=\"op\" value=\"submitrdf\">\r\n\r\n<input type=\"hidden\" name=\"action\" value=\"save\">\r\n\r\n<table border=0 cellspacing=0 cellpadding=0>|;\r\n\r\n$form .= qq|\r\n\r\n<tr>\r\n\r\n<td><FONT color=\"#FF0000\">%%norm_font%%$_[0]%%norm_font_end%%</font></td>\r\n\r\n</tr>| if $_[0];\r\n\r\n$form .= qq|\r\n\r\n<tr>\r\n\r\n<td>%%norm_font%%URL of RDF file:%%norm_font_end%% <input type=\"text\" name=\"url\" size=\"50\"></td>\r\n\r\n</tr>\r\n\r\n<tr>\r\n\r\n<td><input type=\"submit\" value=\"Submit\"></td>\r\n\r\n</tr>\r\n\r\n</table>\r\n\r\n</form>\r\n\r\n|;\r\n\r\nreturn $form;\r\n\r\n}\r\n\r\n','Box to do submitrdf op and such.','titled_box',0),('subpay_cc','Pay for Your Subscription','my $content;\r\nmy $type   = $ARGS[0];\r\nmy $months = $ARGS[1];\r\n\r\n\r\n# If we\'re ordering, do it now.\r\nif ($S->cgi->param(\'final_pay\')) {\r\n	$content .= $S->cc_place_order(\'subscription\');\r\n	return $content;\r\n}\r\n\r\n\r\nmy $type_data = $S->sub_get_type($type);\r\n\r\n# Bounds check the period\r\n$months = $type_data->{max_time} \r\n    if (($type_data->{max_time}) && $months > $type_data->{max_time});\r\n\r\nmy ($price, $remaining) = $S->sub_calculate_purchase_cost($type, $months);\r\n\r\nmy $content = qq{%%norm_font%%$remaining};\r\n\r\nif ($S->cgi->param(\'pay\')) {\r\n    $content .= $S->cc_preview_order($price,$months,\'subscription\');\r\n}\r\n\r\nmy $p_form = $S->cc_make_person_form();\r\nmy $c_form = $S->cc_make_card_form();\r\n\r\n\r\n$content .= qq{\r\n<p>\r\nPlease fill in the payment form below. Required fields are in \r\n<font color=\"#ff0000\">red</font>. When you are done, click \"Preview Order\". \r\nYou will <b>not</b> be billed yet, and you will be able to change what you\'ve \r\nentered before confirming the order.\r\n<form name=\"subpay\" ACTION=\"/subpay\" METHOD=\"POST\">\r\n<input type=\"hidden\" name=\"months\" value=\"$months\">\r\n<input type=\"hidden\" name=\"pay_type\" value=\"cc\">\r\n<input type=\"hidden\" name=\"type\" value=\"$type\">\r\n<p>\r\n<b>Billing Information:</b>\r\n<p>\r\n$p_form\r\n<p>\r\n<b>Credit/Debit Card Information:</b>\r\n<p>\r\n$c_form\r\n<p>\r\n<input type=\"submit\" name=\"pay\" value=\"Preview Order\">\r\n</form>%%norm_font_end%%};\r\n\r\n#\'\r\n\r\nreturn $content;\r\n','Purchase a subscription with a credit card','blank_box',0),('subpay_paypal','','my $content;\r\nmy $type   = $ARGS[0];\r\nmy $months = $ARGS[1];\r\nmy $site = $S->{UI}->{VARS}->{site_url}.$S->{UI}->{VARS}->{rootdir};\r\nmy $secure_site = $S->{UI}->{VARS}->{secure_site_url}.$S->{UI}->{VARS}->{rootdir};\r\nmy $business_id = $S->{UI}->{VARS}->{paypal_business_id};\r\nmy $item = \'Subscription\';\r\n\r\nmy $type_data = $S->sub_get_type($type);\r\n\r\n# Bounds check the period\r\n$months = $type_data->{max_time} \r\n    if (($type_data->{max_time}) && $months > $type_data->{max_time});\r\n\r\nmy ($price, $remaining) = $S->sub_calculate_purchase_cost($type, $months);\r\n\r\nmy $finished = $S->cgi->param(\'finished\');\r\nmy $canceled = $S->cgi->param(\'canceled\');\r\n\r\nif ($finished) {\r\n	$content = $S->{UI}->{BLOCKS}->{sub_paypal_finished};	\r\n	return $content;\r\n} elsif ($canceled) {\r\n	$content = $S->{UI}->{BLOCKS}->{sub_paypal_canceled};\r\n	return $content;\r\n}\r\n\r\nmy $paypal_form = qq{\r\n<form action=\"https://www.paypal.com/cgi-bin/webscr\" method=\"post\">\r\n<input type=\"hidden\" name=\"cmd\" value=\"_xclick\">\r\n<input type=\"hidden\" name=\"business\" value=\"$business_id\">\r\n<input type=\"hidden\" name=\"notify_url\" value=\"$site/special/paypal_confirm\">\r\n<input type=\"hidden\" name=\"item_name\" value=\"Subscription\">\r\n<input type=\"hidden\" name=\"item_number\" value=\"$type\">\r\n<input type=\"hidden\" name=\"no_shipping\" value=\"1\">\r\n<input type=\"hidden\" name=\"return\" value=\"$secure_site/subpay?pay_type=paypal;type=$type;months=$months;finished=1\">\r\n<input type=\"hidden\" name=\"cancel_return\" value=\"$secure_site/subpay?pay_type=paypal;type=$type;months=$months;canceled=1\">\r\n<input type=\"hidden\" name=\"amount\" value=\"$price\">\r\n<input type=\"hidden\" name=\"custom\" value=\"$S->{UID}:$months\">\r\n<input type=\"image\" src=\"%%imagedir%%/paypal.gif\" border=\"0\" name=\"submit\" alt=\"Make payments with PayPal - it\'s fast, free and secure!\">\r\n</form>};\r\n\r\n$content = qq{\r\n%%norm_font%%\r\n$remaining\r\n<p>\r\nClick the Paypal button, and you will go to a page on Paypal where you will finish the payment process.\r\n%%norm_font_end%%\r\n<p>\r\n<table border=0 cellpadding=1 cellspacing=0 bgcolor=\"#000000\" align=\"center\">\r\n  <tr>\r\n    <td>\r\n	  <table width=\"100%\" cellpadding=5 cellspacing=0 border=0 bgcolor=\"#eeeeee\">\r\n		<tr>\r\n		  <td colspan=2 align=\"center\">\r\n		  <FONT FACE=\"verdana, arial, helvetica, sans-serif\" SIZE=\"2\">\r\n		  Click below to purchase.<br>\r\n		  $paypal_form\r\n		  </font>\r\n		  </td>\r\n		</tr>\r\n	  </table>\r\n	</td>\r\n  </tr>\r\n</table>};\r\n\r\nreturn $content;','','blank_box',0),('subpay_type_select','Select Payment Type','my $pay_type = $S->filter_param($S->cgi->param(\'pay_type\'));\r\nmy $type   = $S->filter_param($S->cgi->param(\'type\'  ));\r\nmy $months = $S->filter_param($S->cgi->param(\'months\'));\r\n\r\nif ($pay_type) {\r\n  return \"%%BOX,subpay_cc,$type,$months%%\" if ($pay_type eq \'cc\');\r\n  return \"%%BOX,subpay_paypal,$type,$months%%\" if ($pay_type eq \'paypal\');\r\n  if ($pay_type eq \'none\') {\r\n  	my $return = $S->sub_activate_immediate($type, $months);\r\n	return $return if ($return);\r\n  }\r\n}\r\n#%%\r\n#warn \"Months: $months\\n\";\r\n\r\nunless ($months && $type) {\r\n  return \'Error! No subscription type or duration provided.\';\r\n}\r\n\r\nmy $type_data = $S->sub_get_type($type);\r\n\r\n# Bounds check the period\r\n$months = $type_data->{max_time} if (($type_data->{max_time}) && $months > $type_data->{max_time});\r\n\r\n# If it\'s a free sub, see if they\'ve already had it\r\nif ($S->sub_check_renewable($type_data->{type})) {\r\n  return \'Sorry, but you may not renew this subscription.\';\r\n}\r\n\r\nmy ($price, $purchase_display) = $S->sub_calculate_purchase_cost($type, $months);\r\n\r\nmy $content = qq{\r\n<table width=\"75%\" border=0 cellpadding=5 cellspacing=0 align=\"center\">\r\n  <tr>\r\n    <td colspan=2>%%norm_font%%\r\n$purchase_display%%norm_font_end%%};\r\n\r\nif ($price eq \'ERROR\') {\r\n    $content .= qq{</td></tr></table>};\r\n    return $content;\r\n} elsif ($price == 0) {\r\n	$content .= qq{\r\n		<center>\r\n		<form method=\"POST\" action=\"%%rootdir%%\">\r\n		<input type=\"hidden\" name=\"op\" value=\"subpay\">\r\n		<input type=\"hidden\" name=\"months\" value=\"$months\">\r\n		<input type=\"hidden\" name=\"type\" value=\"$type\">\r\n		<input type=\"hidden\" name=\"pay_type\" value=\"none\">\r\n		<input type=\"submit\" name=\"finish\" value=\"Finish\">\r\n		</form></center></td></tr></table>};\r\n	return $content;\r\n}\r\n\r\n$content .= qq{%%norm_font%%<p>Ok, now it\'s time for payment. Please select a payment type below.</p>\r\n%%norm_font_end%%</td></tr>\r\n};\r\n$content .= qq{<tr>\r\n    <td align=\"center\">%%norm_font%%<a href=\"%%rootdir%%/subpay?pay_type=paypal;type=$type;months=$months\"><img src=\"%%imagedir%%/paypal.gif\" border=\"0\" alt=\"Pay with Paypal\"><br>Pay with Paypal</a>%%norm_font_end%%</td>} if $S->{UI}->{VARS}->{payment_use_paypal};\r\n$content .= qq{    <td align=\"center\">%%norm_font%%<a href=\"/subpay?pay_type=cc;type=$type;months=$months\"><img src=\"%%imagedir%%/cclogos.gif\" width=\"87\" height=\"27\" border=0 ALT=\"We accept Visa and MasterCard\"><br>Pay with Visa or Mastercard</a>%%norm_font_end%%</td>} if $S->{UI}->{VARS}->{payment_use_cc};\r\n$content .= qq{  </tr>\r\n</table>\r\n};\r\n\r\nreturn $content;','Choose the type of payment for a subscription, or, if passed a \"pay_type\" param, just pass through to the appropriate payment processing box.','blank_box',0),('subscriber','','return unless ($S->{UID} == $S->param->{uid});\r\nreturn unless ($S->have_perm(\'allow_subscription\'));\r\nreturn unless ($S->{UI}->{VARS}->{use_subscriptions});\r\n\r\nmy $user = $S->user_data($S->{UID});\r\n\r\nwarn \"(subscriber) active subscription? $user->{sub}->{active}\";\r\n\r\nif ( $user->{sub}->{active} ) {\r\n  my $expires = $user->{sub}->{expires};\r\n  my $now = time;\r\n  my $remaining_days = (int((($expires - $now) / 86400)) + 1);\r\n  return qq{Thank you for subscribing. Your subscription expires in $remaining_days days};\r\n} else {\r\n  return qq{\r\n<P>You are not currently a subscriber. Why not <A href=\"%%rootdir%%/subscribe\">become one</A>?};\r\n}','','empty_box',0),('subscriber_link','','return unless ($S->have_perm(\'allow_subscription\'));\r\nreturn unless ($S->{UI}->{VARS}->{use_subscriptions});\r\n\r\nmy $user = $S->user_data($S->{UID});\r\n\r\n#warn \"(subscriber) active subscription? $user->{sub}->{active}\";\r\n\r\nif ( $user->{sub}->{active} ) {\r\n  my $expires = $user->{sub}->{expires};\r\n  my $now = time;\r\n  my $remaining_days = (int((($expires - $now) / 86400)) + 1);\r\n  return qq{Thank you for subscribing. Your subscription expires in $remaining_days days};\r\n} else {\r\n  return qq{\r\n<P>You are not currently a subscriber. Why not <A href=\"%%rootdir%%/subscribe\">become one</A>?};\r\n}','','empty_box',0),('syndication_link','Syndication link','my $section = $S->cgi->param(\'section\');\r\n$section = $S->filter_param($section);\r\nmy $sid = $S->cgi->param(\'sid\');\r\n$sid = $S->filter_param($sid);\r\nmy $user;\r\nmy $retval;\r\nmy $default = qq{<link rel=\"alternate\" title=\"%%title%%\" href=\"%%path%%\" type=\"application/rss+xml\">\\n};\r\nmy $href = \'http://www.hulver.com/scoop/user/%%user%%/rss/%%section%%/backend.rdf\';\r\nmy $temp;\r\nif ($sid) {\r\n  my $db_name = $S->{CONFIG}->{db_name};\r\n  my $f_sid = $S->{DBH}->quote($sid);\r\n  my $archive = $S->_check_archivestatus($sid);\r\n\r\n  my ($rv, $sth) = $S->db_select({\r\n   ARCHIVE => $archive,\r\n   WHAT => \'aid, section, tid, u.nickname AS nick\',\r\n   FROM => \"stories s LEFT JOIN $db_name.users u ON s.aid = u.uid\",\r\n   WHERE => qq|sid = $f_sid|});\r\n\r\n  my $data = $sth->fetchrow_hashref;\r\n  $sth->finish;\r\n  $section = $data->{section};\r\n  $user = $data->{nick};\r\n}\r\n\r\n$retval .= $default;\r\n$temp = $href;\r\n$temp =~ s/%%user%%/_all_/g;\r\n$temp =~ s/%%section%%/__all__/g;\r\n$retval =~ s/%%title%%/Hulver\'s site || Stories/g;\r\n$retval =~ s/%%path%%/$temp/g;\r\n\r\n$retval .= $default;\r\n$temp = $href;\r\n$temp =~ s/%%user%%/_all_/g;\r\n$temp =~ s/%%section%%/Diary/g;\r\n$retval =~ s/%%title%%/Hulver\'s site || Diaries/g;\r\n$retval =~ s/%%path%%/$temp/g;\r\n\r\nif (($section) && ($section ne \'Diary\') && ($section ne \'Crap\')) {\r\n  $retval .= $default;\r\n  $temp = $href;\r\n  $temp =~ s/%%user%%/_all_/g;\r\n  $temp =~ s/%%section%%/$section/g;\r\n  $retval =~ s/%%title%%/Hulver\'s site || All $section stories/g;\r\n  $retval =~ s/%%path%%/$temp/g;\r\n}\r\n\r\nif ($user) {\r\n  $retval .= $default;\r\n  $temp = $href;\r\n  $temp =~ s/%%user%%/$user/g;\r\n  $temp =~ s/%%section%%/__all__/g;\r\n  $retval =~ s/%%title%%/Hulver\\\'s site || All $user\\\'s stories/g;\r\n  $retval =~ s/%%path%%/$temp/g;\r\n}\r\n\r\nif ($user) {\r\n  $retval .= $default;\r\n  $temp = $href;\r\n  $temp =~ s/%%user%%/$user/g;\r\n  $temp =~ s/%%section%%/Diary/g;\r\n  $retval =~ s/%%title%%/Hulver\\\'s site || All $user\\\'s diaries/g;\r\n  $retval =~ s/%%path%%/$temp/g;\r\n}\r\n\r\nif ($S->have_perm(\'hotlist_flex\')) {\r\n  $retval .= $default;\r\n  $temp = $href;\r\n  $temp =~ s/%%user%%/$user/g;\r\n  $temp =~ s/%%section%%/Diary/g;\r\n  $retval =~ s/%%title%%/Hulver\\\'s site || Replies to $S->{NICK}\\\'s comments/g;\r\n  $retval =~ s/%%path%%/http:\\/\\/www.hulver.com\\/scoop\\/rss_replies\\//g;\r\n}\r\n\r\nreturn $retval;','Hidden link for hot linking.','empty_box',0),('tag_listing','','my $sid = $S->cgi->param(\'sid\');\r\nmy $tags = $S->tag_display($sid);\r\nmy $content = \"$tags\";\r\n# if we can post comments, we can tag.\r\nif($S->have_perm(\'comment_post\')){\r\n    my $addlink = ($S->have_perm(\'edit_story_tags\')) ? qq~ :: <a href=\"/addtag/$sid\">Add/Edit Tags to this Story</a>~ : qq~ :: <a href=\"/addtag/$sid\">Add Tags to this Story</a>~;\r\n    $content .= $addlink;\r\n    }\r\nreturn $content;','','empty_box',0),('tag_page_order','','my $switch = $S->cgi->param(\'switch\');\r\n\r\nif($S->{UID} > 0){\r\n    $S->pref(\'tag_sort\', $switch); # nice and easy\r\n    }\r\nelse { # not so easy\r\n    $S->session(\'tag_sort\', $switch);\r\n    }\r\nmy $url = $S->{UI}->{VARS}->{site_url} . \r\n          $S->{UI}->{VARS}->{rootdir} . \"/\" \r\n          . \"tag\";\r\n\r\n		$S->{APACHE}->headers_out->{\'Location\'} = $url;\r\n$S->{HEADERS_ONLY}=1;\r\n\r\nreturn;','','empty_box',0),('tag_sort_change','','# change the default ordering for the \"All Tags\"\r\n# page\r\n# don\'t display if we\'re not looking at the \"All\r\n# Tags\" page, though.\r\nreturn if $S->cgi->param(\'tag\');\r\n\r\nmy $switchto = ($S->pref(\'tag_sort\') eq \'alpha\') ? \"count\" : \"alpha\";\r\n# and if we\'re not logged in, it\'s slightly\r\n# different\r\nif($S->{UID} < 0){\r\n    $switchto = ($S->session(\'tag_sort\') eq \'alpha\') ? \"count\" : \"alpha\";\r\n    }\r\nmy $ordering = ($switchto eq \'alpha\') ? \'Alphabetical\' : \'Popularity\';\r\nmy $link = qq~<a href=\"%%rootdir%%/tagsort/$switchto\">$ordering</a>.~;\r\n\r\n# a little complicated, but whatever\r\nmy $linktext = ($switchto eq \'alpha\') ? \"<br>Sort by: Popularity | $link\" : \"Sort by: $link | Alphabetical\";\r\n\r\nreturn $linktext;','','empty_box',0),('test_box','','my @path;\r\n  my $p = {};\r\n\r\n  $p->{page} = $path[0];\r\n  my @host;\r\n  for (split(/\\./, $S->apache->hostname)) {\r\n    push(@host, ($host[$#host]) ? $host[$#host] . \'.\' . $_ : $_);\r\n  }\r\n  unshift(@host, $S->apache->hostname);\r\n  warn $host[0];\r\n  if ($host[1] eq \'www\') {\r\n    warn $host[0];\r\n  }\r\n  return $p;\r\n','','blank_box',0),('theme_chooser','',' ################################################\r\n# WARNING! This box is called so early in the  #\r\n# setup phase that screwing it up will require #\r\n# a trip directly to the database.  If you do  #\r\n# mess it up, follow the following procedure.  #\r\n#                                              #\r\n# First, hit the back button so you can read   #\r\n# these instructions.  That\'s the only part    #\r\n# you have to memorize.                        #\r\n# Second, go into the database and type the    #\r\n# following sql command (it\'s on 2 lines here) #\r\n#                                              #\r\n# UPDATE box SET content=\"return \\\"default\\\";\" #\r\n# WHERE boxid=\"theme_chooser\";                 #\r\n#                                              #\r\n# Don\'t forget the WHERE clause!               #\r\n# Then, figure out what went wrong, and fix it.#\r\n# You can save the box and it will overwrite   #\r\n# the simple \'return \"default\";\' box that is   #\r\n# guaranteed to not cause errors.              #\r\n# If you didn\'t fix the problem, return to     #\r\n# step one and try again.                      #\r\n#                                              #\r\n# Please note that you won\'t have to change    #\r\n# this box unless you want to set a theme based#\r\n# on something other than section, user_agent, #\r\n# user group, and site_id. That\'s what the site#\r\n# controls in the category \"Themes\" are for.   #\r\n################################################\r\n\r\nmy $default_theme = $S->{UI}->{VARS}->{default_theme};\r\n\r\n# first, are we using themes at all:\r\nunless ( $S->{UI}->{VARS}->{use_themes} ) {\r\n    return $default_theme;\r\n}\r\n\r\n# returns a comma-separated list of themes to be \r\n# applied, in order.  Should always start with the \r\n# default theme.\r\n \r\n# set the values of the criteria we\'re testing for\r\nmy $siteid = $S->{CONFIG}->{site_id};\r\nmy $session_theme = $S->session(\'theme\');\r\nmy $agent = \"\";\r\nunless ($session_theme) {\r\n	$agent = $S->run_box(\"detect_agent\");\r\n	if ($agent eq \'mobile\') {\r\n		$session_theme = $agent;\r\n		$S->session(\'theme\',$agent);\r\n	}\r\n}\r\nmy $group = $S->{GID};\r\nmy $pref;\r\nif ( $S->{UI}->{VARS}->{allow_user_themes} ) {\r\n  if ( $S->{prefs}->{theme} ) {\r\n   $pref = $S->{prefs}->{theme};\r\n  } else {\r\n   if ( $S->{UID} == -1 ) {\r\n     $pref = $S->{UI}->{VARS}->{anon_theme};\r\n   } else {\r\n     $pref = \"\";\r\n   }\r\n  }\r\n}\r\n\r\n# section is a bit of a special case\r\nmy $section;\r\nif ( $S->param->{\"section\"} ) {\r\n  $section = $S->param->{\"section\"};\r\n} elsif ( $S->param->{\"sid\"} ) {\r\n  my $sid = $S->param->{\"sid\"};\r\n  my ($rv,$sth) = $S->db_select({\r\n         WHAT => \'section\',\r\n           FROM => \'stories\',\r\n          WHERE => qq@sid = \"$sid\"@,});\r\n  if ( $rv ) {\r\n    my $sect = $sth->fetchrow_hashref();\r\n    $section = $sect->{\"section\"};\r\n  } else {\r\n    $section = \"\";\r\n  }\r\n  $sth->finish;\r\n}\r\n\r\nmy @order = split( /,\\s*/, $S->{UI}->{VARS}->{order} );\r\n\r\nmy $themelist = $default_theme;\r\n\r\nforeach my $criteria ( @order ) {\r\n  if ( $criteria eq \"section\" ) {\r\n   if ( $section ) {\r\n    my $th=$S->{UI}->{VARS}->{\"section_$section\"};\r\n    $themelist .= \",$th\" if $th;\r\n   }\r\n  } elsif ( $criteria eq \"siteid\" ) {\r\n    my $th = $S->{UI}->{VARS}->{\"siteid_$siteid\"};\r\n    $themelist .= \",$th\" if $th;\r\n  } elsif ( $criteria eq \"group\" ) {\r\n    my $th = $S->{UI}->{VARS}->{\"group_$group\"};\r\n    $themelist .= \",$th\" if $th;\r\n  } elsif ( $criteria eq \"agent\" ) {\r\n    my $th = \"\";\r\n	#FIXME: need to write box detect_agent\r\n  } elsif ( $criteria eq \"pref\" ) {\r\n    my $th = $pref;\r\n    $themelist .= \",$th\" if $th;\r\n  } elsif ( $criteria eq \"session\" ) {\r\n    my $th = $session_theme;\r\n    $themelist .= \",$th\" if $th;\r\n  }\r\n}\r\n\r\nreturn $themelist;\r\n ','chooses which themes should be applied, and in which order.  \'default\' should come first, as a complete theme; subsequent themes overwrite any blocks with the same name.','blank_box',0),('time_zone_pref','','my %zones = $S->_timezone_hash();\r\nmy $S_zone = $ARGS[0];\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"time_zone\" size=\"1\">};\r\n\r\nforeach my $zone (sort keys %zones) {\r\n  my $z = uc($zone);\r\n  my $selected = \'\';\r\n  if ($z eq $S_zone) {\r\n    $selected = \' SELECTED\';\r\n  }\r\n  $select .= qq{\r\n         <OPTION value=\"$z\"$selected>[$z] $zones{$zone}</OPTION>};\r\n}\r\n\r\n$select .= \"\r\n      </SELECT>\";\r\n\r\nreturn $select;','timezone selectbox','empty_box',0),('topic_view','','my ($rv, $sth) = $S->db_select({\r\n        WHAT => \'*\',\r\n        FROM => \'topics\',\r\n        ORDER_BY => \'tid asc\'\r\n});\r\n\r\nmy $content = \"<TR>\";\r\n\r\nmy $i = 0;\r\nif ($rv ne \'0E0\') {\r\n        while (my $topic = $sth->fetchrow_hashref) {\r\n                unless ($topic->{tid}) {\r\n                        $topic->{tid} = \"New\";\r\n                }\r\n\r\n                $content .= qq(\r\n                <TD align=\"center\">\r\n                   <IMG SRC=\"/images/topics/$topic->{image}\" BORDER=0 HEIGHT=\"$topic->{height}\" WIDTH=\"$topic->{width}\" ALT=\"$topic->{alttext}\" TITLE=\"$topic->{alttext}\"><BR>$topic->{alttext} \r\n                </TD>\r\n                );\r\n                $i++;\r\n                if (($i % 5) == 0) {\r\n                        $content .= qq(\r\n                        </TR><TR>);\r\n                }\r\n        }\r\n}\r\n$sth->finish;\r\n\r\nreturn $content;','','empty_box',0),('trackback','Trackbacks','my $sid = $S->{CGI}->param(\'sid\');\r\n\r\nreturn unless ($sid);\r\n\r\nmy $id = $S->{CGI}->param(\'trackback_id\');\r\nmy $action = $S->{CGI}->param(\'trackback_action\');\r\nmy $showdelete = 1;\r\n\r\nunless ($S->have_perm(\'comment_delete\')) {\r\n  $id = \'\';\r\n  $action = \'\';\r\n  $showdelete = 0;\r\n}\r\n\r\nif ($action eq \'delete\') {\r\n  my ($rv, $sth) = $S->db_delete({\r\n    FROM => \"trackback\",\r\n    WHERE => \"track_id = ?\",\r\n    PARAMS => [$id]\r\n  });\r\n}\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n WHAT => \"url, blog_name, title, excerpt, track_id\",\r\n FROM => \"trackback\",\r\n ORDER_BY => \'time\',\r\n WHERE => \'sid = ?\',\r\n PARAMS => [$sid]});\r\n\r\nif ($rv eq \'0E0\') {\r\n  $sth->finish();\r\n  return;\r\n}\r\nunless ($rv) {\r\n  $sth->finish();\r\n  return;\r\n}\r\n\r\nmy $content = \"<br>\";\r\nmy $del_url;\r\nmy $max_intro = $S->{UI}->{VARS}->{rdf_max_intro} || 10;\r\nwhile (my ($url, $blog_name, $title, $excerpt, $id) = $sth->fetchrow()) {\r\nif ($max_intro) {\r\n	my @intro = split(\' \', $excerpt);\r\n	@intro = splice(@intro, 0, $max_intro);\r\n	$excerpt = join(\' \', @intro) . \'...\';\r\n}\r\n        $del_url = \'<a href=\"\' . $S->{APACHE}->uri . qq{?trackback_id=$id&trackback_action=delete\">(delete)</a>} if ($showdelete);\r\n	$content .= qq{<a class=\"trackback_title\" href=\"$url\">$blog_name - $title</a> $del_url\r\n<div class=\"trackback_excerpt\">$excerpt</div><br><br>}\r\n}\r\n$sth->finish();\r\n\r\nreturn $content;','Shows trackbacks to a story.','box',1),('trackback_cron','','my ($rv, $sth) = $S->db_select({\r\n    WHAT => \'sid\',\r\n    FROM => \'to_trackback\',\r\n    WHERE => \'updated = 0\'});\r\n\r\nwhile (my $sid = $sth->fetchrow()) {\r\nmy $urls;\r\nmy $urlcount = -1;\r\nmy $stories = $S->getstories(\r\n {-type => \'fullstory\',\r\n   -sid => $sid,\r\n   -perm_override => 1});\r\nmy $story;\r\nif ($stories) {\r\n  $story = $stories->[0];\r\n} else {\r\n  return 0;\r\n}\r\n\r\nmy $nick = $S->get_nick_from_uid($story->{aid});\r\n\r\nmy $text = $story->{introtext} . \'<br>\' . $story->{bodytext};\r\nmy $excerpt = $text;\r\n\r\nmy $max_intro = $S->{UI}->{VARS}->{rdf_max_intro} || 50;\r\nif ($max_intro) {\r\n	my @intro = split(\' \', $excerpt);\r\n	@intro = splice(@intro, 0, $max_intro);\r\n	$excerpt = join(\' \', @intro) . \'...\';\r\n}\r\n$excerpt =~ s/<[p|br]>/\\n/g; #preserve line & para breaks\r\n$excerpt =~ s/<.*?>//g;\r\n# unfilter < and >, so that we don\'t turn them into &amp;lt;\r\n$excerpt =~ s/&lt;/</g;\r\n$excerpt =~ s/&gt;/>/g;\r\n# filter &\r\n$excerpt =~ s/&/&amp;/g;\r\n# (re-)filter < and >\r\n$excerpt =~ s/</&lt;/g;\r\n$excerpt =~ s/>/&gt;/g;\r\n# Filter out high-bit characters\r\n$excerpt =~ s/([\\200-\\377])/\"&#\".ord($1).\";\"/eg;\r\n$excerpt =~ s/\\n/<br>\\n/g;\r\n\r\nmy $pingargs = { };\r\n$pingargs->{title} = $story->{title};\r\n$pingargs->{url} = $S->{UI}->{VARS}->{site_url} . $S->{UI}->{VARS}->{rootdir} . \"/story/$sid\";\r\n$pingargs->{blog_name} = $nick . \' from \' . $S->{UI}->{VARS}->{sitename};\r\n$pingargs->{excerpt} = $excerpt;\r\n\r\nmy $link_arr = { };\r\nwhile ( $text =~ /<a href=?\"?(.*?)\"?>(.*?)(<\\/a>)/gis ) {\r\n	my $url = $1;\r\n	$link_arr->{$url} ++;\r\n}\r\n\r\nforeach my $url (keys %{$link_arr}) {\r\n	my $ping = $S->discover_tb($url);\r\n	if ($ping) {\r\n		$urls .= \"$url\\n\";\r\n		$urlcount ++;\r\n		$S->send_ping($ping,$pingargs);\r\n	}\r\n}\r\n\r\n$urlcount ++ if ($urlcount >= 0);\r\n\r\nif ($urlcount > 0) {\r\n$S->db_update({\r\n	SET => \'urls = ?, updated = ?\',\r\n	WHAT => \'to_trackback\',\r\n	WHERE => \'sid = ?\',\r\n	PARAMS => [$urls, $urlcount, $sid]\r\n	});\r\n} else {\r\n$S->db_delete({\r\n	FROM => \'to_trackback\',\r\n	WHERE => \'sid = ?\',\r\n	PARAMS => [$sid]\r\n	});\r\n}\r\n\r\n}\r\n\r\n\r\n$sth->finish();','This is designed to run as a cron. It will go off and check each listed URL in a story post, and ping the trackbacks if found.','empty_box',0),('trackback_inform','','my $sid = $ARGS[1];\r\n\r\nreturn unless ($S->have_perm(\'trackback\'));\r\n\r\nmy ($rv, $sth) = $S->db_insert({\r\n    INTO => \'to_trackback\',\r\n    COLS => \'sid\',\r\n    VALUES => \'?\',\r\n    PARAMS => [$sid]});\r\n\r\nreturn \'\';\r\n','This is designed to run as a hook on story_new. It writes and entry to a table, so the cron job can do the intensive going off and checking for links and updateing trackbacks.','empty_box',0),('trackback_list','All Trackbacks','return unless ($S->have_perm(\'comment_delete\'));\r\n\r\nuse Data::Dumper;\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n WHAT => \"*\",\r\n FROM => \"comments\",\r\n WHERE => qq{sid =\"1150146432_uJzaISWJ\"} });\r\n\r\nmy $content;\r\n\r\nmy $row = $sth->fetchrow_hashref();\r\n\r\n$content .= Data::Dumper->Dump($row);\r\n\r\n$row = $sth->fetchrow_hashref();\r\n\r\n$content .= Data::Dumper->Dump($row);\r\n\r\nreturn $content;\r\n','Shows all trackbacks.','box',0),('unpaid_ad_reap','','my ($rv, $sth) = $S->db_delete({\r\n    FROM => \'ad_info\',\r\n    WHERE => \'paid is null and TO_DAYS(NOW()) - TO_DAYS(submitted_on) >= 14 and example != 1 and purchase_price > 0\'});\r\n$sth->finish();\r\n','Reap unpaid ads after 14 days. They are unlikely to ever be paid for then.','blank_box',0),('unpaid_ad_reap_old','','my ($rv, $sth) = $S->db_delete({\r\n    FROM => \'ad_info\',\r\n    WHERE => \'paid is null and TO_DAYS(NOW()) - TO_DAYS(submitted_on) >= 14 and example != 1 and purchase_price > 0\'});\r\n$sth->finish();\r\n','Reap unpaid ads after 14 days. They are unlikely to ever be paid for then.','blank_box',0),('userpref_menu','','my $edit = 0;\r\nmy $return = \'\';\r\nmy $nick = $S->param->{nick};\r\nmy $tool = $S->param->{tool} || \'info\';\r\nmy $admin_edit = \'\';\r\n\r\n# first, do we have permission to edit \r\n# this user\'s prefs?\r\n\r\nif ( $S->{UID} == $S->param->{uid} || $S->have_perm(\'edit_user\') ) {\r\n  $edit = 1;\r\n}\r\n\r\n$admin_edit = qq{<li>[<a href=\"%%rootdir%%/user/$nick/prefs\">edit user</a>]</li>} if ($S->have_perm(\'edit_user\'));\r\n\r\n# links to create\r\nmy $links = \"<p>${nick}<ul>$admin_edit \";\r\n\r\n# user info pages\r\nif ( $tool eq \'info\' ) {\r\n  $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick\">Info</a></li>};\r\n  $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/comments\">Comments</a></li>};\r\n  $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/stories\">Stories</a></li>};\r\n\r\n  if ( $S->{UI}->{VARS}->{use_diaries} ) {\r\n    $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/diary\">Diary</a></li>};\r\n  }\r\n\r\n  if ( $S->{UI}->{VARS}->{use_ratings} ) {\r\n    $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/ratings\">Ratings</a></li>};\r\n  }\r\n\r\n  if ( $S->{UI}->{VARS}->{allow_uploads} ) {\r\n    $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/files\">Files</a></li>};\r\n  }\r\n\r\n  if ( $S->{UI}->{VARS}->{use_ads} ) {\r\n    $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/ads\">Ads</a></li>};\r\n  }\r\n\r\n  $return = $links . \"</ul></p>\";\r\n} elsif ( $edit && $tool eq \'prefs\' ) {\r\n  my %editlinks;\r\n  my ($rv, $sth) = $S->db_select({\r\n               WHAT => \'page\',\r\n               FROM => \'pref_items\',\r\n               GROUP_BY => \'page\'\r\n  });\r\n  while (my ($item) = $sth->fetchrow_array()) {\r\n    $editlinks{\"$item\"} = \"%%rootdir%%/user/$nick/prefs/$item\";\r\n  }\r\n  $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/prefs/Protected\">Email and Password</a></li>};\r\n\r\n  foreach my $item (sort {$b cmp $a} keys %editlinks) {\r\n    $links .= qq{\r\n   <li><a href=\"$editlinks{$item}\">$item</a></li>};\r\n  }\r\n  $return = $links . \"</ul></p>\";\r\n}\r\n\r\nreturn $return;\r\n','navigation for user pref pages','empty_box',0),('userpref_menu_file_pref','','my $edit = 0;\r\nmy $return = \'\';\r\nmy $nick = $S->param->{nick};\r\nmy $tool = $S->param->{tool} || \'info\';\r\nmy $admin_edit = \'\';\r\n\r\n# first, do we have permission to edit \r\n# this user\'s prefs?\r\n\r\nif ( $S->{UID} == $S->param->{uid} || $S->have_perm(\'edit_user\') ) {\r\n  $edit = 1;\r\n}\r\n\r\n$admin_edit = qq{<li>[<a href=\"%%rootdir%%/user/$nick/prefs\">edit user</a>]</li>} if ($S->have_perm(\'edit_user\'));\r\n\r\n# links to create\r\nmy $links = \"<p>${nick}<ul>$admin_edit \";\r\n\r\n# user info pages\r\nif ( $tool eq \'info\' ) {\r\n  $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick\">Info</a></li>};\r\n  $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/comments\">Comments</a></li>};\r\n  $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/stories\">Stories</a></li>};\r\n\r\n  if ( $S->{UI}->{VARS}->{use_diaries} ) {\r\n    $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/diary\">Diary</a></li>};\r\n  }\r\n\r\n  if ( $S->{UI}->{VARS}->{use_ratings} ) {\r\n    $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/ratings\">Ratings</a></li>};\r\n  }\r\nmy $udata = $S->user_data($S->param->{\'uid\'});\r\n#  if ( $S->{UI}->{VARS}->{allow_uploads} ) {\r\nif($S->{UI}->{VARS}->{allow_uploads} && (($S->have_perm(\'view_user_files\') && $S->have_perm(\'upload_user\', $udata->{\'perm_group\'})) || $S->have_perm(\'upload_admin\')) ) {\r\n    $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/files\">Files</a></li>};\r\n  }\r\n\r\n  if ( $S->{UI}->{VARS}->{use_ads} ) {\r\n    $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/ads\">Ads</a></li>};\r\n  }\r\n\r\n  $return = $links . \"</ul></p>\";\r\n} elsif ( $edit && $tool eq \'prefs\' ) {\r\n  my %editlinks;\r\n  my ($rv, $sth) = $S->db_select({\r\n               WHAT => \'page, perm_edit\',\r\n               FROM => \'pref_items\',\r\n               GROUP_BY => \'page\'\r\n  });\r\n  while (my $item = $sth->fetchrow_hashref()) {\r\n     $editlinks{\"$item->{page}\"} = \"%%rootdir%%/user/$nick/prefs/$item->{page} $item->{perm_edit}\";\r\n  }\r\n  $sth->finish;\r\n  $links .= qq{\r\n     <li><a href=\"%%rootdir%%/user/$nick/prefs/Protected\">Email and Password</a></li>};\r\n\r\n  foreach my $item (sort {$b cmp $a} keys %editlinks) {\r\n    my $c = 0;\r\n    my ($rv2, $sth2) = $S->db_select({\r\n        WHAT => \'perm_edit\',\r\n        FROM => \'pref_items\',\r\n        WHERE => \"page = \'$item\'\"\r\n        });\r\n    while(my $i = $sth2->fetchrow_hashref()) {\r\n        $c++ if ($S->have_perm($i->{perm_edit}) || !$i->{perm_edit});\r\n        }\r\n    $sth2->finish;\r\n    $links .= ($c) ? qq{\r\n   <li><a href=\"$editlinks{$item}\">$item</a></li>} : \'\';\r\n  }\r\n  $return = $links . \"</ul></p>\";\r\n}\r\n\r\nreturn $return;\r\n','navigation for user pref pages','empty_box',0),('users_stories','','my $content = \'\';\r\nif ($S->{UID} <= 0) {\r\n	return \'\';\r\n}\r\n\r\nmy ($rv,$sth) = $S->db_select({\r\n   FROM => \'stories\',\r\n   WHAT => \'sid\',\r\n   WHERE => \'aid = ?\',\r\n   ORDER_BY => \'time DESC\',\r\n   PARAMS => [$S->{UID}]\r\n});\r\n\r\nif ($rv) {\r\n        while (my $sid = $sth->fetchrow()) {\r\n                $content .= \"$sid\\n\";\r\n        }\r\n        $sth->finish();\r\n}\r\n\r\nmy ($rv,$sth) = $S->db_select({\r\n   ARCHIVE => 1,\r\n   FROM => \'stories\',\r\n   WHAT => \'sid\',\r\n   WHERE => \'aid = ?\',\r\n   ORDER_BY => \'time DESC\',\r\n   PARAMS => [$S->{UID}]\r\n});\r\n\r\nif ($rv) {\r\n        while (my $sid = $sth->fetchrow()) {\r\n                $content .= \"$sid\\n\";\r\n        }\r\n        $sth->finish();\r\n}\r\n\r\nreturn { content => $content };\r\n\r\n','','empty_box',0),('user_box','User Links','my $content;\r\nif ($S->{UID} > 0) {\r\n  if ($S->have_perm(\'moderate\')) {\r\n    my ($nstories, $tstories, $estories) = $S->_count_new_sub();\r\n    $content .= qq{\r\n    <a class=\"light\" href=\"%%rootdir%%/modsub\">%%dot%% Moderate</a> ($tstories/};\r\nif ($estories) {\r\n  $content .= qq{<font color=\"blue\">$estories</font>/}\r\n} else {\r\n  $content .= qq{$estories/};\r\n};\r\nif ($nstories) {\r\n  $content .= qq{<font color=\"red\">$nstories</font>}\r\n} else {\r\n  $content .= qq{$nstories};\r\n};\r\n$content .= \" new) <br> \";\r\n  }\r\n  if ($S->{TRUSTLEV} == 2 || $S->have_perm(\'super_mojo\')) {\r\n      $content .= qq{\r\n	%%dot%% <a class=\"light\" href=\"%%rootdir%%/search?type=comment;hidden_comments=show\">Review Hidden Comments</a><br>\r\n	%%dot%% <a class=\"light\" href=\"%%rootdir%%/zerod\">Review Zeroed Comments</a><br>};\r\n  }\r\n\r\n  my $urlnick = $S->urlify($S->{NICK});\r\n  my $diary_link;\r\n  my $msg_link;\r\n  if ($S->have_perm(\'private_messages\')) {\r\n    $msg_link = qq { %%dot%% <a class=\"light\" href=\"%%rootdir%%/pm_inbox\">Private Messages</a> };\r\n    my $count = 0;\r\n    my ($rv, $sth) = $S->db_select({\r\n		DEBUG => 0,\r\n		WHAT => \'count(*)\',\r\n		FROM => \'private_message\',\r\n		WHERE => \'msg_read = 0 AND inbox_delete = 0 AND to_uid = \' . $S->{UID}});\r\n    if ($rv ne \'0E0\') {\r\n      $count = $sth->fetchrow();\r\n    }\r\n    if ($count == 0) {\r\n      $msg_link .= qq{<img src=\"%%imagedir%%/nomessage.gif\" alt=\"No new messages\" title=\"No new messages\">}\r\n    } else {\r\n      $msg_link .= qq{ ($count new) <img src=\"%%imagedir%%/newmessage.gif\" alt=\"$count new messages\" title=\"$count new messages\">}\r\n    }\r\n    $msg_link .= \"<br>\";\r\n  }\r\n  if ($S->{UI}->{VARS}->{allow_user_host}) {\r\n	my $newnick = $S->{NICK};\r\n	$newnick =~ s/ /-/g;\r\n	$newnick .= \".\" . $S->{UI}->{VARS}->{default_domain};\r\n	$diary_link = qq{ %%dot%% <a class=\"light\" href=\"http://$newnick%%rootdir%%/\">Your Diary</a><br>};\r\n  } else {\r\n	$diary_link = qq{ %%dot%% <a class=\"light\" href=\"%%rootdir%%/user/$urlnick/diary\">Your Diary</a><br>};\r\n  };\r\n  $diary_link = \"\" unless ( $S->{UI}->{VARS}->{use_diaries} );\r\n  my $files_link = ( $S->have_perm(\'upload_user\') ? qq { %%dot%% <a class=\"light\" href=\"%%rootdir%%/user/$urlnick/files\">Your Files</a><br>} : qq { } ) ;\r\n  $content .= qq|\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/user/$urlnick\">User Info</a><br>\r\n      $msg_link\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/user/$urlnick/comments\">Your Comments</a><br>\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/user/$urlnick/stories\">Your Stories</a><br>\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/user/$urlnick/ratings\">Your Ratings</a><br>\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/user/$urlnick/ads\">Your Adverts</a><br>\r\n      $diary_link\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/submitstory/Diary\">New Diary Entry</a><br>\r\n      $files_link\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/user/$urlnick/prefs\">User Preferences</a><br>\r\n      %%dot%% <a class=\"light\" HREF=\"%%rootdir%%/my/prefs/Protected\">Change Password</a><br>\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/my/prefs/Interface\">Display Preferences</a><br>\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/my/prefs/Comments\">Comment Preferences</a><br>\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/submitad\">Submit Advert</a><br>\r\n      %%dot%% %%logout_link%%Logout $S->{NICK}</a><br>|;\r\n$content .= $S->run_box(\"subscriber_link\");\r\n    $title = \"$S->{NICK}\";\r\n} else {\r\n    $content = $S->{UI}->{BLOCKS}->{login_box};\r\n    $content =~ s/%%LOGIN_ERROR%%/$S->{LOGIN_ERROR}/;\r\n    $title = \"Login\";\r\n}\r\nreturn {content => $content, title => $title };','the login box','box',1),('user_feeds','External Feeds','return unless $S->{UI}->{VARS}->{use_rdf_feeds};\r\n\r\nmy $to_display = {};\r\nif (@ARGS || $S->{CGI}->param(\'rdf\')) {\r\n	my $rdf_arg = $S->{CGI}->param(\'rdf\');\r\n	@ARGS = split(/,/, $rdf_arg) if $rdf_arg;\r\n	foreach (@ARGS) {\r\n		$to_display->{$_} = 1;\r\n	}\r\n}\r\n\r\nmy $content;\r\nmy $channels = $S->rdf_channels();\r\nmy $user_feeds = $S->rdf_get_prefs() unless @ARGS;\r\nmy $item_limit = (@ARGS && (@ARGS->[0] eq \'all\')) ?\r\n	150 :\r\n	defined($S->{prefs}->{rdf_max_headlines}) ?\r\n	$S->{prefs}->{rdf_max_headlines} :\r\n	defined($S->{UI}->{VARS}->{rdf_max_headlines}) ?\r\n	$S->{UI}->{VARS}->{rdf_max_headlines} : 15;\r\n\r\nif ($S->have_perm(\'submit_rdf\')) {\r\n	$content = qq| %%dot%% <a class=\"light\" href=\"%%rootdir%%/submitrdf\">Submit Feed</a><br><br>\\n|;\r\n}	\r\n\r\nforeach my $c (@{$channels}) {\r\n	if (@ARGS) {\r\n		next unless ($to_display->{ $c->{rid} }) || (@ARGS->[0] eq \'all\');\r\n	} else {\r\n		next unless $user_feeds->{ $c->{rid} };\r\n	}\r\n	next unless $c->{title};\r\n	unless ($S->have_perm(\'rdf_admin\')) {\r\n		next if $c->{submitted} || !$c->{enabled};\r\n	}\r\n	$content .= qq~<div class=\"rdf\">~;\r\n	if ($S->{UI}->{VARS}->{rdf_use_images} && $c->{image_url}) {\r\n		$content .= qq~<a href=\"$c->{image_link}\"><img src=\"$c->{image_url}\" alt=\"$c->{image_title}\" border=\"1\"></a><br>\\n~;\r\n	} else {\r\n		$content .= qq~<b><a class=\"light\" href=\"$c->{link}\">$c->{title}</a></b><br>\\n~;\r\n	}\r\n\r\n	my $items = $S->rdf_items($c->{rid}, $item_limit);\r\n	foreach my $i (@{$items}) {\r\n		my $title = $S->filter_subject($i->{title});\r\n		$title = $i->{link} unless ($title);\r\n		$content .= qq~%%dot%% <a class=\"light\" href=\"$i->{link}\">$title</a><br>\\n~;\r\n	}\r\n\r\n	if ($S->{UI}->{VARS}->{rdf_use_forms} && $c->{form_link}) {\r\n		$content .= qq~<form action=\"$c->{form_link}\" method=\"GET\">$c->{form_title}: <input type=\"text\" name=\"$c->{form_name}\"></form><br>\\n~;\r\n	}\r\n\r\n	$content .= \"</div><br>\\n\";\r\n}\r\n\r\nreturn $content;\r\n','contains RDF feeds from other sites','empty_box',0),('user_files_list','User Files','return unless $S->have_perm(\'upload_user\');\r\n\r\nmy $uid = $S->{UID};\r\n\r\nmy $mode = $ARGS[0];\r\n\r\nmy $content = qq[\r\n	<form name=\"insert_file\">\r\n	<select name=\"file_link\" size=\"1\">\r\n	<option value=\"\">Select File:</option>\r\n];\r\n\r\nmy $file_link = $S->var(\'upload_link_user\') . $uid;\r\nmy ($file_counter, $file_total_count) = (0, 0);\r\n\r\nmy @files = $S->get_file_list($uid, \'user\');\r\n$file_total_count = scalar @files;\r\n@files = sort { lc($a) cmp lc($b) } @files;\r\n\r\nwhile ($file_counter < $file_total_count ) {\r\n	my $file_name = $files[$file_counter];\r\n	$content .= qq{<option value=\"((file [$uid/$file_name] []))\">$file_name</option>\\n};\r\n	$file_counter++;\r\n}\r\n\r\nif ($mode eq \'comment\') {\r\n$content .= qq[\r\n	</select><br>\r\n	<input type=\"button\" value=\"<< Comment\" onclick=\"document.postcomment.comment.value+=document.insert_file.file_link.value\"><br>\r\n];\r\n} else {\r\n$content .= qq[\r\n	</select><br>\r\n	<input type=\"button\" value=\"<< Body Text\" onclick=\"document.editstory.bodytext.value+=document.insert_file.file_link.value\">\r\n];\r\n}\r\n$content .= qq[\r\n	</form>\r\n	%%norm_font%%<a class=\"light\" href=\"%%rootdir%%/user/uid:$uid/files\">View Your Files</a>%%norm_font_end%%\r\n];\r\nreturn $content;\r\n','Allows a user to insert a IMG tag pointing at an uploaded file into the introtext or bodytext of a story.','box',0),('user_group_box','','my ($curr_id) = $ARGS[0];\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n  WHAT => \'perm_group_id\',\r\n  FROM => \'perm_groups\',\r\n  DEBUG => 0});\r\n\r\nmy $selector = qq{\r\n<SELECT NAME=\"perm_group_id\" SIZE=1>};\r\n\r\nmy $selected = \'\';\r\n\r\nwhile (my $group = $sth->fetchrow()) {\r\n  $selected = \'\';\r\n  $selected = \" SELECTED\" if ($group eq $curr_id);\r\n  $selector .= qq{\r\n  <OPTION VALUE=\"$group\"$selected>$group};\r\n}\r\n\r\n$selector .= \"</SELECT>\";\r\n\r\nreturn $selector;\r\n','','empty_box',0),('user_page_box','Login','my $content;\r\nif ($S->{UID} > 0) {\r\n  $content = qq|<h2>User page for $S->{NICK} ($S->{UID})</h2>|;\r\n  if ( $S->have_perm(\'story_post\') ) {\r\n    $content .= qq{%%dot%% <A CLASS=\"light\" HREF=\"/scoop/submit\">Submit Front Page Story</A><BR>};\r\n  }\r\n  if ($S->have_perm(\'moderate\')) {\r\n    my ($nstories, $tstories) = $S->_count_new_sub();\r\n    my $color = \'\';\r\n    my $c_end = \'\';\r\n    if ($nstories) {\r\n       $color = \'<FONT COLOR=\"#FF0000\"><B>\';\r\n       $c_end = \'</b></font>\';\r\n    }\r\n    $content .= qq|\r\n    %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/modsub\">Moderate Submissions</a> ($tstories/$color$nstories$c_end new)<BR>|;\r\n  }\r\n\r\n  if ($S->{TRUSTLEV} == 2 || $S->have_perm(\'super_mojo\')) {\r\n    $content .= qq{\r\n	%%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/search?type=comment;hidden_comments=show\">Review Hidden Comments</a><BR>\r\n	%%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/zerod\">Review Zeroed Comments</a><BR>};\r\n  }\r\n  my $msg_link;\r\n  if ($S->have_perm(\'private_messages\')) {\r\n    $msg_link = qq { %%dot%% <a class=\"light\" href=\"%%rootdir%%/pm_inbox\">Private Messages</a> };\r\n    my $count = 0;\r\n    my ($rv, $sth) = $S->db_select({\r\n		DEBUG => 0,\r\n		WHAT => \'count(*)\',\r\n		FROM => \'private_message\',\r\n		WHERE => \'msg_read = 0 AND to_uid = \' . $S->{UID}});\r\n    if ($rv ne \'0E0\') {\r\n      $count = $sth->fetchrow();\r\n    }\r\n    if ($count == 0) {\r\n      $msg_link .= qq{<img src=\"%%imagedir%%/nomessage.gif\" alt=\"No new messages\" title=\"No new messages\">}\r\n    } else {\r\n      $msg_link .= qq{ ($count new) <img src=\"%%imagedir%%/newmessage.gif\" alt=\"$count new messages\" title=\"$count new messages\">}\r\n    }\r\n    $msg_link .= \"<br>\";\r\n  }\r\n  \r\n  my $urlnick = $S->urlify($S->{NICK});\r\n  my $rss_link = ( $S->{UI}->{VARS}->{use_diaries} ? \r\n		qq{<A CLASS=\"light\" HREF=\"%%rootdir%%/user/$urlnick/rss/Diary/backend.rdf\">Diary RSS feed</a><BR>} :\r\n		qq{} );\r\n  my $diary_link;\r\n  if ($S->{UI}->{VARS}->{allow_user_host}) {\r\n	my $newnick = $S->{NICK};\r\n	$newnick =~ s/ /-/g;\r\n	$newnick .= \".\" . $S->{UI}->{VARS}->{default_domain};\r\n	$diary_link = qq{ %%dot%% <A CLASS=\"light\" HREF=\"http://$newnick%%rootdir%%/\">Your Diary</a><BR>};\r\n  } else {\r\n	$diary_link = qq{ %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/user/$urlnick/diary\">Your Diary</a><BR>};\r\n  };\r\n  $diary_link = \"\" unless ( $S->{UI}->{VARS}->{use_diaries} );\r\n  my $files_link = ( $S->have_perm(\'upload_user\') ? qq { %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/user/$urlnick/files\">Your Files</a><BR>} : qq { } ) ;\r\n\r\n  $content .= qq|\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/user/$urlnick\">User Info</a><BR>\r\n      $msg_link\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/user/$urlnick/comments\">Your Comments</a><BR>\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/user/$urlnick/stories\">Your Stories</a><BR>\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/user/$urlnick/ratings\">Your Ratings</a><BR>\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/user/$urlnick/ads\">Your Adverts</a><BR>\r\n      $diary_link\r\n      %%dot%% <a class=\"light\" href=\"%%rootdir%%/special/feeds\">Your Feeds</a><br>\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/submitstory/Diary\">New Diary Entry</a><BR>\r\n      $files_link\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/user/$urlnick/prefs\">User Preferences</a><BR>\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/my/prefs/Protected\">Change Password</a><BR>\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/my/prefs/interface\">Display Preferences</a><BR>\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/my/prefs/Comments\">Comment Preferences</a><BR>\r\n      %%dot%% <A CLASS=\"light\" HREF=\"%%rootdir%%/submitad\">Submit Advert</a><BR>\r\n      %%dot%% %%logout_link%%Logout $S->{NICK}</a><BR>\r\n|;\r\n$content .= qq{<br><br>You can syndicate your diary if you wish (Beta feature) by using your $rss_link<BR>} if ($rss_link);\r\n    $title = \"$S->{NICK}\";\r\n} else {\r\n    $content = qq{<h1>You must login first</h1>};\r\n}\r\nreturn {content => $content, title => $title };\r\n','the login box','empty_box',0),('user_prefs_box','','        my $zone_select = $S->_timezone_list();\r\n        my $topic_img_select = $S->_topic_img_select();\r\n        my $image_server_select = $S->_image_server_select();\r\n        my $rdf_feed_checks = $S->_rdf_feed_checks();\r\n        my $box_toggles = $S->_user_box_toggles();\r\n        my $spellcheck_toggle = $S->_spellcheck_toggles();\r\n        my $start_page_select = $S->_start_page_select();\r\n        my $ad_open_select = $S->_ad_open_select();\r\n        my $textarea_cols = $S->{prefs}->{textarea_cols} %%%%\r\n $S->{UI}->{VARS}->{default_textarea_cols};\r\n        my $textarea_rows = $S->{prefs}->{textarea_rows} %%%%\r\n $S->{UI}->{VARS}->{default_textarea_rows};\r\n\r\n        $ad_open_select = \'\' unless( $S->{UI}->{VARS}->{use_ads} == 1);\r\n\r\n        my $cloaked = $S->{prefs}->{online_cloak} ? \' checked=\"checked\"\' : \'\';\r\n        my $dyn = $S->{prefs}->{dynamic_interface} ? \' checked=\"checked\"\' : \'\';\r\n\r\n\r\n\r\nmy $result = qq[\r\n                <form name=\"intpref\" method=\"post\" action=\"/scoop/\">\r\n                <input type=\"hidden\" name=\"op\" value=\"interface\">\r\n                <input type=\"hidden\" name=\"tool\" value=\"prefs\">\r\n                <table width=\"100%\" border=\"0\" cellpadding=\"3\" cellspacing=\"0\">\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Your time zone:</B></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"> $zone_select </font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Number of story summaries to show:<br>(on main page)</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"5\" name=\"maxstories\" value=\"$S->{UI}->{VARS}->{maxstories}\"></font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Number of story titles to show:<br>(in \"older stories\" box)</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"5\" name=\"maxtitles\" value=\"$S->{UI}->{VARS}->{maxtitles}\"></font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Text box width:</B></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"5\" name=\"textarea_cols\" value=\"$textarea_cols\"></font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Text box height:</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"5\" name=\"textarea_rows\" value=\"$textarea_rows\"></font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>font face:</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"30\" name=\"norm_font_face\" value=\"$S->{UI}->{VARS}->{norm_font_face}\"></font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Font Size:</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"5\" name=\"norm_font_size\" value=\"$S->{UI}->{VARS}->{norm_font_size}\"></font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Number of story titles to show:<br>(in \"older stories\" box)</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"5\" name=\"maxtitles\" value=\"$S->{UI}->{VARS}->{maxtitles}\"></font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Text box width:</B></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"5\" name=\"textarea_cols\" value=\"$textarea_cols\"></font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Text box height:</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"5\" name=\"textarea_rows\" value=\"$textarea_rows\"></font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>font face:</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"30\" name=\"norm_font_face\" value=\"$S->{UI}->{VARS}->{norm_font_face}\"></font></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Font Size:</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"text\" size=\"5\" name=\"norm_font_size\" value=\"$S->{UI}->{VARS}->{norm_font_size}\"></font></td>\r\n                </tr>\r\n                $ad_open_select\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Show topic images with stories?</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"> $topic_img_select </font></td>\r\n                </tr>\r\n                $start_page_select\r\n                <tr valign=\"top\">\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><b>Hide yourself in the Who\'s Online box?</b></font></td>\r\n                        <td><font face=\"verdana, arial, helvetica, sans-serif\" size=\"2\"><input type=\"checkbox\" name=\"online_cloak\"$cloaked></font></td>\r\n                </tr>\r\n];','','empty_box',0),('user_script','','my $filelocation = $S->{UI}->{VARS}->{upload_path_user} . $S->{UID} . \'/userscript.js\';\r\nmy $urllocation = $S->{UI}->{VARS}->{upload_link_user} . $S->{UID} . \'/userscript.js\';\r\n\r\nmy $content;\r\n\r\nif (-r $filelocation) {\r\n  $content = qq{<script src=\"$urllocation\"></script>};\r\n}\r\n\r\nreturn $content;','Links in some user suppied javascript file, if it exists.','empty_box',0),('user_theme','Theme Picker','my $choice = $S->{UI}->{VARS}->{default_theme};\r\nmy $default = $S->{UI}->{VARS}->{default_theme};\r\nmy $sel = $S->filter_param($S->{CGI}->param(\'theme\'));\r\nmy $setting = $S->filter_param($S->{CGI}->param(\'settheme\'));\r\nmy $themes = $S->{UI}->{VARS}->{user_themes};\r\nmy @themes = split ( /,\\s*/, $themes );\r\n\r\nmy $sess = $S->session(\'theme\');\r\nmy $pref = $S->{prefs}->{theme};\r\nif ($setting eq \'set\') {\r\n	if ($sel eq \'\') { \r\n		$sel = $default;\r\n		$choice = $sel;\r\n		$sess = $sel;\r\n		$S->session(\'theme\',$sess);\r\n	} else\r\n	{\r\n		foreach my $t (@themes) {\r\n			if ($t eq $sel) {\r\n				$choice = $sel;\r\n				$sess = $sel;\r\n				$S->session(\'theme\',$sess);\r\n			}\r\n		}\r\n	}\r\n	$S->{APACHE}->headers_out->{\'Location\'} = $S->{UI}->{VARS}->{rootdir} . \"/special/theme\";\r\n	$S->{APACHE}->headers_out->{\'Connection\'} = \'close\';\r\n	$S->{APACHE}->status(301); $S->{HEADER_ONLY}=1;\r\n}\r\n$choice = $pref if ($pref);\r\n$choice = $sess if ($sess);\r\n\r\nmy $select = qq{\r\n<FORM NAME=\"usertheme\" ACTION=\"%%rootdir%%/special/theme\" METHOD=\"post\">\r\n      <SELECT name=\"theme\">};\r\n\r\nunless ( $S->{PREF_ITEMS}->{theme}->{default_value} ) {\r\n  my $checked = ($choice eq \'\') ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"\"$checked>none</OPTION>};\r\n}\r\n\r\nforeach my $t (@themes) {\r\n  my $checked = ($t eq $choice) ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"$t\"$checked>$t</OPTION>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>\r\n	  <INPUT TYPE=\"submit\" NAME=\"settheme\" VALUE=\"set\">\r\n</FORM>\r\n};\r\n\r\nreturn $select;','','box',0),('user_theme_pref','','my $choice = $ARGS[0];\r\nmy $themes = $S->{UI}->{VARS}->{user_themes};\r\nmy @themes = split ( /,\\s*/, $themes );\r\n\r\nmy $select = qq{\r\n      <SELECT name=\"theme\">};\r\n\r\nunless ( $S->{PREF_ITEMS}->{theme}->{default_value} ) {\r\n  my $checked = ($choice eq \'\') ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"\"$checked>none</OPTION>};\r\n}\r\n\r\nforeach my $t (@themes) {\r\n  my $checked = ($t eq $choice) ? \' SELECTED\' : \'\';\r\n  $select .= qq{\r\n        <OPTION value=\"$t\"$checked>$t</OPTION>};\r\n}\r\n\r\n$select .= qq{\r\n      </SELECT>};\r\n\r\nreturn $select;','','empty_box',0),('use_fckeditor','','my $editor = $S->pref(\'use_editor\');\r\nreturn \"\" unless ($editor eq \"yes\");\r\nreturn \"%%fckeditor_script%%\";','','empty_box',0),('use_spell_suggest','','return \"\" unless $S->have_perm(\'spellcheck_suggest\');\r\nreturn \"%%spell_suggest_script%%\";','','empty_box',0),('whos_online','Who\'s online','## New Who\'s Online Box\r\n## Quite a bit of stuff borrowed from the old one.\r\n\r\n# The time stuff can be changed by setting the whosonline_interval var\r\n\r\nmy $interval = $S->{UI}->{VARS}->{whosonline_interval} || 10;\r\n\r\nmy ($rv,$sth) = $S->db_select({\r\n   FROM => \'whos_online\',\r\n   WHAT => \'uid, count(uid) as numb, ip\',\r\n   WHERE => \"last_visit > DATE_SUB(NOW(), INTERVAL $interval MINUTE)\",\r\n   GROUP_BY => \'uid\'\r\n});\r\n\r\nmy $total;\r\nmy $anontotal;\r\nmy $hidden;\r\nmy %nicks;\r\nmy %ips;\r\nmy %cloaked;\r\n\r\nwhile (my $data = $sth->fetchrow_hashref()) {\r\n   if ($data->{\'uid\'} == -1) {\r\n        $anontotal = $data->{\'numb\'};\r\n        next;\r\n   }\r\n   $total++;\r\n   my $uid = $data->{\'uid\'};\r\n   my $nick = $S->user_data($uid)->{nickname};\r\n   if ($S->user_data($uid)->{prefs}->{online_cloak} eq \'on\') {\r\n      $hidden++;\r\n      if ($S->{UID} != 2) {\r\n        next;\r\n      }\r\n      $cloaked{ $nick } = 1; \r\n   }\r\n   $nicks{ $nick } = $data->{\'numb\'};\r\n   $ips{ $nick } = $data->{\'ip\'} if ($S->{UID} == 2); \r\n}\r\n\r\n$sth->finish;\r\n\r\nmy @sorted = sort { return lc($a) cmp lc($b) } keys %nicks;\r\n\r\nmy $noneonline = \"No one currently online (except you just now, of course).<BR>\";\r\nreturn {content => $noneonline, title => \"Who\'s Online?\"} unless @sorted;\r\n\r\nmy $out;\r\nforeach (@sorted) {\r\n   if ($S->{UID} == 2) {\r\n     my $ip = $ips{$_};\r\n     $out .= qq~ <a href=\"%%rootdir%%\\/special\\/ip_usage?ip=$ip\"\\>%%dot%%<\\/a> ~;\r\n   } else {\r\n     $out .= \'%%dot%% \';\r\n   }\r\n   $out .= qq~<A HREF=\"%%rootdir%%/user/$_\">$_</A> ~;\r\n#   $out .= qq~ ($nicks{$_})~ if ($nicks{$_} > 1);\r\n   if ($cloaked{$_}) {\r\n      $out .= \' (Cloaked)\';\r\n   }\r\n   $out .= qq~<BR>~;\r\n}\r\nif($anontotal){\r\n   my $anon_user_nick = $S->{UI}->{VARS}->{anon_user_nick};\r\n   $out .= \"%%dot%% $anon_user_nick: $anontotal<BR>\";\r\n   }\r\nif ($hidden) {\r\n   $out .= qq~%%dot%% Cloaked Users ($hidden)<p>~;\r\n} else {\r\n   $out .= \'<p>\';\r\n}\r\n$total = $total + $anontotal;\r\n$out .= qq~<small>Note: You may cloak yourself from appearing here in your <A HREF=\"%%rootdir%%/my/prefs/Interface\">Display Preferences</A></small>.<br>$interval minute interval~;\r\n\r\n\r\nreturn {content => $out, title => \"Who\'s Online? ($total)\"};\r\n','','box',0),('whos_online_old','Who\'s online old','## begin whos_online\r\nreturn if $S->{UID} == -1;\r\nif (($S->cache->{CACHE}->{WHOBOX}->{TIME}) &&\r\n    ($S->cache->{CACHE}->{WHOBOX}->{TIME} < (time + 120))) {\r\n	return {\r\n		content => $S->cache->{CACHE}->{WHOBOX}->{CONTENT},\r\n		title => $S->cache->{CACHE}->{WHOBOX}->{TITLE}\r\n	};\r\n}\r\n\r\nrequire Storable;\r\n\r\nmy $interval = 5;\r\nmy ($rv,$sth) = $S->db_select({\r\n	FROM => \'sessions\',\r\n	WHAT => \'a_session\',\r\n	WHERE => \"last_accessed > DATE_SUB(NOW(), INTERVAL $interval MINUTE)\",\r\n	ORDER_BY => \'last_accessed DESC\',\r\n	DEBUG => 0\r\n});\r\n\r\n\r\nmy %uids;\r\nmy $total;\r\nwhile (my ($s) = $sth->fetchrow_array) {\r\n	my $d = Storable::thaw($s);\r\n\r\n	next if $d->{UID} eq \'\';\r\n	$uids{ $d->{UID} } = 0 unless $uids{ $d->{UID} };\r\n	$total++;\r\n	$uids{ $d->{UID} }++;\r\n}\r\n\r\n$sth->finish;\r\n#my @sorted = sort {return 1 if $a == -1; return -1 if $b == -1; return 0;\r\n\r\nmy @sorted = sort { return $a <=> $b } keys %uids;\r\nreturn unless @sorted;\r\n\r\n$S->user_data(\\@sorted); # pre-cache user data\r\n\r\nmy $out;\r\nmy $hidden;\r\nmy $list;\r\nmy $max_show = 75;\r\nforeach (@sorted) {\r\n	$_ = -1 if $_ eq \'anon\';\r\n	if ($S->user_data($_)->{prefs}->{online_cloak}) {\r\n		$hidden++;\r\n		next;\r\n	}\r\n	next unless (($list < $max_show) || $_ == -1);\r\n	$list++ unless $_ == -1;\r\n	my $nick = $S->user_data($_)->{nickname};\r\n	my $linknick = $S->urlify($nick);\r\n	$out .= qq~%%dot%%~;\r\n	$out .= qq~ <A CLASS=\"light\" HREF=\"%%rootdir%%/user/$linknick\">~ unless $_ == -1;\r\n	$out .= \' \' if $_ == -1;\r\n	$out .= $nick;\r\n	$out .= \"</A>\" unless $_ == -1;\r\n	$out .= \" ($uids{$_})\" if $uids{$_} > 1;\r\n	$out .= \"<BR>\\n\";\r\n}\r\n\r\nif ($total > ($list + $hidden + $uids{-1})) {\r\n	my $more = ($total - $list - $hidden - $uids{-1});\r\n	$out .= qq~%%dot%% ...and $more more. :-)<br>~;\r\n}\r\n\r\nif ($hidden) {\r\n	$out .= qq~%%dot%% Cloaked Users ($hidden)<p>~;\r\n} else {\r\n	$out .= \'<p>\';\r\n}\r\n\r\n$out .= qq~<small>\r\n$interval minute interval.<br>You may cloak yourself from appearing here in your <A HREF=\"%%rootdir%%/interface/prefs\">Display Preferences</A></small>.~;\r\n\r\nmy $title = \"Who\'s Online? ($total)\";\r\n\r\n$S->cache->{CACHE}->{WHOBOX}->{CONTENT} = $out;\r\n$S->cache->{CACHE}->{WHOBOX}->{TITLE}   = $title;\r\n$S->cache->{CACHE}->{WHOBOX}->{TIME}    = time;\r\n\r\nreturn {content => $out, title => $title};\r\n','','box',0),('whos_online_reap','','# cron box funtion for reaping anonymous entries in the who\'s online box\r\n# The time stuff can be adjusted to your desire.\r\n\r\nmy ($rv, $sth) = $S->db_delete({\r\n    FROM => \'whos_online\',\r\n    WHERE => \'uid = -1 AND TIME < DATE_SUB(NOW(), INTERVAL 30 MINUTE)\'});\r\n$sth->finish();\r\n','','empty_box',0),('zerod_comments','Zero\'d comments','my $content;\r\nreturn unless (($S->{TRUSTLEV} == 2) || $S->have_perm(\'super_mojo\'));\r\nmy $start = $ARGS[1];\r\nmy $limit = 30;\r\nmy $date_format = $S->date_format(\'c.date\', \'short\');\r\n$start = $S->cgi->param(\'start\') if ($start eq \'\');\r\n$start = $S->filter_param($start);\r\n$start = 1 if ($start eq \'\');\r\n\r\nmy $page = $start;\r\n$start = ($start - 1) * $limit;\r\n\r\nmy $rootdir = $S->{UI}->{VARS}->{rootdir};\r\nmy $page_n = $page;\r\n$page_n --;\r\nmy $prev_page = qq{<a CLASS=\"light\" href=\"$rootdir/zerod/$page_n\"><< Prev Page</a>} if ($page > 1);\r\n$page_n += 2;\r\nmy $next_page = qq{<a CLASS=\"light\" href=\"$rootdir/zerod/$page_n\">Next Page >></a>};\r\n\r\nmy ($rv, $sth) = $S->db_select({\r\n	DEBUG => 0,\r\n	WHAT => \"c.sid, c.cid, c.subject, c.points, $date_format AS ftime, s.title, c.uid, u.nickname\",\r\n	FROM => \"comments as c, commentratings as r, stories as s, users as u\",\r\n	WHERE => \"(c.sid=r.sid and c.cid=r.cid and c.sid=s.sid and c.uid=u.uid) and r.rating=0\",\r\n	ORDER_BY => \'c.date desc\',\r\n	DISTINCT => 1,\r\n	LIMIT => \"$start, $limit\"});\r\n\r\nmy $comments = $sth->fetchall_arrayref();\r\n$sth->finish();\r\n\r\n$rv = 0 if ($rv eq \'\');\r\n\r\n$content = \"Search returned $rv results:<p>\";\r\n\r\n$next_page = \'\' if (($rv < $limit) || (!$rv));\r\n\r\nif ($prev_page || $next_page) {\r\n	$content .= qq{<table width=\"100%\"><tr><td align=\"left\">$prev_page</td><td align=\"right\">$next_page</td></tr></table>};\r\n}\r\n\r\nreturn $content unless ($rv);\r\n\r\n$start++;\r\n$content .= qq{<ol start=\"$start\">};\r\n\r\nforeach my $comment (@{$comments}) {\r\n	my $c_link = $rootdir . \"/comments/$comment->[0]/$comment->[1]\";\r\n	$content .= qq{\r\n	<li><b><a CLASS=\"light\" href=\"$c_link#$comment->[1]\">$comment->[2]</a></b> \r\n        [<a CLASS=\"light\" href=\"$c_link?mode=alone;showrate=1#$comment->[1]\">$comment->[3]</a>]\r\n	<br>posted by <a CLASS=\"light\" href=\"$rootdir/user/uid:$comment->[6]\">$comment->[7]</a> \r\n	on $comment->[4]<br>attached to \r\n	<a CLASS=\"light\" href=\"$rootdir/story/$comment->[0]\">$comment->[5]</a>\r\n	<p>};\r\n}\r\n\r\n$content .= \'</ol>\';\r\nif ($prev_page || $next_page) {\r\n	$content .= qq{<table width=\"100%\"><tr><td align=\"left\">$prev_page</td><td align=\"right\">$next_page</td></tr></table>};\r\n}\r\n\r\nreturn $content;\r\n','','empty_box',0);
/*!40000 ALTER TABLE `box` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2012-10-03 12:28:28
-- MySQL dump 10.11
--
-- Host: localhost    Database: scoop
-- ------------------------------------------------------
-- Server version	5.0.32-Debian_7etch8-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `ops`
--

DROP TABLE IF EXISTS `ops`;
CREATE TABLE `ops` (
  `op` varchar(50) NOT NULL default '',
  `template` varchar(30) NOT NULL default '',
  `func` varchar(50) default NULL,
  `is_box` int(1) default '0',
  `enabled` int(1) default '1',
  `perm` varchar(50) default '',
  `aliases` varchar(255) NOT NULL default '',
  `urltemplates` text NOT NULL,
  `description` text,
  PRIMARY KEY  (`op`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Dumping data for table `ops`
--

LOCK TABLES `ops` WRITE;
/*!40000 ALTER TABLE `ops` DISABLE KEYS */;
INSERT INTO `ops` VALUES ('activate','default_template','activate',1,1,'','','/key/',''),('addtag','default_template','addtag',1,1,'comment_post','','/sid{5}/',''),('adinfo','default_template','ad_info_page',0,1,'','','/ad_id/','Displays everything related to an ad.'),('admin','admin_template','admin_main',0,1,'','','element.1=story:/tool/sid{5}/,\r\nelement.1=editpoll:/tool/editqid/option/,\r\nelement.1=vars:/tool/mode/item/,\r\nelement.1=blocks:/tool/mode/theme/item/,\r\nelement.1=topics:/tool/tid/,\r\nelement.1=sections:/tool/section/,\r\nelement.1=special:/tool/id/,\r\nelement.1=boxes:/tool/id,\r\nelement.1=optemplates:/tool/opcode,\r\nelement.1=groups:/tool/perm_group_id/,\r\nelement.1=rdf:/tool/action/write=1/,\r\nelement.1=cron:/tool/action/which/write=1/,\r\nelement.1=ops:/tool/opcode/,\r\nelement.1=ads:/tool/type/which,\r\nelement.1=log:/tool/log_type/page/log_id/,\r\nelement.1=calendar:/tool/item,\n/tool/','Entry point to the various admin tools.'),('ajax','content_only_page_template','ajax',1,1,'','','/function/action/sid{5}/',''),('blank','blank_template',NULL,0,1,'','','','Uses a blank template to do nothing and show nothing.'),('cabal','index_template','cabal_users',1,1,'cabal_member','','',''),('calendar','default_template','display_calendar',0,1,'','','/view/calendar/date/','monthly, weekly, daily calendar view'),('comments','comment_template','comment_dig',0,1,'','comment','element.1=poll:/null/sid/cid/tool/,\nlength=2:/sid/cid/,\nlength=3:/sid/cid/tool/,\n/sid{5}/cid/tool/','Displays comments in various formats.'),('cron','cron_template','cron',0,1,'','','','Run waiting cron jobs.'),('css','content_only_page_template','css',1,1,'','','/file/','Returns a block of CSS with the correct file type.'),('default','index_template','',0,1,'','','','The template used when no other is known. \'main\' is actually the default op'),('diary','story_template','diarysub_box',1,1,'hotlist_flex','','/user/','subscribe/unsubscribe diary'),('displaystory','story_template','focus_view',0,1,'','story','length=6:/mode/sid{5}/,\n/sid{5}/','Formats and shows a story according to the params.'),('dynamic','dynamic_template','comment_dig',0,1,'','','','Same as comments, except is used for dynamic comment mode.'),('dyn_hotlist','dynamic_template','hotlist_flex_box',1,0,'','','','Dynamic Hotlist op'),('editcalendar','default_template','edit_calendar',0,1,'edit_own_calendar','','/tool/id/action/eid/','interface for managing calendars'),('erase','default_template','erase_user',1,1,'','','',''),('event','default_template','display_event',0,1,'','','/eid/','displays a single event'),('eventsearch','default_template','event_search',0,1,'','','','event search (should one day get rolled in with all the other search stuff)'),('fckfiles','content_only_page_template','fckfiles',1,1,'','','',''),('hide','story_template','hide_story',0,1,'','','length=6:/mode/sid{5}/,\r\n/sid{5}/','Hides a story according to the params.'),('hotlist','',NULL,0,1,'','','/tool/sid{5}/new_op/page/section/','Edits a user\'s story hotlist.'),('ip','default_template','my_ips',1,1,'search','','','Show users own IPs'),('iplookup','default_template','ip_usage_box',1,1,'view_comment_ip','','/iplook/',''),('logout','default_template','logout_box',1,1,'','','','Logs the user out and removes their session.'),('main','index_template','main_page',0,1,'','','EVAL{\r\n  my $p = {};\r\n  my $domain = $S->{UI}->{VARS}->{default_domain};\r\n  $p->{page} = $path[0];\r\n  return $p unless ($S->{UI}->{VARS}->{allow_user_host});\r\n  my $hostname = $S->{APACHE}->headers_in->{\'X-Forwarded-Host\'};\r\n  $hostname =~ s/(.+)\\.$domain/$1/i;\r\n  if ($hostname ne $S->{UI}->{VARS}->{default_host}) {\r\n    my $nick = $hostname;\r\n    $nick =~ s/-/ /g;\r\n    $p->{op} = \'section\';\r\n    $p->{user} = $nick;\r\n    $p->{section} = $S->{UI}->{VARS}->{user_host_section};\r\n    $p->{host} = $S->{UI}->{VARS}->{default_host};\r\n  }\r\n  return $p;\r\n}','Displays the front page.'),('modsub','moderate_template','moderate_subs',0,1,'moderate','queue moderate','','Display the moderation queue.'),('newuser','default_template','new_user',0,1,'','','/tool/','Starts the process of creating a new user.'),('olderlist','default_template','olderlist',0,1,'','','','Gives a listing of older stories.'),('ping','ping_template','',0,0,'','','','Disabled due to spamming'),('pm_inbox','special_template','pm_inbox',0,1,'','','',''),('pm_message','special_template','pm_message',0,1,'','','',''),('pm_send','special_template','pm_send',0,1,'','','',''),('pm_sent','special_template','pm_sent',0,1,'','','',''),('poll_list','default_template','poll_listing',0,1,'','','','Gives a list of all the polls that have been created'),('poll_vote','default_template','just_vote',0,1,'poll_vote','','','Registers a user vote in a poll.'),('print','print_template','print_story',1,1,'','','length=6:/mode/sid{5}/,\r\n/sid{5}/',''),('redirect','','redirect',0,1,'','','/ad_id/','Does ad redirections to other sites, with logging.'),('renew','default_template','renewad_box',1,1,'','','','Used to renew ads that are already running.'),('rss','empty_template','rss_box',1,1,'poll_read_comments','','',''),('rss_replies','empty_template','rss_replies',1,1,'hotlist_flex','','',''),('search','default_template','search',0,1,'search','find','length=2:/type/string/,\r\n/string/','Everything related to searching content on the site.'),('searchnew','search_new_template','search',0,1,'search','','length=2:/type/string/,\r\n/string/','Everything related to searching content on the site.'),('section','index_template','main_page',0,1,'','','/section/page/','Lists the stories, with intros, that are in a specified section.'),('showad','ad_test_template',NULL,0,1,'','','/ad_id/','Displays a single advertisment.'),('special','special_template','special',0,1,'','TheRealInnerCabal','EVAL{\r\n  my $caller = $S->cgi->param(\'caller_op\');\r\n  my $p = {};\r\n  $p->{op}  = \'special\';\r\n  \r\n  if ($caller eq \'special\') {\r\n	$p->{page} = $path[0];\r\n  } else {\r\n    $p->{page} = $caller;\r\n  }\r\n  \r\n  return $p\r\n}','Displays special pages.'),('spell','empty_template','speller',1,1,'spellcheck_suggest','','','For the spell check suggestions'),('storylist','empty_template','users_stories',1,1,'story_post','','',''),('submitad','submit_template','choose_submit_ad_step',0,1,'','','/step/','Start the process of submitting an ad.'),('submitevent','default_template','submit_event',0,1,'submit_event','','/tool/id/','submit/edit an event'),('submitrdf','default_template','submit_rdf',1,1,'','','','Walks the user through submitting an RDF feed.'),('submitstory','submit_template','submit_story',0,1,'story_post','submit','/section/','Submits a story to the moderation queue.'),('subpay','subscribe_template','subpay_type_select',1,1,'','','',''),('subscribe','subscribe_template','subscribe',0,1,'','','','Function for users to purchase a subscription'),('tag','index_template','show_storiesbytag',0,1,'','tags','/tag/page/','Lists the stories, with intros, that are in a specified tag'),('tagsort','content_only_page_template','tag_page_order',1,1,'','','/switch/',''),('tb','empty_template','trackback_handler',0,0,'','','length=6:/target{5}/type,\r\nlength=5:/target{5}/,\r\n/target/type/',''),('trackback_list','special_template','trackback_list',1,1,'comment_delete','','','Show a list of trackbacks'),('unhide','story_template','unhide_story',0,1,'','','length=6:/mode/sid{5}/,\r\n/sid{5}/','Un-Hides a story according to the params.'),('user','default_template','edit_user',0,1,'','whois my ~.+','EVAL{\r\n  my $p = {};\r\n  if ($S->cgi->param(\'caller_op\') eq \'my\') {\r\n    unshift @path__COMMA__ $S->{NICK};\r\n  } elsif ($S->cgi->param(\'caller_op\') =~ m/^~(.+)$/) {\r\n    unshift @path__COMMA__ $1;\r\n  }\r\n  my $uid;\r\n  if ($path[0] =~ /uid:/) {\r\n    $path[0] =~ s/^uid://;\r\n    $uid = $path[0];\r\n    $path[0] = $S->get_nick_from_uid($uid);\r\n  } else {\r\n    $uid=$S->get_uid_from_nick($path[0]); \r\n  }\r\n  if ($path[1] eq \'edit\') { $path[1] = \'prefs\' }\r\n  if ($path[1] eq \'diary\') {\r\n    $p = {\r\n      op      => \'section\'__COMMA__\r\n      user    => \"$path[0]\"__COMMA__\r\n      section => \'Diary\'__COMMA__\r\n      page    => $path[2]\r\n    };\r\n  } elsif ($path[1] =~ /comment/) {\r\n    $p->{op}      = \'search\';\r\n    $p->{type}    = \'comment_by\';\r\n    $p->{string}  = $path[0];\r\n  } elsif ($path[1] eq \'ads\') {\r\n    $p->{op}      = \'adinfo\';\r\n    $p->{ad_id}   = \"uid:$uid\";\r\n  } elsif ($path[1] eq \'stories\' || $path[1] eq \'story\') {\r\n    $p->{op}      = \'search\';\r\n    $p->{type}    = \'author\';\r\n    $p->{string}  = $path[0];\r\n  } elsif ($path[1] eq \'rss\') {\r\n    $p->{op}      = \'rss\';\r\n    $p->{nick}    = $path[0];\r\n    $p->{uid}     = $uid;\n    $p->{section} = $path[2];\r\n    } elsif ($path[1] eq \'calendar\') {\n    $p->{op}      = \'calendar\';\n    $p->{view}    = $path[2] || $S->pref(\'calendar_view\');\n    $p->{uid}     = $uid;\n    $p->{date}    = $path[4];\n  } else {\n$p->{op}      = \'user\';\r\n    $p->{tool}    = $path[1];\r\n    $p->{nick}    = $path[0];\r\n    $p->{action}  = $path[2];\r\n  }\r\n  return $p;\r\n}','Display and edit registered users.'),('userpage','userpage_template','',0,1,'','','','Shows the userpage containing the My comments links etc.'),('view_poll','default_template','poll_focus_view',0,1,'','viewpoll poll','/qid/','Displays a poll or the results of one.'),('whos_online','default_template','whos_online',1,1,'','','',''),('zerod','index_template','zerod_comments',1,1,'comment_rate','','/start','show zerod comments.');
/*!40000 ALTER TABLE `ops` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2012-10-03 12:28:35
-- MySQL dump 10.11
--
-- Host: localhost    Database: scoop
-- ------------------------------------------------------
-- Server version	5.0.32-Debian_7etch8-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `special`
--

DROP TABLE IF EXISTS `special`;
CREATE TABLE `special` (
  `pageid` varchar(50) NOT NULL default '',
  `title` varchar(255) NOT NULL default '',
  `description` text,
  `content` text,
  PRIMARY KEY  (`pageid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Dumping data for table `special`
--

LOCK TABLES `special` WRITE;
/*!40000 ALTER TABLE `special` DISABLE KEYS */;
INSERT INTO `special` VALUES ('Accounts','HuSi Accounts','','Accounts for HuSi, showing gifts, incomings and outgoings.<p>\r\n%%BOX,accounts%%<p>\r\nServer hosting is a regular payment of &pound;54 per month. The Approx. &pound;2 charge is for the backup service. The cost fluctuates with the exchange rate.<p>\r\n<b>Note:</b> These figures, especially for incomings  do not reflect the true amount actually sent to me. Due to Paypal charges, and varying interest rates the amount I get is often lower than what I\'m actually sent. What I record here is the amount that ends up in my bank account after paypal charges etc have been removed.'),('adlist','Advertisement Types','This is just a list of all the types of advertisements.','%%BOX,ad_types%%'),('adpay','Pay for Ad Order','','%%BOX,ad_pay_type_select%%'),('allowed_html','What HTML can I use?','','<b>It can depend on where you are entering the HTML.</b><br><Br>Some people can use different HTML in comments than in stories for example. Here is the HTML <em>you</em> are allowed to use.<br><br><b>Comments</b><p>%%BOX,faq_allowed_html,comment%%<p>\r\n<b>Story Intro text</b>\r\n<p>%%BOX,faq_allowed_html,intro%%<p>\r\n<b>Story Body text</b>\r\n<p>%%BOX,faq_allowed_html,body%%<p>\r\n<b>Your user bio & signature</b>\r\n<p>%%BOX,faq_allowed_html,prefs%%<p>'),('AmazonSearch','','','%%search_form_amazon%%'),('autoformat_syntax','Auto Format Mode Syntax','Description of the Auto Format syntax.','<p>If you don\'t know HTML, that won\'t stop you from making your stories and posts as nicely formatted and fancy as posts by those who do. If you set your \"Post Mode\" in Comment Preferences to \"Auto Format\", Scoop will do its best to format your comment based on its contents, instead of forcing you to litter it with tags. The following page will describe the mechanics used by Scoop to format comments and stories posted in \"Auto Format\" mode.</p>\r\n\r\n<h4>Paragraphs and line breaks</h4>\r\n\r\n<p>In order to start a new paragraph, simply press \r\nEnter twice. To insert a line break, press Enter once. Note that text will automatically wrap to fit the size of the screen, so line breaks like that are generally unnecessary. In most cases, you shouldn\'t need to hit Enter at all except for paragraph breaks.</p>\r\n\r\n<h4>Bold and Italics</h4>\r\n\r\n<p>If you want to emphasize a word or phrase, you can type it into the text box surrounded in asterisks (*), <code>*like this*</code>. This will cause the text between the asterisks to be rendered in <b>bold type</b>. Similarly, you can also enter text between underscores (_) or slashes (/), <code>_like this_ /or this/</code>, in order to render the given text in <i>italics</i>.</p>\r\n\r\n<h4>Making links</h4>\r\n\r\n<p>Of course, you can\'t post on the Web without needing to insert a link every now and then. Creating a link is as simple as typing in the URL (the address shown in your browser\'s toolbar at the top of the window). Auto Format mode will automatically turn all URLs into links. For example, if you were to type the following text:</p>\r\n<blockquote><code>This website runs weblog software from http://scoop.kuro5hin.org.</code></blockquote>\r\n<p>the resulting comment will look like this:</p>\r\n<blockquote>This website runs weblog software from <a href=\"http://scoop.kuro5hin.org\">http://scoop.kuro5hin.org</a>.</blockquote>\r\n<p>Of course, it\'s not always desirable to have the text of the link be the same as the target of the link. You can use brackets (\'[\' and \']\') in order to specify both the link text and link target. For example, if you wanted the text \"<code>This search engine</code>\" to point to <code>http://www.google.com/</code>, you would type the following:</p>\r\n<blockquote><code>[This search engine http://www.google.com/]</code></blockquote>\r\n<p>Which will render like so:</p>\r\n<blockquote><a href=\"http://www.google.com/\">This search engine</a></blockquote>\r\n\r\n<h4>Making lists</h4>\r\n\r\n<p>You can create bulleted lists by entering a series of lines starting with an asterisk followed by a space (\'* \'). Numbered lists can be created similarly, by typing a series of lines beginning with a number follwed by a period (\'1. \'). For example, typing in the following text:</p>\r\n<blockquote><pre>I had these items for breakfast this morning:\r\n* Eggs\r\n* Bacon\r\n* Toast\r\n* Hot grits\r\n</pre></blockquote>\r\n<p>will give the following result:</p>\r\n<blockquote>I had these items for breakfast this morning:\r\n<ul>\r\n<li>Eggs</li>\r\n<li>Bacon</li>\r\n<li>Toast</li>\r\n<li>Hot grits</li>\r\n</ul></blockquote>\r\n<p>You can create numbered lists by simply entering a numbered list.\r\n<blockquote><pre>I had these items for breakfast this morning:\r\n1. Eggs\r\n2. Bacon\r\n3. Toast\r\n4. Hot grits\r\n</pre></blockquote>\r\n<p>will give the following result:</p>\r\n<blockquote>I had these items for breakfast this morning:\r\n<ol>\r\n<li>Eggs</li>\r\n<li>Bacon</li>\r\n<li>Toast</li>\r\n<li>Hot grits</li>\r\n</ol></blockquote>\r\n\r\n<h4>What if auto-format formats something you don\'t want it to?</h4>\r\n\r\n<p>Sometimes, you can confuse auto-format by entering something it <em>thinks</em> is formating, but you actually want to display. this can happen with number for instance. You want to put a list of number down, and auto-format thinks you want a list.\r\n<blockquote><pre>The data recording device gave the following results:\r\n123.45\r\n12.67\r\n18.49\r\n1349.34\r\n</pre</blockquote>\r\n<p>What auto-format will do to this is quite horrible</p>\r\n<blockquote><pre>The data recording device gave the following results:\r\n<ol>\r\n<li value=\"123\">45</li>\r\n<li value=\"12\">67</li>\r\n<li value=\"18\">49</li>\r\n<li value=\"1349\">34</li>\r\n</ol>\r\n</pre</blockquote>\r\n<p>Same with other types of auto-formatting. Sometimes you might want to display the / or the *</p>\r\n<p>To stop any of these, simply put a \\ in front of the thing you want auto-format to ignore.\r\n<blockquote><pre>The data recording device gave the following results:\r\n\\123.45\r\n\\12.67\r\n\\18.49\r\n\\1349.34\r\n</pre</blockquote>\r\n<p>Auto-format will then leave it alone.</p>\r\n<blockquote><pre>The data recording device gave the following results:\r\n123.45\r\n12.67\r\n18.49\r\n1349.34\r\n</ol>\r\n</pre</blockquote>\r\n'),('bugs','Known bugs and some workarounds','List of bugs that users repeatedly ask editors about','<ol>\r\n<li><b>I can\'t login!  It might seem to work, but as soon as I change page I get logged out again.</b><p><i><b>Problem</b></i>: Your problem is that your cookies are invalid, but that your browser doesn\'t realise it.  Scoop (the code that runs HuSi) requires the use of cookies for logins to work<br><br>\r\n<i><b>Resolution</b></i>: Delete your cookies.  In Internet Explorer this can be done through the Tools-&gt;Internet options menu, using the Delete Cookies button.<p>\r\nIf you wish to delete the cookies manually so as not to delete other sites\' cookies, close all browser windows and locate the cookies directory.  You may find the cookie is named \"scoop\" rather than the expected \"www.hulver.com\".<p>\r\n<i><b>Additional</b></i>: This problem is the result of extending the scope of the cookies to all subdomains at hulver.com, rather than just www.hulver.com.  This allows you to remain logged in when using the new diaries feature, that allows you to access a user\'s diaries through <a href=\"http://gazbo.hulver.com\">http://gazbo.hulver.com</a>.<p>\r\n</li>\r\n<li>\r\n<b>I\'ve set my start page to be Diaries, but it shows me the front page!</b><p>\r\n<i><b>Problem</b></i>: This is a minor problem related to the new sub-domain code.<p>\r\n<i><b>Resolution</b></i>: Bookmark the diaries page until Hulver fixes the code.<p>\r\n</li>\r\n<li>\r\n<b>My username has a space in it so I can\'t access my diary at \"http://my name.hulver.com\"</b><p>\r\n<i><b>Problem</b></i>: This is not really a bug, but it is true that you cannot use spaces in domain names.<p>\r\n<i><b>Resolution</b></i>: If your username contains a space you can still access your personal diary page by replacing the space with a hyphen.<p>For example, R Mutt\'s diary would be accessed like so: <a href=\"http://r-mutt.hulver.com\">http://r-mutt.hulver.com</a>.\r\n\r\n</ol>\r\n'),('copyright','Copyright stuff','','<strong>Comment copyright and ownership:</strong>\r\n<p>\r\nWhen you post a comment here, you grant &quot;Hulver\'s Site&quot; non-exclusive rights to display your comment and store it in our database for display on this site, or any future location of this site. It may also be reachable through searches or other means. By posting here, you also grant us the right to remove your comment if we choose not to want it here. Admins never edit comments, but we do remove comments that are inappropriate or offensive to the admins or other users of the site. The code running the site may edit your comment to automatically remove HTML markup or fix broken formatting.\r\n<p>\r\nYou lose no copyright control over your words, and are not beholden to us in any way shape or form.\r\n<p>\r\n&quot;Hulver\'s site&quot; claims no liability for the accuracy of user\'s comments, and reserves no ownership of them whatsoever.\r\n<p>\r\n<strong>Story Contributions:</strong>\r\n<p>\r\nUnless we have explicitly agreed otherwise, contributing a story here means that you grant &quot;Hulver\'s site&quot; non-exclusive serial rights to publish it online, on &quot;Hulver\'s site&quot;, offline and syndicate the title through our RDF backend. You also grant us the right to edit or remove your story as necessary, though we will take great pains to ensure the meaning remains intact.\r\n<p>\r\nYou also, by submitting a story here, warrant that it is your original writing, and not plagiarized from any other published source. &quot;Hulver\'s site&quot; is not responsible for checking the accuracy or originality of any submission, nor will we be liable for plagiarism or the truth or lack thereof of any submission.\r\n\r\n'),('Diary_guide','Diary posting guidelines.','','Here are some in-depth guidelines for diaries:\r\n<UL>\r\n<LI>You can pick a topic for your diary. The default is Diary, which will be ok most of the time. If you\'re writing a diary on a specific subject, you might want to chose a topic to match that instead. There is a list of topics <a href=\"%%rootdir%%/special/Topics\">here</a> that also shows what icon your topic will have.<br><br>\r\n<LI>See <a href=\"%%rootdir%%/special/allowed_html\">this page</a> for the HTML you will be allowed to use, if you want to use HTML.<br><br>\r\n<LI>You can post images using the ((file)) macro. On the right hand side of the screen when you\'re posting a diary you\'ll see a box called &quot;User Files&quot;. If you have uploaded any images, they\'ll be available in the drop down box. Use that to add those images to your diary.<br><br>\r\n<LI>This is a community site. Any thing you post here will be seen in the Diaries section page. Your diary is public, and everybody can read it.<br><br>\r\n<LI><b>Remember</b>, you should consider anything you post here could be around FOREVER. That\'s a mighty long time, as they say. So if you\'re going to post about that time you did <em>&lt;Insert embarrassing act here&gt;</em> you might want to consider what would happen if your boss/wife/husband/lover read it.<br><br>\r\n<LI>You can stop people posting comments in your diary if you choose, but some people would consider that a bit rude.<br><br>\r\n<LI>Please don\'t submit too many diaries in a single day. People come here to read a different range of people. If you post too many diaries people will get annoyed with you.<br><br>\r\n\r\n</UL>'),('donate_thanks','Thanks for your donation','','<p>It\'s much appreciated</p>'),('editor','Editorial Guidelines','','<h2>When to edit</h2><p>\r\nGenerally you leave editing something until you\'re asked to do so.<p>\r\n<h2>When to delete</h2><p>\r\nDeleteing stories is a fairly last resort. If somebody is crapflooding, then yes, delete the stories. Don\'t go through their history and delete everything they\'ve ever posted though :)<br>\r\nGenerally, for something like a goatse post, or something that\'s personally offensive to somebody you should just banish it. To do that, you edit the story, and change the section to &quot;Crap&quot;<p>\r\nDeleteing comments is pretty much a last resort. You\'ve got super-mojo, use it to zero the comment.<br>\r\nFeel free to delete a comment if it\'s breaking page formatting, or somebodies posting goatse images or something like that.<p>\r\n<h2>Polls and things</h2><p>\r\nYou\'ve also got the ability to make front page polls! Use it.<p>\r\n<h2>Logs</h2><p>\r\nAs you can see from the &quot;Log&quot; option on your admin menu, everything is logged. It\'s a bit of a bug that it logs every diary posted, but I\'ll fix that someday :)<br>\r\nSo, if you fuck something up, we can get it back, don\'t worry.<p>\r\n<h2>Toggle?</h2><p>\r\nNext to every comment, you\'ll see a couple of commands in brackets. (delete) is fairly obvious. That will take you to a confirmation page to delete the comment. (toggle) Toggles the comment between Topical and Editorial.'),('faq','Frequently Asked Questions','The FAQ, duh.','<ol>\r\n<li><b>How do I contact you?</b><br><br>What for? If it\'s for a problem with the site, you can email the editors at <a>help at hulver.com</a>. If it\'s hulver you\'re trying to get hold of, then hulver at hulver.com will reach me.</li><br><br>\r\n<li><b>What\'s an editor?</b><br><br>Editors are people who help out on the site. They edit stuff when there are mistakes, and they <strike>smack down</strike> delete any stuff that might be pissing people off. <a href=\"%%rootdir%%/special/editor\">Editorial guidelines</a> has a list of the rules they work to. As you can see, it\'s a fairly loose set of rules.<br><br>\r\nWho are they?<br><br>\r\n<a href=\"%%rootdir%%/user/hulver\">hulver</a> (of course)<br>\r\n<a href=\"%%rootdir%%/user/gazbo\">gazbo</a><br>\r\n<a href=\"%%rootdir%%/user/ana\">ana</a><br>\r\n<a href=\"%%rootdir%%/user/atreides\">atreides</a><br>\r\n<a href=\"%%rootdir%%/user/BadDoggie\">BadDoggie</a><br>\r\n<a href=\"%%rootdir%%/user/CheeseBurgerBrown\">CheeseBurgerBrown</a><br>\r\n<a href=\"%%rootdir%%/user/me0w\">me0w</a><br>\r\n<a href=\"%%rootdir%%/user/MillMan\">MillMan</a><br>\r\n<a href=\"%%rootdir%%/user/mrgoat\">mrgoat</a><br>\r\n<a href=\"%%rootdir%%/user/ucblockhead\">ucblockhead</a><br>\r\n<a href=\"%%rootdir%%/user/WebWench\">WebWench</a><br>\r\n\r\n</li><br>\r\n<li><b>I\'ve just created an account, and I can\'t login</b><br><br>Try selecting the &quot;Forgotten Password&quot; next to the login box. That will mail you a url to visit. Visit that url and then you\'ll get a new password mailed to you. If that doesn\'t work then, humm. Dunno. Try mailing me, and I\'ll see what I can do.</li><br><br>\r\n<li><b>Can I really put images in Stories and comments?</b><br><br>Yes, you can. Images that you\'ve uploaded can be inserted into comments and stories. When you post a comment or story, you\'ll see a drop down list with your files in it (This appears on the right hand side of the page below your hotlist box). Select a file and click the button and your image will be inserted. <em>Any</em> Images that are reported to me as being in-appropriate, mainly Porn, will have the comment deleted, or the story edited to remove them. (I can\'t edit comments, so they just get deleted). You might even end up with your account banned. Don\'t be a prick.</li><br><br>\r\n<li><b>Upload files? What happens to them?</b><br><br>Yes, assuming you\'ve got the privileges, you can upload files to your own personal area using the files section in your user page. When you write a story, these are available in a drop down list for you to insert as images.  There is a filter in place to stop files being accessed from other sites, so please don\'t try.</li><br>\r\n<li><b>I don\'t know how Auto-formatting for comments and stories works</b><br><br>There is a page <a href=\"%%rootdir%%/special/autoformat_syntax\">here</a> that explains how to use auto-format</li><br>\r\n<li><b>I don\'t want to use Auto-format. What HTML can I use in my comments and stories?</b><br><br><a href=\"%%rootdir%%/special/allowed_html\">This page</a> explains what HTML tags are allowed.</li><br>\r\n<li><b>Do you delete Diaries and Comments?</b><br><br>Yes, I can, and I will. Basically if you\'re being really personally offensive to somebody, or revealing information about somebody like real name, phone number or address etc that they don\'t want made known then I will delete it.<br>\r\nAlso, if you\'re just being stupid and pissing off lots of people on the site then stuff you\'re doing might get deleted and your account might get anonymised.<br>\r\nDon\'t be a complete immature idiot, and nothing will happen to you.<br>\r\nBy the way, I won\'t go around deleting stuff you\'ve posted just because I happen to disagree with you. I respect your views, even if they are stupid :)</li><br>\r\n<li><b>Do you have an rdf feed?</b><br><br>Yes, there are several, see the <a href=\"%%rootdir%%/special/syndication/\">Syndication</a> page for more details</li><br>\r\n<li><b>What should I rate somebody?</b><br><br>Comment ratings are often a source of contention. Many people take a low comment rating as a slight against them and their whole family. Some people dole out high comment ratings just because you were nice enough to comment in their diary.<br>\r\nComment ratings are a bit of a joke, but they do serve a purpose. If you get rated high enough, often enough, then you get to be a trusted user. That gives you the ability to see hidden comments, and to zero comments yourself.<br>\r\nMy advice to you is, If you feel like giving somebody a 4, to say something nice, then do so. If you want to give somebody a 1, either because you don\'t like them, or you didn\'t like what they said, then do that as well.<br>\r\nDon\'t moan about comment ratings. They are little numbers, recorded against a bit of text. They do not rate your worth as a human, or your performance in the sack.<br>\r\nThe only comment you should take seriously ares zeros. If you give somebody a zero, you are making a statement that a particular comment is so bad nobody else should see it. That\'s a hell of a thing to say.<br>\r\nIf you\'ve been given a zero by lots of people, perhaps you should have a think about what you said. Don\'t. I repeat, DO NOT, post a diary moaning about it.<br><br>\r\nWhat sort of scale should you use?<br>\r\n<ol start=\"0\"><li>Hide this comment. It\'s spam, or really offensive and nobody should see it</li>\r\n<li>This comment isn\'t very good.</li>\r\n<li>Not used.</li>\r\n<li>Not used.</li>\r\n<li>This comment is OK, or very good, or I\'ve just read it. Whatever, it\'s not a 1.</li>\r\n</ol>\r\n</li><br>\r\n<li><b>What topics are there?</b><br><br>You should look at the <a href=\"%%rootdir%%/special/Topics\">Topics Page</a> for a list of topics.</li><br>\r\n<li><b>How much does HuSi cost to run?</b><br><br>Look for yourself, the accounts are kept online. You can check them at the <a href=\"%%rootdir%%/story/2005/1/19/61940/1053\">Accounts</a> page.</li><br>\r\n<li><b>That much? Can I give you some money then?</b><br><br>Of course you can. You can send me some money with PayPal.<br><br>%%paypal_donate%%<br>You could buy me some goodies from my <a href=\"http://www.amazon.co.uk/exec/obidos/registry/1O3DUR1MQBV1N/husi-21\">Amazon WishList</a><p>You could support the site by buying your stuff from Amazon as well<p><table><tr><td>%%amazon_logo_uk%% </td><td>&nbsp;</td><td>%%amazon_logo%%</td><td>&nbsp;</td><td>%%amazon_logo_ca%%</td></tr></table></li><br>\r\n<li><b>Why does the layout suck <em>so</em> much?</b><br><br>\r\nWell. The formatting uses style sheets, so there you go. If you\'re using an older browser, like say, Netscape 4.something then you are out of luck, sorry. Try something like a newer Netscape. Mozilla or Opera. It looks ok in those.<br>You could try changing the theme as well. Go to your user page, and then to Display Preferences. There is a drop down box asking you &quot;Use Which Theme&quot;. You could try some of those out. If there are enough themes, I might put up a separate page for them later.</li><br><br>\r\n<li><b>Where does hulver come from?</b><br><br>\r\nDo you mean the person, or the nick name?<br><br>\r\n<ul><li><b>The Person</b><br>\r\nHulver is really called Matthew Collins. He\'s a Delphi developer who lives in Sheffield. He used to hang around on <a href=\"http://www.kuro5hin.org\">Kuro5hin</a> a lot, but he\'s normally too busy on here now. He\'s a scoop developer, he bikes a bit, and he\'s got a couple of kids which take up the rest of his time.</li><p>\r\n<li><b>The nickname</b></li><br>\r\n\\Hul\"ver\\, n. [OE. hulfere; prob. akin to E. holly.] Holly, an evergreen shrub or tree. \r\n<br><br><em>Source: Webster\'s Revised Unabridged Dictionary</em></li><br></ol>'),('GoogleSearch','','','%%search_form_google%%'),('hookers_and_beer','Hookers and Beer','Laugh at BadDoggie page.','You don\'t have permission to view the inner cabal page.<p>\r\nPlease contact baddoggie.at.gmail.com and beg him to let you in.'),('ip_usage','IP Usage','Display IP stats.','%%BOX,ip_usage_box%%'),('matthew_home','Matthew\'s page','','<h1>Matthew\'s page</h1><p>\r\nWell, you\'ve found it. The web site of Matthew Collins. Not a lot here is there?<p>\r\nYou might want to go to my <a href=\"/scoop/\">scoop site</a> for some actual content.<p>\r\n'),('mission','Mission Statement','The site\'s purpose','This is this site\'s mission. To be as cool as possible. That is all.'),('patches','Patches','Scoop patches','<h1>hulver\'s scoop patches</h1>\r\n<p><h2>Snapshot</h2>\r\n<p>A snapshot of the code running hulver.com including the custom boxes and macros is available from <a href=\"/hulver-com-code.tar.gz\">here</a>. The custom blocks &amp; boxes are in the hulver.com directory under the main scoop directory. <strong>DO NOT</strong> run that script against an existing scoop database, as it drops the existing tables first. You must run it against a copy you don\'t care about, or a fresh install.'),('paypal_confirm','Paypal auto-confirm','','%%BOX,paypal_confirm%%'),('rate_warn','Warning: Posting rate exceeded','The page that explains what\'s going on when they exceed the defined post limit','You have exceeded this site\'s maximum posting rate. You are only allowed to post a certain number of comments or stories in a short period of time. Your user account is now locked from posting for a few minutes, after which it will become normal again. Be warned though: if you attempt to post again while you\'re locked out, the timeout period will double, and this will keep happening as long as you keep trying to post. Walk away for a few minutes, have a nice cup of coffee, come back, and everything will be cool. Thanks.'),('rdf_preview','External Feeds Preview','Used to preview external feeds\'s boxes.','Below is a preview of what the selected feed will look like once it\'s been added. The headlines within it are the current ones.<p>\r\n<table align=\"center\" width=\"40%\" border=\"0\">\r\n<tr><td>\r\n%%BOX,user_feeds%%\r\n</td></tr>\r\n</table>'),('searchtest','Search Test','','<script type=\"text/javascript\">\r\nfunction toggleSearch()\r\n{\r\n	var el1, el2;\r\n	if( !document.getElementById )	return;\r\n	if( !( el1 = document.getElementById( \'srchAdv\' ) ) %%%% !( el2 = document.getElementById( \'srchSimple\' ) ) )	return;\r\n	if( el1.style.display == \'none\' )\r\n	{\r\n		el1.style.display	= \'block\';\r\n		el2.style.display	= \'none\';\r\n	}\r\n	else\r\n	{\r\n		el1.style.display	= \'none\';\r\n		el2.style.display	= \'block\';\r\n	}\r\n	return false;\r\n}\r\nfunction toggleBetween( force )\r\n{\r\n	var el1, el2;\r\n	if( !document.getElementById )	return;\r\n	if( !( el1 = document.getElementById( \'h\' ) ) %%%% !( el2 = document.getElementById( \'srchBetween\' ) ) )	return;\r\n	var val	= el1.options[el1.selectedIndex].value;\r\n	if( force %%%% val != 10 )	el2.style.display	= \'none\';\r\n	else						el2.style.display	= \'block\';\r\n}\r\n</script>\r\n<style>.box	{ width	: 280px;} .smalltxt	{ font-size:0.85em}</style>\r\n\r\n<!-- header table -->\r\n<form name=\"Search\" action=\"/scoop/\" method=\"get\">\r\n        <input name=\"op\" value=\"search\" type=\"hidden\">\r\n        <input name=\"offset\" value=\"0\" type=\"hidden\">\r\n        <input name=\"old_count\" value=\"30\" type=\"hidden\">\r\n\r\n        <input name=\"type\" value=\"story\" type=\"hidden\"><p>\r\n		</p><table border=\"0\" cellpadding=\"0\" cellspacing=\"5\" width=\"100%\">\r\n                <tbody><tr bgcolor=\"#eeeeee\">\r\n                        <td class=\"sectiontitle\" align=\"center\">Search Hulver\'s site</td>\r\n                </tr></tbody>\r\n                </table>\r\n\r\n<div id=\"srchSimple\"> \r\n                <table border=\"0\" cellpadding=\"0\" cellspacing=\"5\" width=\"100%\">\r\n\r\n                <tr>\r\n                        <td style=\"border-style: solid; border-color: black; border-width: 0px 0px 1px; background-color: rgb(238, 238, 238);\" align=\"center\"><font face=\"verdana, arial, helvetica, sans-serif\" size=\"1\">\r\n<table border=\"0\" cellpadding=\"5\" cellspacing=\"0\" width=\"100%\">\r\n<tbody><tr>\r\n<td align=\"center\"><b><a href=\"http://www.hulver.com/scoop/search?type=story\" onclick=\"return linkSubmit(\'story\');\">Story</a></b></td>\r\n<td align=\"center\"><a href=\"http://www.hulver.com/scoop/search?type=author\" onclick=\"return linkSubmit(\'author\');\">Author</a></td>\r\n<td align=\"center\"><a href=\"http://www.hulver.com/scoop/search?type=comment\" onclick=\"return linkSubmit(\'comment\');\">Comments</a></td>\r\n<td align=\"center\"><a href=\"http://www.hulver.com/scoop/search?type=comment_by\" onclick=\"return linkSubmit(\'comment_by\');\">Comments by</a></td>\r\n<td align=\"center\"><a href=\"http://www.hulver.com/scoop/search?type=polls\" onclick=\"return linkSubmit(\'polls\');\">Polls</a></td>\r\n<td align=\"center\"><a href=\"http://www.hulver.com/scoop/search?type=user\" onclick=\"return linkSubmit(\'user\');\">Users</a></td>\r\n\r\n<td align=\"center\"><a href=\"http://www.hulver.com/scoop/special/AmazonSearch\">Amazon</a></td>\r\n<td align=\"center\"><a href=\"http://www.hulver.com/scoop/special/GoogleSearch\">Google</a></td>\r\n</tr>\r\n</tbody></table>\r\n</font></td>\r\n</tr><tr>\r\n<td align=\"center\">\r\n                        <input name=\"string\" value=\"\" size=\"30\" type=\"text\">\r\n                        <input name=\"search\" value=\"Search Stories\" type=\"submit\">\r\n                        <a href=\"advanced_search.html\" onclick=\"return toggleSearch()\">Advanced Search</a><br>\r\n                        </td>\r\n\r\n                </tr>\r\n</tbody>\r\n\r\n\r\n\r\n\r\n\r\n</table>\r\n</div>\r\n\r\n<div	id=\"srchAdv\" style=\"display:none\">\r\n<table cellpadding=\"0\" cellspacing=\"5\" border=\"0\">\r\n<tbody>\r\n<tr>\r\n	<td align=\"right\">Search for</td>\r\n\r\n	<td><input name=\"a\" id=\"a\" value=\"\" size=\"30\" type=\"text\" class=\"box\" /></td>\r\n</tr>\r\n<tr>\r\n	<td></td>\r\n	<td class=\"smalltxt\">\r\n		<input type=\"radio\" name=\"b\" id=\"b\" value=\"or\" checked=\"true\" />any word\r\n		<input type=\"radio\" name=\"b\" id=\"b\" value=\"and\" /> all words\r\n	</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\">Comments by</td>\r\n\r\n	<td><input name=\"d\" id=\"d\" value=\"\" size=\"30\" type=\"text\" class=\"box\" /></td>\r\n</tr>\r\n<tr>\r\n	<td></td>\r\n	<td class=\"smalltxt\">Leave blank to search all comments</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\">Diaries</td>\r\n	<td><input name=\"e\" id=\"e\" value=\"\" size=\"30\" type=\"text\" class=\"box\" /></td>\r\n</tr>\r\n\r\n<tr>\r\n	<td></td>\r\n	<td class=\"smalltxt\">Leave blank to search all diaries</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\">Sections</td>\r\n	<td>\r\n		<select name=\"g\" id=\"g\" class=\"box\">\r\n			<option	value=\"1\">All Sections</option>\r\n\r\n			<option	value=\"2\">Public Diaries</option>\r\n			<option	value=\"3\">Hole</option>\r\n			<option	value=\"3\">Section Stories</option>\r\n			<option	value=\"3\">Furries</option>\r\n			<option	value=\"3\">Travel</option>\r\n			<option	value=\"3\">Whatnot</option>\r\n\r\n			<option	value=\"3\">...</option>\r\n		</select>\r\n	</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\">Posted</td>\r\n	<td>\r\n		<select name=\"h\" id=\"h\" class=\"box\" onchange=\"toggleBetween()\">\r\n			<option	value=\"1\">Since the dawn of HuSi</option>\r\n\r\n			<option	value=\"1\">Last 24 hours</option>\r\n			<option	value=\"1\">Last 48 hours</option>\r\n			<option	value=\"1\">Last 7 days</option>\r\n			<option	value=\"1\">Last 30 days</option>\r\n			<option	value=\"10\">Between...</option>\r\n		</select>\r\n\r\n	</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\"></td>\r\n	<td>\r\n		<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" id=\"srchBetween\" style=\"display:none\">\r\n		<tbody>\r\n		<tr>\r\n			<td>\r\n				<select name=\"j\" id=\"j\">\r\n\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"1\">1</option>\r\n					<option	value=\"2\">2</option>\r\n					<option	value=\"3\">..</option>\r\n					<option	value=\"31\">31</option>\r\n				</select>\r\n			</td>\r\n\r\n			<td>\r\n				<select name=\"k\" id=\"k\">\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"1\">jan</option>\r\n					<option	value=\"2\">feb</option>\r\n					<option	value=\"3\">..</option>\r\n					<option	value=\"12\">dec</option>\r\n\r\n				</select>\r\n			</td>\r\n			<td>\r\n				<select name=\"l\" id=\"l\">\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"2003\">2003</option>\r\n					<option	value=\"2004\">..</option>\r\n					<option	value=\"2005\">2005</option>\r\n\r\n				</select>\r\n			</td>\r\n			<td>&nbsp;\r\n			and\r\n			&nbsp;</td>\r\n			<td>\r\n				<select name=\"m\" id=\"m\">\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"1\">1</option>\r\n\r\n					<option	value=\"2\">2</option>\r\n					<option	value=\"3\">..</option>\r\n					<option	value=\"31\">31</option>\r\n				</select>\r\n			</td>\r\n			<td>\r\n				<select name=\"n\" id=\"n\">\r\n\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"1\">jan</option>\r\n					<option	value=\"2\">feb</option>\r\n					<option	value=\"3\">..</option>\r\n					<option	value=\"12\">dec</option>\r\n				</select>\r\n			</td>\r\n\r\n			<td>\r\n				<select name=\"o\" id=\"o\">\r\n					<option value=\"\" selected=\"true\"></option>\r\n					<option	value=\"1\">2003</option>\r\n					<option	value=\"1\">..</option>\r\n					<option	value=\"1\">2005</option>\r\n				</select>\r\n\r\n			</td>\r\n		</tr>\r\n		</table>\r\n	</td>\r\n</tr>\r\n<tr>\r\n	<td align=\"right\"></td>\r\n	<td>\r\n		<input name=\"search\" value=\"Search Stories\" type=\"submit\">\r\n		<input name=\"clear\" value=\"Clear\" type=\"reset\" onclick=\"toggleBetween(1)\">\r\n\r\n		<a href=\"advanced_search.html\" onclick=\"return toggleSearch()\">Simple Search</a></td>\r\n</tr>\r\n\r\n</tbody>\r\n</table>\r\n</div>\r\n</form>\r\n<!-- END search_form_default-->'),('southpark','South Park','How various members of HuSi see themselves if they were South Park characters.','<p>How various members of HuSi see themselves if they were South Park characters.  See the key below to put a name to the \"face\".</p><p>Big thanks to ucblockhead for assembling the whole thing.</p>\r\n<p>You can also <a href=\"http://www.cafepress.com/ucblockhead\">Buy this on a T-Shirt!</a></p>\r\n<img src=\"http://www.ucblockhead.org/spavatars/HusiBig.jpg\"><br>\r\n<img src=\"http://www.ucblockhead.org/spavatars/HusiKeyBig.jpg\"><br>\r\n'),('syndication','Syndication and RSS feeds','Details about how to syndicate content from HuSi','There are several way to syndicate content from HuSi.<p>\r\n<h2>Stories from the everywhere but the diary section</h2><p>\r\nThe &quot;Standard&quot; syndication for scoop. Shows everything but stories from the Diary section.<p>\r\n<a href=\"%%rootdir%%/user/_all_/rss/__all__/backend.rdf\">Main syndication file</a><p>\r\n<h2>All diaries from HuSi</h2><p>\r\nLike the main syndication file, but this just shows everything in the diary section.<p>\r\n<a href=\"%%rootdir%%/user/_all_/rss/Diary/backend.rdf\">Diary syndication file</a><p>\r\n<h2>User specific syndication</h2><p>\r\nYou can also syndicate a specific users Diary or Stories.<p>\r\n<b>Diary</b><p>\r\n%%site_url%%%%rootdir%%/user/<em>username</em>/rss/Diary/backend.rdf<p>\r\n<b>Stories</b><p>\r\n%%site_url%%%%rootdir%%/user/<em>username</em>/rss/__all__/backend.rdf<p>'),('test','Testing','','Hello'),('theme','Theme Picker','Allows the user to change their theme.','%%BOX,user_theme%%\r\n'),('Topics','Topics','','<table border=0 cellpadding=10>\r\n%%BOX,topic_view%%\r\n</table>'),('trusted','Trusted User Guidelines','An explanation of what privileges trusted users get, and what responsibilities they have','<P>This site uses a system called \"Mojo\" to try to keep the comments as high-signal as possible. All users can rate all comments, except their own, between 1 and 5. When your comments are rated by others, those ratings are combined into a weighted average (newer comments count more than older ones) called your \"Mojo\". This, roughly, represents the rating we could expect your next comment to receive based on your past comments.</P>\n\n<P>Users who have a mojo greater than a certain minimum, and who have posted a sufficient number of comments, such as yourself, for example, are considered \"trusted\" users, and have the added capability to rate comments below the normal minimum rating, and also to see comments rated below the minimum (they are hidden from normal users).</P>\n\n<P>This is a great responsibility for you. It means you\'ve earned the right to peer-review content from untrusted users, and determine if it is spam. We rely on you to rate as much as you can, and to keep the comments as high-signal as we\'ve all come to expect.</P>\n\n<P>Please use your \"zero\" rating with care! It is *only* for use on comments that are wholly content-free. If you think the poster is clueless, or an idiot, or you just don\'t agree with them, that is *not* grounds for a zero rating. Zero is for comments that are offensive, script-generated, or otherwise content-free and intended solely to annoy and/or abuse other readers.</P>\n\n<P><B>Please do not rate duplicate comments 0! As virtually all duplicate comments are accidental, this unfairly impacts the poster\'s mojo. A \"1\" rating and an email to %%local_email%% notifying us of the duplicate (please include direct link to the comment) is the appropriate response.</B></P>\n\n<P>You also have a duty to read comments posted by untrusted users (you are the only ones who can!) and rate them up if they deserve to be viewable. We hate to see users become untrusted, and want them to rejoin the community, and rating them up when they post good comments is the only way for that to happen.</P>\n\n<P>It is a cruel irony that those who are trusted, in any context, usually have more work with no particular reward for that work, and that is the case here as well. You still post with no initial rating, like a normal user, and your ratings do not carry any extra weight or power. The big reward for being trusted is that you get to see the bottom-of-the-barrel dreck. But basically, someone has to do this, and you have shown the rest of the %%sitename%% readers that you have the responsibility and perception to be trusted with this task. Hopefully there are enough of you that no one person will have to expend any unreasonable efforts.</P>\n\n<P>Thank you for contributing to %%sitename%%, and for taking on the mantle of responsibility for keeping the site as high-quality as you\'ve helped make it. I, and all the other readers, salute you.'),('untrusted','Why am I untrusted?','An explanation of why somebody is untrusted, and what they can do about it','<P>This site uses a system called \"Mojo\" to try to keep the comments as high-signal as possible. All users can rate all comments, except their own, between 1 and 5. When your comments are rated by others, those ratings are combined into a weighted average -- newer comments count more than older ones -- called your \"Mojo\". This, roughly, represents the rating we could expect your next comment to receive based on your past comments.</P>\n\n<P>Users who have a mojo greater than a certain minimum and who have posted a sufficient number of comments are considered \"trusted\" users, and have the added capability to rate comments below the normal minimum rating. If enough of a user\'s comments are rated below 1, that user becomes \"untrusted\", which means that respected members of the community have repeatedly indicated that your input is offensive, content-free, or merely intended to annoy others.</P>\n\n<P>If you are untrusted, then your comments are posted with an initial rating equal to your mojo. Since this is below the normal rating minimum, these comments are not visible to any but trusted users. They may, if they choose, rate your comments above the minimum, and make them visible to others. You may earn back the trust of the community simply by posting worthwhile comments, and not spamming.</P>\n\n<P>Please do not see this as a condemnation of you as a person. We\'re sure you\'re very nice once we get to know you. This merely means that perhaps you\'ve posted some rather ill-considered comments, and the community as a whole has decided that we\'d rather have your input peer-reviewed before it goes out to the general public. Next time you post, think carefully about what you\'re saying and whether it adds to the topic at hand. If not, there are plenty of places on the web that don\'t filter input at all, and would be glad to hear whatever\'s on your mind.</P>\n\n<P>If you believe your posting history does not warrant an untrusted rating and you have been the victim of malicious rating, then please contact us at %%local_email%%. Think carefully, and review your previous comments before you do this. If you complain and have in fact been spamming, then I will not be pleased with you. If your untrusted rating is unjustified though, then we will deal with the situation.</P>\n\n<P>Thank you for reading %%sitename%%.</P>');
/*!40000 ALTER TABLE `special` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2012-10-03 12:31:39
